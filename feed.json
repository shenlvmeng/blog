{
    "version": "https://jsonfeed.org/version/1",
    "title": "Shenlvmeng's Blog",
    "description": "Be sharp, my friend.",
    "home_page_url": "http://shenlvmeng.github.com/blog",
    "items": [
        {
            "id": "http://shenlvmeng.github.com/blog/2022/12/30/2022-to-2023/",
            "url": "http://shenlvmeng.github.com/blog/2022/12/30/2022-to-2023/",
            "title": "2022-to-2023",
            "date_published": "2022-12-30T10:31:02.000Z",
            "content_html": "<h1 id=\"2022回顾暨2023畅想\"><a href=\"#2022回顾暨2023畅想\" class=\"headerlink\" title=\"2022回顾暨2023畅想\"></a>2022回顾暨2023畅想</h1><blockquote>\n<p>2021-2022: <a href=\"https://shenlvmeng.github.io/blog/2021/12/22/2021-to-2022/\">https://shenlvmeng.github.io/blog/2021/12/22/2021-to-2022/</a></p>\n</blockquote>\n<p>2022比想象中过去得要快，这一年是紧贴时代脉搏一起脱轨的一年。生活的很多方面也不免受到影响。在日常琐事之中也埋着个人命运的一条主线——告别单身，走向家庭。在上面两个基调的影响下，回头看看过去1年拍过的照和写下的博文，似乎比往年少了些浓墨重彩的趣事。也许生活本身的难以预料琢磨，才是它令人着迷的地方吧。</p>\n<h2 id=\"2022回顾\"><a href=\"#2022回顾\" class=\"headerlink\" title=\"2022回顾\"></a>2022回顾</h2><p>书籍阅读上，经过大半年的努力，完成大部头《代码大全》的阅读；同时，神书《GEB》在进行中。读书进度受疫情影响较大，经常因为居家办公而打断。</p>\n<ul>\n<li><a href=\"https://shenlvmeng.github.io/blog/2022/03/03/all-about-code/\">关于编码的一切 ——《代码大全》 上</a></li>\n<li><a href=\"https://shenlvmeng.github.io/blog/2022/08/25/all-about-code-2/\">关于编码的一切 ——《代码大全》 下</a></li>\n</ul>\n<p>小说的阅读倒是没受到丝毫影响，剩余的推理和刑侦小说一本不落的看完了。去年未完成的X、Y、Z的悲剧还有《犹大之窗》比想象中出彩。去年剩下的管理学书籍在工作中实在有些屠龙之术的处境，对于我这样的入行年限，研究这么高深的管理学技巧有捡了芝麻丢了西瓜的嫌疑。所以先暂时搁置。一项全新领域的研究也在《GEB》的阅读中有一定收获，其关于自我指代、悖论的介绍既艰深又有趣。</p>\n<p>今年的黑天鹅事件比去年只多不少，先是3月份魔都疫情爆发导致封城3个月到6月初，我也是既20年在湖北隔离2个月后，体验到更久禁足的滋味。在家早起抢菜、做饭洗碗、白天下楼排队核酸、晚上跟着刘畊宏上下翻飞，快递动辄等个数月，数个节假日都只能在家庆祝。这种脱轨的生活在相册里体现就是清一色的做饭返图，在身体上体现就是精打细算的吃喝和锻炼让体重最多减了10斤，在竞技技术上体现就是出色的分手厨房技术，在脸上体现就是我已经记不起嘉雯化妆之后的样子。管中窥豹，可以想见我和嘉雯天天都在做些啥。因为这个原因，2022年3个硬菜的目标算是超额完成，卤牛肉、卤蛋、炸鸡柳、糖醋排骨、葱油拌面、鱼汤、骨头汤，这些以前不会尝试的大菜也算是给隔离时光带来了些许挑战的乐趣。隔离在家的3个月也算是部分弥补了之前异地的4个月里我和嘉雯聚少离多的场面。每天低头不见抬头见的同居生活，似乎并没有让我俩觉得枯燥，反而过得有滋有味的，属实奇妙。</p>\n<p>待6月初接触禁足后，车还没骑过，2022业已过半。扑朔迷离的疫情形式和管控手势下，长途骑行和旅行也成了开盲盒。本来打算在国庆来一次上海到宁波的旅行，由于凯哥的婚礼被迫取消，2022也因此没了唯一的长途骑行机会。不过，能带着嘉雯参加我最好兄弟的婚礼，还是很棒的，基友也一同去了邵东。我和嘉雯还趁着机会见缝插针在长沙和杭州<a href=\"https://shenlvmeng.github.io/blog/2022/10/14/tour-to-changsha-and-hangzhou/\">玩了一圈</a>。这趟旅途也是意外满满，看来2022并不适合旅行。livehouse和旅行一样，因为疫情并未履行。饮酒频率在封控的上半年，作为苦中作乐的方式，一直保持不高不低的频率。在凯哥婚礼的晚上俩人喝high了导致吐个没完差点影响旅行后，一直戒酒至今。运动上，骑行和游泳的频率比去年有所下降，早睡早起也间歇性遵守。出外娱乐上，我俩还是以吃为主，但更多是熟悉的老店，可能是疫情让人变宅，探店的兴致也受到了影响。</p>\n<p>每年都会有新的兴趣，2022也不例外。疫情在家莫名其妙燃起了桌游的兴趣，通过视频了解了美式、德式各种桌游的风格，隔三差五屯起了桌游。一度每个周末要组织2场桌游局，快乐的同时感觉大脑和嗓门也得到了充分的锻炼。为此家里还专门置办了一个书柜，其中1&#x2F;3用来放我买回来的桌游。另外，我俩对于拼图的兴趣也让我们陆续买了3件2000片的大幅拼图，看着整幅画面从最开始的零散到逐渐完整，成就感满满。社交上，在那些桌游局中认识了不少嘉雯的朋友。中秋时候带嘉雯回了趟老家，相处得也很是愉快。因为老大哥尚在北京出差，去沈阳的计划没能成行。</p>\n<p>工作上，似乎和之前有了不一样的认识，在转换了工作角色和工作位置后，渐渐找到了新位置的感觉。虽然和之前在教育的时候很不一样，但也胜在踏实和轻松。尽管团队规模也不算大，但也在尝试之前没有做过的东西，且有一定的学习和产出，整体还是朝好的方向发展的。回头想想自己去年的定位，可能有点过于浮躁和眼高手低了。在公司的定位下，还不需要我有多高的管理技巧，而需要有这种技巧的位置，我是否真得准备好了呢？看看现在扮演这些角色的人，他们的一天是不是你想要过的呢？这么想完之后，我又觉得现在这样也挺好。作为一只下金蛋的鸡，能保持自己一直下出金蛋也不错。至于下一步的计划，不能心急，还要慢慢积累。去年说的脚踏实地的状态，大概就是我现在的态度。我觉得这不算躺平，也算是在付着应付的责任。</p>\n<p>时间来到12月，防疫政策陆续放松，情理之中又在意料之外，大家恢复自由身的同时，医疗和药物资源的挤兑也带来了一些困难。谢天谢地，在药品并不齐备的情况下，我和嘉雯的家人暂时扛过了第一波疫情高峰，成为了康。期待明年春暖花开之后，生活秩序恢复到疫情前的模样。</p>\n<h2 id=\"2022小结\"><a href=\"#2022小结\" class=\"headerlink\" title=\"2022小结\"></a>2022小结</h2><ul>\n<li>继续脚踏实地</li>\n<li>身体才是本钱</li>\n<li>只要方向是对的，好事就会不疾不徐地发生</li>\n<li>不要太“躺”，去做成一些事情，再小的也行</li>\n<li>两个人在一起久了之后，就成了命运共同体，很多事情要一同经历一同解决</li>\n<li>大脑像水车，书籍像水，只有不断往水车上浇水，才能保证大脑新鲜灵活</li>\n</ul>\n<h2 id=\"2023畅想\"><a href=\"#2023畅想\" class=\"headerlink\" title=\"2023畅想\"></a>2023畅想</h2><p>23年有些明确的路径，譬如求婚、领证、介绍双方父母认识，还有欠下的长途骑行和旅行等等。其他的就让它自然发生吧。</p>\n<ul>\n<li>家庭<ul>\n<li>接待父母来魔都1次</li>\n<li>回家看望家人1次</li>\n<li>求婚成功</li>\n<li>领证</li>\n</ul>\n</li>\n<li>个人<ul>\n<li>完成GEB的阅读</li>\n<li>为之后的身份转变体验积累知识</li>\n<li>升级对象的骑行体验</li>\n<li>控制体重在当前附近</li>\n<li>坚持骑行和游泳</li>\n</ul>\n</li>\n<li>生活<ul>\n<li>至少1次户外长途骑行</li>\n<li>至少1次旅行</li>\n<li>看一次livehouse</li>\n<li>继续保持探店的热情</li>\n</ul>\n</li>\n<li>事业<ul>\n<li>在划定方向上完成里程碑</li>\n<li>所在小方向上为团队每个成员确定定位</li>\n</ul>\n</li>\n</ul>\n<p>剩下的，就让它顺其自然吧。我们明年见。</p>\n<p>Bye~</p>\n",
            "tags": [
                "总结",
                "2022",
                "2023"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2022/10/14/tour-to-changsha-and-hangzhou/",
            "url": "http://shenlvmeng.github.com/blog/2022/10/14/tour-to-changsha-and-hangzhou/",
            "title": "长沙、杭州之行 —— 惊不惊喜、意不意外",
            "date_published": "2022-10-14T09:17:48.000Z",
            "content_html": "<blockquote>\n<p>后疫情时代，旅游消费也带上了运气成分，再没有“说走就走”般的潇洒</p>\n</blockquote>\n<h2 id=\"序：疫情\"><a href=\"#序：疫情\" class=\"headerlink\" title=\"序：疫情\"></a>序：疫情</h2><p>疫情管控下，旅行如同开盲盒。能去哪里玩耍并不由自己的财力喜好决定，也要仰仗病毒大人给面子。上海的病毒就格外不懂事，在打工人上班的工作日岁月静好，一临近节假日就格外来精神。中秋假期，和嘉雯就和病毒擦边而过，居家办公数日得以回家过节。这次国庆前也是提心吊胆，所幸所在区疫情未扩大，倒是一路辗转，核酸7天7检，在病毒边上跳舞。</p>\n<p>这次选定长沙主要是因为姚凯婚礼，我和圣僧也是一起放弃了长途骑行计划，来邵阳蹭蹭喜气。来都来了，就顺道去长沙看看，刚好嘉雯也没去过。</p>\n<h2 id=\"Day-1-婚礼\"><a href=\"#Day-1-婚礼\" class=\"headerlink\" title=\"Day 1 婚礼\"></a>Day 1 婚礼</h2><blockquote>\n<p>邵阳</p>\n</blockquote>\n<p>我们10月1日下午从上海南站出发，搭上前往邵阳的卧铺，嘉雯之前还未坐过卧铺，适应也挺快，躺床上一路晃晃悠悠，第二天一早便到了目的地。车窗外一片阳光普照，甚是美好。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw14P0.jpg\" alt=\"邵阳\"></p>\n<p>邵阳是个县级市，类似母亲老家枣阳的感觉。城市不大，尽管姚凯预定的酒店在城市的边缘，滴滴快车开了10多分钟就到了。在酒店大堂正巧碰到姚凯和伴郎在拍摄婚礼用的短片，人逢喜事，红光满面。我和嘉雯不便打扰人家的大喜之日，简单寒暄几句，住进了姚凯事先定好的房间。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1oxU.jpg\" alt=\"酒店\"></p>\n<p>中午的婚礼现场很完美，主持人沉着冷静，凯哥表现可圈可点，整个流程也没有让人尬到脚趾扣地的情节，现场一片其乐融融，像是我未来的理想婚宴。婚宴过后，姚凯忙东忙西，我和嘉雯找了个号称邵东环境第一的网吧，吸了2个小时二手烟。屋内空调还坏了，老板一人发了根老冰棍想让我们冷静下来。</p>\n<p>在烟雾缭绕中拿到了首胜，做够了神仙，我们仓皇逃出，往市中心的百富广场走走。边走边走马观花地领略这里的风土民情。红绿灯对于这里的行人约束力并不强，大家秉承着实用主义至上的思路。路上无甚可逛，倒是见到了许多山寨品牌。晚上姚凯攒了个小局，可能是近2年不见，我俩喝得很尽兴，以至于我上头到夜里2点才睡下。</p>\n<h2 id=\"Day-2-美食\"><a href=\"#Day-2-美食\" class=\"headerlink\" title=\"Day 2 美食\"></a>Day 2 美食</h2><blockquote>\n<p>黄兴路、茶颜悦色、坡子街、南门口、电动车、东瓜山</p>\n</blockquote>\n<p>从邵阳去长沙的火车很早，一大早被嘉雯喊起来，胃里还是酒意，头脑天旋地转，脚如腾云驾雾，8点的火车，我在车上睡了一路，出站后又吃了个酒店楼下的<strong>杀猪粉</strong>，算是恢复了大半元气。杀猪粉里的胡椒粉放得很有诚意，一碗下来喉咙和胃里都是暖暖的。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1I2T.jpg\" alt=\"杀猪粉\"></p>\n<p>来长沙的第一天，天气其实算是相当阳光明媚了。哦不，甚至是明媚得过了头，到了不打伞会晒伤的程度。也许是这个天气，又或许是郊区出现的零星病例，黄兴步行街上游客并没有想象中那么密集。作为长沙第一天的第一站，也是做好了敞开了胃吃一路的心里准备。这趟美食旅程从茶颜悦色自由开始。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw15GV.jpg\" alt=\"茶颜悦色-1\"></p>\n<p>长沙街头<strong>茶颜悦色</strong>的密度相当大，而这个相当大的极值恰在黄兴路步行街。本以为要排长队的奶茶店，在三步一茶颜的密度下，极大的提升了赏味体验。第一次我们尝试了幽兰拿铁和花木兰，风味果然名不虚传，恰逢活动两杯24，性价比拉满。坐在阴凉下抿一口，哈———，巴适。</p>\n<p><img src=\"/blog/\" alt=\"幽兰拿铁\"></p>\n<p>在等位中间，我们还尝试了大众点评推荐的刘记特色里脊肉，口感滑嫩，但口味偏咸，稍有些失望。中午我们顺道去了附近的<strong>德天顺盖码饭</strong>。招牌的孜然牛肉还有辣椒炒肉味道尚可，不过性价比略低。好好拍的话，应该还挺好出图。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw17MF.jpg\" alt=\"盖码饭\"></p>\n<p>吃完不像午饭的午饭，正赶上日头最毒辣的时候，在嘉雯的提醒下，<strong>臭豆腐</strong>是不可少的。我们顺道走到了坡子街，去了一家也是连锁店遍地的臭豆腐网红店，用了张优惠券买了个大份。俩人像砌墙一样，一人一块用臭豆腐砌到了嗓子眼。不得不说，从辣度上说，还是挺正宗的。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1Hr4.jpg\" alt=\"臭豆腐\"></p>\n<p>既然吃了辣，解辣的奶茶自不能少，我俩浅排了个小队，坐在<strong>费大厨</strong>的门口，假装等号，享用着第二顿的茶颜悦色。栀子生椰就像涓涓细流，从墙砖的缝隙中滋润火热的胃。臭豆腐垒成的砖墙瞬间融化，胃口又找了回来。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1bqJ.jpg\" alt=\"栀子生椰\"></p>\n<p>尽管已经不知道吃了多少，在坡子街走了走之后，我还能吃的壮志又回来了。路上遇到M记新品——红糖冰粉，入之。刚到长沙的这几个小时似乎一直在吃，但我发现不止是我，步行街上的人们也都化身饕餮。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1LZ9.jpg\" alt=\"红糖冰粉\"></p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1XI1.jpg\" alt=\"吃\"></p>\n<p>下午沿着步行街一路走到南门口，兜兜转转好不快活。不过直到第3天，我俩才发现步行街的地下一样精彩。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1OaR.jpg\" alt=\"柠檬茶\"></p>\n<p>不知不觉，来到南门口的时候，时间已近5点，我俩在日头地下行色疲惫，想找个能歇歇脚吹吹空调的地方。秉承着光荣传统，我们骑着电动车去了网鱼网咖，并用充值体现我们对这家连锁企业的支持。</p>\n<p>嘉雯是第一次骑<strong>电动车</strong>，我虽是第二次，也比她强不少。只见她最开始慌慌张张，拒绝相信电动车有手就能骑比自行车还简单，没骑到几分钟后脸上就逐渐浮现出笑容。“啊，真香。”，我想她一定想这么喊出来。</p>\n<p>从网吧出来日头已经落下，我们要去寻找晚饭的觅食地点。才骑过一次电动车的嘉雯果断选择骑着去。骑电动车的简单快乐魔咒一定是她来长沙的最大收获。不过这可能也和养猫养狗一个道理，别人家的猫狗肯定比自己家的香，毕竟不用自己喂粮、洗澡、吸毛、铲屎就可以撸，只需办张6块钱的卡就能3次免费骑到不用自己充电的电动车，这也太爽了吧。看嘉雯掩饰不住的笑容就知道。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1vPx.jpg\" alt=\"电动车\"></p>\n<p>拐到湘江中路后，便来到了风景最好的一段，虽然看不到江，但是一路晚风吹着，一边江边步道上不少市民游客漫步起舞，另一边高楼彩灯鳞次栉比迷乱人眼，这种不受约束自由的快乐可能正是旅行的一大意义吧。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1xG6.jpg\" alt=\"高楼\"></p>\n<p>在意外发现<strong>馨砣粉店</strong>只有早上营业后，我们正巧赶上<strong>东瓜山</strong>夜市的时间，可能是晚上气温宜人，本就狭窄的东瓜山街头人头攒动，路边的摊位卖着酒酿汤圆、紫苏桃子、糖油坨坨，饭店多是烧烤，赤膊和半赤膊的人们流着汗翘着腿坐在长条板凳上，撸串碰杯，交谈混着叫号声满是喧闹。打开大众点评搜索，附近网红店，高分店不胜枚举，选择困难。不由得感慨，长沙这座城市，不论白天夜晚都是映入眼帘的小吃文化，不多带1个胃来，怕是得多带好多关于美食的遗憾离开。</p>\n<p>由于来的晚，加上对密集人群的天生厌恶，我俩并没有去朋友推荐的小龙虾店，将就选择了一家有空调的烧烤，对付着解决了晚饭的问题。下次要是再来，还是要赶早点，去那家<strong>天宝兄弟</strong>探探究竟。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw1zRK.jpg\" alt=\"东瓜山\"></p>\n<p>饭后，我们骑上电动车，沿着白沙路——韭菜园路一路直行回到酒店。路上还经过了<strong>天心阁</strong>。可惜时间有限，只是远远拍了张剪影。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3SxO.jpg\" alt=\"天心阁\"></p>\n<h2 id=\"Day-3-徒步\"><a href=\"#Day-3-徒步\" class=\"headerlink\" title=\"Day 3 徒步\"></a>Day 3 徒步</h2><blockquote>\n<p>糖油坨坨、橘子洲、岳麓山、冰箱贴</p>\n</blockquote>\n<p>由于前一夜空调不给力加上睡觉不踏实，早上起床就发觉有些感冒。想到晚上看到的望城区和天心区有病例，细思恐极。再加上西伯利亚远道而来的冷空气前锋已经来袭，天色阴沉了许多。实在是有点打扰游览的雅兴。洗漱过后，我们打起精神，先去太平街区转转。这里有点像宽敞版的南锣鼓巷，也许是疫情也许是天气，街头的人不多。我们叫了个糖油坨坨，垫了点肚子。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw39MD.jpg\" alt=\"糖油坨坨\"></p>\n<p>浅走了一段，在西牌楼的街上看到了传说中的<strong>公交新村粉店</strong>和<strong>笨罗卜湘菜</strong>。粉店环境一般，食客即吃即走，排队的人尚不算长，湘菜店则排好排到几百桌。我俩叫了雪里蕻牛肉粉，感觉不过如此，甚至不如酒店楼下的杀猪粉。考虑到价格10元出头，我们也没有太过抱怨。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3PqH.jpg\" alt=\"公交新村粉店\"></p>\n<p>吃饱喝足，我们沿湘江大桥走向橘子洲，恰如我7年前第一次来长沙那样。不同于那次8月底七月流火尚有暑热未散尽，此时桥面江风尽是萧瑟秋意，昨日的烈日高照完全不见了踪影。橘子洲角的绿树和江岸的高楼相互应和，我一边拍照一边握紧手机。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3Cse.jpg\" alt=\"湘江-1\"></p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3kdA.jpg\" alt=\"湘江-2\"></p>\n<p>沿着桥面的方向向对岸望去，岳麓山的曲线格外明显，那里正是我俩下午要去的地方。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3FZd.jpg\" alt=\"岳麓山\"></p>\n<p>在江中间下桥便到了橘子洲。下了桥看到核酸点排队人不多，为了保险，我们顺带做了个核酸（没想到第二天救了我们）。时间不充裕的情况下，想在橘子洲头看伟人头像和指点江山题字，小火车是必坐的，40元不限次数还算良心。只可惜头像周围的人实在太多，没有办法拍下我们仨的合影，我和嘉雯也不想和围栏边密密麻麻的人群一起凑热闹，只是坐在江滨的台阶上安静吹风。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3AII.jpg\" alt=\"头像\"></p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3Vit.jpg\" alt=\"广场\"></p>\n<p>坐太久不利于感冒康复，兴尽我俩又坐地铁来到湖南师大，准备吃个午饭再从岳麓书院方向爬<strong>岳麓山</strong>。没想到这里的人比昨天还要夸张，不禁感慨防疫的困难程度。最终花了1个小时终于拿到茶颜悦色和M记。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3ZJP.jpg\" alt=\"声声乌龙\"></p>\n<p>爬山的过程其实比想象中更快，依旧是从书院出口沿爱晚亭上山，依旧是走一段石板路走一段野路，欣慰的是嘉雯终于买到了心心念念的冰箱贴。山顶并不算高，也就200来米，铺设的柏油路上走满了游人。此时天色已不早，我俩赶在缆车卖票的最后时刻买到了下山的缆车，真是好险。单人下山只需25元，能坐10来分钟，还在俯瞰橘子洲、湘江两岸，性价比很高。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3eRf.jpg\" alt=\"缆车\"></p>\n<p>下了山已经是5点多了，天色渐暗，我们在虎头局吃了俩泡芙，也没有到处走走的念头，想着去网吧坐一会儿再去IFS逛逛，没想到因为胜率问题，还没拿到首胜就已经9点。屋外气温已不适合短袖出行，我俩干脆打道回府。</p>\n<h2 id=\"Day-4-意外\"><a href=\"#Day-4-意外\" class=\"headerlink\" title=\"Day 4 意外\"></a>Day 4 意外</h2><blockquote>\n<p>黄码、绿码、IFS</p>\n</blockquote>\n<p>早上起床，感冒没有好转，天气却进一步入冬，窗外下起了小雨，气温更低了。等来到地铁站准备前往五一广场时，发现健康码居然变黄了，这也是疫情这几天，健康码第一次变黄。想到最近3天也有2次核酸阴性，应该可以申诉转绿，于是回到酒店向所在社区报备，工作人员说可以再做一次核酸就可以变回来。我们便前往最近的核酸监测点做核酸，结果黄码的检测队伍已经排满了，只能去湖南第二人民医院去做。从队伍里的人聊天的内容看，健康码突然变黄的游客似乎并不少。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3uQS.jpg\" alt=\"黄码\"></p>\n<p>我们打了个车去往下一个核酸点，还好也就10分钟车程，令人哭笑不得的是，车还没到码就神奇地又变绿了。为了保险起见，我们还是打算做一次，正排着绿码核酸的队伍，健康码又变黄了。只能再去黄码队伍里排着，寒风里像我们这样排队的人并不少，也有挺多黄了又绿绿了又黄的。在网上搜了下黄码申诉的渠道，结果电话到最后都没有打通过。只能被迫下载极为难用的app，也不顾忌个人信息的安全问题，做了黄码专属核酸，填了申诉表单；填完也看不到申诉进度，只能祈祷黄码能早点转绿。在微博上搜了下#长沙 黄码#关键词，不出意外，受害者颇多，甚至也有当地人前来吐槽。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3MLQ.jpg\" alt=\"申诉\"></p>\n<p>做完核酸也到了午饭的时间，户外实在太冷，也没有心情和健康码前往五一广场吃湘菜，只能就地在马路对面的巡湘记解决。期间又经历了一次黄转绿转黄。而我已风轻云淡，伴随着黄码和因感冒失灵的鼻子，这顿饭吃得并不算香。不过，其中的豌豆还是相当不错。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3mz8.jpg\" alt=\"豌豆\"></p>\n<p>饭后码依旧是黄的，参考小上的经验，我们去韭菜园社区线下申诉，幸运的是因为做了3天两检，我们的情况可以通过填表申诉解决，欣然配合后社区提交疾控中心，说2个小时内解决。在码转绿之前也没有商场能容下我们，我俩只能再次光临网鱼网咖。由于抵达时间过早，码还没有变绿网吧小哥还收到了社区电话，结果等我俩打车准备回酒店的时候，码突然好了。在给网吧小哥解释后，我们在这里战斗了一个下午。</p>\n<p>晚饭时间，我们打车去了最后的目的地IFS，享用了最后的茶颜悦色，以一顿不辣的湘菜结束了第三天。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3Ksg.jpg\" alt=\"茶颜.jpg\"></p>\n<h2 id=\"Day-5-宅\"><a href=\"#Day-5-宅\" class=\"headerlink\" title=\"Day 5 宅\"></a>Day 5 宅</h2><blockquote>\n<p>杭州</p>\n</blockquote>\n<p>绿码坚强地坚持到了这一天一早，我们6点不到便启程前往长沙南车站，一路和满口湘普的滴滴司机交谈甚欢。经过4个小时车程，我俩成功“逃离”长沙，来了杭州。杭州东站的检疫措施一点不输长沙，偌大的站厅被划成迷宫，好在核酸效率很高，只用了10多分钟我们就坐上了去江边的地铁。</p>\n<p>杭州也是阴雨连绵，我们满心期待预定的江景房风景也打了折扣，江面和对岸的群山如同被盖上了薄纱。我俩感冒没好，也没有心情冒着雨去西湖散步，叫了个外卖奶茶吃饱喝足便回到床上躺下。嗯……果然还是茶颜悦色更胜一筹。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3lZj.jpg\" alt=\"江景\"></p>\n<p>晚上我们去附近的一家泰式餐厅南妈stay解决了晚饭，性价比还是不错的。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw31ds.jpg\" alt=\"南妈stay\"></p>\n<h2 id=\"Day-6-返程\"><a href=\"#Day-6-返程\" class=\"headerlink\" title=\"Day 6 返程\"></a>Day 6 返程</h2><p>旅程的最后一天，我们睡到12点才出发，雨还在淅淅沥沥下着，雾倒是消散了些，旅行的兴致已经没剩多少。商城里的点都德还是熟悉的味道，各种点心和在上海还有广州尝到的区别不大。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw3Giq.jpg\" alt=\"点都德\"></p>\n<p>饭后再商场里闲逛，发现居然有KTV，价格还算公道，于是在中包里度过了愉快的一个下午，唱到了许多许久未唱的老歌。</p>\n<p><img src=\"https://s1.ax1x.com/2022/10/14/xw33on.jpg\" alt=\"KTV\"></p>\n<p>从商场出来，时间也不早了，我们打着伞，拖着拉杆箱，坐地铁来到杭州站。晚上9点多久回到了上海，还是熟悉的上海南站。补做了车站的核酸，顺利回了家，结束了这次惊喜意外的国庆旅程。</p>\n<p>尽管和去年相比，因为核酸和天气多了意外，但也是我和嘉雯的第一次一起出发一起回家，期待下一次出发。坏天气总会过去，坏运气也是。</p>\n",
            "tags": [
                "随笔",
                "长沙",
                "杭州",
                "湖南",
                "核酸",
                "美食"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2022/08/25/all-about-code-2/",
            "url": "http://shenlvmeng.github.com/blog/2022/08/25/all-about-code-2/",
            "title": "关于编码的一切 ——《代码大全》 下",
            "date_published": "2022-08-25T14:37:19.000Z",
            "content_html": "<blockquote>\n<p>文接<a href=\"https://shenlvmeng.github.io/blog/2022/03/03/all-about-code/\">关于编码的一切 ——《代码大全》 下</a></p>\n</blockquote>\n<h2 id=\"软件质量\"><a href=\"#软件质量\" class=\"headerlink\" title=\"软件质量\"></a>软件质量</h2><p>在了解最基本的变量和语句组织后，这一部分围绕提高软件质量展开。</p>\n<h3 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h3><p>软件的外在质量特性体现在：</p>\n<ul>\n<li>正确性</li>\n<li>可用性</li>\n<li>效率</li>\n<li>可靠性</li>\n<li>健壮性</li>\n<li>适应性</li>\n<li>完整性</li>\n<li>精确性</li>\n</ul>\n<p>内在质量特性体现在：</p>\n<ul>\n<li>可维护性</li>\n<li>可扩展性</li>\n<li>可移植性</li>\n<li>可读性</li>\n<li>可测试性</li>\n<li>可理解性</li>\n</ul>\n<p>而改善软件质量可以有很多技术：</p>\n<ul>\n<li>确定目标</li>\n<li>测试策略</li>\n<li>非正式走查</li>\n<li>正式技术复查</li>\n<li>外部审查</li>\n</ul>\n<p>开发过程中可以通过量化结果、制作原型、控制变更等手段提升质量。</p>\n<ul>\n<li>不同的质量保障手段效率各不相同，多种缺陷检测办法结合、人工和计算机检测结合，效果会比单打独斗要好；然而没有任何一种错误检测办法可以解决全部问题</li>\n<li>越早引入软件的问题，修正代价越大，尽早开始代码质量保障工作</li>\n<li>需求或架构上的错误相比编码阶段会带来更广泛的影响</li>\n<li>改善质量可以降低开发成本</li>\n</ul>\n<h3 id=\"协同构建\"><a href=\"#协同构建\" class=\"headerlink\" title=\"协同构建\"></a>协同构建</h3><p>协同构建即在同行的帮助下完成代码构建。方式包括但不限于结对编程、正式检查、非正式技术复查、文档阅读等等。<strong>结对编程</strong>和<strong>技术性复查</strong>可以缩短开发周期，排查出更多错误，减少代码的维护时间。同时，同行间的协同构建也有助于快速提升公司开发者的开发水平。</p>\n<ul>\n<li>结对编程<ul>\n<li>结对编程中，一名程序员敲代码，另外一名注意有没有出现错误，以及考虑策略性问题</li>\n<li>成功秘诀<ul>\n<li>事先确定编程规范，避免琐碎争吵</li>\n<li>不编程的成员不能变成旁观者</li>\n<li>不需要在简单问题上使用结对编程</li>\n<li>灵活对结对成员轮换，让大家熟悉不同系统</li>\n<li>避免新手组队</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>正式检查<ul>\n<li>一种特殊的复查，与会主持人负责组织事宜，按计划、概述、准备、与会人（非作者）阐述代码、详查报告、跟进等步骤推进</li>\n<li>针对代码而非作者</li>\n<li>最终由作者负责如何处理缺陷</li>\n</ul>\n</li>\n<li>走查<ul>\n<li>走查是形式和流程都比较宽松的代码复查方式，时间较短，重点也在检查错误而非修正它们</li>\n</ul>\n</li>\n<li>代码阅读<ul>\n<li>类似Code Review，关注点主要在代码本身，而非会议</li>\n</ul>\n</li>\n<li>公开演示：类似showcase</li>\n</ul>\n<h3 id=\"开发者测试\"><a href=\"#开发者测试\" class=\"headerlink\" title=\"开发者测试\"></a>开发者测试</h3><p>测试分单元测试、组件测试、集成测试、回归测试、系统测试，前两部分通常由开发者进行，后三部分由专门的测试人员进行。测试按是否了解测试对象内部工作原理也可以分为黑盒测试和白盒测试。最后要注意，<strong>测试 ≠ 调试</strong>。</p>\n<p>对于开发者而言，测试天生有些特别：</p>\n<ul>\n<li>测试的目标是找出错误而非实现功能</li>\n<li>测试绝不可能彻底证明程序里没有错误</li>\n<li>测试无法改善软件质量，它本身只是一个指示器</li>\n</ul>\n<p>开发者测试在整个项目时间中大概占8% - 25%，在测试时有一些tips：</p>\n<ul>\n<li>写代码前先写测试用例，不会比后写多花功夫</li>\n<li>不止进行“干净测试”，也要考虑“肮脏测试”</li>\n<li>很容易对测试覆盖率过度乐观</li>\n</ul>\n<p>在现实世界中，要穷尽所有可能的输入是不可能的，<strong>测试不可能完全</strong>，有些方法会起到作用：</p>\n<ul>\n<li>使用<strong>路径数</strong>计算计算用例的<strong>最少</strong>数目，它可以保证所有代码的执行<ul>\n<li>通过子程序时，开始记1</li>\n<li>遇到<code>if</code>、<code>while</code>、<code>repeat</code>、<code>for</code>、<code>and</code>、<code>or</code>或等价物时，+1</li>\n<li>遇到每一个<code>case</code>语句，+1；没有缺省分支时，再+1</li>\n</ul>\n</li>\n<li><strong>数据流测试</strong>可以覆盖到数据的变化情况<ul>\n<li>数据有<strong>已定义</strong>、<strong>已使用</strong>、<strong>已销毁</strong>状态</li>\n<li>子程序控制流有<strong>已进入</strong>、<strong>已退出</strong>状态</li>\n<li>测试所有的<strong>已定义</strong>、<strong>已定义-已使用</strong>组合，注意其他的组合顺序</li>\n</ul>\n</li>\n<li>一个好的测试用例可以覆盖可数据数据的一大部分</li>\n<li>用启发式方法去<strong>猜测错误</strong></li>\n<li>留意<strong>边界值</strong>，如数组边界的off-by-one错误</li>\n<li>考察<strong>好数据</strong>和<strong>坏数据</strong><ul>\n<li>好数据：期望输入、最小正常值、最大正常值、旧数据兼容性</li>\n<li>坏数据：没有数据、过多数据、无效数据、长度错误、未初始化</li>\n</ul>\n</li>\n<li>使用容易验证结果的测试数据</li>\n</ul>\n<p>关于错误，也有一些先验的规律：</p>\n<ul>\n<li>符合八二法则、<strong>绝大多数错误通常和几个具有严重缺陷的子程序有关</strong></li>\n<li>大多数错误影响范围有限</li>\n<li>大多数构建错误来自编程人员的错误，多从自身想问题</li>\n<li>笔误是一个常见的问题根源</li>\n<li>错误理解需求也是常见原因</li>\n<li>大多数的错误都较易修正</li>\n<li>业界经验是，平均1000行代码发现1-25个错误，发布产品大概是1000行代码0.5个，</li>\n<li>同样留意，测试用例本身是否有误</li>\n</ul>\n<p>在当前的编程环境和工作条件下，容易找到很多测试框架，它们会包含脚手架、diff工具、测试数据生成器、覆盖率监测、日志记录、系统干扰器等。另外，自动化测试、测试问题复盘等对测试质量也有提升帮助。</p>\n<h3 id=\"调试\"><a href=\"#调试\" class=\"headerlink\" title=\"调试\"></a>调试</h3><p>调试（debug）是寻找错误根本原因和纠正错误的过程。它和测试一样，本身不是提升代码质量的方法，而是诊断代码缺陷的手段。</p>\n<ul>\n<li>调试の误区<ul>\n<li>纯靠猜测找到问题所在</li>\n<li>不去花时间理解程序和问题</li>\n<li>暂时性的掩盖问题</li>\n<li>把问题推给硬件，而不思考是不是出在自己身上</li>\n</ul>\n</li>\n<li>寻找缺陷的步骤<ul>\n<li>让错误状态稳定下来 &#x3D;&gt; 稳定复现</li>\n<li>收集相关数据，构造错误原因假说</li>\n<li>通过测试或检查代码证实或证伪假说</li>\n</ul>\n</li>\n<li>一个无法稳定重现的问题，可能和初始化或和时间有关系</li>\n<li>寻找缺陷的tips<ul>\n<li>构建缺陷假说时，要能合理解释所有测试用例</li>\n<li>定位缺陷困难时，及时补充更多的测试用例复现问题，用<strong>多视图</strong>的方式盲人摸象定位缺陷</li>\n<li>测试用例过于发散时，及时用用例否定一些假说</li>\n<li><strong>二分法</strong>缩小嫌疑范围</li>\n<li>检查<strong>最近修改</strong>或<strong>最近出过错</strong>的代码</li>\n<li>小黄鸭调试法</li>\n<li>暂时休息一下</li>\n<li>蛮力调试<ul>\n<li>抛弃有问题的代码，从头设计和编码</li>\n<li>抛弃整个程序，从头开始设计和编码</li>\n<li>不放过任何一个编译器错误</li>\n<li>手动遍历所有的循环</li>\n<li>更换编译环境或比那一起</li>\n<li>持续自动化测试</li>\n<li>显示代码中所有的打印日志信息</li>\n</ul>\n</li>\n<li>给启发式调试法一个deadline</li>\n<li>调试中避免心理惯性：人们总期望一个新现象类似他们见过的某种现象</li>\n</ul>\n</li>\n<li>修正缺陷<ul>\n<li>修正问题前确保已经很好地理解了</li>\n<li>理解程序而不仅是问题</li>\n<li>验证对错误的分析或理解</li>\n<li>保留最初的源代码</li>\n<li>治本，而不要治标</li>\n<li>一次只改一个地方</li>\n<li>搜寻代码中还有没有类似的缺陷</li>\n</ul>\n</li>\n<li>调试工具<ul>\n<li>源代码diff</li>\n<li>编译警告信息</li>\n<li>lint和代码自动修正</li>\n<li>性能剖测（profile）</li>\n<li>测试脚手架</li>\n<li>调试器</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"重构\"><a href=\"#重构\" class=\"headerlink\" title=\"重构\"></a>重构</h3><blockquote>\n<p>更多重构介绍可以参考这篇blog<a href=\"https://shenlvmeng.github.io/blog/2020/08/17/refactoring-design-improvement/\">重构 —— 代码的实用性与艺术性</a></p>\n</blockquote>\n<p>重构即在<strong>不改变软件外部行为的基础上，改变其内部结构</strong>。即便是管理完善的项目，每个月都会发生需求变化，稳定不变的需求是个童话。</p>\n<p>代码出现以下“坏味道”（smell）时，代表需要重构了。</p>\n<ul>\n<li>代码重复</li>\n<li>子程序冗长</li>\n<li>嵌套过深</li>\n<li>内聚性差</li>\n<li>参数列表过长</li>\n<li>类和继承关系不合理</li>\n<li>基本数据类型过多</li>\n<li>“流浪数据”传递</li>\n<li>无所事事的类</li>\n<li>命名不当</li>\n<li>难理解的注释</li>\n<li>全局变量</li>\n<li>子程序需要前置或后置处理</li>\n<li>过早设计或过度设计</li>\n<li>…</li>\n</ul>\n<p>重构分级别有下面一些手段</p>\n<ul>\n<li>数据级<ul>\n<li>具名常量</li>\n<li>更可读的变量</li>\n<li>函数替代表达式</li>\n<li>中间变量</li>\n<li>减少重复使用变量</li>\n<li>类型码转成类或枚举类型</li>\n<li>类封装</li>\n</ul>\n</li>\n<li>语句级<ul>\n<li>分解布尔表达式</li>\n<li>用可读名字的布尔函数替代布尔表达式</li>\n<li>合并条件语句中的重复代码片段</li>\n<li><code>break</code>或<code>return</code>替代循环控制变量</li>\n<li>多态替换条件语句</li>\n<li>null对象替代空值检测</li>\n</ul>\n</li>\n<li>子程序<ul>\n<li>内莲花</li>\n<li>提炼子程序</li>\n<li>转化为类</li>\n<li>增&#x2F;删参数</li>\n<li>合并&#x2F;拆分子程序</li>\n<li>读写操作分离</li>\n<li>传递成员&#x2F;类</li>\n</ul>\n</li>\n<li>类实现<ul>\n<li>值&#x2F;引用对象转化</li>\n<li>成员函数&#x2F;成员数据位置移动</li>\n<li>相似代码提炼到基类</li>\n<li>差异代码拆分到派生类</li>\n</ul>\n</li>\n<li>类接口<ul>\n<li>类拆分&#x2F;合并</li>\n<li>删除类</li>\n<li>去掉中间人</li>\n<li>继承替代委托</li>\n<li>委托替代继承</li>\n<li>引入外部成员函数</li>\n<li>引入扩展类</li>\n<li>封装不使用的成员函数</li>\n</ul>\n</li>\n<li>系统级<ul>\n<li>为无法控制的数据创建索引源</li>\n<li>工厂模式</li>\n<li>异常&#x2F;错误处理代码选型</li>\n</ul>\n</li>\n</ul>\n<p>要想让重构不影响日常功能开发，需要考虑</p>\n<ul>\n<li>有一个代码版本管理工具</li>\n<li>重构步伐小一点</li>\n<li>同一时间只做一个重构</li>\n<li><strong>重新测试</strong></li>\n<li>增加测试用例</li>\n<li>检查代码更改</li>\n<li>根据重构风险选择重构方法</li>\n<li>不要把重构当成糟糕设计的挡箭牌</li>\n<li>避免用重构代替重写</li>\n</ul>\n<p>重构可以在修改代码的时候进行，不论是增加修改子程序还是类，或者是修复缺陷。对于从未重构的糟糕代码，可以用一部分混乱的代码隔离复杂度，把理想规整的代码和混乱不堪的真实世界隔离开。</p>\n<h3 id=\"代码调整策略\"><a href=\"#代码调整策略\" class=\"headerlink\" title=\"代码调整策略\"></a>代码调整策略</h3><p>代码调整指出于<strong>性能</strong>考虑，对代码进行实现上的调整。本章主要讨论策略。</p>\n<ul>\n<li>动手前的考虑<ul>\n<li><strong>性能≠代码速度</strong></li>\n<li>想清楚你确实在解决一个需要解决的问题</li>\n</ul>\n</li>\n<li>调整考量<ul>\n<li>程序设计：设计架构时考虑整体性能，再为每个子系统、类设计要达到的资源占用目标</li>\n<li>和操作系统的交互</li>\n<li>代码编译</li>\n<li>硬件</li>\n<li>类和子程序设计</li>\n<li>代码调整</li>\n</ul>\n</li>\n<li>帕累托法则，又称八二法则，程序中20%的子程序耗费了80%的执行时间</li>\n<li>一些<strong>错误认知</strong><ul>\n<li>减少代码行数就可以减少资源占用</li>\n<li>特定的写法会比其他的更快，代码也会更小（<em>要看编译环境</em>）</li>\n<li>应当随时随地优化（<em>不成熟的优化不如不优化</em>）</li>\n<li>运行速度和正确性同样重要</li>\n</ul>\n</li>\n<li>先提升代码可维护性，在程序完成且表现正确后，再去提升系统性能</li>\n<li>常见的低效率来源<ul>\n<li>IO操作</li>\n<li>内存分页</li>\n<li>系统API调用</li>\n<li>脚本语言</li>\n</ul>\n</li>\n<li>性能测量：没有准确的性能测量就不要去做优化</li>\n<li>代码调整需要反复尝试，才能达到理想的性能提高</li>\n</ul>\n<h3 id=\"代码调整技术\"><a href=\"#代码调整技术\" class=\"headerlink\" title=\"代码调整技术\"></a>代码调整技术</h3><p>文接上章，本章讨论具体调整手段。</p>\n<ul>\n<li>代码调整和重构相反，大多数情况下是以牺牲程序可读性为代价换取更高的性能</li>\n<li>调整手段<ul>\n<li>逻辑<ul>\n<li>知道答案后停止判断</li>\n<li>按照出现频率调整判断顺序，把容易为真的判断放在最前面</li>\n<li>表驱动法代替复杂表达式</li>\n<li>惰性求值</li>\n</ul>\n</li>\n<li>循环<ul>\n<li>把判断提出循环体</li>\n<li>展开小循环</li>\n<li>合并循环</li>\n<li>减少循环体内的操作</li>\n<li>用哨兵值提前结束循环</li>\n<li>把最忙的循环放在最内侧</li>\n<li>用低强度的计算代替高强度计算，如加法替代乘法，乘法代替幂运算</li>\n</ul>\n</li>\n<li>数据<ul>\n<li>使用整型而非浮点数</li>\n<li>减少数组维度</li>\n<li>使用辅助索引</li>\n<li>使用缓存</li>\n</ul>\n</li>\n<li>表达式<ul>\n<li>利用恒等式简化代码复杂度</li>\n<li>削弱计算强度</li>\n<li>编译期初始化</li>\n<li>小心系统函数，为了兼容最糟情况，系统函数会比较复杂</li>\n<li>事先算出结果</li>\n<li>删除公共表达式</li>\n</ul>\n</li>\n<li>子程序<ul>\n<li>子程序改为内联</li>\n</ul>\n</li>\n<li>用低级语言重写</li>\n</ul>\n</li>\n<li>再次强调，<strong>没有性能优化测量就没有代码调整</strong></li>\n</ul>\n<h2 id=\"系统考虑\"><a href=\"#系统考虑\" class=\"headerlink\" title=\"系统考虑\"></a>系统考虑</h2><p>这一部分站在系统的角度考虑构建过程中的程序规模、集成、工具等问题。</p>\n<h3 id=\"程序规模带来的影响\"><a href=\"#程序规模带来的影响\" class=\"headerlink\" title=\"程序规模带来的影响\"></a>程序规模带来的影响</h3><p>软件规模的扩大可能会为你带来意料之外的大量问题。</p>\n<ul>\n<li>如果你习惯于开发小项目，那么你的第一个大型项目很可能会严重失控</li>\n<li><strong>沟通交流</strong>：项目成员的扩大带来的交流路径不是加性的，是<strong>乘性</strong>的</li>\n<li><strong>错误</strong>：项目规模的扩大也会带来更高的缺陷密度</li>\n<li><strong>生产率</strong>：大项目会带来更低的生产率</li>\n<li><strong>工作量</strong>：软件构建的工作量和项目大小是线性关系，而其他活动的工作量则是非线性增加</li>\n<li>不同规模的代码从小到大可以称作程序、产品、系统、系统产品，没能意识到它们间的不同也是估算偏差的出现来源</li>\n<li>项目越正规，就越重视<strong>方法论</strong>，不得不写的文档也会更多，撰写的文档也会更正规</li>\n</ul>\n<h3 id=\"构建管理\"><a href=\"#构建管理\" class=\"headerlink\" title=\"构建管理\"></a>构建管理</h3><p>构建管理是软件管理中的一部分。</p>\n<ul>\n<li>鼓励良好的编程实践<ul>\n<li>逐行复查</li>\n<li>代码签名</li>\n<li>鼓励最佳实践</li>\n</ul>\n</li>\n<li>配置管理：系统化定义项目工件和处理流程<ul>\n<li>需求和设计变更<ul>\n<li>遵循系统化的变更手续</li>\n<li>成组变更</li>\n<li>评估变更成本</li>\n<li>坏味道：频繁大量变更</li>\n</ul>\n</li>\n<li>软件变更：版本控制软件</li>\n<li>机器配置变更：机器镜像</li>\n</ul>\n</li>\n<li>评估构建进度表<ul>\n<li>评估项目规模和工作量是软件项目管理中最具挑战性的部分，平均水平的大型软件都要超时1年，超预算100%才能完成</li>\n<li>清楚说明软件需求</li>\n<li>使用不同方法评估再对比</li>\n<li>定期更新评估</li>\n<li>以下因素会影响软件开发进度，但不易被量化<ul>\n<li>开发者的经验和能力</li>\n<li>团队的动力</li>\n<li>管理质量</li>\n<li>可重用的代码数目</li>\n<li>人员流动性</li>\n<li>需求变更</li>\n<li>文档量</li>\n<li>分级安全环境</li>\n</ul>\n</li>\n<li>如果进度落后了要怎么办<ul>\n<li>扩充团队在<strong>项目任务不能分割并一一击破</strong>时，只会增加项目交流复杂度，并加速项目延期</li>\n<li>缩减项目范围，有限保证核心功能</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>度量：对项目特征进行度量可以评估项目进度和风险，当然保证ddl比收集度量数据更重要</li>\n<li>把程序员当人看<ul>\n<li>程序员1天大概有30%时间花费在“对项目没有直接好处”的非技术活动中</li>\n<li><strong>不同程序员间的努力和能力差异很大</strong>，不同团队在软件质量和生产率的差异上也很大，好的和坏的程序员都倾向于聚集在一起</li>\n<li>在代码风格的信仰问题上，使用“建议”或大多数人达成统一的指导规范</li>\n<li>优良的物理工作环境有助于提升程序员的生产率和生产质量</li>\n</ul>\n</li>\n<li>管理你的管理者：向上管理</li>\n</ul>\n<h3 id=\"集成\"><a href=\"#集成\" class=\"headerlink\" title=\"集成\"></a>集成</h3><p>集成方式也会影响到集成的质量。从频率上分，有<strong>阶段式集成</strong>和<strong>增量集成</strong>，在阶段式集成中，分为单元开发和系统集成两个阶段。增量集成中，程序是一点一点写出来并一点点拼接起来的。对比阶段式集成，增量集成有下面一些好处：</p>\n<ul>\n<li>易于定位错误</li>\n<li>更早在项目中取得系统级结果</li>\n<li>对项目结果更好的监控</li>\n<li>能在更短的开发计划中建造出整个系统</li>\n</ul>\n<p>而增量集成有下面一些常见策略：</p>\n<ul>\n<li><strong>自顶向下集成</strong>：先集成系统设计，再集成具体实现；优点是能更早有整个系统的大局观，缺点是在前期会加入很多底层的mock代码，且将调试过程推迟到项目后期</li>\n<li><strong>自底向上集成</strong>：和自顶向下相反，优点是很容易定位错误，缺点是丧失全局的认识，系统设计的问题在后期修改成本较高</li>\n<li><strong>三明治集成</strong>：先集成顶部的高层业务对象和底部的基础工具类，再集成中间层代码，整合了自顶向下和自底向上</li>\n<li><strong>风险导向的集成</strong>：鉴别不同类的风险级别，先集成风险高的</li>\n<li><strong>功能导向的集成</strong>：一次集成一组功能，它基本上不需要脚手架，且每次集成都能增强系统的功能性，且和面向对象设计比较好协同工作</li>\n<li><strong>T型集成</strong>：在集成高层对象后，先选中某个特定功能块，完成一次所有类的集成，这样可以作为MVP演练整个系统</li>\n</ul>\n<p>结合<strong>冒烟测试</strong>的“<strong>每日构建</strong>”（daily build）是软件集成的一种最佳实践。它能让产品每天都有进步，且让项目保持一个固定的脉搏。做好daily build，有下面一些建议</p>\n<ul>\n<li>不放过失败的build，保证每次build都能通过冒烟测试</li>\n<li>每天进行冒烟测试</li>\n<li>冒烟测试需要和代码一样“与时俱进”</li>\n<li>让daily build和冒烟测试<strong>自动化</strong></li>\n<li>要求开发人员构建前进行冒烟测试</li>\n<li>将修订保持合适的合并节奏，不要太密，也不要太疏</li>\n<li>在早上发布build，给潜在问题留下修复时间</li>\n<li>顶住需求压力，保证daily build和冒烟测试</li>\n</ul>\n<p>在daily build的基础上，可以很轻易地做到1日多次的<strong>持续集成</strong>。</p>\n<h3 id=\"编程工具\"><a href=\"#编程工具\" class=\"headerlink\" title=\"编程工具\"></a>编程工具</h3><blockquote>\n<p>工欲善其事，必先利其器</p>\n</blockquote>\n<p>现代化的编程环境下，有很多可以采用的编程工具：</p>\n<ul>\n<li>设计工具</li>\n<li>源代码工具<ul>\n<li>IDE</li>\n<li>文本替换工具</li>\n<li>diff工具</li>\n<li>merge工具</li>\n<li>源代码美化器</li>\n<li>接口文档生成</li>\n<li>代码模板&#x2F;代码生成</li>\n<li>命令行</li>\n<li>代码质量分析<ul>\n<li>linter</li>\n<li>metrics报告</li>\n</ul>\n</li>\n<li>重构代码<ul>\n<li>重构器</li>\n<li>代码翻译器</li>\n</ul>\n</li>\n<li>版本控制工具</li>\n<li>数据字典</li>\n</ul>\n</li>\n<li>可执行码工具<ul>\n<li>目标码生成<ul>\n<li>编译器、链接器</li>\n<li>build工具，如make、ant</li>\n</ul>\n</li>\n<li>程序库&#x2F;第三方库</li>\n<li>代码生成向导</li>\n<li>安装指引</li>\n</ul>\n</li>\n<li>调试</li>\n<li>测试</li>\n<li>代码调整<ul>\n<li>性能剖测</li>\n<li>汇编和反汇编</li>\n</ul>\n</li>\n</ul>\n<p>在Unix这样的工具导向环境下就更容易孕育编程工具，如grep、diff、sort、make、tar、line、sed、awk、vi等。几乎所有的大型组织都有自己的内部工具和支持团队，不少比市面上的还要优秀。针对特定项目，有时候也会开发特定的项目工具，如航天、保险、医疗等。对于个人开发，也可以使用脚本这种自动执行重复性杂务的工具。</p>\n<p>最后要澄清一个事实，<strong>编程工具并不能消灭人在编程里的核心地位</strong>，只是不断<strong>重塑</strong>（reshape）编程的含义。连接到其他软硬件的复杂接口，规章制度、业务规则这些计算机编程之外的复杂之源还是要人来应对。而被用来填补真实世界和解决问题的计算机之间鸿沟的人，被称作程序员。</p>\n<h2 id=\"软件工艺\"><a href=\"#软件工艺\" class=\"headerlink\" title=\"软件工艺\"></a>软件工艺</h2><p>编程是硬件与艺术的融合体，软件工艺是编程美学的一种体现。</p>\n<h3 id=\"布局与风格\"><a href=\"#布局与风格\" class=\"headerlink\" title=\"布局与风格\"></a>布局与风格</h3><p>编排出色的代码会带来<strong>视觉</strong>上和<strong>思维</strong>上的愉悦。</p>\n<ul>\n<li>基本原则<ul>\n<li>好的布局可以凸显程序的逻辑结构，也更符合人类直觉</li>\n<li><strong>傻子都会写计算机理解的代码，而优秀程序员写的是人能看懂的代码</strong></li>\n<li>高手的机型并非天生优于新手，而是高手具备某种知识结构，这种结构有助于高手记住特定类型的信息；因此当信息符合这些结构时，就可以被轻易的理解</li>\n<li>布局非信仰，要保持头脑开放，接受已被证实更好的方法</li>\n</ul>\n</li>\n<li>布局技术<ul>\n<li><strong>空白</strong><ul>\n<li>分组</li>\n<li>空行</li>\n<li>缩进</li>\n</ul>\n</li>\n<li>括号</li>\n</ul>\n</li>\n<li>布局风格：同一层级的语句缩进相同<ul>\n<li>纯块结构</li>\n<li>模仿块结构</li>\n<li>花括号指定边界</li>\n<li>行尾布局（不推荐）</li>\n</ul>\n</li>\n<li>控制结构布局<ul>\n<li>段落间的空行</li>\n<li>复杂的表达式拆分条件到多行</li>\n<li>不用<code>goto</code></li>\n</ul>\n</li>\n<li>单行语句布局<ul>\n<li>控制长度</li>\n<li>使用空格</li>\n<li>后续行缩进统一</li>\n<li>后续行结尾统一</li>\n<li><strong>一行一条语句</strong><ul>\n<li>减少复杂度</li>\n<li>读代码仅需自上而下</li>\n<li>不要在单行中多个操作</li>\n</ul>\n</li>\n<li>一行一个声明</li>\n</ul>\n</li>\n<li>注释风格<ul>\n<li>缩进和代码一致</li>\n<li>用空行和代码隔开</li>\n</ul>\n</li>\n<li>子程序布局<ul>\n<li>空行分段</li>\n<li>参数按标准缩进</li>\n</ul>\n</li>\n<li>类布局<ul>\n<li>头部注释 -&gt; 构造函数&#x2F;析构函数 -&gt; public子程序 -&gt; protected子程序 -&gt; private子程序和成员</li>\n<li>文件布局<ul>\n<li>一个文件一个类</li>\n<li>文件命名和类有关</li>\n<li>在文件中清晰分隔各子程序</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"自说明代码\"><a href=\"#自说明代码\" class=\"headerlink\" title=\"自说明代码\"></a>自说明代码</h3><p>本节专注于文档的特殊补充形式，即“注释”。</p>\n<ul>\n<li>在代码中起主要作用的并非注释，而是<strong>好的编程风格</strong></li>\n<li>注释的哲学<ul>\n<li>注释能提供更高层级的抽象</li>\n<li>重复注释根本没用</li>\n<li>注释写的不合适只会起反作用</li>\n</ul>\n</li>\n<li>注释类别：在代码完工后，只允许出现后三种<ul>\n<li>重复代码（Bad case）</li>\n<li>解释代码：当代码过于复杂到需要解释时，最好是改进代码，而不是添加注释</li>\n<li>代码标记，如<code>TODO</code>，<code>FIXME</code></li>\n<li>概述代码</li>\n<li>意图说明</li>\n<li>传达代码以外的信息，如版权声明、保密要求</li>\n</ul>\n</li>\n<li>高效注释<ul>\n<li>用伪代码法减少注释时间</li>\n<li>将注释如何到开发风格中</li>\n</ul>\n</li>\n<li>注释技术<ul>\n<li>注释单行<ul>\n<li>去掉无关注是</li>\n<li>减少行尾注释</li>\n<li>行尾注释只用于数据声明、维护标记、标记行尾等场景</li>\n</ul>\n</li>\n<li>注释代码段<ul>\n<li>应表达<strong>why</strong>而非<strong>how</strong></li>\n<li>代码本身应尽力组做好说明</li>\n<li>注明非常规用法</li>\n<li>错误或语言环境独特点要加注释</li>\n</ul>\n</li>\n<li>注释数据声明<ul>\n<li>数值单位</li>\n<li>允许范围</li>\n<li>输入限制</li>\n<li>全局数据</li>\n</ul>\n</li>\n<li>注释控制结构<ul>\n<li>循环结束的行尾注释是代码太复杂的征兆</li>\n</ul>\n</li>\n<li>注释子程序<ul>\n<li>注释要靠近说明的代码</li>\n<li>用简短的话进行说明</li>\n<li>注释声明参数</li>\n<li>可以使用Javadoc这种工具</li>\n<li>说明子程序的全局作用</li>\n</ul>\n</li>\n<li>注释类、文件、程序</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"个人性格\"><a href=\"#个人性格\" class=\"headerlink\" title=\"个人性格\"></a>个人性格</h3><p>软件工程是纯粹的脑力劳动。软件工程师研究工具和原材料的本质时，实际上是在研究人的智力、性格这种无形的东西。</p>\n<ul>\n<li>编程工作本质上是项难以监督的工作，你也需要对自己负责</li>\n<li>聪明和谦虚</li>\n<li>求知欲<ul>\n<li>形成自我意识</li>\n<li>实验</li>\n<li>学习成功项目</li>\n<li>阅读文档</li>\n<li>和同行交流</li>\n</ul>\n</li>\n<li>不屈不挠的诚实感</li>\n<li>交流和合作：<strong>编程首先是与人交流，然后才是和计算机交流</strong></li>\n<li>创造力和纪律</li>\n<li>懒惰：避免“实在懒”，追求“开明懒”和“一劳永逸的懒”</li>\n<li>可能不那么明显的性格<ul>\n<li>坚持：要时不时抬头开清方向</li>\n<li>经验：不同于其他行业，<strong>软件开发行业的经验比书本知识价值要小，基础知识变化很快</strong>，不存在越老越吃香的情况。不持续学习跟上潮流，仅靠经验吃饭，会被逐渐淘汰。</li>\n</ul>\n</li>\n<li>习惯<ul>\n<li>好习惯很重要</li>\n<li>不要用“没有习惯”替代“坏习惯”</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"软件工艺探讨的话题\"><a href=\"#软件工艺探讨的话题\" class=\"headerlink\" title=\"软件工艺探讨的话题\"></a>软件工艺探讨的话题</h3><p>《代码大全》全书都着重于软件构建的细节，本章从抽象的关注点出发，看看哪些方面会影响软件的工艺。</p>\n<ul>\n<li>软件开发的核心是致力于<strong>降低复杂度</strong>，管理复杂度是软件的核心使命，之前各章节提过了很多具体办法。各种形式的抽象都是管理复杂度的强大工具。<ul>\n<li>划分子系统</li>\n<li>仔细定义类接口</li>\n<li>保持接口抽象性</li>\n<li>避免全局变量</li>\n<li>避免深层次继承</li>\n<li>避免深度嵌套和循环</li>\n<li>不用<code>goto</code></li>\n<li>子程序短小精悍</li>\n<li>使用清晰明了的变量名</li>\n<li>使用规范和约定减少理解负担</li>\n</ul>\n</li>\n<li>软件开发和其<strong>过程</strong>密不可分，在多程序员参与的项目里，组织性的重要性超过了个人技能<ul>\n<li>坏的过程只会损耗脑力，好的过程则可以开发脑力到极限</li>\n</ul>\n</li>\n<li>首先为人写程序，然后才是机器，强调代码可读性，便于与同行沟通</li>\n<li>深入一门语言去编程，不浮于表面<ul>\n<li>杰出的程序员会考虑他们要干什么，然后才是怎么用手头的工具实现目标</li>\n</ul>\n</li>\n<li>借助<strong>规范</strong>集中注意力</li>\n<li>基于问题域编程<ul>\n<li>将程序划分为不同层级的抽象<ul>\n<li>第0层：操作系统的操作和机器指令</li>\n<li>第1层：编程语言结构和工具</li>\n<li>第2层：底层实现结构，如算法和数据结构</li>\n<li>第3层：低层问题域，这一层已经有问题域相关的操作原语可以使用</li>\n<li>第4层：高层问题域，你的非技术用户某种程度也应该可以看懂你的代码</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>编程是科学和艺术融合的一门工程学科</li>\n<li><strong>迭代</strong>在软件开发中是很正常的现象。软件设计是一个逐步精化的过程。</li>\n<li>将软件和信仰分离开<ul>\n<li>不要盲目跟风</li>\n<li>保持折中态度</li>\n<li>权衡各种技术，再做决定</li>\n<li>基于实验，保持开放心态</li>\n</ul>\n</li>\n</ul>\n<p>–END–</p>\n",
            "tags": [
                "编程",
                "范式",
                "设计",
                "艺术",
                "质量"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2022/03/03/all-about-code/",
            "url": "http://shenlvmeng.github.com/blog/2022/03/03/all-about-code/",
            "title": "关于编码的一切 ——《代码大全》 上",
            "date_published": "2022-03-03T15:09:50.000Z",
            "content_html": "<blockquote>\n<p>拿到它的时候，它已印刷了13年之久；能在京东上找到，也是极大的幸运。</p>\n</blockquote>\n<p>《代码大全》是一部又大又全的工具书，它涵盖了关于编程各个环节的充分经验，可以作为日程编程工作的指导。将其他教我如何编程的书中的内容做了一个打包。数月研读下来，难免有所遗忘。这里将其中的精华尽量记录下来，也作为对全书内容的一个回顾。</p>\n<h2 id=\"打好基础\"><a href=\"#打好基础\" class=\"headerlink\" title=\"打好基础\"></a>打好基础</h2><p>第1部分主要围绕构建为读者讲解什么是构建，和关于构建我们需要了解和准备的。也为后面展开具体编程细节和设计艺术打基础。</p>\n<h3 id=\"走进软件构建\"><a href=\"#走进软件构建\" class=\"headerlink\" title=\"走进软件构建\"></a>走进软件构建</h3><p>构建是软件开发的核心，构建的质量对软件质量有实质影响。</p>\n<h3 id=\"隐喻理解软件开发\"><a href=\"#隐喻理解软件开发\" class=\"headerlink\" title=\"隐喻理解软件开发\"></a>隐喻理解软件开发</h3><p>用隐喻可以帮助理解软件开发的过程。</p>\n<ul>\n<li>一个好的隐喻应该是简单的，忽略了不必要的细节，对概念进行内化和抽象，让人从更高层面思考问题，从而避免低层次错误</li>\n<li>隐喻更像<strong>启示</strong>，而非<em>算法</em></li>\n<li>对于编程来说，还是将问题概念化</li>\n<li>有一些常见的软件隐喻<ul>\n<li>写作&#x2F;耕作：这些隐喻不太合适</li>\n<li>养殖：增量、迭代、自适应、演进的成长概念</li>\n<li>建造：规划设计文档，使用现成组件</li>\n</ul>\n</li>\n<li>组合各种隐喻，不要过度引申隐喻，带来误导</li>\n</ul>\n<h3 id=\"提前准备\"><a href=\"#提前准备\" class=\"headerlink\" title=\"提前准备\"></a>提前准备</h3><p>提前准备，降低风险。</p>\n<ul>\n<li>前期准备的必要性<ul>\n<li>降低风险</li>\n<li>通过逻辑、类比、数据说服项目经理<ul>\n<li>开始大项目前需要制定计划</li>\n<li>程序员是食物链的最后一环，架构师吃掉需求，设计师吃掉架构，程序员消化设计</li>\n<li>发现错误的时间要尽可能接近引入错误的时间，可以尽量降低修复时间</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>判别你所在的软件领域<ul>\n<li>在软件开发中，适用迭代式开发法比适用序列式开发法的情况多得多</li>\n</ul>\n</li>\n<li>先清楚定义问题</li>\n<li>再正确认清需求<ul>\n<li>正式详尽地描述需求，是项目成功的关键<ul>\n<li>面向目标、契约式编程</li>\n</ul>\n</li>\n<li>稳定需求是可望而不可即的<ul>\n<li><strong>开发过程会帮助客户更好地理解自己的需求，这也是需求变更的主要来源</strong></li>\n</ul>\n</li>\n<li>应对需求变更<ul>\n<li>核对当前需求的质量（<em>需要有一个需求质量的核对表</em>），及时回退到需求设计环节</li>\n<li>确保每个人都知道变更的代价</li>\n<li>建立变更的控制流程</li>\n<li>要放弃么？</li>\n<li>考虑项目的商业价值</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>考虑架构设计<ul>\n<li>架构指整个系统的设计约束，不会细节到子系统或类的设计约束</li>\n<li>架构的组成部分<ul>\n<li>程序组织</li>\n<li>主要的类和类的继承体系</li>\n<li>数据结构设计</li>\n<li>业务规则描述</li>\n<li>UI设计</li>\n<li>资源管理：数据库连接、线程、句柄</li>\n<li>安全</li>\n<li>性能</li>\n<li>可扩展性</li>\n<li>国际化</li>\n<li>错误处理：纠正还是检测、主动还是被动</li>\n<li>输入输出</li>\n<li>容错性</li>\n<li>过度工程：明确设立期望目标</li>\n<li>“买”还是“造”：如果架构选择自己做，那么一定要证明自己定制的组件在某方面胜过现有的</li>\n<li>变更策略：如何应对变更</li>\n</ul>\n</li>\n<li>架构的总体质量<ul>\n<li>和嗦、所解决的问题和谐一致，看起来自然</li>\n<li>描述所有主要的决策动机</li>\n<li>优秀的架构很大程度和机器与编程语言无关</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>投入的时间一般在20%-30%</li>\n</ul>\n<h3 id=\"关键的构建决策\"><a href=\"#关键的构建决策\" class=\"headerlink\" title=\"关键的构建决策\"></a>关键的构建决策</h3><p>选择语言、技术、构建实践。</p>\n<ul>\n<li>高级语言表达力更强<ul>\n<li><strong>你思考的能力取决于你是否知道可以表达该思想的词汇</strong></li>\n</ul>\n</li>\n<li>提前讲好使用的<strong>编程约定</strong>，去统一编程语言的细节</li>\n<li>找准在技术浪潮中的位置<ul>\n<li>如果在浪潮后期，就可以持续使用稳定的功能；在浪潮前期，则需要花时间找到文档中没有说明的编程语言特性</li>\n<li>“深入一种语言去编程”，<strong>程序员现决定想表达的思想是什么，再决定如何使用特定语言的工具去表达这些思想</strong></li>\n</ul>\n</li>\n<li>选择构建实践</li>\n</ul>\n<h2 id=\"创建高质量代码\"><a href=\"#创建高质量代码\" class=\"headerlink\" title=\"创建高质量代码\"></a>创建高质量代码</h2><p>这一部分主要讲解类和子程序的设计和编码。</p>\n<h3 id=\"如何做设计\"><a href=\"#如何做设计\" class=\"headerlink\" title=\"如何做设计\"></a>如何做设计</h3><p>一些启发式准则和idea</p>\n<ul>\n<li>设计的挑战<ul>\n<li>有的问题需要“解决”一边，才能明确定义它，然后再次解决</li>\n<li>设计成功应该是组织良好且清爽的，不过设计过程却并非如此</li>\n<li>设计需要取舍，受到限制</li>\n<li>设计需要启发式思维，但也是不断评估、讨论、调试实验中诞生的</li>\n</ul>\n</li>\n<li>设计的关键概念<ul>\n<li>管理复杂度<ul>\n<li>软件开发的本质复杂性来自复杂无序的现实世界，精确完整地识别依赖关系和意外情况，设计完全正确而不是部分正确的方案</li>\n<li>软件需要管理复杂度，在组织程序的时候便于在一个时刻专注于一个特定的部分，另外不遗漏暂时忽视的部分</li>\n<li>应对复杂度：减少本质复杂度到最小、避免偶然复杂度的无谓增长</li>\n</ul>\n</li>\n<li>理想的设计特征<ul>\n<li>最小复杂度</li>\n<li>易于维护</li>\n<li>松耦合</li>\n<li>可扩展、可重用</li>\n<li>高扇入（类被其他类大量使用）、低扇出（类少量使用其他类）</li>\n<li>可移植性</li>\n<li>精简性</li>\n<li>标准化</li>\n</ul>\n</li>\n<li>设计的层次<ul>\n<li>软件系统 &gt; 子系统或包 &gt; 类 &gt; 子程序 &gt; 子程序内</li>\n<li>常用子系统：业务规则、用户界面、数据库访问、OS抽象层</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>设计构造块：启发式方法<ul>\n<li>寻找现实对象：想想系统要模仿什么<ul>\n<li>辨识对象和其属性</li>\n<li>确定可以对对象做的操作</li>\n<li>确定对象能对其他对象进行的操作</li>\n<li>确定对象的可见范围</li>\n<li>定义对象接口</li>\n</ul>\n</li>\n<li>形成一致的<strong>抽象</strong>：让你关注某概念的时候忽略不必要的细节</li>\n<li><strong>封装</strong>实现细节：封装帮你掩盖不需要你看到的复杂度</li>\n<li><strong>继承</strong>能简化设计就继承</li>\n<li>隐藏秘密信息<ul>\n<li>保证接口最小且完备</li>\n<li>隐藏复杂度和变化源</li>\n</ul>\n</li>\n<li>找出容易改变的区域<ul>\n<li>业务规则、硬件依赖、输入输出、非标准的预演特性、状态变量、糟糕或复杂的设计</li>\n<li>将容易变化的部分隔离开，让变化的影响范围和变化的可能性成反比</li>\n</ul>\n</li>\n<li>保持松散耦合<ul>\n<li>耦合种类：简单数据参数、简单对象、对象参数、语义耦合（过多假设）</li>\n</ul>\n</li>\n<li>了解常用的设计模式<ul>\n<li>设计模式提供了现成的抽象来减少复杂度</li>\n<li>设计模式将抽象SOP化</li>\n<li>设计模式可以起到启发性作用</li>\n<li>设计模式将设计对话提高到更高层次来简化交流</li>\n</ul>\n</li>\n<li>其他启发式方法<ul>\n<li>高内聚</li>\n<li>契约式设计</li>\n<li>TDD</li>\n<li><strong>创建中央控制点，集中管控</strong></li>\n<li>拿不准时，使用蛮力突破</li>\n<li>画一个图</li>\n<li>设计模块化</li>\n</ul>\n</li>\n<li>使用启发式方法的原则<ul>\n<li>先理解问题</li>\n<li>找出现有数据和未知量之间的联系</li>\n<li>寻找之前的类似问题，或者解决一些相关问题</li>\n<li>执行计划</li>\n<li>回顾解</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>设计实践<ul>\n<li>迭代：第二个尝试往往会好于第一个</li>\n<li>分而治之，增量式改进</li>\n<li>自上而下设计和自下而上设计</li>\n<li>建立试验性原型：原型要足够简单可抛弃，又足以验证效果</li>\n<li>记录你的设计成果：wiki、邮件、UML图</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"设计类\"><a href=\"#设计类\" class=\"headerlink\" title=\"设计类\"></a>设计类</h3><ul>\n<li><strong>类是一组数据和子程序的聚合，有内聚的明确定义的职责</strong></li>\n<li>抽象数据类型（ADT）<ul>\n<li>ADT可以让你像现实世界一样操作实体，而不必在底层实现上摆弄实体</li>\n<li>ADT的好处<ul>\n<li>隐藏实现细节</li>\n<li>改动不需要影响整个程序</li>\n<li>接口语义更强</li>\n<li>更容易提高性能</li>\n</ul>\n</li>\n<li>在非面向对象环境，也可以使用ADT</li>\n</ul>\n</li>\n<li>良好的类接口<ul>\n<li>好的抽象<ul>\n<li>类接口应该有一致的抽象层次</li>\n<li>要理解类的抽象是什么</li>\n<li>考虑提供成对的服务，如打开&#x2F;关闭、添加&#x2F;删除</li>\n<li>尽可能让接口可编程，而不仅是表达语义</li>\n<li>谨防在修改时破坏接口抽象</li>\n<li>同时考虑抽象性和内聚性</li>\n</ul>\n</li>\n<li>好的封装<ul>\n<li>封装比抽象更强，它直接阻止你看到细节</li>\n<li>尽可能限制类和成员的可访问性</li>\n<li>不要公开暴露成员数据</li>\n<li>不要将实现细节暴露在接口上</li>\n<li>不要对类的使用者做任何假设</li>\n<li>让阅读代码比编写更方便，代码的阅读次数比编写多得多</li>\n<li>不要<strong>透过</strong>接口来编程，仅仅看类的接口文档无法得知如何使用一个类的话，正确的做法不是拉出类的源代码，查看内部实现，而是联系类作者。对于类作者来讲，正确的做法不是面对面告诉答案，而是去修改类的接口文档</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>设计和实现<ul>\n<li>通过<strong>包含</strong>来实现“有一个”的关系<ul>\n<li>警惕超过<strong>7</strong>个成员的类</li>\n</ul>\n</li>\n<li>通过<strong>继承</strong>实现“是一个”的关系<ul>\n<li>用public继承</li>\n<li>要么使用继承并详细说明，要么就不要使用它</li>\n<li>遵循Liskov替换原则，即对基类的子程序，在它的所有派生类上含义都应该是相同的，在调用时只用看基类无需考虑是哪一个派生类</li>\n<li>只继承需要继承的部分</li>\n<li>只有一个实例的类值得怀疑</li>\n<li>只有一个派生类的类也值得怀疑</li>\n<li>派生中覆盖了某个子程序，但是其中没做任何操作，也值得怀疑<ul>\n<li>很可能修改了基类接口的语义，慢慢地从基类接口很难理解派生类上的行为</li>\n</ul>\n</li>\n<li>避免过深地继承：降低复杂度</li>\n<li>尽量使用<strong>多态</strong>，避免类型检查</li>\n<li>适度使用继承<ul>\n<li>多个类共享数据而非行为 &#x3D;&gt; 创建类包含的公用对象</li>\n<li>多个类共享行为而非数据 &#x3D;&gt; 都从基类派生，在基类中定义公用的子程序</li>\n<li>多个类既公用数据也公用行为 &#x3D;&gt; 都从基类派生，在基类中定义公用的子程序和数据</li>\n<li>通过基类控制接口 &#x3D;&gt; 继承</li>\n<li>自己控制接口 &#x3D;&gt; 包含</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>成员函数和数据成员<ul>\n<li>减少子程序</li>\n<li>进制不必要的成员和运算符</li>\n<li>减少对其他类子程序的间接调用</li>\n</ul>\n</li>\n<li>构造函数<ul>\n<li>尽可能早构造函数中初始化所有数据成员</li>\n<li><strong>用私有构造函数来实现单例数据</strong></li>\n<li>优先使用深拷贝，除非需要，才使用浅拷贝</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>创建类的原因<ul>\n<li>为现实&#x2F;抽象世界的对象建模</li>\n<li>降低&#x2F;隔离复杂度</li>\n<li>隐藏实现细节</li>\n<li>限制变动的影响范围</li>\n<li>建立中心控制点</li>\n<li>将相关操作包装在一起</li>\n<li>避免的类：万能类、无关紧要类、动词命名类</li>\n</ul>\n</li>\n<li>超越类：包</li>\n</ul>\n<h3 id=\"设计子程序\"><a href=\"#设计子程序\" class=\"headerlink\" title=\"设计子程序\"></a>设计子程序</h3><ul>\n<li>子程序是为了实现特定目的编写的方法或过程</li>\n<li>编写子程序的正当理由<ul>\n<li>降低复杂度</li>\n<li>引入中间、易懂的抽象</li>\n<li>避免代码重复</li>\n<li>支持派生类覆盖</li>\n<li>隐藏指针操作</li>\n<li>改善性能</li>\n<li>增加可读性</li>\n</ul>\n</li>\n<li>子程序上的设计<ul>\n<li><strong>一个子程序只做一件事</strong></li>\n<li><strong>考虑靠近纯函数或纯副作用函数</strong></li>\n<li>内聚性<ul>\n<li>功能上的、顺序上的、通信上的</li>\n<li>避免临时的内聚性（只是需要同时执行才放在一起操作的子程序），如贫血的<code>startup()</code>方法</li>\n<li>避免逻辑上的、巧合的内聚性</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>起个好名字<ul>\n<li>描述所做的事情，而非做事情的过程</li>\n<li>避免使用模糊的动词</li>\n<li>不要仅用数字区分子程序名</li>\n<li>函数名不要过长</li>\n<li>考虑描述返回值</li>\n<li>使用预期强烈的动词 + 宾语</li>\n<li>使用对仗词，如add&#x2F;remove</li>\n<li><strong>为常用操作统一命名</strong></li>\n</ul>\n</li>\n<li>子程序长度：最好少于100行，可以接受100 - 200行</li>\n<li>子程序入参<ul>\n<li>按输入、修改、输出顺序排列参数</li>\n<li>如果子程序使用了相似的参数，考虑让他们的排列顺序一致</li>\n<li>删掉没有使用到的参数</li>\n<li>不要给入参重新赋值</li>\n<li>限制入参数（有的说3个，有的说7个）</li>\n<li>考虑给参数名增加前缀、后缀</li>\n<li><strong>入参和子程序需要在一个抽象层级下</strong></li>\n<li>使用具名参数</li>\n</ul>\n</li>\n<li>宏子程序和内联子程序<ul>\n<li>将宏表达式整个包含在括号内</li>\n<li>一般来讲，是不会用宏代替子程序的</li>\n<li>节制使用inline子程序，在确认有性能改进后再使用inline子程序</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"防御式编程\"><a href=\"#防御式编程\" class=\"headerlink\" title=\"防御式编程\"></a>防御式编程</h3><p>防御式编程让错误更容易发现和修改，并减小破坏。</p>\n<ul>\n<li>断言<ul>\n<li>主要用于开发和维护的阶段</li>\n<li>用错误处理代码处理预期中的状况，用断言处理绝不该出现的状况</li>\n<li>避免把需要执行的代码放在断言中</li>\n<li>对于高健壮性代码，应该先断言再处理错误</li>\n</ul>\n</li>\n<li>错误处理技术<ul>\n<li>返回中立值，如空串、0</li>\n<li>换用下一个正确数据，如获取温度</li>\n<li>返回上一个正确数据，如屏幕重绘</li>\n<li>使用最接近的合法值</li>\n<li>打印警告信息到日志文件中</li>\n<li>返回错误码</li>\n<li>显示出错信息</li>\n<li>关闭程序</li>\n<li>平衡正确性和健壮性</li>\n</ul>\n</li>\n<li>异常<ul>\n<li>通知程序其他部分，发生了不可忽略的错误</li>\n<li>只在真正例外的情况下才抛出异常</li>\n<li>避免再构造函数或析构函数中抛出异常</li>\n<li>在恰当抽象层次抛出异常</li>\n<li>在异常信息中加上导致异常的所有信息</li>\n<li>避免空的<code>catch</code>语句</li>\n<li>异常标准化 &amp; 异常报告机制</li>\n</ul>\n</li>\n<li>辅助调试的代码<ul>\n<li>进攻式编程：让问题更早暴露</li>\n<li>方便地移除调试代码</li>\n</ul>\n</li>\n<li>保留防御式代码的程度<ul>\n<li>保留检查重要错误的代码</li>\n<li>去掉检查细微错误的代码</li>\n<li>保留让程序稳妥崩溃的代码</li>\n<li>记录错误信息</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"伪代码编写\"><a href=\"#伪代码编写\" class=\"headerlink\" title=\"伪代码编写\"></a>伪代码编写</h3><ul>\n<li>创建一个类<ul>\n<li>创建类的总体设计</li>\n<li>创建类中的子程序</li>\n<li>复审并测试</li>\n</ul>\n</li>\n<li>伪代码<ul>\n<li>使用类似英语的用法描述准确操作</li>\n<li>避免使用特定编程语言的语法元素，防止陷入到代码本身的层级上设计</li>\n<li>在略高于代码的层次上进行设计</li>\n</ul>\n</li>\n<li>通过伪代码创建子程序<ul>\n<li>检查先决条件</li>\n<li>定义子程序要解决的问题</li>\n<li>决定如何测试</li>\n<li>在第三方库中搜寻可用功能</li>\n<li>考虑错误处理</li>\n<li>编写伪代码</li>\n<li>将伪代码转为高层次的注释</li>\n<li>在注释下填充代码</li>\n<li>检查代码是否需要进一步分解</li>\n<li>使用lint或编译器检查错误</li>\n<li>去掉冗余注释</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"变量\"><a href=\"#变量\" class=\"headerlink\" title=\"变量\"></a>变量</h2><p>这一部分深入到代码细节，围绕如何正确使用变量展开。</p>\n<h3 id=\"一般事项\"><a href=\"#一般事项\" class=\"headerlink\" title=\"一般事项\"></a>一般事项</h3><ul>\n<li>初始化的一些建议<ul>\n<li>声明的时候初始化</li>\n<li>靠近变量使用的时候初始化</li>\n<li>考虑对常量使用<code>final</code>或<code>const</code></li>\n<li>注意累加器和计数器的重置</li>\n<li>用可执行代码初始化</li>\n<li>检查合法性</li>\n</ul>\n</li>\n<li>作用域<ul>\n<li>将变量引用点集中起来可以提高可读性，这样可以减少大脑缓存</li>\n<li>减少变量的“存活时间”（从第一条引用语句到最后一条）</li>\n<li>减少作用域的一些原则<ul>\n<li>循环开始时初始化循环变量</li>\n<li>变量使用前再赋值</li>\n<li>对于变量先采用最严格的可见性，再逐渐放宽</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>持续性<ul>\n<li>子程序内&#x2F;手动回收前&#x2F;程序运行时&#x2F;持久存储</li>\n<li>为变量选择合适的持续性</li>\n</ul>\n</li>\n<li>绑定时间<ul>\n<li>编码时&#x2F;编译时&#x2F;加载时&#x2F;实例化时&#x2F;运行时</li>\n<li><strong>越晚绑定越有灵活</strong></li>\n<li>选择合适的灵活度</li>\n</ul>\n</li>\n<li>和控制结构匹配的数据结构<ul>\n<li>序列型数据 -&gt; 顺序语句</li>\n<li>选择型数据 -&gt; <code>if case</code>语句</li>\n<li>迭代型数据 -&gt; 循环语句</li>\n</ul>\n</li>\n<li>变量单一用途<ul>\n<li>只用作一件事</li>\n<li>使用所有已声明变量</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"取名\"><a href=\"#取名\" class=\"headerlink\" title=\"取名\"></a>取名</h3><p>取名是个学问。</p>\n<ul>\n<li>几个原则<ul>\n<li><strong>信达雅</strong></li>\n<li><strong>以问题为导向</strong>，面向目的而不是手段</li>\n<li>适当的长度，小于20个字符，大于8个字符</li>\n<li>作用域越小，变量名越短；使用较少的变量或全局变量适用较长的名字</li>\n<li>使用限定词（如min、avg、max）和对仗词</li>\n</ul>\n</li>\n<li>特定类型的变量名<ul>\n<li>循环下标：<code>i</code>,<code>j</code>,<code>k</code>，在嵌套循环时建议使用表意的变量名</li>\n<li>状态变量：取个比<code>xxxflag</code>更好的名字</li>\n<li>临时变量：避免用临时名字</li>\n<li>布尔变量：名字要蕴含真假的意义<ul>\n<li><code>done</code>&#x2F;<code>error</code>&#x2F;<code>found</code>&#x2F;<code>success</code></li>\n<li><strong>不建议使用<code>is</code>前缀</strong></li>\n<li>使用表示<strong>肯定</strong>的名字，理解成本低</li>\n</ul>\n</li>\n<li>枚举变量：缺少组前缀的需要加上前缀</li>\n<li>常量：不使用magic number或magic string</li>\n</ul>\n</li>\n<li>组内需要确定一个命名规范</li>\n<li>标准前缀<ul>\n<li>用户自定义类型缩写，UDT缩写</li>\n<li>正交化、便于检索</li>\n</ul>\n</li>\n<li>如何缩写<ul>\n<li>使用标准缩写</li>\n<li>去掉非前置元音</li>\n<li>去掉虚词，<code>and</code>等</li>\n<li>去掉无用后缀</li>\n<li>使用每个单词的第一或前几个字母</li>\n<li>不提倡语音缩写</li>\n<li>缩写要能读出来</li>\n<li>避免容易看错或读错的字符组合</li>\n</ul>\n</li>\n<li>应该避免的名字<ul>\n<li>令人误解</li>\n<li>具有不同含义但有相似名字</li>\n<li>发音相近</li>\n<li>出现数字，这是不好的征兆</li>\n<li>拼写错误</li>\n<li>仅靠大小写区分</li>\n<li>使用易混淆的字符，如<code>0</code>和<code>o</code>，<code>1</code>和<code>l</code></li>\n</ul>\n</li>\n<li>代码阅读次数要远远多于编写次数</li>\n</ul>\n<h3 id=\"基本数据类型\"><a href=\"#基本数据类型\" class=\"headerlink\" title=\"基本数据类型\"></a>基本数据类型</h3><ul>\n<li>数值<ul>\n<li>避免magic number</li>\n<li>避免除0</li>\n<li>避免混合类型比较哦</li>\n</ul>\n</li>\n<li>整数<ul>\n<li>检查整数除法</li>\n<li>检查整数溢出</li>\n</ul>\n</li>\n<li>浮点数<ul>\n<li>避免数据级相差巨大的数之间的加减</li>\n<li>避免相等比较</li>\n<li>避免舍入误差</li>\n</ul>\n</li>\n<li>字符串<ul>\n<li>避免magic string</li>\n<li>考虑国际化</li>\n<li>unicode支持</li>\n<li>C语言的字符串<ul>\n<li>注意字符串指针和字符数组的差异</li>\n<li>注意字符串长度声明为CONSTANT + 1</li>\n<li>用<code>null</code>初始化避免无结束符</li>\n<li>建议使用字符数组</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>布尔变量<ul>\n<li>使用布尔中间变量简化复杂判断</li>\n</ul>\n</li>\n<li>枚举类型<ul>\n<li>带来类型提示和提升可读性</li>\n<li>简化修改</li>\n<li>作为布尔变量的可扩展性方案</li>\n<li>枚举类型的第一个元素留作非法制</li>\n</ul>\n</li>\n<li>具名常量：“参数化”程序<ul>\n<li>统一使用</li>\n</ul>\n</li>\n<li>数组<ul>\n<li>确认数组下标</li>\n<li>顺序访问元素，不建议随机访问</li>\n<li>数组边界点</li>\n</ul>\n</li>\n<li>自定义类型：<code>typedef</code>作为类的轻量级方案</li>\n</ul>\n<h3 id=\"不常见的数据类型\"><a href=\"#不常见的数据类型\" class=\"headerlink\" title=\"不常见的数据类型\"></a>不常见的数据类型</h3><ul>\n<li>结构体：数据组合，没有行为的类<ul>\n<li><strong>用前一问：可以用类么</strong></li>\n<li>简化数据块操作</li>\n<li>简化参数列表</li>\n</ul>\n</li>\n<li>指针：灵活但容易出错<ul>\n<li><strong>用前一问：有访问器子程序或防御式编程么</strong></li>\n<li>标识内存中<strong>某个位置</strong>有<strong>某种内容</strong></li>\n<li>一般技巧<ul>\n<li>同时声明和定义</li>\n<li>使用前检查</li>\n<li>使用前判断内存是否损毁</li>\n<li>在提高代码清晰度上，不要节约使用指针</li>\n<li>简化指针表达式</li>\n<li>正确删除链表中的指针</li>\n<li>删除或释放前设为空值</li>\n<li>删除前检查是否非法</li>\n<li>统一跟踪分配情况</li>\n<li>统一在子程序里，集中实现上述策略</li>\n</ul>\n</li>\n<li>C++指针<ul>\n<li>理解指针和引用</li>\n<li><strong>指针用于“按引用传递”，const引用用于“按值传递”</strong></li>\n<li>使用<code>shared_ptr</code></li>\n</ul>\n</li>\n<li>C指针<ul>\n<li>使用显式类型</li>\n<li>避免强制类型转换</li>\n<li>遵循参数传递的<code>*</code>规则</li>\n<li>内存分配时使用<code>sizeof()</code>确定变量大小</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>全局数据：风险较大<ul>\n<li><strong>用前一问：有更好的方法么</strong></li>\n<li>常见问题<ul>\n<li>多线程重入问题</li>\n<li>阻碍代码重用</li>\n<li>破坏模块化和智力上的可管理性</li>\n</ul>\n</li>\n<li>使用理由<ul>\n<li>简化极常用的数据使用</li>\n<li>消除流浪数据（调用链中间的子程序不使用数据）</li>\n</ul>\n</li>\n<li>用访问器子程序取代全局数据<ul>\n<li>在访问前锁定控制</li>\n<li>在访问器子程序里构建一个抽象层</li>\n<li>对数据的所有访问限制在一个抽象层</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"语句\"><a href=\"#语句\" class=\"headerlink\" title=\"语句\"></a>语句</h2><p>在了解了数据视角的变量元素后，这一部分围绕语句组织展开。</p>\n<h3 id=\"直线型代码\"><a href=\"#直线型代码\" class=\"headerlink\" title=\"直线型代码\"></a>直线型代码</h3><ul>\n<li>直线型代码即按先后顺序放置语句和语句块</li>\n<li>必须明确先后顺序的语句<ul>\n<li><strong>想办法明确展示语句的依赖关系</strong><ul>\n<li>组织代码</li>\n<li>使用子程序名&#x2F;子程序参数凸显依赖</li>\n<li>使用注释</li>\n<li>通过断言或错误处理来检查</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>顺序无关的语句<ul>\n<li>使代码易于从上向下阅读，避免跳来跳去</li>\n<li>将相关语句组织在一起</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"条件语句\"><a href=\"#条件语句\" class=\"headerlink\" title=\"条件语句\"></a>条件语句</h3><ul>\n<li><code>if</code>语句<ul>\n<li><code>if-then</code>语句<ul>\n<li>先写正常代码，再写不常见情况</li>\n<li>不要在<code>if</code>后跟随空子句</li>\n<li>看看是不是不需要<code>else</code>子句</li>\n</ul>\n</li>\n<li><code>if-then-else</code>语句<ul>\n<li>利用布尔函数简化复杂的检测</li>\n<li>把常见情况放在最前面</li>\n<li>检查是否考虑了所有情况</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><code>case</code>语句<ul>\n<li>选择最有效的排列顺序，如执行频率</li>\n<li>简化每种case下的操作</li>\n<li><strong>最好能搭配枚举类型一起使用</strong></li>\n<li>使用<code>default</code>子句检查默认情况或错误</li>\n<li>注意有些语言的<code>case</code>会有fallthrough，需要加<code>break</code></li>\n</ul>\n</li>\n<li>循环语句<ul>\n<li>分为计数循环、连续求值循环、无限循环、迭代器循环。分别适用<code>for</code>、<code>while</code>、<code>foreach</code>语句</li>\n<li>循环控制<ul>\n<li>应该把循环体看作黑盒子，外围程序只知道它的控制条件</li>\n<li>合理判断使用<code>for</code>和<code>while</code>的地方</li>\n<li>尽量避免空循环</li>\n<li>循环内务（包括索引增加）要么放在循环开始，要么放在循环最后</li>\n<li>让循环终止条件看起来明显</li>\n<li>不要为了终止循环改动<code>for</code>循环的下标</li>\n<li>小心散布了很多<code>break</code>的循环，小心谨慎使用<code>break</code>和<code>continue</code></li>\n<li>检查循环端点是否会有off-by-one的问题</li>\n<li>在嵌套循环中使用有意义的变量名增强可读性</li>\n<li>循环要尽可能短，便于一目了然</li>\n<li>把嵌套限制在3层以内</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"不常见的控制结构\"><a href=\"#不常见的控制结构\" class=\"headerlink\" title=\"不常见的控制结构\"></a>不常见的控制结构</h3><ul>\n<li>多处返回：指程序中途的return或exit<ul>\n<li>只在能增强可读性时，使用中途的<code>return</code></li>\n<li>用防卫子句提前退出，简化复杂的错误处理</li>\n<li>减少程序中的<code>return</code>数目</li>\n</ul>\n</li>\n<li>递归：将复杂问题分而治之<ul>\n<li>确认终止条件</li>\n<li>使用安全计数器防止出现无穷递归</li>\n<li>把递归限制在一个子程序里，避免循环调用</li>\n<li>留意栈空间</li>\n<li>可以用循环结构等价式的先考虑循环结构，如阶乘和斐波那契数列</li>\n</ul>\n</li>\n<li><code>goto</code><ul>\n<li>反对随意使用<code>goto</code></li>\n<li><code>goto</code>灵活度太高，不容易用好，在可以使用其他控制结构时，不使用<code>goto</code></li>\n<li>在错误处理中，可以用状态变量、<code>try finally</code>语句实现跳出正常流</li>\n<li>如果在那1%的情况下需要使用<code>goto</code>，注意以下几点<ul>\n<li>尽量一个子程序只使用一个<code>goto</code></li>\n<li>尽量向前跳转而非向后</li>\n<li>确保所有的goto标号都被执行到</li>\n<li><strong>确认<code>goto</code>不会产生执行不到的代码</strong></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"表驱动法\"><a href=\"#表驱动法\" class=\"headerlink\" title=\"表驱动法\"></a>表驱动法</h3><p>表驱动法是<strong>空间换时间</strong>的一种编程模式，使用数据结构模拟逻辑结构，将大部分复杂度放到容易被理解的数据结构中，从而提升代码可读性。下面是一个代码范例。</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> (((<span class=\"string\">&#x27;a&#x27;</span> &lt;= inputChar) &amp;&amp; (inputChar &lt;= <span class=\"string\">&#x27;z&#x27;</span>)) ||</span><br><span class=\"line\">  ((<span class=\"string\">&#x27;A&#x27;</span> &lt;= inputChar) &amp;&amp; (inputChar &lt;= <span class=\"string\">&#x27;Z&#x27;</span>)))  &#123;</span><br><span class=\"line\">  charType = CharacterType.Letter;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ((inputChar == <span class=\"string\">&#x27; &#x27;</span>) || (inputChar == <span class=\"string\">&#x27;,&#x27;</span>) ||</span><br><span class=\"line\">  (inputChar = <span class=\"string\">&#x27;.&#x27;</span>) || (inputChar == <span class=\"string\">&#x27;!&#x27;</span>) || (inputChar == <span class=\"string\">&#x27;(&#x27;</span>) ||</span><br><span class=\"line\">  (inputChar = <span class=\"string\">&#x27;)&#x27;</span>) || (inputChar == <span class=\"string\">&#x27;:&#x27;</span>) || (inputChar == <span class=\"string\">&#x27;;&#x27;</span>) ||</span><br><span class=\"line\">  (inputChar = <span class=\"string\">&#x27;?&#x27;</span>) || (inputChar == <span class=\"string\">&#x27;-&#x27;</span>)) &#123;</span><br><span class=\"line\">  charType = CharacterType.Punctuation;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">else</span> <span class=\"keyword\">if</span> ((<span class=\"string\">&#x27;0&#x27;</span> &lt;= inputChar) &amp;&amp; (inputChar &lt;= <span class=\"string\">&#x27;9&#x27;</span>)) &#123;</span><br><span class=\"line\">  charType = CharacterType.Digit;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>使用一个查询表建立每个字符和它的字符类型的关联后，代码可以简化为</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">charType = charTypeTable[inputChar];</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>查表方法<ul>\n<li>直接访问：如查询每月天数，或不同年龄对应的保险费率<ul>\n<li>有的时候键值要预先处理后才能直接使用，如可能很多年龄对应相似的费率，这时最好先将年龄<strong>换算</strong>到一个更好的key上</li>\n<li>进一步，我们可以把键值转换提取为独立的子程序</li>\n</ul>\n</li>\n<li>索引访问表：和直接访问的区别在于，对于不易<strong>换算</strong>到键值的情况，提供一个额外的索引表，先<strong>映射</strong>到索引表再查到数据</li>\n<li>阶梯访问表：主要针对表中的记录是对<strong>数据范围</strong>而非<strong>数据点</strong>生效的情况，使用端点作为key<ul>\n<li>留心端点带来的off-by-one情况</li>\n<li>可以使用二分查找代替顺序查找</li>\n<li>也可以使用索引访问技术</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"一般性问题\"><a href=\"#一般性问题\" class=\"headerlink\" title=\"一般性问题\"></a>一般性问题</h3><h4 id=\"布尔表达式\"><a href=\"#布尔表达式\" class=\"headerlink\" title=\"布尔表达式\"></a>布尔表达式</h4><ul>\n<li>使用<code>true</code>或<code>false</code>作判断</li>\n<li>简化复杂的表达式<ul>\n<li>使用中间变量或布尔函数</li>\n<li>使用决策表替代复杂的判断逻辑</li>\n</ul>\n</li>\n<li>编写<strong>肯定</strong>的布尔表达式，会让布尔表达式更易理解</li>\n<li>用括号分割较长的布尔表达式</li>\n<li>注意短路求值或惰性求值的情况</li>\n<li><strong>按照数轴的顺序编写数值表达式</strong>，类似<code>MIN_VALUE &lt;= i and i &lt;= MAX_VALUE</code>，可读性好很多</li>\n<li>在C语言中最好把常量放在左边</li>\n<li>注意区分Java中<code>a==b</code>和<code>a.equals(b)</code></li>\n</ul>\n<h4 id=\"空语句\"><a href=\"#空语句\" class=\"headerlink\" title=\"空语句\"></a>空语句</h4><ul>\n<li>小心使用</li>\n<li>使用<code>doNothing()</code>函数或<code>noop()</code>函数</li>\n<li>考虑能否换用非空的循环体</li>\n</ul>\n<h4 id=\"优化深层嵌套\"><a href=\"#优化深层嵌套\" class=\"headerlink\" title=\"优化深层嵌套\"></a>优化深层嵌套</h4><ul>\n<li>优化重复的<code>if</code>检查</li>\n<li>使用<code>break</code>简化嵌套<code>if</code>，如防卫子句</li>\n<li>转换成一组<code>if-then-else</code>结构</li>\n<li>转换成<code>case</code>语句</li>\n<li>将深度嵌套的语句抽离成子程序</li>\n<li>借助多态</li>\n<li>借助异常来跳出正常流</li>\n</ul>\n<h4 id=\"结构化编程\"><a href=\"#结构化编程\" class=\"headerlink\" title=\"结构化编程\"></a>结构化编程</h4><p>结构化编程的思路是仅使用<strong>顺序</strong>、<strong>选择</strong>、<strong>迭代</strong>的思路描述程序流，避免使用<code>break</code>，<code>continue</code>，<code>return</code>，<code>try-catch</code>来打断。</p>\n<h4 id=\"降低复杂度\"><a href=\"#降低复杂度\" class=\"headerlink\" title=\"降低复杂度\"></a>降低复杂度</h4><ul>\n<li><strong>程序复杂度的一个衡量标准是，为了理解程序，必须在同一时间记忆的智力实体数目</strong>，即理解程序花费的精力</li>\n<li>控制流的复杂度和不可靠的代码以及频繁出现的错误息息相关</li>\n<li>可以通过计算子程序的“决策点”粗估子程序的复杂度<ul>\n<li>从1开始，遇到<code>if</code>，<code>while</code>，<code>repeat</code>，<code>for</code>，<code>and</code>，<code>or</code>加一，为每一种<code>case</code>加一</li>\n</ul>\n</li>\n</ul>\n",
            "tags": [
                "编程",
                "范式",
                "设计"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/12/22/2021-to-2022/",
            "url": "http://shenlvmeng.github.com/blog/2021/12/22/2021-to-2022/",
            "title": "2021回顾暨2022展望",
            "date_published": "2021-12-22T14:59:05.000Z",
            "content_html": "<blockquote>\n<p>2018-2019: <a href=\"https://shenlvmeng.github.io/blog/2019/01/03/2018-to-2019/\">https://shenlvmeng.github.io/blog/2019/01/03/2018-to-2019/</a><br>2019-2020: <a href=\"https://shenlvmeng.github.io/blog/2020/01/04/2019-to-2020/\">https://shenlvmeng.github.io/blog/2020/01/04/2019-to-2020/</a><br>2020-2021: <a href=\"https://shenlvmeng.github.io/blog/2021/01/05/2020-to-2021/\">https://shenlvmeng.github.io/blog/2021/01/05/2020-to-2021/</a></p>\n</blockquote>\n<p>从19年初写下第一篇总结到现在，已过去近3年，每年写总结时，都会发现计划永远赶不上变化，惊喜总在发生，也总能体验这辈子从未经历过的一些事情。就像在超市购物时推着一辆磕磕巴巴的小车一样，正反馈的前进路线需要不断地人为纠正。最终走出一条弯弯曲曲却通向想去方向的路线。</p>\n<p>世事难料，2021年尤其是个例外。我目送了朋友的离开，见证了忠贞的新人携手相拥，告别了早该舍弃的人，与老朋友重逢，来到陌生却熟悉的新城市，拥抱了所爱也爱我的人，认识又立马和新朋友告别，开启看起来模糊却又无比清晰的未来道路。生活逐渐健康，生活更加明亮，生活逐渐充满期望。不过总有些不变的，譬如固定的长途骑行，以及在间歇性踌躇满志和间歇性混吃等死中间徘徊。</p>\n<h2 id=\"2021回顾\"><a href=\"#2021回顾\" class=\"headerlink\" title=\"2021回顾\"></a>2021回顾</h2><p>比照去年目标，在内在上，看完了4本技术书籍中的2本，以及剩余10本小说中的8本：</p>\n<ul>\n<li><a href=\"https://shenlvmeng.github.io/blog/2021/01/29/zen-of-unix/\">Unix编程艺术集萃</a></li>\n<li><a href=\"https://shenlvmeng.github.io/blog/2021/03/22/clean-architecture/\">《架构整洁之道》—— 软件设计的思考</a></li>\n</ul>\n<p>剩余的2本，devops读至一半，深感信息量之少，收获甚少，弃之。《代码大全》则由于过厚暂时搁置。不过，在某leader的启发下，对管理学产生了兴趣。从推荐的《领导梯队》和《赢》入手，接触到德鲁克的一些观念：</p>\n<ul>\n<li><a href=\"https://shenlvmeng.github.io/blog/2021/11/24/leadership-pipeline/\">《领导梯队》—— 领导力模型构建</a></li>\n<li><a href=\"https://shenlvmeng.github.io/blog/2021/12/07/winning-note/\">公司管理和自我修养 —— 《赢》读书笔记</a></li>\n<li><a href=\"https://shenlvmeng.github.io/blog/2021/12/16/effective-executive/\">卓有成效的管理者 —— 德鲁克笔记系列之一</a></li>\n</ul>\n<p>经过这几本的洗礼，感受到管理学绝不仅仅是日常的事务性管理动作。而有一整套价值观和方法论，如依人办事等。看完之后大开眼界，颇有些屠龙之术的意思。这也许只是我屁股不在目标人群中吧。于是剩余的两本德鲁克及时叫停，回到追求实用的现实世界。在技术以外了解一些其他领域的知识，启示挺大。</p>\n<p>个人形象上，除了改成推平的毛寸<del>（以及发胖）</del>之外，几乎没有任何变化。发胖这点，也不能完全赖我，和对象也有一定关系。早睡早起这点倒是因为和对象同住坚持得很好，这大概是今年最大的进步了。锻炼频率从来了上海之后有所下降，等到对象回到附近之后预期会好很多。整体看，发胖这点还是要重视的。</p>\n<p>社交上，来到上海后，除了老朋友外，倒是拾起了一些很久未联系的“新朋友”。情感上，很庆幸地，经过身边亲朋好友的轮番劝导和自己的冷静思考，让我及时从糟糕的关系中摆脱出来。谢天谢地，又让我遇到现在的她。说来奇妙又激动。2021年似乎在5月份和6月底开启了两次新篇章。之后整个下半年局面大为不同。经过艰难又忐忑的4个月异地，辛苦却又自然地合体。一切仿佛都是最佳的选择。</p>\n<p>生活上，业余时间基本都是和对象一同。不过俩人的兴趣爱好相仿，骑车和看电影都能一起，因此这两点并没放下。在今年5月份开启新篇章后，斥巨资换了现在的新公路车，大大提升了骑行体验，不得不说真能买到快乐。之前的公路车刚好可以给对象骑。尽管11月才结束异地，已经一同骑了快10次了。魔都的骑行路况尽管比不上帝都，气温相对帝都还是要温柔一些。照例，今年完成了<a href=\"https://shenlvmeng.github.io/blog/2021/10/20/taihu-lark-riding/\">环太湖之旅</a>，一路上经过苏州、无锡、宜兴、湖州、南浔，也算是满足了圣僧一路江南城市的愿望。清理完已有的洋酒库存后，小酌频率的确下降很多了，可惜对象酒量很差，平日只能看我表演。旅行上，在偶发疫情的情况下，和对象国庆去<a href=\"https://shenlvmeng.github.io/blog/2021/10/22/tour-to-jinan-and-qingdao/\">济南青岛</a>转了一圈，十月底被痛仰两放鸽子后，得到了宝贵的杭州一日游。搬到和对象同居之后，俩人分工，一人负责干净一人负责整洁，整个房间倒是窗明几净、井然有序。平日周末一同下厨或探店或社交，不亦乐乎。livehouse倒是计划了好几次，可惜疫情人算不如天算，至今未能看到。</p>\n<p>事业上，借助大方向的发展势头，年初得到了意料之外情理之中的提升机会。赶在行业腰斩个人选择导致的发展减缓前，获得此等良机，可以说很幸运了。而后随着来到魔都，第一次感受landing流程和新leader磨合，另外团队也有所扩张，十分难得。可惜由于公司政策调整，结合个人意愿选择，放弃了这个良机。去向了一个完全陌生的领域，极大提升通勤体验的同时，牺牲了先发优势。正如那位leader所说，“既然是去一项成熟的业务，最好提前降低下预期”，因此也做好了发挥空间有限，要重新建立信任的准备。有挑战才有意思嘛。也希望在来年能有所成果。结合管理学阅读还有某leader的1on1，在职业规划和发展路线上有了一些粗浅的想法。在和对象的交流下，了解到内卷业务的可怕，还有外企的香甜，不由得内心也心向往之。作为一项国际化业务，这里倒是也可以当做未来的跳板吧。何时才能成长到在外企大厂带人做事的程度呢？</p>\n<p>至于落脚城市，就这里吧，也挺好。下一阶段，就是房子、车子、票子的事情了。有了可以一同踏踏实实的人，也放心去想踏踏实实的事儿了。</p>\n<h2 id=\"2021总结\"><a href=\"#2021总结\" class=\"headerlink\" title=\"2021总结\"></a>2021总结</h2><ul>\n<li>仰望星空的同时，脚踏实地也很重要</li>\n<li>保持身体健康</li>\n<li>减肥要提上日程</li>\n<li>生活中总会发生不公平的事情，不过整体来看，它还是公平的</li>\n<li>少吃一口饿不死，多做一点累不死</li>\n<li>迈出第一步，事情就会慢慢发生，就像在山顶推一个石头</li>\n<li>事业上，成果导向，用人所长，因人成功</li>\n<li>工作中有些事情，功夫在诗外，人际关系也很重要</li>\n<li>要开始考虑一些更长远更现实的事情，比如买房、养老、医保，做一个合格的父亲</li>\n</ul>\n<h2 id=\"2022展望\"><a href=\"#2022展望\" class=\"headerlink\" title=\"2022展望\"></a>2022展望</h2><p>好了，写计划和期望的时候总是心情舒畅。下面列出一些期望，</p>\n<ul>\n<li>内在<ul>\n<li>完成代码大全和至少一本专业书籍的阅读</li>\n<li>完成剩下所有小说阅读</li>\n<li>探索一个新的领域，形成积累</li>\n</ul>\n</li>\n<li>外在<ul>\n<li><strong>控制体重回到80kg</strong></li>\n<li>坚持早睡早起早饭</li>\n<li>坚持一项骑行以外的运动，如游泳</li>\n<li>升级对象骑行体验</li>\n</ul>\n</li>\n<li>生活<ul>\n<li>至少1次和对象的旅行</li>\n<li>至少1次户外长途骑行</li>\n<li>学习3种硬菜</li>\n<li>至少1次livehouse</li>\n<li>控制饮酒频率</li>\n<li>享受探店</li>\n<li>更好地融入魔都<ul>\n<li>社保、户口</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>社交<ul>\n<li>和对象相互认识老朋友</li>\n<li>回一次家 &amp; 去一次沈阳</li>\n</ul>\n</li>\n<li>事业<ul>\n<li>做出一项成果</li>\n<li>能在所在业务下带小团队</li>\n</ul>\n</li>\n</ul>\n<p>凡是经历没经历过的事情，都是好事。预知后事如何，明年拭目以待。</p>\n<p><em>Bye~</em></p>\n",
            "tags": [
                "总结",
                "2021",
                "2022"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/12/20/deep-link-note/",
            "url": "http://shenlvmeng.github.com/blog/2021/12/20/deep-link-note/",
            "title": "deeplink技术分析",
            "date_published": "2021-12-20T14:48:09.000Z",
            "content_html": "<p><a href=\"https://en.wikipedia.org/wiki/Deep_linking\">deep link</a>是指可以从任何渠道，包括短信、应用内、网页中直接跳转到应用app内的特定页面的技术。它一定程度上打破了移动端app间“孤岛”的局面，实现了快捷的跳转。根据是否安装app，主要有下面两种行为：</p>\n<ul>\n<li>已安装，唤起app并跳转到特定页面</li>\n<li>未安装，跳转到App Store或下载页面引导用户下载安装，在下载后的第一次打开自动跳转到特定深度页面，这种情况也叫<strong>deferred deep link</strong></li>\n</ul>\n<p><img src=\"https://support.staffbase.com/hc/article_attachments/115003896431/deeplink_deeplink-browser-app.png\" alt=\"deep-link-info\"></p>\n<h2 id=\"场景\"><a href=\"#场景\" class=\"headerlink\" title=\"场景\"></a>场景</h2><p>deep link可以应用在很多常见的场景下，如</p>\n<ul>\n<li>社交分享</li>\n<li>广告引流</li>\n<li>web和app互通</li>\n<li>裂变活动</li>\n<li>短信、邮件营销</li>\n</ul>\n<p>在web和app互通场景下，可以很方便地实现从外部回流页回到app内特定位置，如：</p>\n<ul>\n<li>电商类app：分享H5跳转到特定商品页</li>\n<li>游戏类app：分享H5跳转到特定房间或任务</li>\n<li>直播类app：分享H5跳转到特定直播间</li>\n</ul>\n<p>deep link缩短了操作路径，减少了用户操作成本，从而降低用户流失率，帮助app拉新和留存。</p>\n<h2 id=\"实现方式\"><a href=\"#实现方式\" class=\"headerlink\" title=\"实现方式\"></a>实现方式</h2><p>常见的实现方式有下面几种</p>\n<ul>\n<li>URL scheme，iOS和Android下的通用方式，打开前会询问是否打开某app</li>\n<li><a href=\"https://developer.chrome.com/docs/multidevice/android/intents/\">Chrome Intent</a>，Chrome 25+无法通过URL scheme 唤起 App，必须使用Intent</li>\n<li>Universal Link，适用于iOS 9及更高版本，点击http&#x2F;https即跳转，操作丝滑</li>\n<li>App Links，适用于Android 6及更高版本，点击http&#x2F;https即跳转，操作丝滑</li>\n</ul>\n<p>除了上面几种，还有<a href=\"https://developer.apple.com/documentation/webkit/promoting_apps_with_smart_app_banners\">Smart App Banners</a>、剪贴板等方案</p>\n<h3 id=\"URL-scheme\"><a href=\"#URL-scheme\" class=\"headerlink\" title=\"URL scheme\"></a>URL scheme</h3><p>格式形如<code>[scheme:][//authority][path][?query][#fragment]</code>，一般使用在iOS 9和Android 6之前。方法通用，但有以下问题：</p>\n<ul>\n<li>本身没有规范，难以获知要跳转的path或query</li>\n<li>功能不全，app越复杂，scheme就越复杂</li>\n<li>会被拦截，包括浏览器或应用的webview，如微信</li>\n<li>打开app失败后，iOS会有错误弹窗，体验不好<ul>\n<li>提示网页无效</li>\n</ul>\n</li>\n<li>URL scheme可能重复</li>\n</ul>\n<p>常见Scheme URL</p>\n<table>\n<thead>\n<tr>\n<th>微信</th>\n<th>电商</th>\n<th>浏览器</th>\n<th>系统</th>\n<th>其他</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>weixin:&#x2F;&#x2F;dl&#x2F;scan 扫一扫<br />weixin:&#x2F;&#x2F;dl&#x2F;moments 朋友圈<br /> weixin:&#x2F;&#x2F;dl&#x2F;settings 设置</td>\n<td>淘宝：taobao:&#x2F;&#x2F;<br />支付宝：alipay:&#x2F;&#x2F;<br />美团：imeituan:&#x2F;&#x2F;</td>\n<td>Chrome：googlechrome:&#x2F;&#x2F;<br />UC 浏览器：ucbrowser:&#x2F;&#x2F;</td>\n<td>邮箱：mailto:&#x2F;&#x2F;<br />短信：message:&#x2F;&#x2F;<br />App Store：itms-appss:&#x2F;&#x2F;  macappstores:&#x2F;&#x2F;</td>\n<td>飞书：lark:&#x2F;&#x2F;<br />微博：sinaweibo:&#x2F;&#x2F;</td>\n</tr>\n</tbody></table>\n<h3 id=\"Chrome-Intent\"><a href=\"#Chrome-Intent\" class=\"headerlink\" title=\"Chrome Intent\"></a>Chrome Intent</h3><p>Chrome 25+无法通过iframe的src启动Android app。改为构造形如下面的intent锚点。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intent:  </span><br><span class=\"line\">   HOST/URI-path // Optional host  </span><br><span class=\"line\">   #Intent;  </span><br><span class=\"line\">      package=\\[string\\];  </span><br><span class=\"line\">      action=\\[string\\];  </span><br><span class=\"line\">      category=\\[string\\];  </span><br><span class=\"line\">      component=\\[string\\];  </span><br><span class=\"line\">      scheme=\\[string\\];  </span><br><span class=\"line\">   end;</span><br></pre></td></tr></table></figure>\n\n<p>在<code>end</code>前添加<code>S.browser_fallback_url=[encoded_full_url]</code>可以指定唤起失败的地址。一个构造好的intent形如：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intent://path#Intent;scheme=xxx;package=com. xxx;S.browser_fallback_url=https://xxx;end</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Universal-Link\"><a href=\"#Universal-Link\" class=\"headerlink\" title=\"Universal Link\"></a>Universal Link</h3><blockquote>\n<p><a href=\"https://developer.apple.com/ios/universal-links/\">官方介绍</a></p>\n</blockquote>\n<p>Universal Link，即通用链接，是iOS 9推出的通过HTTPS链接来启动app的特性。既可以打开app，在没有安装时，则打开特定网页。对比URL Scheme优势在于：</p>\n<ul>\n<li>无缝切换，不弹窗确认</li>\n<li>兼容性好，未安装时直接打开网页</li>\n<li>使用通用的HTTP协议，不用担心scheme重复</li>\n<li>通过网站的配置文件和app关联，保证安全</li>\n</ul>\n<p>在网站下根目录或<code>.well-known</code>路径下需要有<code>apple-app-association</code>（无后缀名）JSON文件。例如，知乎的配置文件为<a href=\"https://oia.zhihu.com/apple-app-site-association%E3%80%82%E5%9C%A8%E9%85%8D%E7%BD%AE%E6%97%B6%EF%BC%8C\">https://oia.zhihu.com/apple-app-site-association。在配置时，</a></p>\n<ul>\n<li>需要保证有一个HTTPS的域名，最好和web网页域名区分开，保证web网页的正常访问</li>\n<li>在开发者中心 ，Identifiers下 AppIDs 找到自己的App ID，编辑打开Associated Domains服务</li>\n<li>打开工程配置中的 Associated Domains ，在其中的 Domains 中填入你想支持的域名，必须以<code>applinks:</code>为前缀</li>\n<li>配置<code>apple-app-site-association</code>文件，不带任何后缀，上传该文件到服务器的根目录或者<code>.well-known</code>目录下</li>\n</ul>\n<p><img src=\"https://docs-assets.developer.apple.com/published/4cbbb0bb235bdd82277b0f8d294afab8/13300/supporting-associated-domains-1@2x.png\"></p>\n<p>在网站下配置好Universal Link后，用户点击网站链接后，即会直接跳转到App，而不需要经过浏览器。当然，微信等app还是会拦截Universal Link的行为，需要在微信注册自己的应用id和Universal Link。</p>\n<h3 id=\"App-Links\"><a href=\"#App-Links\" class=\"headerlink\" title=\"App Links\"></a>App Links</h3><blockquote>\n<p><a href=\"https://developer.android.google.cn/studio/write/app-link-indexing\">官方介绍</a></p>\n</blockquote>\n<p>App Links，类似Universal Link，是Android 6（Android M）及以上操作系统中适用的HTTPS路径链接。可以直接将用户带入到Android app内的特定页面中，实现上，网站配置文件名为<code>assetlink</code>，只能放在<code>.well-known</code>目录下。如<a href=\"https://vt.tiktok.com/.well-known/assetlinks.json%E3%80%82%E4%B8%8D%E8%BF%87%EF%BC%8C%E5%9B%BD%E4%BA%A7%E7%9A%84%E5%AE%89%E5%8D%93%E7%89%88%E6%9C%AC%E4%BB%A5%E5%8F%8A%E5%BE%AE%E4%BF%A1%E7%AD%89app%E4%BE%9D%E6%97%A7%E4%BC%9A%E6%8B%A6%E6%88%AA%E3%80%82\">https://vt.tiktok.com/.well-known/assetlinks.json。不过，国产的安卓版本以及微信等app依旧会拦截。</a></p>\n<h3 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h3><ul>\n<li>Android webview本身支持唤醒第三方app，但如果设置了自定义WebViewClient则需要自己处理，具体是指在<code>shouldOverrideUrlLoading</code>方法中决定如何处理</li>\n<li>Smart App Banners，在网页里增加一个<code>&lt;meta&gt;</code>标签，可以在打开页面时，检测手机是否安装某个app，并且在页面顶部显示一个Banner显示App的基本信息，安装时显示打开，未安装时显示安装</li>\n</ul>\n<h2 id=\"相关产品或开源库\"><a href=\"#相关产品或开源库\" class=\"headerlink\" title=\"相关产品或开源库\"></a>相关产品或开源库</h2><p>结合点击行为、重定向行为、来源去向分析、落地页等，还可以做很多事情，市面上也有下面一些产品：</p>\n<ul>\n<li><a href=\"https://www.mob.com/mobService/moblink\">MobLink</a></li>\n<li><a href=\"https://www.linkedme.cc/link-page.html\">LinkedMe</a></li>\n<li><a href=\"https://www.openinstall.io/deeplinking.html\">openinstall</a></li>\n</ul>\n<p>另外，也有一些开源库实现web跳转app</p>\n<ul>\n<li><a href=\"https://github.com/suanmei/callapp-lib\">https://github.com/suanmei/callapp-lib</a></li>\n<li><a href=\"https://github.com/jawidx/web-launch-app\">https://github.com/jawidx/web-launch-app</a></li>\n<li><a href=\"https://github.com/luojinghui/web-open-app\">https://github.com/luojinghui/web-open-app</a></li>\n</ul>\n<p><em>–END–</em></p>\n",
            "tags": [
                "引流",
                "universal-link",
                "app-link"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/12/16/effective-executive/",
            "url": "http://shenlvmeng.github.com/blog/2021/12/16/effective-executive/",
            "title": "卓有成效的管理者 —— 德鲁克笔记系列之一",
            "date_published": "2021-12-16T15:06:27.000Z",
            "content_html": "<p>与其说德鲁克是管理学鼻祖，他更像在研究社会、组织、企业存在的合理性与最佳实践。德鲁克认为人性是不完美的，那人设计出来的社会也不可能完美。他抵制极权专制，这里的极权不同集权，所追求的是全面彻底地操纵和控制人类的每一个成员。德鲁克视管理学为一种“博雅艺术”（liberal art）。它既不像人文文化，也不像科学文化。它关心人的价值成长和社会组织的影响，但又关心管理工作的应用的成果。这使得管理学不像世俗观点中的那样，<strong>是一个人或一个机构的成功学</strong>。它只在让每个人在社会和社群中更健康，自由地选择并履行承担的责任，从而是人类社会和社区更健康，人们受到更少的伤害和痛苦。</p>\n<p>而这本书即从管理者的成效出发，探讨一个管理者如何能<strong>管理好自己</strong>。毕竟让一个自身成效不高的管理者管好他下面的下属，几乎是不可能的事情。而卓有成效的管理者也逐渐成为社会中的关键资源。</p>\n<h2 id=\"卓有成效可以学会\"><a href=\"#卓有成效可以学会\" class=\"headerlink\" title=\"卓有成效可以学会\"></a>卓有成效可以学会</h2><p>卓有成效<strong>重要且可以学会</strong>。</p>\n<ul>\n<li>首先端正思路，管理者为什么<strong>必须有效</strong><ul>\n<li><strong>有效即“做对的事情”</strong>，而不是纯执行的“把事情做对”</li>\n<li><strong>当下知识工作者</strong>逐步增多，他们产出的更多是抽象的知识、创意或信息，无法用传统衡量体力活动的方式衡量，因此需要自己管理自己，自觉做出贡献，追求工作效益</li>\n</ul>\n</li>\n<li>谁是管理者<ul>\n<li>如果在组织内，一个知识工作者，能够凭借职位或知识，对组织负有贡献的责任，因而能对组织的经营能力或成果有实质性影响。那他就是一位管理者。</li>\n<li>衡量知识工作，主要应看结果而不是工作繁杂程度</li>\n<li>一般的经理人员工作性质和董事长、政府机构的行政领导是相同的，那就是计划、组织、整合、激励和考核</li>\n</ul>\n</li>\n<li>管理者的不利现状<ul>\n<li>组织<strong>内</strong>的管理者会面临下面一些压力<ul>\n<li>时间往往属于别人，不属于自己，如经常有外部人员拜访</li>\n<li>往往被迫忙于“事务性工作”，除非他们敢于采取行动改变周围的一切<ul>\n<li>管理者需要一套判断体系，去找到真正重要的事项</li>\n</ul>\n</li>\n<li>管理者的贡献<strong>能被其他人利用时，才算有效</strong><ul>\n<li><strong>组织是使个人才干能够增值的工具</strong>，一个人的知识可以被组织吸收，作为其他知识工作者工作的资源</li>\n<li>贡献不能被有效利用时，有效性也会打折扣</li>\n</ul>\n</li>\n<li>管理者会受到组织的局限<ul>\n<li>受到的信息会被组织过滤</li>\n<li><strong>组织需要为外部服务</strong>，因此需要得到外部的信息</li>\n<li>组织是社会中的人为产物，和生物体类似的是，成长得越大，消耗的资源和复杂度就越大</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>对外部信息的收集，人从现象中的抽象能力往往优于机器（类似深度学习）</li>\n</ul>\n</li>\n<li>提高有效性，让工作达到令人满意的程度<ul>\n<li>不要期望万能的天才来达到绩效，通才难求，学会善用专精于某一领域的人</li>\n<li>通过从各种有效的管理者归纳来看，他们各个方面都不完全一样，<strong>人人都具有做好该做事情的能力</strong>，即有效性</li>\n<li>下面一些习惯是成为卓有成效管理者所必须的<ul>\n<li><strong>善用时间</strong>，知道时间都去哪儿了</li>\n<li>重视对外界的贡献，<strong>目标导向</strong></li>\n<li>善于利用长处</li>\n<li>集中精力到少数重要领域</li>\n<li>敢于、善于做决策</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"掌握自己的时间\"><a href=\"#掌握自己的时间\" class=\"headerlink\" title=\"掌握自己的时间\"></a>掌握自己的时间</h2><p>时间是最珍贵的资源，先摸清自己的时间分配，再统一管理和安排。</p>\n<ul>\n<li>所有资源里，时间不像资金、人力，是<strong>最稀有</strong>，<strong>毫无可替代性</strong>，<strong>所有工作必须消耗</strong>的资源，而人往往不善于使用这种资源</li>\n<li>管理者面临的时间压力<ul>\n<li>管理者作为知识工作者，他的大多数任务，都需要<strong>相当多的整块时间</strong></li>\n<li><strong>管理者要与他人一同工作</strong>，需要各种信息，需要讨论、需要指导他人，需要协调人际和工作关系，这些都是费时的</li>\n<li>只有在脑力上多费时，才能在体力上少费时</li>\n<li>如果时间短促，一个人就只能考虑他已经熟悉的事，做曾经做过的事，无法创新和变革</li>\n</ul>\n</li>\n<li>你诊断过你的时间么<ul>\n<li>第一步是记录时间的耗用情况，一定要<strong>当即</strong>记，事后回忆往往不准确，然后问下面一些问题</li>\n<li>“什么事情根本不必做”</li>\n<li>“哪些活动可以由别人代为参加”，学会授权</li>\n<li>“有浪费别人的时间么”，如过多的会议</li>\n</ul>\n</li>\n<li>消除浪费时间的活动<ul>\n<li>找出可以通过制度或远见避免的时间浪费<ul>\n<li><strong>一个平静无波的工厂，必然是管理上了轨道，因为所有危机都已预见，并变成了例行工作</strong></li>\n</ul>\n</li>\n<li>人员过多会带来人际关系的时间浪费</li>\n<li>组织不健全，表现就是会议太多<ul>\n<li>之所以要开会，是因为某种情况的所需的知识不能装在一个大脑里</li>\n<li>要开会，也要有计划</li>\n</ul>\n</li>\n<li>信息功能不健全，上下文不透明，或信息表达不当</li>\n</ul>\n</li>\n<li>统一安排可以自己支配的时间<ul>\n<li>高级主管可以自由运用的时间，可能只有1&#x2F;4，组织越大，维系组织运行而不是发挥组织价值的工作越多，从而不由自己掌控的时间越多</li>\n<li>可以给自己的时间划分最小单位，如90分钟，聚合碎片时间</li>\n<li>对时间的控制和管理不是一劳永逸的，要不断记录时间消耗并分析</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"我能贡献什么\"><a href=\"#我能贡献什么\" class=\"headerlink\" title=\"我能贡献什么\"></a>我能贡献什么</h2><p>关注产出，目标导向，可以帮助自己thinking out of the box。</p>\n<ul>\n<li>重视贡献，注意对成果负责，才能看到整体的绩效<ul>\n<li>只有这样，一个人才能考虑自己的技能、专长和整个组织以及组织目标的关系</li>\n<li>管理者如果不自问“我可以做出什么贡献”，在工作中就不会有远大的目标，而偏向执行的角色</li>\n</ul>\n</li>\n<li>一般机构对成效的要求往往有下面三个方面<ul>\n<li>直接成果</li>\n<li>梳理新的价值观或对价值观的重新确认</li>\n<li>培养和开发明天所需的人才</li>\n</ul>\n</li>\n<li>职位越高，对外所需的贡献就越大</li>\n<li>对于专业人员，必须使自己的“产品”——即他的只是可以为别人所用；同时，肩负贡献的责任，要求他知道应该了解别人的需要、别人的方向，别人的理解，从而使别人能够应用他的成果</li>\n<li>有效的人际关系有4项基本要求，而着眼贡献正可以满足<ul>\n<li>以目标为导向，可以很方便对齐期望，有助于<strong>互相沟通</strong></li>\n<li>强调贡献有助于横向沟通，促成<strong>团队合作</strong></li>\n<li><strong>个人发展</strong>，一定程度上也要看是否重视贡献</li>\n<li>重视贡献的管理者必然能启发他人寻求自我发展，从而<strong>培养他人</strong></li>\n</ul>\n</li>\n<li>重视贡献，才能使管理者的视线从“内部事务”转向“外部世界”</li>\n</ul>\n<h2 id=\"发挥他人长处\"><a href=\"#发挥他人长处\" class=\"headerlink\" title=\"发挥他人长处\"></a>发挥他人长处</h2><p>人无完人，有效的管理者可以使人发挥长处，减少短处带来的限制。</p>\n<ul>\n<li><strong>世界上从来没有发生过下属的才干反而害了主管的事</strong></li>\n<li>人的精力有限，卓越通常只能表现在某一或者某几方面<ul>\n<li>是用人来做事，不是用人来投自己所好，或投主管所好</li>\n<li>有效的管理者从来不问“我和他能合得来吗”，而是问“他能贡献什么”，从来不问“他不能做什么”，而是问“他能做什么”</li>\n</ul>\n</li>\n<li><strong>要坚持因事用人而不是因人设事</strong>，这样才能减少组织变动，同时保证以任务为重心，而不是以人为重心<ul>\n<li>只有极少数例外，譬如有特殊才干，从事非一般工作，取得杰出成就的人</li>\n</ul>\n</li>\n<li>能建立一流经营体制的管理者<strong>在公事上</strong>，通常会和周围同事以及下属保持一定距离，避免个人好恶挑选人才</li>\n<li>如何做到发挥长处，同时避免因人设事的4个原则<ul>\n<li>一个职位，如果先后多人担任都失败了，那肯定是常人无法胜任的职位，需要重新设计<ul>\n<li>国际部副总裁的压力，需要由按产品类别调整组织，或是按市场的社会经济背景调整组织来合理规划</li>\n<li><strong>只有让“平凡人做出不平凡事”的组织，才是好组织</strong></li>\n</ul>\n</li>\n<li>职位要求要严格，涵盖要广（想象空间大）<ul>\n<li>从而保证下限高，人才又有能充分发挥的机会</li>\n<li>知识工作者的职位设计，还应该能够让人及早发现自己是否适合该职位</li>\n<li>与体力劳动者不同，<strong>知识工作者的贡献产出不仅和本身的知识技能有关，和组织的目标、价值观也有很大关系</strong></li>\n</ul>\n</li>\n<li>用人时，先考虑某人能做什么，而不是职位的要求是什么<ul>\n<li>在考评、绩效制度上，更多从“某人能完成什么”的视角看问题<ul>\n<li>“哪方面的工作他确实做得很好”</li>\n<li>“哪方面的工作还可以做得更好”</li>\n<li>“为了充分发挥长处，他还可以再学习什么知识”</li>\n<li>“如果我有了子女，愿意让子女在他的指导下工作吗，为什么？”</li>\n</ul>\n</li>\n<li>正直的品格很关键</li>\n</ul>\n</li>\n<li>必须能容忍人的缺点<ul>\n<li>结合具体任务来寻找别人的长处</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>用人所长是有效管理者的必备素质，也是组织能否有效的关键</li>\n<li>卓有成效的管理者还会设法发挥<strong>上司的长处</strong><ul>\n<li>不能唯命是从，需要协助上司发挥所长，也能给自己更大的空间</li>\n</ul>\n</li>\n<li>也要了解自己的长处，寻找适合发挥自己长处的工作方式，做出自己的绩效</li>\n<li><strong>管理者的任务不是去改变人，而是在于运用每个人的才干</strong></li>\n</ul>\n<h2 id=\"要事优先\"><a href=\"#要事优先\" class=\"headerlink\" title=\"要事优先\"></a>要事优先</h2><p>时间有限，做重要的事；而立足现在看未来才可看到真正重要的事情</p>\n<ul>\n<li>时间总是不够，只有几种个人、组织的所有才干，才能获得成果</li>\n<li>一次只做好一件事，恰恰能加快工作速度<ul>\n<li>我们往往会低估完成任务的时间</li>\n</ul>\n</li>\n<li>很多组织都容易错误地看待过去的成功和失败<ul>\n<li>当下的很多计划和制度，是基于<strong>过去的经验</strong>确定的，时间久了已不能产生成果</li>\n<li>及时重构，去肥增瘦；只有推陈才能出新</li>\n</ul>\n</li>\n<li>对于新工作，应责成确能证明有能力的人来负责</li>\n<li>所谓压力，总是偏爱机构内部的事务，偏爱已经发生的事而忽视未来，偏爱危机忽视基于，偏向急功近利而忽视现实世界</li>\n<li>真正的难度不在决定做什么，而是<strong>什么可以缓一缓</strong><ul>\n<li>被搁置一般等同于被取消，因为外部世界变化极快</li>\n<li>下面有一些可以确定事情优先顺序的原则<ul>\n<li>将来 &gt; 过去</li>\n<li>重视机会，不要只看到困难</li>\n<li>选择自己的方向不盲从</li>\n<li>目标要高，要有新意，不能只求安全和容易</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>化机会为成果，肯定比解决旧问题更有生产性。解决旧问题，不过是恢复昨天的平衡而已</li>\n</ul>\n<h2 id=\"决策的要素\"><a href=\"#决策的要素\" class=\"headerlink\" title=\"决策的要素\"></a>决策的要素</h2><p>管理者要做对组织绩效有效果的决策，决策是观念性、战略性的，不是细节的、解决问题的。</p>\n<ul>\n<li>一项决策如果不能付诸行动，就只能算作想法</li>\n<li>贝尔公司的费尔和通用汽车的斯隆，解决问题，都着眼于最高层次的观念性认识，所做的决策不是为了适应当时的临时需求，而是战略性考虑</li>\n<li>决策有下面一些要素<ul>\n<li>判别问题性质<ul>\n<li>一般遇到的问题可以分为四类<ul>\n<li>表面现象之下的真正<strong>经常性问题</strong></li>\n<li>特殊情况下偶然发生的实质上<strong>经常性问题</strong></li>\n<li>真正偶发的特殊事件（“黑天鹅事件”）</li>\n<li>第一次出现的“经常事件”</li>\n</ul>\n</li>\n<li>对于经常性问题要有经常性的解决办法——一种规则、一种政策或一种原则</li>\n<li>判断问题性质并没那么简单，可能遇到一些常见错误<ul>\n<li>把经常性问题视为一连串的偶发问题（“实用主义”）</li>\n<li>将真正的新问题视作旧病复发，从而采取错误的方法</li>\n<li>对根本性问题界定似是而非</li>\n<li>只看到问题局部，没看到全貌</li>\n</ul>\n</li>\n<li>一个有经验的管理者总会先假定问题只是表面现象，从最高层次的观念方面寻求解决方法。他要找出真正问题，不满足表面现象，从更基本、更理性、更广泛的观念上谋求解决办法</li>\n</ul>\n</li>\n<li>找到解决问题的限制条件或假设前提<ul>\n<li>边界条件往往不容易找到，因为每个人的视角不同</li>\n<li>错误的边界条件，比没有更误事</li>\n<li><strong>边界条件清晰时，有助于决策人在情况变化时，更快用新决策取代旧决策</strong></li>\n<li><strong>依赖太多边界条件去决策是危险的</strong></li>\n</ul>\n</li>\n<li>考虑问题的正确方案，<strong>之后再</strong>考虑必要妥协或让步事项<ul>\n<li>如果一开始就问“什么是能让人接受的决策”，那永远不会有结果</li>\n</ul>\n</li>\n<li>决策要<strong>兼顾执行措施</strong><ul>\n<li>必须能准确无误地回答下列问题<ul>\n<li>谁应该了解这项决策（object）</li>\n<li>应该采取什么行动（what）</li>\n<li>谁采取行动（subject）</li>\n<li>行动如何进行（how）</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>重视反馈，验证决策的有效性<ul>\n<li>决策是会过期的，需要建立反馈机制更新决策</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"有效的决策\"><a href=\"#有效的决策\" class=\"headerlink\" title=\"有效的决策\"></a>有效的决策</h2><p>一项决策若要保证有效，需要考虑各种方案，甚至包括反对意见。另外，电脑不能取代管理者做决策，反而会让更多人参与到决策中。</p>\n<ul>\n<li>决策不是从搜集事实开始，而是先有自己的看法和立场，再去搜集事实证明<ul>\n<li>搜集事实本身就会预设立场，做不到客观</li>\n<li><strong>大胆猜测，小心求证</strong>：假设和见解不必辩论，鼓励大家提出，但是必须经过深思，必须经得起验证</li>\n</ul>\n</li>\n<li>如何<strong>衡量</strong>决策，需要的时间和经历也极多<ul>\n<li>使用反馈的制度</li>\n<li>只有有<strong>多项</strong>方案，从中选择一项，才能称得上判断</li>\n<li>管理者一定要<strong>先有若干种不同的衡量方法，再从中选择最合适的一种</strong></li>\n</ul>\n</li>\n<li>好的决策，应该以<strong>互相冲突的意见为基础</strong>，从不同观点和判断中选择<ul>\n<li><strong>反对意见</strong>相当重要<ul>\n<li><strong>唯有反对意见，才能保护决策者不至沦为组织的俘虏</strong></li>\n<li>反对意见不深，也可以作为决策的“另一方案”</li>\n<li>反对意见可以激发想象力和创造力</li>\n</ul>\n</li>\n<li>当然世上有蠢材和恶作剧的人，不过有效的管理者会假定，某人意见纵然错了，也是由于此人看到的现实不同，或者关注的问题不一样</li>\n</ul>\n</li>\n<li>是否真的需要一项决策<ul>\n<li>满足下面两项原则即可<ul>\n<li>利益远大于成本或风险就该做<ul>\n<li>不要做鸡毛蒜皮的小事，也不要墨守成规</li>\n</ul>\n</li>\n<li>行动或不行动，切忌只做一半或折中</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>决策前，想清楚规范、不同方案、得失也衡量了，采取什么行动也想好了。尚未想清楚前，不要冒冒失失地决策，但都想好了，也绝不会优柔寡断</li>\n<li>电脑只是工具，人类则不是逻辑的，而是具有感官的；电脑所做的决策是预先安排的，不能随机应变，都是基于<strong>硬性原则</strong></li>\n<li>每一位知识工作者有效决策能力的高低，决定了其工作能力的高低</li>\n</ul>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>全书内容无非两点：</p>\n<ul>\n<li>管理者的工作必须卓有成效</li>\n<li>卓有成效可以学会</li>\n</ul>\n<p>做到卓有成效需要从几个方面努力：</p>\n<ul>\n<li>记录好时间的使用情况，分析时间记录，消除不必要浪费</li>\n<li>集中眼光在贡献上，从执行进入到观念，关注个人目标和组织目标的关联</li>\n<li>充分发挥人的长度，融合个人能力和组织成果</li>\n<li>做重要的事情</li>\n<li>有效的决策，合理的行动</li>\n</ul>\n<p>今天的组织需要的是<strong>平凡人做不平凡的事业</strong>。组织取得好的成效，要靠组织中的人切实进行系统化、专门化的自我训练，成为有效的管理者。在如今，知识工作者为组织服务，除了物质上，在心理需求和个人价值上也需要从工作和职位上获得满足。因此，一定要使组织绩效和个人成就结合起来。管理者在卓有成效上的自我提高就是唯一解法。</p>\n",
            "tags": [
                "管理",
                "效率",
                "知识工作者",
                "卓有成效"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/12/07/winning-note/",
            "url": "http://shenlvmeng.github.com/blog/2021/12/07/winning-note/",
            "title": "公司管理和自我修养 —— 《赢》读书笔记",
            "date_published": "2021-12-07T14:27:07.000Z",
            "content_html": "<p>关于管理和商业化这个大话题，《赢》这本书从“术”的角度，结合自身几十年的成功经验，给出了自己的看法和建议。书中的视角不像<a href=\"https://shenlvmeng.github.io/blog/2021/11/24/leadership-pipeline/\">《领导梯队》</a>一样，切入到很实际的角度，很具象地描述和推广领导力模型。《赢》的视角要更为大和全面，在管理上更实用。同时，相对德鲁克的管理学著作对于组织、管理的系统探讨，《赢》又更实用和大杂烩一点，不仅介绍了公司的管理技巧，也讲解了公司竞争、个人发展相关的一些商业手段。整体值得一看，可以开拓自己的做事思路，文本精简而平易近人，很易读。</p>\n<h2 id=\"原则篇\"><a href=\"#原则篇\" class=\"headerlink\" title=\"原则篇\"></a>原则篇</h2><p>韦尔奇从先从自己的经营方式中，总结出4个基本原则，作为后续实践的基础：</p>\n<ul>\n<li><strong>使命和价值观</strong><ul>\n<li>有效的使命需要有<strong>清晰</strong>的方向，以赢的<strong>商业利益</strong>为导向，又要让人充满<strong>雄心壮志</strong><ul>\n<li>例：成为世界上最有竞争力的企业，即各个业务领域都在第一或第二的位置</li>\n</ul>\n</li>\n<li>确定使命始终是企业高管的职责</li>\n<li>价值观体现在人的行动，是具体的、本质的、可以描述的<ul>\n<li>让员工参与进来</li>\n<li><strong>具体的价值观念和行动纲领</strong></li>\n<li>反复实践修正</li>\n<li>配合奖惩</li>\n</ul>\n</li>\n<li>使命和价值观需要融为一体，出现偏离时，通常是因为商业生活中出现了危机</li>\n</ul>\n</li>\n<li><strong>坦诚</strong><ul>\n<li>坦诚可以<strong>减少沟通负担、鼓励信息流动、减少沟通中的信息损耗或走样</strong>；从而吸引更多人参与对话、提高效率、节约成本</li>\n<li>坦诚使人紧张，这是人们的世故带来的，</li>\n<li>鼓励坦诚是项艰难而费时的工作，<ul>\n<li>要普及坦诚，需要不断激励、赞赏、谈论它，还需要自己带头，同时展示给别人看</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>考评</strong><ul>\n<li>考评不过是<strong>资源配置</strong>而已，将资源投放到回报最丰厚的地方，避免不必要的损失</li>\n<li>可以将员工分为最好的20%，中间的70%，最差的10%<ul>\n<li>最好的20%：大加鼓励，基于物质和精神财富</li>\n<li>中间的70%：培训教育、积极反馈，分辨哪些人有提升潜力</li>\n<li>最差的10%：“不是人人都能成为优秀的棒球手”</li>\n</ul>\n</li>\n<li><strong>需要坦诚和清晰的流程来保证</strong><ul>\n<li>清晰的期望值、目标和时间表</li>\n</ul>\n</li>\n<li>在商业生活中，<strong>积极向上且外向</strong>的人通常能做得更好，得到更多偏爱</li>\n</ul>\n</li>\n<li><strong>发言权和尊严</strong><ul>\n<li>人们都希望得到发言权和尊严</li>\n<li>“对于讨论会上的75%的建议，需要现场给出‘行’或‘不行’的回答；剩下的25%要在30天内回答”</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"公司管理\"><a href=\"#公司管理\" class=\"headerlink\" title=\"公司管理\"></a>公司管理</h2><p>下面6章主要介绍公司管理的有效手段</p>\n<h3 id=\"领导力\"><a href=\"#领导力\" class=\"headerlink\" title=\"领导力\"></a>领导力</h3><p>在你成为领导者之后，你的成功和他人的成长有关。有下面一些准则评估一个领导者的领导力：</p>\n<ul>\n<li>坚持不懈提升自己团队，珍惜每一次oneone的机会<ul>\n<li>必须做好评估、提供指导、树立员工自信心</li>\n</ul>\n</li>\n<li>让员工心怀梦想，实践梦想<ul>\n<li>保持和公司同步</li>\n</ul>\n</li>\n<li>深入员工中，传递积极活力<ul>\n<li>一个团队的风格会受到领导的影响，积极的领导才能带出积极的团队</li>\n</ul>\n</li>\n<li>以坦诚、透明度提升自己的可信赖感<ul>\n<li>坦诚、言出必行</li>\n<li>context, not control，激发潜能</li>\n</ul>\n</li>\n<li>有勇气作出决定</li>\n<li>用好奇心和怀疑精神监督业务，要习惯于提问题，不放过问题<ul>\n<li>适当的challenge可以让员工更深入本质</li>\n</ul>\n</li>\n<li>用于承担风险和学习<ul>\n<li>对于比自己优秀的下属，要向他们学习</li>\n</ul>\n</li>\n<li>学会庆祝</li>\n</ul>\n<h3 id=\"招聘\"><a href=\"#招聘\" class=\"headerlink\" title=\"招聘\"></a>招聘</h3><p>招聘的员工可以怎么考察。</p>\n<ul>\n<li>3项考验<ul>\n<li><strong>正直</strong>：说真话、授信、知错能改</li>\n<li><strong>智慧</strong>：有求知欲和知识面</li>\n<li><strong>成熟</strong>：能够控制情绪，尊重他人情感</li>\n</ul>\n</li>\n<li>4E1P人员招聘方法<ul>\n<li><strong>Energy</strong>：积极向上的人热爱生活</li>\n<li><strong>Energize</strong>：能激励人，鼓舞自己的团队</li>\n<li><strong>Edge</strong>：需要能做出果断的决定</li>\n<li><strong>Execute</strong>：有执行力，能落实工作任务</li>\n<li><strong>Passion</strong>：有旺盛的生命力和激情</li>\n</ul>\n</li>\n<li>招聘高层人士的额外特征<ul>\n<li><strong>真诚</strong>：需要保持本色，没有伪装</li>\n<li><strong>对变化来临的敏感性</strong></li>\n<li><strong>爱才</strong>：即希望周边人更优秀和聪明</li>\n<li><strong>强大的韧性</strong>，不怕失败，能屈能伸</li>\n</ul>\n</li>\n<li>招聘管理职位时，至少需要有前两个E</li>\n<li>招聘人才时，要更看重<strong>长远的发展潜力</strong>，努力寻找能和业务一同成长或者能到更高职位的人才<ul>\n<li>在招聘员工时，不要提供他们职业生涯的“终极岗位”</li>\n</ul>\n</li>\n<li><strong>询问上一次的离职原因通常可以获取到绝大多数你想了解的信息</strong></li>\n</ul>\n<h3 id=\"人员管理\"><a href=\"#人员管理\" class=\"headerlink\" title=\"人员管理\"></a>人员管理</h3><p>对于按上章标准招聘来的人才，可以有下面一些管理准则：</p>\n<ul>\n<li>重视人力资源管理，人力资源管理人员可以帮助经理人培养领导者<ul>\n<li>人力资源管理应当与公司其他业务一样重要</li>\n<li>出色的人力资源经理，既是牧师又是父母，既能倾听，又能给与关爱和教育</li>\n</ul>\n</li>\n<li>采用一套严格、非官僚的业绩评价体系<ul>\n<li>简洁明了的评价</li>\n<li>和行为相关联的标准</li>\n<li>每年一次到两次</li>\n<li>应当包含职业发展的内容</li>\n</ul>\n</li>\n<li>有一个激励机制，包括物质上和精神上的<ul>\n<li>和奖赏一样，培训也有同样的激励作用</li>\n</ul>\n</li>\n<li>积极处理和<strong>工会</strong>、<strong>明星员工</strong>、<strong>边缘分子</strong>、<strong>捣乱分子</strong>的关系<ul>\n<li><strong>工会</strong>：正直和积极的态度，有原则</li>\n<li><strong>明星员工</strong>：提前考虑可替代性</li>\n<li><strong>边缘人员</strong>：拉回正轨或者及时辞退</li>\n<li><strong>捣乱分子</strong>：限期改正或及时辞退</li>\n</ul>\n</li>\n<li>不要忽视70%的大多数</li>\n<li>设计更扁平和更易懂的组织框架</li>\n</ul>\n<h3 id=\"解雇\"><a href=\"#解雇\" class=\"headerlink\" title=\"解雇\"></a>解雇</h3><p>既然有招聘，当然就有解雇。解雇分三类：</p>\n<ul>\n<li>违法或者违反道德准则而遭解雇</li>\n<li>因为大环境或经济问题的裁员</li>\n<li>因为业绩不佳的解雇</li>\n</ul>\n<p>对于第一种，不需要解释，当机立断即可。对于第二种，需要让员工提前知道公司的经营情况，从而有提前的心理准备。对于第三种，主要在于降低员工的羞耻感，给一个缓冲时间，尽量做到：</p>\n<ul>\n<li><strong>留下缓冲时间</strong>：给人心理准备</li>\n<li><strong>坦诚清晰</strong>：减少误解，直说事实，无需粉饰</li>\n<li><strong>及时say goodbye</strong>：拖得太久会影响团队的稳定性</li>\n</ul>\n<h3 id=\"改革\"><a href=\"#改革\" class=\"headerlink\" title=\"改革\"></a>改革</h3><p>公司要能适应外界变化和自身情况，积极调整自己，这即是改革。</p>\n<ul>\n<li>如果你认为需要改革，但是却不具备权威，那就提出自己的议案，你的建议如果没得到响应，那么要么接受现状要么离开</li>\n<li>设立清晰的目标和指标，不要为了改革而改革<ul>\n<li>收集bad case</li>\n<li>远离空洞口号，立足实际的行动</li>\n</ul>\n</li>\n<li>招募和提拔支持者<ul>\n<li>这类人通常以“卷王”的形式出现</li>\n</ul>\n</li>\n<li>清理反对者，尤其是在他们构成阻碍的时候</li>\n<li>抓住良机<ul>\n<li>黑天鹅事件无时无刻都在发生</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"危机管理\"><a href=\"#危机管理\" class=\"headerlink\" title=\"危机管理\"></a>危机管理</h3><p>解决危机可能是每个管理者不愿面对，却又不得不面对的事情。下面是这一章中提到的一些tips：</p>\n<ul>\n<li>假设问题本身比表现出来的<strong>更糟糕</strong><ul>\n<li>降低预期，饱和式补救</li>\n</ul>\n</li>\n<li>假设所有人最终都会知道事件真相<ul>\n<li>要坦诚错误，但也不要将所有错误都包揽在身上，保证说得都是事实就行</li>\n</ul>\n</li>\n<li>假设你和所在组织会被人用摸黑的态度描述出来<ul>\n<li>在别人全面曝光之前，如果不能奋起反抗，为自己辩护，那就只能被别人埋葬了</li>\n</ul>\n</li>\n<li>危机处理中，<strong>总要有人付出代价</strong><ul>\n<li>危机后总有变革发生</li>\n<li>有人需要对发生的事故承担责任</li>\n</ul>\n</li>\n<li>假设你的组织将从危机中恢复，并变得更强大<ul>\n<li>就像免疫系统一样</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"赢得竞争\"><a href=\"#赢得竞争\" class=\"headerlink\" title=\"赢得竞争\"></a>赢得竞争</h2><p>不同于上一部分，这一部分在管理以外，介绍赢得商业竞争的各方面</p>\n<h3 id=\"战略\"><a href=\"#战略\" class=\"headerlink\" title=\"战略\"></a>战略</h3><p>全篇在阐述战略没有想象中复杂神秘。无非是摸清游戏规则，找到一个努力的方向，果断行动。</p>\n<ul>\n<li>找一个大方向，找到聪明、实用、可以获得竞争优势的办法<ul>\n<li>如果大方向对头，又有一定宽度，则战略不需要经常变化</li>\n</ul>\n</li>\n<li><strong>把合适的人放在合适的位置</strong><ul>\n<li>为不同类型的方向安排对应特质的人</li>\n</ul>\n</li>\n<li>不断迭代探索最佳实践<ul>\n<li>学习竞争对手或是优秀同行的成功经验</li>\n</ul>\n</li>\n</ul>\n<p>找到一个可以获得优势的大方向需要一些讨论和分析，可以从下面几个角度出发：</p>\n<ul>\n<li>在什么场景下<ul>\n<li>行业里有哪些竞争对手</li>\n<li>市场份额占有情况如何，我们的企业更擅长什么市场</li>\n<li>行业特征怎么样<ul>\n<li>平民化？高附加值？</li>\n<li>长周期？短周期？</li>\n<li>在增长曲线的什么位置？</li>\n<li>决定利润率的因素是什么</li>\n</ul>\n</li>\n<li>竞争对手的优劣势在哪里<ul>\n<li>产品</li>\n<li>研发</li>\n<li>销售</li>\n<li>组织文化</li>\n</ul>\n</li>\n<li>客户有哪些，购买方式如何</li>\n</ul>\n</li>\n<li>最近的竞争态势<ul>\n<li>竞争对手过去一年的改变市场格局的举动</li>\n<li>有什么新产品、新技术或是新的销售渠道</li>\n<li>是否进入了新的玩家</li>\n</ul>\n</li>\n<li>我们的近况如何<ul>\n<li>过去一年，我们企业对市场竞争格局的影响</li>\n<li>是否通过收购、引进新产品、挖角、引进新技术得到竞争优势</li>\n<li>是否失去某些竞争优势</li>\n</ul>\n</li>\n<li>有哪些潜在风险<ul>\n<li>对手有没有可能做出什么事情，将我们封杀出具</li>\n<li>对手有没有什么能改变游戏规则的举动</li>\n<li>公司会不会被收购</li>\n</ul>\n</li>\n<li>有什么胜招<ul>\n<li>我们能做什么——兼并、新产品、全球化</li>\n<li>如何保持用户粘性</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"预算\"><a href=\"#预算\" class=\"headerlink\" title=\"预算\"></a>预算</h3><ul>\n<li>不要把预算会变成辩论会或是形式化的会</li>\n<li>使用灵活的指标，不论是规划预算还是评估盈利结果，用更具建设性的方式讨论<ul>\n<li>对个人和部门的奖励不是根据实际业绩与预算目标对比决定，而是通过实际业绩和此前的业绩结合竞争环境的对比决定，要考虑到现实的战略机会和困难因素</li>\n<li>这种改变的推进可能会遇到持续的阻力</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"有机的成长\"><a href=\"#有机的成长\" class=\"headerlink\" title=\"有机的成长\"></a>有机的成长</h3><p>公司内会通过孵化新产品或兼并收购来获得进一步增长。这一章先介绍新产品。对管理者来讲，有下面3个原则：</p>\n<ul>\n<li>做大笔投入，把最优秀、最进取、最有活力的人放在领导岗位上<ul>\n<li>不要把新业务当做边缘部门，安排平凡的人</li>\n</ul>\n</li>\n<li>大肆宣传新项目的潜力和重要性<ul>\n<li>新项目报告层次至少应该提升2级，甚至到CEO的地步</li>\n</ul>\n</li>\n<li>给予自由度，允许犯错误，让新项目自己成熟起来<ul>\n<li>适当自由度会给人主人翁意识和自豪感</li>\n</ul>\n</li>\n</ul>\n<p>对新业务负责人来讲，要有<strong>创业者</strong>的心态</p>\n<ul>\n<li>要做好资金不足、人手不够优秀的心理准备，竭力去争取！</li>\n<li>适当渲染</li>\n<li>用自我行动争取公司的自由度</li>\n</ul>\n<p>新的项目需要高水平的人才、大规模的资源投入、大规模的宣传。</p>\n<h3 id=\"企业并购\"><a href=\"#企业并购\" class=\"headerlink\" title=\"企业并购\"></a>企业并购</h3><p>上章是增长的一种方式——新项目，这章介绍了增长的另一种方式——并购。并购有下面一些注意事项：</p>\n<ul>\n<li><strong>“平等合并”很难发生</strong><ul>\n<li>至少工业领域内，除了银行和咨询产业，很难发生</li>\n</ul>\n</li>\n<li>不要过分关注经营策略的匹配而忽略了<strong>企业文化的融合</strong><ul>\n<li>不要让被收购方过于影响自己的企业文化</li>\n</ul>\n</li>\n<li>不要在收购中让步太多</li>\n<li>整合行动节奏应该在90天内完成，不要拖泥带水<ul>\n<li>公布清晰的合并程序</li>\n</ul>\n</li>\n<li>克服“征服者综合征”，收购的目标之一是<strong>寻求更好更多的人才</strong><ul>\n<li>合并最大的战略收益之一就是让收购方从丰富的人才库来组建队伍</li>\n</ul>\n</li>\n<li>不要付出太高收购代价</li>\n<li>作为被收购方，不能拥抱变化的人就只能离开</li>\n</ul>\n<h3 id=\"六西格玛\"><a href=\"#六西格玛\" class=\"headerlink\" title=\"六西格玛\"></a>六西格玛</h3><p><a href=\"https://wiki.mbalib.com/wiki/%E5%85%AD%E8%A5%BF%E6%A0%BC%E7%8E%9B\">六西格玛</a>是一种企业质量控制策略。它主要做两件事：</p>\n<ul>\n<li>建立体系，减衡量质量波动</li>\n<li>减少质量波动</li>\n</ul>\n<h2 id=\"个人发展\"><a href=\"#个人发展\" class=\"headerlink\" title=\"个人发展\"></a>个人发展</h2><p>这一部分从个人角度出发，聊聊发展的思路。</p>\n<h3 id=\"合适的工作\"><a href=\"#合适的工作\" class=\"headerlink\" title=\"合适的工作\"></a>合适的工作</h3><p><strong>寻找合适的工作需要时间、尝试和耐心</strong>。下面有一些判断工作或好或坏的信号。</p>\n<ul>\n<li>人<ul>\n<li>好信号：你喜欢那里的人，融入得很好，可以和他们很好地沟通，志趣相投</li>\n<li>坏信号：你感觉自己需要戴上面具，不会和他们交朋友</li>\n</ul>\n</li>\n<li>机会<ul>\n<li>好信号：你能学到之前没有遇到的知识，获得人生或职业的进步空间</li>\n<li>坏信号：你似乎是办公室里最聪明的人，不需要能力提升</li>\n</ul>\n</li>\n<li>未来：从事的每种职业都是一种赌博，它可能会开拓你的发展空间或是缩小你的选择范围<ul>\n<li>好信号：工作会给你能力背书；行业发展强劲或是新兴业务</li>\n<li>坏信号：该产业或公司已经过了巅峰期，不能给职业发展提供更多帮助</li>\n</ul>\n</li>\n<li>主导权<ul>\n<li>好信号：你能自己cover这个工作，同时为自己工作</li>\n<li>坏信号：你出于外在原因，或被迫选择这份工作</li>\n</ul>\n</li>\n<li>工作内容<ul>\n<li>好信号：内容令人着迷，让你感到有趣，或是热爱</li>\n<li>坏信号：只是工作而已，不过是权宜之计</li>\n</ul>\n</li>\n</ul>\n<p>同时要对薪水坦诚，尤其是职业生涯的前几年。另外：</p>\n<ul>\n<li>对于第一份工作的面试，如果没有明显的长处，要保持坦诚和坦白</li>\n<li>如果是当前陷入困境，被迫寻找下一份工作，要记住<strong>寻找更好的工作，最快捷的办法是在现在的岗位上干出业绩</strong>，从而不会显得是能力不足从而寻找下家</li>\n<li>被辞退后，要能坦诚面对，承认错误，然后主动地走出来</li>\n</ul>\n<h3 id=\"晋升\"><a href=\"#晋升\" class=\"headerlink\" title=\"晋升\"></a>晋升</h3><p>可以说晋升是绝大多数人职业生涯中努力追求的，当然首先需要有<strong>渴望晋升的欲望</strong>。</p>\n<ul>\n<li>尽管有些晋升的机会纯粹来自于<strong>运气</strong>，但在职业生涯中，运气起到的作用比你可以控制的因素要小</li>\n<li>晋升的基础主要有两点<ul>\n<li>要：要交出动人的、<strong>远超预期的业绩</strong>，同时机遇来临时，勇于<strong>扩展工作职责到预期范围外</strong><ul>\n<li>eg. 超出预期的行动、新理念、新流程</li>\n</ul>\n</li>\n<li>不要：不要麻烦老板动用<strong>政治资本</strong>帮助你（推一把就水到渠成的地步）<ul>\n<li>eg. 不要当刺儿头，不要表露过强的职业欲望，要获得普遍认可</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>具体下来，用下面几点行动守则<ul>\n<li>要处理好<strong>和下属的关系</strong>，像对老板一样认真<ul>\n<li>也要和下属保持距离，不要跨越边界</li>\n</ul>\n</li>\n<li>在项目上<strong>早日做出成绩</strong>，受到关注或普遍认可<ul>\n<li>勇于承担大家关注的业务</li>\n</ul>\n</li>\n<li>寻找和利用良师益友</li>\n<li>保持积极向上，不要自认为清高或华而不实</li>\n<li>不要惧怕挫折</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"糟糕的领导\"><a href=\"#糟糕的领导\" class=\"headerlink\" title=\"糟糕的领导\"></a>糟糕的领导</h3><ul>\n<li>世界上总有乖僻古怪的人，有的或许就是能当上领导</li>\n<li>不能表现的像一名受害者</li>\n<li>领导一般对他们喜欢、尊重、需要的人表现并不差</li>\n<li>当价值观有问题但是绩效出色的人，公司不一定会很快开除</li>\n</ul>\n<h3 id=\"工作和生活平衡\"><a href=\"#工作和生活平衡\" class=\"headerlink\" title=\"工作和生活平衡\"></a>工作和生活平衡</h3><p>本章有些屁股决定脑袋的成分，很多观点本人并不认同。</p>\n<ul>\n<li>老板最关心的是竞争力，他只希望你的WLB（work life balance）不要影响工作<ul>\n<li>老板的第一优先级是盈利</li>\n</ul>\n</li>\n<li>有出色业绩，才可以有余地追求WLB<ul>\n<li>既然参与了工作这个“游戏”，就要服从游戏规则</li>\n</ul>\n</li>\n<li>很多老板认为WLB是应该自己去解决的问题，不应该交给公司<ul>\n<li>工作和生活总需要平衡和取舍，自己需要承担后果的</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><p>其他的一些零星问题</p>\n<ul>\n<li>竞争力的三要素<ul>\n<li>成本、质量、服务</li>\n</ul>\n</li>\n<li>考虑公司文化多元化</li>\n</ul>\n<p><em>–END–</em></p>\n",
            "tags": [
                "管理学",
                "公司",
                "个人发展",
                "战略",
                "晋升"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/11/24/leadership-pipeline/",
            "url": "http://shenlvmeng.github.com/blog/2021/11/24/leadership-pipeline/",
            "title": "《领导梯队》—— 领导力模型构建",
            "date_published": "2021-11-24T15:07:36.000Z",
            "content_html": "<p>对于很多从一线成长到管理岗位的员工来讲，管理工作和管理能力的阶段多少要靠自己领悟。可能从日常工作、文档培训中形成了管理工作懵懂认识，不成熟的归纳认知很可能会让你卡在某个阶段无法提升，又找不到办法。《领导梯队》这本书从基层开始分析管理路线上每一个阶段的做事思路，或许不能适应在所有场景下，但最起码能给人一种启示——什么才叫管理，以及想走管理路线的话，可以做些什么。当然，做事过犹不及，作为技术人员，理清管理思路后，别忘了你的本职工作。至少在前几个阶段，对你的技术能力是有要求的。</p>\n<h2 id=\"序和导论\"><a href=\"#序和导论\" class=\"headerlink\" title=\"序和导论\"></a>序和导论</h2><p>在讨论领导梯队和领导力模型之前，我们要认清下面一些现状：</p>\n<ul>\n<li>在快速发展的行业里（如互联网），是缺乏领导人才的</li>\n<li>一味地引入，忽视内部培养，无法建立完善而持久的领导梯队</li>\n</ul>\n<p>因此，公司需要一个领导力发展模型，模型从个人贡献者到CEO可以分为6个阶段：</p>\n<ul>\n<li>个人贡献者到一线经理</li>\n<li>一线经理到部门总监</li>\n<li>部门总监到事业部副总经理</li>\n<li>事业部副总经理到事业部总经理</li>\n<li>事业部总经理到集团高管</li>\n<li>集团高管到CEO</li>\n</ul>\n<p>角色负责的范围逐渐扩大，在<strong>工作技能</strong>、<strong>时间管理</strong>、<strong>工作理念</strong>三方面的要求也各有侧重。</p>\n<p>最后，书中提到的领导力模型和阶段并非适用于所有场景，需要根据实际情况灵活调整。毕竟人是复杂的，管理也是。</p>\n<h2 id=\"概述\"><a href=\"#概述\" class=\"headerlink\" title=\"概述\"></a>概述</h2><p>这里具体介绍了领导力发展的6个阶段：</p>\n<ul>\n<li>从管理自我到管理他人<ul>\n<li>从专业化、职业化思路转变到<strong>通过他人完成任务</strong>作为自己取得成功的关键</li>\n</ul>\n</li>\n<li>从管理他人到管理经理人员<ul>\n<li>负责选拔人才成为一线经理</li>\n<li>帮助一线经理清除“依靠自己获得成功”的错误观念</li>\n</ul>\n</li>\n<li>从管理经理人员到管理职能部门<ul>\n<li>战略眼光</li>\n<li>跨层级沟通</li>\n<li>和其他部门合作，基于工作需要帮自己部门争取资源</li>\n</ul>\n</li>\n<li>从管理职能部门到事业部总经理<ul>\n<li>清楚管理工作和市场结果的关系</li>\n<li>从盈利和长远发展出发</li>\n<li>兼顾长远和近期目标</li>\n<li>更多时间用来分析反思</li>\n</ul>\n</li>\n<li>从事业部总经理到集团高管<ul>\n<li>资金调拨和人才配置</li>\n<li>培养事业部经理</li>\n<li>评估业务投资组合策略</li>\n</ul>\n</li>\n<li>从集团高管到CEO<ul>\n<li>从管理技能转变到经营理念</li>\n<li>远大抱负、权衡取舍、外部视角</li>\n</ul>\n</li>\n</ul>\n<p>在小公司里，可能不会有这么多领导力的层级。</p>\n<h2 id=\"管理自我到管理他人\"><a href=\"#管理自我到管理他人\" class=\"headerlink\" title=\"管理自我到管理他人\"></a>管理自我到管理他人</h2><blockquote>\n<p>关键词：团队努力、计划、沟通</p>\n</blockquote>\n<p>随着个人贡献者能力的提升，一部分人会被提拔到职业生涯里第一个领导岗位上。在这个岗位上获得成功需要心态上的一大转变，即<strong>工作成功不再通过自己亲自做获得，而是通过下述和团队的努力获得</strong>。在这个位置，经理身上需要承担一些管理动作，包括：</p>\n<ul>\n<li>制定计划</li>\n<li>工作涉及</li>\n<li>人员选拔</li>\n<li>授权</li>\n<li>绩效监督、评估</li>\n<li>辅导和反馈收集</li>\n<li>沟通和氛围营造</li>\n<li>获取资源</li>\n<li>奖励和激励</li>\n</ul>\n<p>在时间管理上，需要划分出更多时间做：</p>\n<ul>\n<li>执行计划</li>\n<li>和下属沟通</li>\n<li>和兄弟部门、客户、供应商等沟通</li>\n</ul>\n<p>这一阶段可以采用下面一些手段帮助经理对齐领导力模型：</p>\n<ul>\n<li>准备：提前对齐岗位期望</li>\n<li>监督：通过旁听、360评估、和同行比较等方法</li>\n<li>干预：oneone沟通，引导</li>\n</ul>\n<p>一线经理是未来领导者的摇篮，在选拔这类人才时，可以考察此人帮助别人成功的意愿以及是否可以从帮助别人获得满足。</p>\n<h2 id=\"管理他人到管理经理\"><a href=\"#管理他人到管理经理\" class=\"headerlink\" title=\"管理他人到管理经理\"></a>管理他人到管理经理</h2><blockquote>\n<p>关键词：授权、选培一线经理、部门协作</p>\n</blockquote>\n<p>这个过程通常代表着从一线经理到部门总监。工作上也主要围绕着一线经理展开，主要职责是整合工作、分配资源和培训管理者。要敢于<strong>授权</strong>，同时建设授权后的问责系统，另外开始培养战略和文化的问题。作为一个部门总监，至少需要以下几个技能：</p>\n<ul>\n<li>选拔和培养有能力的一线经理<ul>\n<li>建设性批评、就事论事</li>\n</ul>\n</li>\n<li>让一线经理对管理工作负责<ul>\n<li>对齐期望，减少越俎代庖</li>\n<li>调整不合适的一线经理</li>\n</ul>\n</li>\n<li>在部门配置资源<ul>\n<li>根据部门情况调配资源（薪水、项目等）</li>\n</ul>\n</li>\n<li>协调下属部门和其他部门的管辖<ul>\n<li>信息共享，鼓励团结协作</li>\n<li>context、not control</li>\n</ul>\n</li>\n</ul>\n<p>其中第一项能力最为重要，要善于授权，培养<strong>大局观</strong>。寻找对管理工作有真正热情的人。在交流时，把一线经理当成一个团队而非一线员工。部门总监是第一个完全依靠管理技能而非从事专业技术工作的管理层级，要能够传递高层战略到基层员工，也要能将基层员工的执行能力反馈给战略制定者。</p>\n<h2 id=\"管理经理到管理职能部门\"><a href=\"#管理经理到管理职能部门\" class=\"headerlink\" title=\"管理经理到管理职能部门\"></a>管理经理到管理职能部门</h2><blockquote>\n<p>关键词：信息收集、全局观、战略思维、成熟度</p>\n</blockquote>\n<p>职能主管这个层级会有多种信息来源，需要能够熟练地收集和理解信息，沟通上从交谈转为倾听，要能积极倾听开放思想。另外，职能主管需要认识到，他不再是职能部门的一员，而是该部门的领导者。他需要拥有<strong>战略性思维</strong>，可以胸怀<strong>全局</strong>把握整体，而不是依赖以往领域的经验做事：</p>\n<ul>\n<li>长期思维（3-5年）</li>\n<li>关注业界最新发展动态<ul>\n<li>技术方面</li>\n<li>经营方面</li>\n</ul>\n</li>\n<li>全面了解商业模式和战略目标<ul>\n<li>业务目标</li>\n<li>市场定位</li>\n<li>战略变动</li>\n<li>如何盈利</li>\n<li>团队优势</li>\n<li>所在部门可以做出的贡献</li>\n<li>其他部门的贡献</li>\n</ul>\n</li>\n<li>将职能部门的所有方面纳入战略考虑，这也要求了解之前不甚熟悉的其他职能领域</li>\n</ul>\n<p>一个称职的事业部副总应该是<strong>成熟</strong>的。这体现在：</p>\n<ul>\n<li>谦逊好学、坦诚清晰</li>\n<li>善于授权、相信他人</li>\n<li>乐于沟通，善于表达</li>\n<li>和兄弟职能部门保持合作而不是竞争，因为个人成功和进步只有在企业成功时才有可能实现</li>\n</ul>\n<p>与之相反，可能会出现下面这些bad case：</p>\n<ul>\n<li>无法从项目运作导向转变到战略导向</li>\n<li>不重视不熟悉或是不感兴趣的工作</li>\n<li>表现不成熟</li>\n</ul>\n<h2 id=\"管理职能部门到事业部总经理\"><a href=\"#管理职能部门到事业部总经理\" class=\"headerlink\" title=\"管理职能部门到事业部总经理\"></a>管理职能部门到事业部总经理</h2><blockquote>\n<p>关键词：时间管理、工作透明、部门权衡、视野开阔</p>\n</blockquote>\n<p>相对职能主管，事业部总经理工作的曝光度要高得多，他有很强的掌控权，也对成本和收入直接负责。副总经理需要制定业务战略和整合各部门工作。对比职能主管的部门策略思维，事业部总经理的<strong>业务战略</strong>思维要求他拥有更广泛的视野，综合无数外部因素，考虑本行业甚至全球事务。</p>\n<ul>\n<li>如何实现业务增长</li>\n<li>如何提高盈利水平</li>\n<li>如何增强竞争优势</li>\n</ul>\n<p>这个思维模式的转变是有难度的，也是必须完成的。</p>\n<p>事业部总经理需要处理错综复杂的各种问题，兼顾短期和长期目标。为了了解业务的方方面面，保证视野开阔，他还需要时间学习很多新知识。<strong>时间管理</strong>成为一个难题。事业部总经理不能单单依靠个人能力获得成功，他需要把部门经理整合成高效团队，重视和平衡所有部门，并把具体工作授权给它们。事业部总经理的关注对比副总经理更为强烈，在项目、计划和人员管理上也有很大权限，这也让他的一举一动十分透明。做每一个决定前都要认真考虑。</p>\n<p>自我提升上，可以借助<strong>协同三角形</strong>模型：</p>\n<ul>\n<li>战略方向<ul>\n<li>竞争优势：产品、市场、客户</li>\n</ul>\n</li>\n<li>人员能力<ul>\n<li>经验</li>\n<li>技能</li>\n<li>思维模式</li>\n<li>视角</li>\n</ul>\n</li>\n<li>组织能力<ul>\n<li>组织结构</li>\n<li>工作设计</li>\n<li>工作流程</li>\n<li>权力配置</li>\n<li>人员配置</li>\n<li>组织文化</li>\n</ul>\n</li>\n</ul>\n<p>可以通过考虑一些问题来实现上面的思考方式：</p>\n<ul>\n<li>我们有合适的产品么</li>\n<li>我们的竞争优势能报纸么</li>\n<li>我们的客户细分市场何合适么</li>\n<li>员工是否有创新意识</li>\n<li>我们是否有客户导向的思维模式</li>\n<li>我们的产品研发部门是否有足够授权</li>\n<li>我们的各部门是否可以有效组织</li>\n</ul>\n<h2 id=\"事业部总经理到集团高管\"><a href=\"#事业部总经理到集团高管\" class=\"headerlink\" title=\"事业部总经理到集团高管\"></a>事业部总经理到集团高管</h2><blockquote>\n<p>关键词：集团战略、新机会、选培事业部总经理</p>\n</blockquote>\n<p>晋升到集团高管后，脱离了具体某项业务。要学会<strong>从集团的角度</strong>出发制定战略，辅导培训事业部总经理。具体体现在</p>\n<ul>\n<li>和事业部领导班子保持交流，选拔和培养总经理</li>\n<li>评估各事业部的战略规划，批准它们的业务规划而不是亲自管理</li>\n<li>超越财务结果评价事业部总经理</li>\n<li>监督各业务部门奉行公司的价值观和各项政策</li>\n<li>在必要的时候使用兼并收购的方式补充业务</li>\n</ul>\n<p>集团高管还要能抽出时间发现行业里的潜在机会和新商机。</p>\n<p>一个合格的集团高管需要有下面的标准：</p>\n<ul>\n<li>业绩优异</li>\n<li>出色的战略能力</li>\n<li>有效的人才培养</li>\n<li>对客户满意充满激情</li>\n<li>敏锐的商业头脑</li>\n<li>愿意共享资源</li>\n<li>践行公司价值观</li>\n<li>关心公司成功</li>\n</ul>\n<h2 id=\"从集团高管到首席执行官\"><a href=\"#从集团高管到首席执行官\" class=\"headerlink\" title=\"从集团高管到首席执行官\"></a>从集团高管到首席执行官</h2><blockquote>\n<p>关键词：可持续发展、执行力、组织能力培养、长期思想</p>\n</blockquote>\n<p>首席执行官受到各方的密切关注，不容出错。在领导力模型里面临下面一些挑战：</p>\n<ul>\n<li>平衡长短期利益，实现可持续发展</li>\n<li>设定公司发展的方向，承担风险，深思熟虑<ul>\n<li>公司方向、行业变化、商业模式、竞争格局</li>\n</ul>\n</li>\n<li>培养组织能力，保证人才供给</li>\n<li>确保战略执行到位，对如何盈利有与生俱来的直觉<ul>\n<li>我的表现如何</li>\n<li>我了解公司的情况么</li>\n<li>有向上反馈渠道么</li>\n<li>董事会履行自己授权么</li>\n<li>我的团队高效有活力么</li>\n</ul>\n</li>\n<li>处理好全球化和外部关系</li>\n</ul>\n<p>培养首席执行官没有捷径，一个首席执行官需要经历领导力模型的大多数阶段，他的理想路径包括：</p>\n<ul>\n<li>在核心业务部门的多个职位工作过</li>\n<li>有海外任职经历</li>\n<li>领导业务部门实现突破性增长</li>\n<li>领导新兴业务和振兴衰落业务</li>\n<li>主管过公司的人力资源</li>\n</ul>\n<p>首席执行官的工作目标通常都需要<strong>较长的时间</strong>才能逐步达成，工作理念上也要有所转变。</p>\n<h2 id=\"诊断问题\"><a href=\"#诊断问题\" class=\"headerlink\" title=\"诊断问题\"></a>诊断问题</h2><p>在上面介绍完了整个领导力模型后，这里可以比照着整个模型，定期做整个组织的审视，很容易发现人员错误配置在某一层级的情况。通常因为在快速晋升的过程中，遗漏或仓促跳过了一些发展阶段，做事思路还没有转变。这会引起：</p>\n<ul>\n<li>虽然短期业务看着不错，对长期可持续发展却没有帮助</li>\n<li>越俎代庖和工作效率下降</li>\n<li>对员工职业发展不利</li>\n</ul>\n<p>在评估时，可以通过和个体以及个体的上下级沟通，判断在领导技能、时间管理、工作理念几方面是否和层级相匹配。</p>\n<h2 id=\"改善业绩评估\"><a href=\"#改善业绩评估\" class=\"headerlink\" title=\"改善业绩评估\"></a>改善业绩评估</h2><p>在日常的绩效评估中，可以加入领导模型的能力评估。避免出现职责断裂或者重叠的情况。可以用圆圈标识一个员工的7项绩效内容期望。当达到<strong>全面绩效</strong>时，可以考虑将他人名到一个新的领导岗位。每提升到一个新的领导层级，从会出现绩效缺口。在培训工作持续进行时后，培训对象会逐渐取得全面绩效。这个时候对其进行超常规能力的测试，如果结果表明候选人已做好准备，就可以继续升职。这个测试可以通过让同一层级的领导者组成团队，完成一项高度挑战性任务来实施。</p>\n<h2 id=\"继任计划\"><a href=\"#继任计划\" class=\"headerlink\" title=\"继任计划\"></a>继任计划</h2><p>继任计划是指在各级领导梯队中培养高绩效人员，确保充足的人才储备。整体思路是关注<strong>绩效</strong>和<strong>潜能</strong>，适配公司的实际情况，定期审视领导梯队继任计划。</p>\n<p>潜能上分3档：</p>\n<ul>\n<li><strong>转型潜能</strong>：3-5年甚至更短时间可以从事下一层工作</li>\n<li><strong>成长潜能</strong>：不久可以从事同一层级的更重要工作</li>\n<li><strong>熟练潜能</strong>：可以更好完成当前层级的相同工作</li>\n</ul>\n<p>从潜能和绩效两个维度，可以划分出9类员工。针对不同方格内的员工，着重培养领导力和提升绩效。</p>\n<p>好的继任计划要求适用在所有业务和职能、贴合公司实际、可以公开讨论。</p>\n<h2 id=\"梯队的潜在缺陷\"><a href=\"#梯队的潜在缺陷\" class=\"headerlink\" title=\"梯队的潜在缺陷\"></a>梯队的潜在缺陷</h2><p>领导梯队也有遇到问题的时候，通常可能来自下面这些情况：</p>\n<ul>\n<li>选错人才<ul>\n<li>在上一个层级做出成绩，不代表他的领导技能、时间管理、工作理念都已达到下一层级的要求</li>\n</ul>\n</li>\n<li>让表现不佳者在岗位停留太久<ul>\n<li>判断一名管理者是否还依赖上一级的领导技能、时间管理、工作理念</li>\n<li>观察管理者直接下属的职业发展和业绩</li>\n</ul>\n</li>\n<li>不善于倾听反馈<ul>\n<li>开阔心胸</li>\n<li>选择性听取</li>\n</ul>\n</li>\n<li>不善于定义工作<ul>\n<li>明确责任边界</li>\n<li>对齐责任边界</li>\n</ul>\n</li>\n</ul>\n<p>一个组织能需要有一个领导力框架，它能给绩效评估标准，提供更多的讨论问题的角度。通常一个团队内缺乏坦诚也是缺陷即将出现的危险信号。</p>\n<h2 id=\"职能主管发展路线\"><a href=\"#职能主管发展路线\" class=\"headerlink\" title=\"职能主管发展路线\"></a>职能主管发展路线</h2><p>除了上面提到的领导力模型之外，还有职能方向的支线，即从集团职能主管到企业职能主管。集团职能主管和事业部总经理很像，但又不太一样：</p>\n<ul>\n<li>事业部总经理将智能战略纳入到整体业务计划中，但职能直观则将每一个事业部的职能战略纳入到集团整体的职能战略中</li>\n<li>两者都要有商业思维，职能主管也要从“我们能这么做么”转变到“我们这样做能赚钱么”</li>\n<li>职能主管通常同时向集团职能主管和事业部总经理负责，这需要他能灵活处理各种人群和利益关系，并且知道怎么妥协</li>\n<li>集团职能主管主要为集团高管提供咨询意见而不是产品和其他内容</li>\n</ul>\n<p>作为集团职能主管，要避免出现下面的情况：</p>\n<ul>\n<li>给所有人承诺，却从不兑现<ul>\n<li>集团职能主管要能够分解复杂关系，划清责任边界，获知业务优先级、自己优先级，最后做出果断的决定</li>\n</ul>\n</li>\n<li>过度干涉职能部门经历的工作</li>\n<li>整天围着集团高管转</li>\n</ul>\n<p>企业职能主管一般指CFO、CTO、COO、总法律顾问这些。他们的目的是将自己的职能和公司联系在一起，因此他们必须设定职能发展方向、学会服务整个公司而不仅是自己的职能、了解公司外部环境。要能满足下面一些要求：</p>\n<ul>\n<li>商业竞争中如何发挥职能的支持获得竞争优势</li>\n<li>了解所在职能在业界的发展状况</li>\n<li>向集团高管提供所在职能领域或一般性领域的发展机会</li>\n</ul>\n<p>下面是一些对于企业职能主管的发展建议：</p>\n<ul>\n<li>尽早获取专家对职能部门的建议</li>\n<li>和CEO和各层级关键领导对齐你的目标和计划</li>\n<li>定期和各层级部门交流</li>\n<li>学会管理时间</li>\n</ul>\n<h2 id=\"教练辅导\"><a href=\"#教练辅导\" class=\"headerlink\" title=\"教练辅导\"></a>教练辅导</h2><p>教练辅导即用一种富有激励的方式，将上面的领导力模型指引给员工或是管理者。可以通过一些问题确定此人的领导能力、时间管理和工作理念：</p>\n<ul>\n<li>谈谈你的职业发展<ul>\n<li>经历的每一个职务</li>\n<li>工作具体内容</li>\n<li>工作成就</li>\n<li>重大挑战</li>\n</ul>\n</li>\n<li>现在职位的工作<ul>\n<li>面临的问题、挑战</li>\n<li>取得的成就</li>\n</ul>\n</li>\n<li>工作日程</li>\n<li>主要依靠的技能</li>\n<li>工作信念是什么</li>\n<li>职业抱负是什么</li>\n</ul>\n<p>有些时候，自己进行教练辅导会比聘用不专业的教练要更好。</p>\n<h2 id=\"领导力模型惠及全员\"><a href=\"#领导力模型惠及全员\" class=\"headerlink\" title=\"领导力模型惠及全员\"></a>领导力模型惠及全员</h2><p>略</p>\n<p><em>–END–</em></p>\n",
            "tags": [
                "读书笔记",
                "管理学",
                "领导力",
                "梯队"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/10/22/tour-to-jinan-and-qingdao/",
            "url": "http://shenlvmeng.github.com/blog/2021/10/22/tour-to-jinan-and-qingdao/",
            "title": "济南、青岛之行 —— 泉海之约",
            "date_published": "2021-10-22T04:33:39.000Z",
            "content_html": "<blockquote>\n<p>流水账向絮叨文风，以纪念和嘉雯的第一次旅行</p>\n</blockquote>\n<h2 id=\"序：出发！\"><a href=\"#序：出发！\" class=\"headerlink\" title=\"序：出发！\"></a>序：出发！</h2><p>国庆节的出游通常都要提前一个多月计划，不过这次出游计划却比较仓促。由于某人的身体原因，我们在节前数天才定下这趟我期待了好久的出游。这一方面倒是让我在选择目的地上省了心，有很多之前计划去的地方，要么是去不了，要么是回不来。最终剩下广州、济南+青岛、济南+天津几个选项。报给对象看后，确定了这次山东之行。</p>\n<p>既然定了地点，按我们的风格，三下五除二分工搞定了日程安排和机票住宿。对象继续赶工离谱需求，我回家当表哥伴郎。</p>\n<h2 id=\"Day-1：小吃\"><a href=\"#Day-1：小吃\" class=\"headerlink\" title=\"Day 1：小吃\"></a>Day 1：小吃</h2><blockquote>\n<p>宽厚里、泉城广场</p>\n</blockquote>\n<p>在表哥婚礼的第二天，我早8点从家里出发抵达遥墙机场，对象下午从上海出发抵达济南西站。本以为我会晚很多，没想到机场大巴一路绿灯甚是给力，我们干脆约在济南站见面。大巴到济南站时已近黄昏，“易立竞老师”还给我贴心地留了个麦麦脆汁鸡，啊这就是爱情。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWQ9f.jpg\" alt=\"济南站\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWnAI.jpg\" alt=\"易立竞老师\"></p>\n<p>废话不多说，我们打车回酒店修整后，出发前往宽厚里。这是济南远近闻名的小吃步行街。我们一路骑车过来，正是晚上的黄金时间，路上交通拥堵异常（后来发现白天也拥堵）。小吃街也是人声鼎沸，摩肩接踵，每个看起来像是网红店的都排着老长的队伍。我俩大致逛了逛，小吃也没太多新意，奶茶店里，沪上阿姨、蜜雪冰城、冰雪时代几家尤其多。根据大众点评的推荐，我们排了个奶奶的美食，脆皮肠还不错。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWuNt.jpg\" alt=\"宽厚里\"></p>\n<p>也许是垃圾桶摆放不合理，街头的路面很脏，观感比较差。我们最终在一家鲁菜馆解决了晚饭。因为去得比较晚，经典的鲤鱼和大肠已经没了。剩下的菜里，鱼和虾都是酸甜口的，似乎鲁菜的口味都比较浓郁。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWK4P.jpg\" alt=\"晚饭掠影\"></p>\n<p>饭后已近10点，我们从泉城广场打道回府，夜里的广场端详不出明细，都是踏上归途的人。和对象在鸟屋旁一番神来般的交流，观赏鸽子的同时，不巧不远处有夫妻吵架。没待多久，我俩也知趣溜走。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWeHA.jpg\" alt=\"鸟屋\"></p>\n<h2 id=\"Day-2：公园\"><a href=\"#Day-2：公园\" class=\"headerlink\" title=\"Day 2：公园\"></a>Day 2：公园</h2><blockquote>\n<p>大明湖、曲水亭街、芙蓉街、解放阁、黑虎泉公园、趵突泉</p>\n</blockquote>\n<p>尽管地铁没那么方便，但是济南的核心景点距离都很近，可以骑车方便来往，公园基本上都无需门票，相当良心还是要夸一下的。由于距离酒店较近，我们从大明湖开始逛，这里更像一个大型的市民公园，无需门票。好在公园也够大，人流也就稀释得没那么密集，在国庆节期间体验还不错。湖面开阔，有零星游船。四周矗立着不少高楼，应和着绿树青天，有陆家嘴、曼哈顿公园那味儿了。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWl38.jpg\" alt=\"大明湖-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yW1gS.jpg\" alt=\"大明湖-2\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yW3jg.jpg\" alt=\"大明湖-3\"></p>\n<p>只可惜天色多云，要不风景只会更棒。兜圈下来路遇超然楼，考虑门票价格后，弃之继续前行。最后从南门出来，前往南边的百花洲街区。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWJBj.jpg\" alt=\"大明湖碑\"></p>\n<p>从南门正对着的曲水亭街直走是大路，我们随便抄了条小道，迷迷糊糊摸到了临近的芙蓉街，很类似宽厚里，北京的南锣鼓巷，街边的美食和吆喝声让人头攒动的接到更加热闹。抵抗不住诱惑，我俩试了个豆腐和滕州菜煎饼，嗯……果然没太出彩。不过，在这么拥挤的环境下，路面卫生居然出奇得还行。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWGuQ.jpg\" alt=\"小巷\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWYHs.jpg\" alt=\"豆腐\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWNEn.jpg\" alt=\"滕州菜煎饼\"></p>\n<p>从芙蓉街绕回曲水亭街后，我俩继续骑车，抄了一些小道后，我们到达临近宽厚里的解放阁。这里也无需门票，拾阶而上，在阁顶能俯瞰内城东南角附近。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWUNq.jpg\" alt=\"小巷-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWwCV.jpg\" alt=\"解放阁-1\"></p>\n<p>转瞬间，狂风大作，暴雨倾盆。幸好我俩带了伞。雨后的风光似乎被蒙上了一层灰，很是朦胧。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWa40.jpg\" alt=\"解放阁-2\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yW03T.jpg\" alt=\"解放阁-3\"></p>\n<p>不远处，居然有一个露天泳池，在雨中似乎并没有受到积极性的打击。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWBgU.jpg\" alt=\"露天泳池\"></p>\n<p>解放阁下便是黑虎泉公园，据说泉水来自地下水，可以直接饮用。同样是不要门票，这里人也不少。我们来到才发现，这里其实不只黑虎泉一个泉，有不少泉眼，涌出的水注入到城河。这水清冽无比，以至于里面连小鱼都没有，若不是有气泡不间断珍珠般涌出，水面似乎像静止了一样。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWDvF.jpg\" alt=\"白石泉\"></p>\n<p>公园内水量最大当然也是最出名的莫过于黑虎泉。对于我俩这种从未见过泉水的人来说，可谓是大开眼界叹为观止。原来泉水还能涌出这么大的量，地下水这么多的么。泉边专门设有接水的地方，我尝了点，比矿泉水淡一些，又比白开水多一点味道。这里吸引了不少游客驻足。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWyDJ.jpg\" alt=\"黑虎泉\"></p>\n<p>当然了，这里的两个题字也是妙极。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yW2U1.jpg\" alt=\"黑虎泉题字-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWgER.jpg\" alt=\"黑虎泉题字-2\"></p>\n<p>后续泉眼大同小异，人流不多，这里不再赘述。从公园出来正好又回到昨日的泉城广场，我俩又是一路骑车来到内城西南角的趵突泉，路上得以看到白天的泉城广场的模样。趵突泉需要40元门票，可以美团网上订票，可这并没有阻挡国庆节热情满满的游客。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yW6b9.jpg\" alt=\"趵突泉公园\"></p>\n<p>趵突泉公园并不止有趵突泉这一头牌，它也是一组泉眼。这一点和黑虎泉公园差不多。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWR4x.jpg\" alt=\"漱玉泉\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWfC6.jpg\" alt=\"卧牛泉\"></p>\n<p>经过黑虎泉的洗礼，在见到趵突泉之前，我很好奇它是什么模样，可以如此出名夺目。不过见到后，不禁感慨还是自己年轻了。三眼泉水，左右两股更大，中间一股略小，但整体水量充沛。在平静的湖面上激起湍流，水质清澈见底，真乃奇观。直令人挪不开脚步。我俩驻足了有近半个小时。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yWh8K.jpg\" alt=\"趵突泉\"></p>\n<p>泉水涌出的水汇聚后，流入到护城河中。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yW4gO.jpg\" alt=\"泉水\"></p>\n<p>天色已晚，我俩骑车去了一家潮汕砂锅粥店，结束了一天密集的美景洗礼。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/21/5yW5vD.jpg\" alt=\"干炒牛河\"></p>\n<h2 id=\"Day-3：⛰和🍺\"><a href=\"#Day-3：⛰和🍺\" class=\"headerlink\" title=\"Day 3：⛰和🍺\"></a>Day 3：⛰和🍺</h2><blockquote>\n<p>千佛山、老谢野馄饨、小褚烧烤</p>\n</blockquote>\n<p>因为时间有限，这一天的旅程里，我们没有安排较远的山东博物馆和美术馆。决定在城南往事吃了午饭后去千佛山看看。午饭是正宗的鲁菜，我俩根据大众点评的推荐，里面下面这些：</p>\n<ul>\n<li>糖醋鲤鱼</li>\n<li>九转大肠</li>\n<li>油旋</li>\n<li>醋熘腰花</li>\n<li>水煎包</li>\n<li>老酸奶</li>\n</ul>\n<p>基本没有踩雷，口味都较浓郁，适合稍重口一点的人吃。鲤鱼是这家店的招牌菜，店员还会帮忙拆鱼。油旋很香，不过分量也不少。酸奶里不知放了什么，口感十分特别，介于酸奶和老酸奶之间，很爽口。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yoxx0.jpg\" alt=\"城南往事-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yov2q.jpg\" alt=\"城南往事-2\"></p>\n<p>解决午饭后，自然又是骑行去千佛山。爬山的前半程较缓，让我对它的高度产生了一些误会。根据我的观察，山应该得名于里诸多的佛像。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yojGn.jpg\" alt=\"千佛山-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTSMV.jpg\" alt=\"千佛山-2\"></p>\n<p>在历山院的半山处，可以俯瞰城区景观。经过一个名不副实的历山飞瀑后，再爬一段陡路就可以来到山顶制高点，这里风势略大，但是视野极好。不仅能尽览城区，起伏的丘陵也是一览无余。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yoXPs.jpg\" alt=\"历山院\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTprT.jpg\" alt=\"俯瞰-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yT9qU.jpg\" alt=\"俯瞰-2\"></p>\n<p>天色不妙，我俩没在山顶待太久便下山打道回府，收拾行李准备前往青岛。在济南站，还吃到了满大街到处都有的超意兴，自助选餐，找到了大学打饭的感觉。顺便弥补了之前没有吃到把子肉的遗憾，不过，吃到第一口便发现，“不吃很遗憾，吃了更遗憾”。很油腻，我和对象俩人吃了一口不到。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTPZF.jpg\" alt=\"超意兴\"></p>\n<p>经过2个小时的车程，我们在青岛站下车。此时已近10点，我俩直接坐地铁来到江西路旁的酒店修整。稍微调整过后，还是决定出门吃个夜宵。既然是夜宵，又是在青岛。那当然是烧烤+啤酒没跑了。先暂时把体重的事情放一边。在大众点评一番寻找，我做了这个旅程最后悔的决定，去老谢野馄饨吃烧烤。这家店在大众点评上颇为火爆，他家的野馄饨据说美味且实惠。从下车开始，看到店门口茫茫多的人，不妙的兆头已经萌发。但“来都来了”，我俩还是硬着头皮尝试进店点餐。店内更是混乱，柱子上贴着需要自己寻找座位的字样，顾客非常多。坐下来吃的是少数，更多是坐下来等上串的，还要不少站在桌边等吃完的。画面甚是壮观。由于服务效率太低，管理也不好，桌面和地面上残骸不少。再加上有不知如何点餐的新人（就譬如我们），场面一片混乱。我抬手看了下表，难以置信这是晚上11点。</p>\n<p>店里馄饨需要点，烤串需要自己挑选然后交给前台烤，啤酒也要自己打。店员很冷酷地告诉我们，目前烤串要等1个半小时，还好刚刚的糟糕情况给了我俩心理准备。一顿摸索，我俩来到了地下一层，这里稍微好点（可能因为有人不知如何下来），只是有不散的烟味。我们扫了码，和人拼桌，放弃了烤串，准备吃个馄饨就走。大概40分钟后，在主动抱怨下，终于吃上珍贵的12元馄饨。此时和我们拼桌，比我们还晚来的情侣已经吃完走人。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTia4.jpg\" alt=\"老谢野馄饨\"></p>\n<p>馄饨汤的胡椒味很重，皮和馅儿很棒，很对我口味。不过对比漫长的等待和糟糕的服务质量，还是不值的。边吃，我们边寻找备选吃点喝点。结果发现巧合的是，这里距啤酒博物馆很近。最终在大多数已经关门的烤串店里，找到幸存的小褚烧烤。这家店离青岛啤酒厂的大门很近。我们要了一扎原浆。原浆未经过多的防腐手段，保质期比较短，因此也保留了更多发酵的菌群，朴实和清甜的口感未经修饰，是我喝过最棒的啤酒了。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTFIJ.jpg\" alt=\"青岛原浆\"></p>\n<p>兴许是老谢的对比，兴许是真饿了，烤串也比我在北京吃的更棒。也算是一天的慰藉。酒足饭饱已经是第二天，幸在很好打车，回到酒店，对象倒头就睡。我洗罢衣服也睡下。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTAi9.jpg\" alt=\"小褚烤串\"></p>\n<h2 id=\"Day-4：海和丘陵\"><a href=\"#Day-4：海和丘陵\" class=\"headerlink\" title=\"Day 4：海和丘陵\"></a>Day 4：海和丘陵</h2><blockquote>\n<p>开海海鲜、太平角、海水浴场、八大关、信号山、大学路鱼山路、小鱼山、五四广场、本家韩国菜</p>\n</blockquote>\n<p>依旧是多云转阴的一天，我们甚至起得更晚了。出门时已近中午，我们干脆直奔五四广场的万象城。好在从江西路坐地铁去五四广场还比较方便。当初看酒店的时候，青岛因为旅游的属性，价格整体就要比济南高出一截。五四广场附近的就更离谱了。当然要是你财力雄厚，当然还是住在五四广场附近更加方便。</p>\n<p>到达万象城的时候正是饭点，好在这里不像北京吃饭那么卷，大国庆的排队的人也还能接受。我们在溜冰场和附近的小吃城逛了下就到了。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTVR1.jpg\" alt=\"万象城\"></p>\n<p>来青岛自然要吃海鲜，我和对象错过了最好的季节，但也还是有的吃的。我俩事先做了下功课，根据我们的喜好要了：</p>\n<ul>\n<li>辣炒小鲍鱼</li>\n<li>辣炒蛤蜊</li>\n<li>海鲜水饺全家福</li>\n<li>锅烧碟鱼头</li>\n</ul>\n<p>这几个算是这家的招牌了，剩下还有海参拌饭，捶山茄啥的就无福消享了。不愧是当地人推荐的店，除了鱼头，其他几个我觉得都很棒，鲍鱼很入味，蛤蜊的性价比简直超神。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTEGR.jpg\" alt=\"辣炒小鲍鱼\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTmM6.jpg\" alt=\"辣炒蛤蜊\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTZxx.jpg\" alt=\"水饺全家福\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTuqO.jpg\" alt=\"锅烧碟鱼头\"></p>\n<p>饭后坐两站地铁来到太平角，就可以沿着海岸线感受青岛的魅力了。沿海的栈道非常长，能够走好几天。海景自然也是赏心悦目，只可惜天色一片苍白。若是暑假过来，肯定是另一番美景。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTnsK.jpg\" alt=\"太平角\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTMZD.jpg\" alt=\"海景\"></p>\n<p>在和对象切磋过（基本是碾压）打水漂技巧后，我们顺路看了下附近八大关街区，街区较小，但是恰似青岛的缩影，上下坡不断，充分展示出丘陵的地形。这可能也是青岛没有共享单车的一大原因吧（电单车也没有）。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yT3id.jpg\" alt=\"八大关-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTQde.jpg\" alt=\"八大关-2\"></p>\n<p>回到第二海水浴场的路上，偶遇的喵和花挽救了对八大关的失望。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTlIH.jpg\" alt=\"吸猫\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yT8JA.jpg\" alt=\"花-1\"></p>\n<p>来海边除了打水漂，免不了还有戏水环节。对象身先士卒冲了下去。11月的海水，似乎也并没有那么刺骨。我还趁机尝了下海水。啊呸，果然是咸的。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTGRI.jpg\" alt=\"戏水-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTJzt.jpg\" alt=\"戏水-2\"></p>\n<p>时间有限，我们继续向第一海水浴场和信号山走去。一路可以轻易看到海天一线的景观，实在是悦目极了。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTtQP.jpg\" alt=\"海景-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTNsf.jpg\" alt=\"海景-2\"></p>\n<p>目前不是夏天，我们简单穿过海水浴场，开始了爬坡的旅程。在青岛旅游似乎总少不了上上下下。去信号山的一路也是如此，还很神奇的路遇大学路鱼山路的网红墙，不过除了俩路牌，我实在想不到可以网红的点。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTUL8.jpg\" alt=\"鱼山路\"></p>\n<p>信号山不大，也无需门票。山顶可以俯瞰红瓦黄墙，若再有蓝天晚霞那就太美了，很值得一来。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTdeS.jpg\" alt=\"信号山-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yTwdg.jpg\" alt=\"信号山-2\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/5yT0oQ.jpg\" alt=\"信号山-3\"></p>\n<p>没过多久，天色变暗，气温下来。我们放弃了后续安排，下了山，计划坐地铁去五四广场。路上还看见了神奇的红色光环，喝到了中药味的崂山可乐。在冰冻加持下，似乎也没有那么暗黑。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/561JyQ.jpg\" alt=\"光环\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/561Uwn.jpg\" alt=\"崂山可乐\"></p>\n<p>晚饭依旧是在万象城解决的。吃的韩餐，青岛的韩国人挺多，韩式料理比较正宗。这个本家韩国料理也是当地朋友推荐的。石锅拌饭和冷面都还不错。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/561aoq.jpg\" alt=\"本家\"></p>\n<p>饭后，五四广场是绝佳选择，这里是欣赏灯光秀最佳地点，诸多高楼的灯光拼凑出歌唱祖国的图样，红得耀眼。广场上，小商贩和城管玩着捉迷藏。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/561YLj.jpg\" alt=\"五四广场\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/22/561Nes.jpg\" alt=\"夜景-1\"></p>\n<p><img src=\"https://i.loli.net/2021/10/22/K4vaoQyPkIhRJn3.jpg\" alt=\"夜景-2\"></p>\n<p>五四广场西边还有个音乐广场，里面有些或好或惨不忍睹的素人演唱。晚10点，我俩来到网吧结束了忙碌的一天。战斗很愉悦，她也是。</p>\n<h2 id=\"Day-5：海其二\"><a href=\"#Day-5：海其二\" class=\"headerlink\" title=\"Day 5：海其二\"></a>Day 5：海其二</h2><blockquote>\n<p>鲁迅公园、琴屿路、小青岛、栈桥、台东步行街、小褚烧烤</p>\n</blockquote>\n<p>前一日行程受阻外加赖床，我们第二天果断放弃崂山，继续海边深度游。大概又是12点出门，我们这次的目的地是好美味馄饨店，尝试了这里的皮蛋、蛋黄馅儿馄饨以及微波烤串，还有某人从未吃过的火烧。馄饨和串的形式挺有意思，味道的话差强人意。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/JwojXgHZlPFfOzT.jpg\" alt=\"好美味馄饨\"></p>\n<p>青岛城市里没有共享单车，我俩只能耐心地走到地铁站，再做地铁到人民会堂。在鲁迅公园和琴屿路的交接处再次与海重逢。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/vWlUjdDBGCtZbR4.jpg\" alt=\"琴屿路\"></p>\n<p>涨潮速度比想象中快，我俩险些被困在礁石上，对象还湿了鞋。附近的店里，洞洞鞋倒是不少，我挑了双明黄色的，还有小熊(๑¯㉨¯๑)logo，挺好看。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/JTqh3CAinPKfoWL.jpg\" alt=\"涨潮\"></p>\n<p><img src=\"https://i.loli.net/2021/10/22/KU1kuvaMGeYn3x6.jpg\" alt=\"礁石\"></p>\n<p>天空阴云密布，海面也不平静。远处能看到搭载客人的游轮。琴屿路上，若是晴空万里，可能会更加好点看。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/2zJXQTIkUPH47sd.jpg\" alt=\"游轮\"></p>\n<p>沿着琴屿路走到尽头，可以到达小青岛景区，小青岛的确是个岛，的确很小，也的确很绿。就是下图的左侧部分。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/9Yax3ZjzA7h2suV.jpg\" alt=\"小青岛远眺\"></p>\n<p>我们上岛时，天色已经不太作美。远远地，能看到我们的下个目的地——栈桥。同样的，阴天稍降低了些风景的美感。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/uPZj8JimdOUXVBS.jpg\" alt=\"小青岛-1\"></p>\n<p><img src=\"https://i.loli.net/2021/10/22/kr8YRzGJvQjU39g.jpg\" alt=\"小青岛-2\"></p>\n<p>还未到栈桥雨就下了起来，因为下雨栈桥上人不算太多。远远地，能回望到小青岛。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/MvTLEFWPmwr1sRS.jpg\" alt=\"栈桥\"></p>\n<p>海边的旅程到栈桥就基本到了尾声，我们在M记稍作休整，乘地铁前往奥帆中心。从这里可以获得和五四广场不一样的观赏夜景的视角。高楼灯光秀似乎也更对齐了一点。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/FL1TDJQUpl3RWSO.jpg\" alt=\"奥帆中心-1\"></p>\n<p><img src=\"https://i.loli.net/2021/10/22/5913zo6LMd7nxES.jpg\" alt=\"奥帆中心-2\"></p>\n<p>从奥帆中心离开，我们慕名前往台东步行街。也有幸目睹了十分下沉的万达广场，找到了本世纪初的感觉。这块步行街的氛围和价格都很亲民，就像回到了老家一样。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/BiYxcr67KmQNPFA.jpg\" alt=\"台东步行街\"></p>\n<p>今日的旅程又是以小褚烧烤作为结尾，虽没了第一天那么惊艳，但老板认出了我们是前天来过的，给了我们意外的优惠，还是很惊喜的。啤酒博物馆门外的啤酒街霓虹闪烁，也许这才有资格叫做灯红酒绿吧。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/AYZB9wWXuLS21Qq.jpg\" alt=\"啤酒街\"></p>\n<h2 id=\"Day-6：尾声\"><a href=\"#Day-6：尾声\" class=\"headerlink\" title=\"Day 6：尾声\"></a>Day 6：尾声</h2><blockquote>\n<p>失望的黄焖鸡</p>\n</blockquote>\n<p>由于距离和赖床的双重作用，我们放弃了啤酒博物馆的日程，用黄焖鸡来为第一次一起旅行画上句号。最终在大幅降温前一同离开了青岛。</p>\n<p><img src=\"https://i.loli.net/2021/10/22/ZwePkDrnpNWj2xh.jpg\" alt=\"自拍\"></p>\n<p>之前听人说，“情侣两人一同长途旅行一次，如果不分手，那么他们一定是真爱”。因为在计划阶段的行事风格，以及旅行途中的生活观念、饮食习惯、兴趣爱好等都是未来同居生活的小型预演，可以直接看出两个人的磨合程度。回头看，一起旅行的这些天，我们克服了一些困难，放弃了一些计划，也遇到了一些惊喜。尽管之前，我俩号称合体的晴天娃娃，这趟旅程却都是阴天和多云。不过问题不大，至少心情是漂亮的。相信这会是一个不错的开始，期待下次一同骑车长途旅行。</p>\n",
            "tags": [
                "攻略",
                "随笔",
                "美食",
                "青岛",
                "济南",
                "山东"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/10/20/taihu-lark-riding/",
            "url": "http://shenlvmeng.github.com/blog/2021/10/20/taihu-lark-riding/",
            "title": "环太湖骑记",
            "date_published": "2021-10-20T14:30:30.000Z",
            "content_html": "<blockquote>\n<p>经历就会有惊喜</p>\n</blockquote>\n<h2 id=\"序：启程\"><a href=\"#序：启程\" class=\"headerlink\" title=\"序：启程\"></a>序：启程</h2><p>自上次<a href=\"https://shenlvmeng.github.io/blog/2020/10/06/tour-to-qinghai-lake/\">青海湖长途骑行</a>，已经过去1年。这1年里发生了许多计划之外的事情，我优化了旧的喜德盛山地，拥有了新的闪电公路车，追求更佳的骑行体验。我减慢了更博文和读新书的频率，暂停了拉琴训练，腾出时间去追求人生的下一阶段，最后有惊无险最后遇到吕嘉雯，就像是老天对我一直以来坦诚相待的回报。扯远了，说回来，和<a href=\"https://feichashao.com/travels/\">基友</a>约定的一年一次长途骑行还是继续。我们在7、8月份的骑行中就约定好大致的骑行目的地（江南沿海）和时间（中秋节）。青海湖骑行之后，我们患上了补给不足恐惧症，基友最终选定太湖，也是考虑到环湖下来都是大城市带来的优越体验。事后证明，这种安排让这次骑行带上了更多旅行的感觉。</p>\n<h2 id=\"Day-1-北京-gt-苏州\"><a href=\"#Day-1-北京-gt-苏州\" class=\"headerlink\" title=\"Day 1 北京 -&gt; 苏州\"></a>Day 1 北京 -&gt; 苏州</h2><p>这次出发的时间碰巧赶上双减政策，让骑行得以宽裕地进行。只可惜对象要回乡下老家没能参与。我们选在中秋前最后一个工作日的晚上，做卧铺去苏州。</p>\n<p>火车一大早到达苏州，我们住的酒店在<strong>观前街</strong>地区，算是苏州一个传统的购物步行街。7点多的步行街还没有什么人烟。所谓观前街，在步行街的核心地带有一个玄妙观。我们放下行李，在观旁的M记吃了顿早饭，作为旅途的第一顿餐食。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEa8K.jpg\" alt=\"观旁边的M记\"></p>\n<p>从观前街向东走过一个街区，可以到达<strong>平江路</strong>。在没那么商业化的角落，还是能感受到江南水乡的秀气。小桥流水，白墙黛瓦，一叶扁舟，绿柳蓊郁。我们在街巷中随意穿梭，故意做两只无头苍蝇。还无意中捕捉到好几家之前在小红书上看到的网红店。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEBKe.jpg\" alt=\"平江路-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEwvD.jpg\" alt=\"咖啡店\"></p>\n<p>我们来的时间也很巧，上午的时候路上人还不多，气温也很适宜。可以很舒服地慢慢散步扯淡。不得不说，小河的水利治理还挺不错，很少见到垃圾，水质也挺不错。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEdgO.jpg\" alt=\"平江路-2\"></p>\n<p>逛完城墙博物馆，我们兜了一圈又回到观前街，开启游客打卡模式，尝试了秃油黄面和三虾面，还有特色绿豆汤。面的口感还不错，很契合我喜欢吃细面的偏好。面口味偏淡，一碗100+，还不错但没到惊艳的地步。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEUC6.jpg\" alt=\"秃油黄面\"></p>\n<p>绿豆汤着实让人耳目一新，新颖的薄荷味配合冰水的温度让人感觉像是在喝漱口水。整体味道就是糖水口。基友没能坚持喝完，不怪他。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEDDH.jpg\" alt=\"绿豆汤\"></p>\n<p>在酒店稍作休整，我们继续启程，前往金鸡湖旁的国际博览园区。出地铁时，刚好赶上看夕阳的最佳时机。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BErbd.jpg\" alt=\"落日\"></p>\n<p>入夜后，这边商业区的风景要更为迷人。在诚品书店的屋顶，已近中秋的月亮分外亮眼。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEyVA.jpg\" alt=\"诚品屋顶的月亮\"></p>\n<p>当然，之前就有所耳闻的<strong>东方之门</strong>就更要打卡了，站在裤裆底下拍照的感觉还挺好玩。时间有限，<strong>山塘街</strong>我们最终没有去，算是小小的一个遗憾。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEc5t.jpg\" alt=\"东方之门\"></p>\n<p>回到酒店，时间大概是9点多，基友回了房间。我去附近一个网鱼网咖坐了会儿，居然发现以前还剩了30多元没用完，居然还有意外之财，真棒！</p>\n<h2 id=\"Day-2-苏州-gt-无锡\"><a href=\"#Day-2-苏州-gt-无锡\" class=\"headerlink\" title=\"Day 2 苏州 -&gt; 无锡\"></a>Day 2 苏州 -&gt; 无锡</h2><blockquote>\n<p>晒伤程度：0%</p>\n</blockquote>\n<p>骑行的起点从湖边的一个国际青年旅社开始，一天100元，只有一种山地车可以选择，不提供驼包和车锁。可以肉眼看出的不专业。奈何太湖这边没找到其他像样的租车行，且湖边本来就离市区较远。我俩也没挑剔太多。付好500元押金，我们从环太湖大道出发。</p>\n<p>天色不是很好，初到湖边还是比较有新鲜感的，微风吹过，吹散了骑行身上的燥热，还挺舒服。没想到，这也是这几天唯一逃过晒伤的一次。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BE6UI.jpg\" alt=\"环太湖大道-1\"></p>\n<p>和青海湖边上的环湖东路不同，环太湖大道名不虚传，果然是十分贴近湖面，有些路段甚至直接修在湖面上。搭配着青山小河，景色妙绝。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BE2PP.jpg\" alt=\"环太湖大道-2\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BER8f.jpg\" alt=\"环太湖大道-3\"></p>\n<p>简单在太湖湿地公园旁的农家乐吃过午饭，继续出发前往太湖大道，一路依旧在湖边前进。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEfxS.jpg\" alt=\"太湖-1\"></p>\n<p>快骑到无锡边界时，还能看到头顶的飞机。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEW28.jpg\" alt=\"无锡的飞机\"></p>\n<p>经过一座跨河的桥，我们进入无锡市。远离了太湖，但是再次感受到令人安心的城市气息。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BE5rQ.jpg\" alt=\"市界\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BE4Kg.jpg\" alt=\"夕阳路\"></p>\n<p>最终沿着具区路骑行20公里，我们歇脚在<strong>江南大学</strong>旁的宜必思。简单地更换衣物后，正是晚饭时间，我们坐地铁进入城区，化身半日游的游客。在无夕小笼包店里简单地恰了心心念念的蟹粉小笼包和传说中的刀鱼馄饨后，我们来到小红书告诉我们最繁华的<strong>南长街</strong>和<strong>南禅寺</strong>。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEIbj.jpg\" alt=\"蟹粉小笼包 &amp; 刀鱼馄饨\"></p>\n<p>类似的河，类似的巷，也许是因为门店的格调问题，或是路面修缮太过人工，我总觉得没有平江路来的那么自然和和谐。宽阔笔直的街道和河流，让它和之前在丽江大研古镇的旅行体验也有差距。当然热闹还是热闹的，也能勉强感受到江南小城的意味。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BETVs.jpg\" alt=\"南长街-1\"></p>\n<p>当然，中秋的月亮还是很不错的。在南禅寺大概逛了逛，我们打道回府，无锡的地铁线路相对比较简单，可以乘坐1号线直达。和苏州地铁一样，也许是人口不多，在中秋佳节的黄金时间，地铁里也能轻松找到位置，乘坐体验极佳，推荐地铁出行。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BE7an.jpg\" alt=\"南长街-3\"></p>\n<p>回到酒店，烘干好的衣服也好了。对比去年的青海湖骑行，体验好了太多。我们简单收拾下，便带着疲惫睡下。</p>\n<h2 id=\"Day-3-无锡-gt-宜兴\"><a href=\"#Day-3-无锡-gt-宜兴\" class=\"headerlink\" title=\"Day 3 无锡 -&gt; 宜兴\"></a>Day 3 无锡 -&gt; 宜兴</h2><blockquote>\n<p>晒伤程度：80%</p>\n</blockquote>\n<p>第二日天气好了太多，令人心情愉悦，再加上前日的阴天，让我忘记了关键的防晒。为悲剧晒伤埋下了伏笔。我们从江南大学旁的缘溪道出发，沿着高浪西路上山水东路便开始了晒足一天的旅程。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEH5q.jpg\" alt=\"江南大学-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEqP0.jpg\" alt=\"江南大学-2\"></p>\n<p>路线擦过无锡城区西南边缘，一路湖水树林，路况不错，风景更棒，尤其在<strong>鼋头渚</strong>附近。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEO2T.jpg\" alt=\"鼋头渚\"></p>\n<p>在环湖路锦园路交叉口，沿锦园路骑行可以获得更好的骑行风景。贴着湖边，有一个华东疗养院，附近的有不少钓鱼的人，风景很棒。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BELGV.jpg\" alt=\"锦园路-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEXxU.jpg\" alt=\"锦园路-2\"></p>\n<p>回到环太湖大道，骑一小段可以看到十八湾地质公园，省道路况甚好，当然阳光也甚好，骑过十八湾公园，爬一个长坡来到拐角，有一个缓下坡，边放坡边欣赏湖景的体验太棒了！迎面的清风，路面弯曲的美感，湖面的一览无余，踩踏的双腿似乎都已感受到慰藉不再疲惫。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEvMF.jpg\" alt=\"放坡-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BExr4.jpg\" alt=\"放坡-2\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BEzqJ.jpg\" alt=\"放坡-3\"></p>\n<p>离开省道进入常州市后，可以选择从雪雅线或者雪马路回到环湖路上，一路穿村而过，最后再太滆村回到湖边。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BV9aR.jpg\" alt=\"雪马路\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BVpZ9.jpg\" alt=\"太滆村\"></p>\n<p>晴日下的波光粼粼让太湖看起来更有生气了一点。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BVCI1.jpg\" alt=\"波光粼粼的太湖\"></p>\n<p>回到渎边线后，一路平坦笔直，日光毒辣，工业区属实没什么风景好看，一路狂飙后，在宜浦路交叉口朝宜兴城区逼近。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BM5EF.jpg\" alt=\"渎边线\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BViPx.jpg\" alt=\"宜浦路\"></p>\n<p>经过范蠡大道交叉口，终于有种进入城区的熟悉感，没想到这是痛苦体验的开始，最后进城的几公里，地势上上下下，爬的坡比过往都还多。甚至于都没骑过平路。每当我以为，爬坡到此为止后。放坡结束又要开始下个煎熬。甚至于还有一个在上坡中间的红绿灯，把我虐够呛。一路折磨，最终来到龙背山——今日的终点。庆幸的是，今日宜必思的旁边又熟悉的沙县小吃，填补了我缺失的午餐。</p>\n<p>宜兴没有很多好逛的地方，我们在八佰伴解决了晚餐后，踱步到东浗市民广场算是作罢。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BMH3R.jpg\" alt=\"东浗市民广场\"></p>\n<p>结束一天的骑行后，通红的皮肤和洗澡时的刺痛，不时提醒我防晒的重要性。</p>\n<h2 id=\"Day-4-宜兴-gt-湖州\"><a href=\"#Day-4-宜兴-gt-湖州\" class=\"headerlink\" title=\"Day 4 宜兴 -&gt; 湖州\"></a>Day 4 宜兴 -&gt; 湖州</h2><blockquote>\n<p>晒伤程度：150%</p>\n</blockquote>\n<p>这天依旧是一个很棒的晴天，这次我开始考虑防晒的重要性。虽然我带了长袖，但是是黑色的且不透气，所以只能将就做好防晒就出发。今天的路线就更为简单，沿着浗滨大道来到G104国道，路过高铁站一路缓下坡，骑行体验甚好。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BMbg1.jpg\" alt=\"浗滨大道\"></p>\n<p>在快进入浙江省时，还捕捉到了1314里程碑。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BMOu6.jpg\" alt=\"1314\"></p>\n<p>快到省界前，是一个漂亮的爬坡，和很棒的湖景。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BMqjx.jpg\" alt=\"G104-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BM7C9.jpg\" alt=\"G104-2\"></p>\n<p>省界的里程碑也很有意思。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BMXDK.jpg\" alt=\"省界\"></p>\n<p>在夹浦村岔路口，可以拐到滨湖大道上，让你一路湖景看到够，为了弥补前两天湖景的不足，我和基友不顾日头毒，毅然选择了这条路线。事实证明，我们的选择很正确。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BMjHO.jpg\" alt=\"滨湖大道-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQS4H.jpg\" alt=\"滨湖大道-2\"></p>\n<p>整条路骑到湖州太湖度假区约20公里，当然一路没有太多树荫，一成不变的湖景看久了，显得稍有些枯燥。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BMxED.jpg\" alt=\"滨湖大道-3\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BMzUe.jpg\" alt=\"滨湖大道-4\"></p>\n<p>所幸经过太湖旅游度假区后，几乎是一路下坡，骑行体验很棒，和昨日宜兴的进城之路形成了鲜明的对比。由于没有补充午餐，路上险些低血糖，幸好基友的月饼救了一命。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQ9Cd.jpg\" alt=\"太湖度假区\"></p>\n<p>一顿跋涉后，最终在下午3点来到银泰城对面的康铂酒店。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQC8A.jpg\" alt=\"银泰城\"></p>\n<p>在一顿海底捞弥补宜兴火锅被坑后，我们来<strong>衣裳街</strong>逛了逛，不出所料，是湖州版的南锣鼓巷，果然也有湖南臭豆腐和轰炸大鱿鱼，也不知大鱿鱼犯了什么错，要去轰炸它。也许是工作日，又也许是湖州并不是旅游城市，步行街里的人并不多，贴着市河一侧还稍微有点意境。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQPgI.jpg\" alt=\"衣裳街\"></p>\n<p>一日疲惫，我们走到兴尽，打车回府。</p>\n<h2 id=\"Day-5-湖州-gt-南浔\"><a href=\"#Day-5-湖州-gt-南浔\" class=\"headerlink\" title=\"Day 5 湖州 -&gt; 南浔\"></a>Day 5 湖州 -&gt; 南浔</h2><blockquote>\n<p>晒伤程度：180%</p>\n</blockquote>\n<p>南浔是湖州的一个区，所以这一天的路程不算太遥远。姑且作为修整。沿着苕溪东路来到织里镇，可以拐到318国道上一路直行进入南浔。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQivt.jpg\" alt=\"苕溪东路\"></p>\n<p>318国道从上海人民广场开始到西藏聂拉木县樟木镇中尼友谊桥。中间从成都到拉萨段也是很出名的骑行、徒步、自驾路线。这块里程碑表示距离上海市区只有136公里，比想象中居然近这么多。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQkKP.jpg\" alt=\"G318-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQEb8.jpg\" alt=\"G318-2\"></p>\n<p>由于只有30+km，中午12点多我们就抵达酒店。在一家猪蹄店大快朵颐后，我们回酒店休息到日头没有那么强烈，继续一个游客的使命。我也换上长袖，为过度晒伤盖上一块遮羞布。南浔区<strong>南浔古镇</strong>是较出名的景点，白日有乌镇的感觉，可惜我们来的时候已近饭点。古镇据说5点后不收门票，园内人数尚可，兴许是工作日的原因。南侧部分和平江路、南长街没什么太大的区别，北侧百间楼倒是有别样的韵味。在此处，河道渐宽，游客也比较少，还有一些原住民，有了江南水乡的感觉。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQADf.jpg\" alt=\"南浔古镇-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQZVS.jpg\" alt=\"南浔古镇-2\"></p>\n<p>逛完古镇，在基友的期盼下，今天用海底捞画上句号。从海底捞打车会酒店，短短2公里，没想到滴滴也有人接单，看来还是在大城市呆习惯了。需要避免一些惯性思维。</p>\n<h2 id=\"Day-6-南浔-gt-苏州-gt-上海\"><a href=\"#Day-6-南浔-gt-苏州-gt-上海\" class=\"headerlink\" title=\"Day 6 南浔 -&gt; 苏州 -&gt; 上海\"></a>Day 6 南浔 -&gt; 苏州 -&gt; 上海</h2><blockquote>\n<p>晒伤程度：150%</p>\n</blockquote>\n<p>由于湖州那天在滨湖大道上，已经连着看了20公里的湖景，再加上晒伤严重，最后一天我和基友不约而同选择了没那么沿湖的路线。基友率先出发，出了南浔区没多久，很快由回到江苏省境内。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQeUg.jpg\" alt=\"江苏界\"></p>\n<p>从318国道拐到258省道后，一路坦途。两侧既没有湖景，也没有树荫。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQm5Q.jpg\" alt=\"258省道-1\"></p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQM2n.jpg\" alt=\"258省道-2\"></p>\n<p>路过吴江大道后，我们又回到苏州，由于不确定省道能否左拐到东太湖路，我们从吴江区内绕路过湖，顺便做了补给。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQuCj.jpg\" alt=\"江陵西路\"></p>\n<p>沿着东太湖路一路向西可以回到环太湖大道，我们并没有向南去东山镇做更多的探索。回到熟悉的环太湖大道，心里的石头也落下了地。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQK8s.jpg\" alt=\"环太湖大道\"></p>\n<p>太湖大道上人并不多，我们还了车退了押金，也很轻松地叫了车进城。基友去宜家打卡，我去苏州站坐高铁去上海找对象。</p>\n<p><img src=\"https://z3.ax1x.com/2021/10/20/5BQQvq.jpg\" alt=\"三虾面\"></p>\n<p>这几天我们是幸运的，车和人都没出意外状态，除了身上显眼的晒伤。脖子上明显的色差让我的脑袋像是后来组装在我的身体上。这次骑行过后，基友更坚信了我是他的吉祥物，和我一起来骑车，总能避免下雨和疫情。骑行前做的应急预案也很幸运地都没有用上。对比去年青海湖的受苦，这次骑行的风格明显更养生一点，每天不止能磨练筋骨，愉悦眼球，还能在疲惫过后享受现代科技的便利，无脑进入游客模式。体验可以说不能更好了。</p>\n<p>在观前街分别前，我也祝福他十一环海南的旅途一路顺风。我们明年再见👋。</p>\n",
            "tags": [
                "江南",
                "苏州",
                "无锡",
                "宜兴",
                "湖州",
                "南浔",
                "游记",
                "随笔"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/09/10/trunk-based-development/",
            "url": "http://shenlvmeng.github.com/blog/2021/09/10/trunk-based-development/",
            "title": "Trunk Based Development（主干开发）介绍",
            "date_published": "2021-09-10T02:44:08.000Z",
            "content_html": "<blockquote>\n<p>主干开发是相对<a href=\"https://nvie.com/posts/a-successful-git-branching-model/\">GitFlow</a>和<a href=\"https://guides.github.com/introduction/flow/\">Github Flow</a>更贴合CI&#x2F;CD（持续集成&#x2F;持续分发）的高效版本控制管理实践，也更贴合Devops团队。</p>\n</blockquote>\n<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>在软件开发的早年期间，GitFlow和GithubFlow被用来在软件开发中做版本控制管理。</p>\n<ul>\n<li>GitFlow工作流中，分为主干分支（<code>master</code>）、开发分支（<code>dev</code>）、特性分支、分布分支、热修分支等，这些分支都是长期存在的，并在需求开发完成&#x2F;bug修复完成&#x2F;代码发布等特定时候执行代码的CR（Code Review）和合码工作。且在合并时，由仓库的核心成员或者管理员们把握代码质量。随着项目的扩大，冲突的几率提高，每次代码合码时候的工作量也大大提升，带来了额外的仓库维护成本。Github Flow便随着Github逐渐流行起来。<br><img src=\"https://nvie.com/img/git-model@2x.png\" alt=\"GitFlow\"></li>\n<li>Github Flow工作流中，只有一个主干分支（<code>master</code>），一些特性分支以及发布时会用到的分布分支。开发者可以自由从主干分支签出特性分支开发、调试，并在需求完成后合入主干分支。一定程度上减少了长期存在分支的维护成本，但同样的，CR依然是项目管理者进行，特性分支合码时代码量依然有可能很大，团队内规范不好的话，也容易导致合码后主干分支不可发布。<br><img src=\"https://images.prismic.io/launchdarkly/bf307def-6bfc-4d27-ac8b-f4dd1a403935_TrunkBasedDev-01+%283%29.png?auto=compress,format\" alt=\"Merge Conflict\"></li>\n</ul>\n<p>主干开发（Trunk Based Development）是一种更敏捷的git工作流，所有的开发者都可以合码到主干分支，结合CI&#x2F;CD流程，有助于团队快速迭代。</p>\n<h2 id=\"什么是主干开发\"><a href=\"#什么是主干开发\" class=\"headerlink\" title=\"什么是主干开发\"></a>什么是主干开发</h2><p>主干开发和CI&#x2F;CD相互依赖相辅相成。</p>\n<ul>\n<li>进行主干开发才能保证CI&#x2F;CD，即每天充分多次的集成乃至发布</li>\n<li>CI&#x2F;CD过程中的<strong>快速</strong>自动化测试可以保证主干分支的可发布性</li>\n</ul>\n<p>在主干开发中每位或者每小组开发者将自己的工作分成小份，然后以每天至少一次的形式从自己的分支合并到主干，由于每次合并代码量不大，CR时间以及CI时间都会缩短。一个典型的主干开发时间轴如下：</p>\n<p><img src=\"https://cloud.google.com/architecture/devops/images/devops-tech-trunk-based-development-typical-trunk-timeline.svg\" alt=\"主干开发时间轴\"></p>\n<p>在主干开发中，某些情况下需要从主干分支中选出最佳的bug修复合并到对应版本中，但如果每天发布多次，则根本不需要发布分支，可直接从主干中部署。这样做的最大优势在于减少开发线，频繁执行小批量合并，将代码保持最新。从而降低团队的合码成本。</p>\n<h2 id=\"如何实现主干开发\"><a href=\"#如何实现主干开发\" class=\"headerlink\" title=\"如何实现主干开发\"></a>如何实现主干开发</h2><p>在进行主干开发时，开发者需要了解如何拆解工作为小份，同时，还需要让构建流程保持通过，如果CI失败，开发者需要立即停止当前工作修复问题，无法短期修复时，也要还原相应更改。通常来讲，主干开发有下面这样的特征：</p>\n<ul>\n<li>仓库里的活跃分支不超过3个</li>\n<li>分支的合码频率不少于每天1次，即分支的生存周期不超过1天</li>\n<li>没有代码冻结期或集成期</li>\n</ul>\n<p>在实践中，有下面一些tips：</p>\n<ul>\n<li><strong>小commit，多合码</strong>：将每次合码改动限制在少量的commit和较少的代码改动上，保证合码时轻松；主干分支应该有频繁的小批量改动合码</li>\n<li><strong>最少1天1合码</strong>：每天合并或关闭待合并分支，有效减少合码压力，提高增量发布敏捷度</li>\n<li><strong>同步Code Review</strong>：主干分支的每次合码需要保证CR的及时响应，这可以借助一些代码分析工具的辅助</li>\n<li><strong>全面的自动化测试覆盖</strong>：确保有全面的自动化单元测试套件，保证测试通过后再合并代码，这也是保证主干分支可发布的基础</li>\n<li><strong>构建快速</strong>：降低CI成本，构建和测试需要在几分钟内完成</li>\n</ul>\n<p>同时也带来两个新概念</p>\n<ul>\n<li><strong>分支抽象</strong>：在主干开发中，合码频率很高，有些大需求可能没有办法在1天内就完成合码，对于未完成的需求，可以在代码中先埋下未使用的新特性，等待需求完成后，再使用埋好的新功能。这种在源代码中提前埋下“代码分支”的方式成为抽象分支（Branch by abstraction）</li>\n<li><a href=\"https://featureflags.io/\"><strong>特性开关</strong></a>：在分支抽象的基础上，有些合并到主干的改动不一定想让所有用户都看见，可以在代码中预先埋入分支语句，再从配置中读取当前是否使用特性。这样可以实现功能灵活切换、实现ab-test等效果</li>\n</ul>\n<p><img src=\"https://images.prismic.io/launchdarkly/7ad744e0-5c46-4a2f-b08d-6013a95e89c5_TrunkBasedDev-02+%283%29.png?auto=compress,format\" alt=\"feature-flags\"></p>\n<h2 id=\"标准开发流\"><a href=\"#标准开发流\" class=\"headerlink\" title=\"标准开发流\"></a>标准开发流</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git checkout master &amp;&amp; git pull --prune</span><br><span class=\"line\">git checkout -b &lt;feat/branch&gt;</span><br><span class=\"line\"><span class=\"comment\"># coding</span></span><br><span class=\"line\">git push -u origin &lt;feat/branch&gt;</span><br><span class=\"line\"><span class=\"comment\"># after any updates</span></span><br><span class=\"line\">git push</span><br><span class=\"line\"><span class=\"comment\"># or add --force if rebased during updates</span></span><br><span class=\"line\">git push -f</span><br></pre></td></tr></table></figure>\n\n<ol>\n<li>更新本地master分支</li>\n<li>签出特性分支</li>\n<li>编码</li>\n<li>推送本地分支到远端</li>\n<li>提MR，如果MR后有更新，继续push，当rebase master遇到冲突时，推送需要增加<code>-f</code>参数</li>\n<li>合码</li>\n</ol>\n<blockquote>\n<p>注：因为主干开发每次合码量不大，建议使用<code>rebase</code>解决冲突</p>\n</blockquote>\n<h2 id=\"主干开发的好处\"><a href=\"#主干开发的好处\" class=\"headerlink\" title=\"主干开发的好处\"></a>主干开发的好处</h2><p>主干开发的最大好处在于对CI的亲和度。可以想象开发者完成当日工作，当日合码，当日测试通过完成集成，达到可发布状态。很大程度减少了合码的痛苦。进而有：</p>\n<ul>\n<li>持续CI</li>\n<li>持续CR</li>\n<li>持续CD</li>\n</ul>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>非常适用于敏捷开发中，对于团队成员能力过关（要懂得怎样拆分需求）、测试有着良好建设的团队来讲，是种提效的好方式，值得一试。相反如果成员拆分不够良好、代码review不够及时，测试不够自动化和系统，则不适用主干开发。</p>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://www.atlassian.com/continuous-delivery/continuous-integration/trunk-based-development\">Trunk-based development</a></li>\n<li><a href=\"https://cloud.google.com/architecture/devops/devops-tech-trunk-based-development\">DevOps技术：主干开发</a></li>\n<li><a href=\"https://trunkbaseddevelopment.com/\">Trunk Based Development: Introduction</a></li>\n<li><a href=\"https://launchdarkly.com/blog/git-branching-strategies-vs-trunk-based-development/\">Git Branching Strategies vs. Trunk-Based Development</a></li>\n<li><a href=\"https://launchdarkly.com/blog/what-are-feature-flags/\">What Are Feature Flags?</a></li>\n</ul>\n",
            "tags": [
                "工作流",
                "主干开发",
                "GitFlow",
                "GithubFlow"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/03/22/clean-architecture/",
            "url": "http://shenlvmeng.github.com/blog/2021/03/22/clean-architecture/",
            "title": "《架构整洁之道》—— 软件设计的思考",
            "date_published": "2021-03-22T15:47:20.000Z",
            "content_html": "<blockquote>\n<p>全文参考自马丁大叔的《架构整洁之道》，书中文笔清爽易懂，不过在后半段有点条理不清流于术而非道</p>\n</blockquote>\n<p>在编程领域，问题就像一个生命体一样，是在不断繁殖和进化的。它甚至经常不会人们预期中一般发展。作为一名出色的软件工程师或架构师，你需要有超出普通程序员的视角，考虑系统宏观的未来的发展。你的使命是，在这种恶劣的开发环境下，绘制一幅相对最优的图纸，用最少的时间、人力、金钱构建和维护一个随时可能融化在熵增热汤里的软件系统。和现实物理世界里的架构师类似，你需要了解编程世界里的一般规律，帮助你挑选武器（技术），修炼秘籍（方法论），在不同的江湖里（业务）打造不同的门派（软件系统）。</p>\n<p>开卷有益，祝你练武愉快~</p>\n<h2 id=\"你要做什么\"><a href=\"#你要做什么\" class=\"headerlink\" title=\"你要做什么\"></a>你要做什么</h2><p>简而言之，架构师的终极目标就是<strong>用最少的人力成本来满足构建和维护软件系统的需求</strong>。糟糕的架构设计会让软件在成功之前，就带来高昂的边际人力成本，即开发新需求的开支越来越大（因为程序员的时间都耗费在系统的修修补补上了）。然而，这种日益增长的边际人力成本现象并不少见。来源于类似龟兔赛跑中兔子的盲目自信，实际上，<strong>无论从短期还是长期看，胡乱编写代码的工作速度其实比循规蹈矩更慢</strong>。</p>\n<p>架构师存在的一个必要性就是，软件存在着两种价值维度：</p>\n<ul>\n<li><strong>行为价值（现在时）</strong>：即实现功能和弥补bug。这类价值是<strong>紧急却并不总是重要的</strong>。</li>\n<li><strong>架构价值（将来时）</strong>：即软件是否足够“软”（易于被修改），这类价值是<strong>重要却并不总是紧急的</strong>。</li>\n</ul>\n<p>很现实的一点是，在公司中，<strong>团队之间的抗争本来就是无穷无尽的</strong>。你作为研发团队的一员，职责的一部分就是避免你的代码在抗争的风吹雨打下变成一坨没人爱的shit。</p>\n<h2 id=\"编程范式\"><a href=\"#编程范式\" class=\"headerlink\" title=\"编程范式\"></a>编程范式</h2><p>没错，架构师们也有祖师爷。在1958到1968年期间，3大编程范式就已经陆续出现了。</p>\n<ul>\n<li><strong>结构化编程</strong>，由Dijkstra在1968年提出，并发扬光大，<strong>它对程序控制权的直接转移（程序语句）进行了限制和规范</strong></li>\n<li><strong>面向对象编程</strong>，最早在1966年提出，Ole Johan Dahl和Kriste Nygaard注意到，函数调用堆栈可以被放到堆内存中，从而在函数返回后继续保留。<strong>它对程序控制权的间接转移（函数调用）进行了限制和规范</strong></li>\n<li><strong>函数式编程</strong>，启发自Alonzo Church于1936年发明的lambda演算，发扬于1958年的LISP语言。<strong>它对程序的赋值进行了限制和规范</strong></li>\n</ul>\n<p>值得思考是，三大范式做的都是<strong>限制和规范</strong>，即告诉我们<strong>不能做什么</strong>，而不是可以做什么。另外，多态带来的架构边界飞跃，函数式编程带来的数据访问限制，结构化编程带来的算法拆解为我们架构软件提供了强大武器。这也与软件架构的三个关注点所契合：</p>\n<ul>\n<li><strong>功能性</strong>，即完整的功能实现</li>\n<li><strong>组件独立性</strong>，即合适的耦合度与细粒度</li>\n<li><strong>数据管理</strong>，即良好的数据结构设计</li>\n</ul>\n<h3 id=\"结构化编程\"><a href=\"#结构化编程\" class=\"headerlink\" title=\"结构化编程\"></a>结构化编程</h3><p>Dijkstra在1950年代思考编程时，得出过一个结论：编程是一项<strong>难度很大</strong>的活动。他倾向于把编程类比为数学推导过程，并发现<code>goto</code>的<strong>某些使用</strong>会导致<strong>模块无法被递归拆解成更小的单元</strong>。然而，去掉这些使用的<code>goto</code>可以被<strong>顺序结构、分支结构、循环结构这三种最小集</strong>等价表示出来。从而，大问题可以被逐步拆解为小问题。</p>\n<p>不过，事情也并非这么理想，当程序复杂后，我们不可能像Dijkstra一样，用严格的数学推导形式化证明编程的正确性。相反，类似实验学科的<strong>无法被证伪即正确</strong>，我们现今依旧使用着Dijkstra的结构化编程思路将大问题拆解为小问题。</p>\n<blockquote>\n<p>有趣的是，“无法被证伪即正确”和Dijkstra的一个观点<strong>“测试只能展示bug的存在，并不能证明不存在bug”</strong>不谋而合</p>\n</blockquote>\n<p>简而言之，去掉goto糟粕诞生的结构化编程中，最有价值的地方就是，它赋予我们创造<strong>可证伪程序单元</strong>的能力，从而架构起大程序。在架构设计领域，<strong>功能性拆解仍然是最佳实践之一</strong>。</p>\n<blockquote>\n<p>什么？什么叫做可证伪？你应该写过单元测试吧。</p>\n</blockquote>\n<h3 id=\"面向对象编程\"><a href=\"#面向对象编程\" class=\"headerlink\" title=\"面向对象编程\"></a>面向对象编程</h3><p>什么是面向对象？有人说面向对象是“数据和函数的组合”，也有人说是“对真实世界的一种建模方式”。但这两种理解要么片面，要么虚无缥缈。为了总结这种范式，我们先从它的3大特征入手：</p>\n<ul>\n<li><strong>封装</strong>，即将一组关联数据和函数圈起来。然而这种特性，从C语言起就支持（struct + 头文件），很难说它是面向对象编程的必要条件</li>\n<li><strong>继承</strong>，即可以在某个作用域对外部定义的一组变量与函数进行覆盖。不过C语言也能模拟出这种能力，看起来也比较勉强。</li>\n<li><strong>多态</strong>，即在同一接口描述下的不同具体实现形式，C语言起也做了支持（STDOUT），然而使用函数指针显式实现多态问题就在于指针的<strong>危险性</strong>。而面向对象编程对这种程序间接控制权的转移做了约束。</li>\n</ul>\n<p>传统的函数调用树中，系统行为决定了自上而下的控制流，而控制流决定了<strong>源代码依赖</strong>（代码实现）是自上而下的，比如在C中会使用<code>#include</code>引入依赖。此时不论是代码实现还是代码执行都是自上而下的。然而在<strong>多态</strong>的帮助下，底层函数需要依赖高层接口实现，作为高层函数的插件引入，从而将这种依赖关系和控制流反向，即<strong>依赖反转</strong>。实际上，借助安全便利的多态实现，可以轻松将依赖关系反转。</p>\n<p>从而架构师可以<strong>完全控制</strong>这种方式下，系统中所有的源代码依赖关系，进而随意更改源代码依赖关系。让每个组件都有<strong>独立部署</strong>和<strong>独立开发</strong>能力。好了，我们现在可以说明面向对象编程的含义了：</p>\n<p>面向对象编程就是以多态为手段来对源代码中的依赖关系进行控制的能力。这种能力让架构师可以构建<strong>插件式架构</strong>，让高层<strong>策略性组件</strong>和底层<strong>实现性组件</strong>相分离。借助接口，底层实现性组件作为插件，可以独立于高层组件开发和部署。</p>\n<h3 id=\"函数式编程\"><a href=\"#函数式编程\" class=\"headerlink\" title=\"函数式编程\"></a>函数式编程</h3><p>函数式编程依据的原理早在编程之前就已出现，相对前两种范式，函数式编程的风格可能相对陌生一点。在这类风格中，变量都是不可变的。从而让竞争问题、死锁问题、并发更新问题不复存在。一个架构良好的系统，需要将状态修改的部分和不需要修改的部分隔离开，然后用类似事务型内存的方式来保护可变量。另外，架构师应该着力于将大部分逻辑归于不可变组件中，可变组件的逻辑越少越好。</p>\n<p>书中还提到了只包含CR的事件溯源存储逻辑，即通过事务日志的方式保存当前状态。因为不存在更改和删除，从而不存在并发问题。也是一种很新颖的思路。</p>\n<p>回顾上面的三种编程范式，都在说什么<strong>不应该做</strong>。也即编程好似在充满死路的熵增旷野中，只有沿着相对安全的几个大方向才可拨开迷雾。</p>\n<h2 id=\"设计原则\"><a href=\"#设计原则\" class=\"headerlink\" title=\"设计原则\"></a>设计原则</h2><p>软件的中层需要具有良好的可读性、可扩展性。这里就不得不提到SOLID原则：</p>\n<ul>\n<li>SRP：<strong>单一职责原则</strong>，每个模块有且只有一个需要被改变的理由</li>\n<li>OCP：<strong>开闭原则</strong>，对扩展开放，对修改封闭</li>\n<li>LSP：<strong>里氏替换原则</strong>，子类型应该能够无无缝替换类型使用</li>\n<li>ISP：<strong>接口隔离原则</strong>，依赖的模块不要包含不需要的接口</li>\n<li>DIP：<strong>依赖反转原则</strong>，高层策略性代码不要依赖底层实现性代码</li>\n</ul>\n<h3 id=\"SRP\"><a href=\"#SRP\" class=\"headerlink\" title=\"SRP\"></a>SRP</h3><p>任何一个软件模块（一组紧密相关的函数和数据结构）都应该只对一个行为者负责。实际上，代码和数据就是靠着和某一类行为者的相关性组合起来的。我们需要<strong>将服务不同行为者的代码进行切分</strong>。</p>\n<h3 id=\"OCP\"><a href=\"#OCP\" class=\"headerlink\" title=\"OCP\"></a>OCP</h3><p>设计良好的软件应该易于扩展，同时抗拒修改。实现方式可以通过将系统划分为一系列组件，并且将依赖关系按层次组织，使得高阶组件不会因为低阶组件修改受到影响。</p>\n<h3 id=\"LSP\"><a href=\"#LSP\" class=\"headerlink\" title=\"LSP\"></a>LSP</h3><p>里氏替换原则表示，子类型应该能够被当做父类型使用。它实际上表示了一种面向接口设计的设计原则。一旦违背了这种可替换性，就会不得不在系统架构中增加大量复杂的应对机制。</p>\n<h3 id=\"ISP\"><a href=\"#ISP\" class=\"headerlink\" title=\"ISP\"></a>ISP</h3><p>ISP告诉我们任何软件设计如果依赖了不需要的东西，都是不好的迹象，很容易带来不必要的麻烦。</p>\n<h3 id=\"DIP\"><a href=\"#DIP\" class=\"headerlink\" title=\"DIP\"></a>DIP</h3><p>DIP告诉我们，应该多引用抽象类型，而不是具体实现。因为软件是经常变动的，而抽象出共性的接口则是较少变化的。从而可以衍生出一些守则，譬如：</p>\n<ul>\n<li>应该多使用抽象接口，避免使用多变的实现类</li>\n<li>不要在实现类上创建衍生类</li>\n<li>不要覆盖具体实现的函数</li>\n</ul>\n<p>不过当然了，还是得有人做实现的脏活累活的</p>\n<h2 id=\"组件构建\"><a href=\"#组件构建\" class=\"headerlink\" title=\"组件构建\"></a>组件构建</h2><h3 id=\"组件\"><a href=\"#组件\" class=\"headerlink\" title=\"组件\"></a>组件</h3><p>组件是构建软件的最小单元，同时也是源代码的集合。在早期会使用链接技术将程序和库函数链接起来，而后随着机器性能的增长，我们会在程序运行中插入动态链接文件，如今这种组件化插件式架构是最常见的软件构建形式。</p>\n<h3 id=\"组件聚合\"><a href=\"#组件聚合\" class=\"headerlink\" title=\"组件聚合\"></a>组件聚合</h3><p>和类相似，组件也有一些原则指引我们的构建工作。</p>\n<ul>\n<li>REP：复用&#x2F;发布原则，即可以一起发布的最小粒度就是复用的最小粒度，也即按可以同时发布聚合</li>\n<li>CCP：共同闭包原则，即因为同一原因修改的放在一起，反之不要放在一起，也即按变更原因聚合</li>\n<li>CRP：共同复用原则，即会被一起复用的放在一起，反之不要放在一起，也即按减少无用耦合聚合</li>\n</ul>\n<p>这三大原则相互牵制，在项目的不同阶段，某一原则重要性也会不同；比如在项目早期CCP就会更重要，而后REP会比较重要。</p>\n<h3 id=\"组合耦合\"><a href=\"#组合耦合\" class=\"headerlink\" title=\"组合耦合\"></a>组合耦合</h3><p>本节提出了一些可以定量衡量耦合健康度的指标，比较新颖。</p>\n<ul>\n<li>无依赖环原则：依赖关系中不能有环，会不利于厘清依赖关系；可以通过<strong>依赖反转</strong>或<strong>创建第三方依赖组件</strong>解决。循环依赖关系务必持续监控。</li>\n<li>稳定依赖原则：依赖关系必须指向稳定的方向，简单点说就是让经常变更的组件依赖于不经常变更的组件。一个组件的位置稳定性可以通过入向和出向依赖算出，它要能和组件的实际稳定性匹配。</li>\n<li>稳定抽象原则：抽象化程度需要和稳定性程度一直，即经常变更的组件要容易变更，即更具体实现；反之，稳定的组件要不容易变更，即更抽象。结合上条看，依赖关系应该指向更抽象的方向。</li>\n</ul>\n<p>使用位置稳定性指标I和抽象程度A，可以绘制一个坐标系。在主序列上的是最健康的，相反的两块痛苦区和无用区则是不健康的表现。用偏离主序列线的距离可以大致衡量依赖关系的健康程度。结合发布版本的变化来看，还可以得到变化趋势。</p>\n<h2 id=\"软件架构\"><a href=\"#软件架构\" class=\"headerlink\" title=\"软件架构\"></a>软件架构</h2><p>软件架构目的就是方便在工作中更好地对组件进行研发、部署、运行和维护。其中的策略就是<strong>保留尽可能多的可选项</strong>。让系统最大化程序员的生产力，同时最小化系统运营成本：</p>\n<ul>\n<li>开发：系统架构需要方便开发团队对它的开发，不同的团队结构应该采用不同的架构设计，比如团队的大小就会影响架构的选择</li>\n<li>部署：一键式部署</li>\n<li>运行：几乎任何运行问题都可以通过增加硬件来解决</li>\n<li>维护：减小新功能和系统缺陷占用的人力资源</li>\n</ul>\n<p>保持可选项，忽略那些无关紧要的实现细节。任何软件系统都可以拆解成<strong>策略</strong>（业务的宏观逻辑和流程）和<strong>细节</strong>（具体操作行为）。而<strong>策略才是系统的真正价值所在</strong>。细节是指那些和策略交互的东西，包括:</p>\n<ul>\n<li>I&#x2F;O设备</li>\n<li>数据库</li>\n<li>Web系统</li>\n<li>服务器</li>\n<li>框架</li>\n<li>交互协议</li>\n</ul>\n<p>在设计时，可以尽量拖延上面这些的设计，这样我们做出的决策才不会依赖各种很容易变化的信息。另一方面，也可以<strong>增加实现底层的可替换性</strong>。举个具体例子：<strong>设备无关性</strong>。</p>\n<h3 id=\"独立性\"><a href=\"#独立性\" class=\"headerlink\" title=\"独立性\"></a>独立性</h3><p>一个良好的架构应支持下面几点：</p>\n<ul>\n<li>系统用例：设计良好的架构需要能够<strong>看起来</strong>就可以反映系统的设计意图，比如一个购物车应用架构应该看起来就该是用来实现购物车的</li>\n<li>系统运行：可以解耦出多个独立服务，然后通过某种网络协议通信，这种架构即微服务</li>\n<li>系统维护</li>\n<li>系统开发</li>\n<li>系统部署：理想的独立部署应该能够做到<strong>热更新</strong></li>\n</ul>\n<p>要注意留意表面的重复和实际的重复，如果两段代码变更速率和缘由不同，那么就不算是真正的重复。</p>\n<h3 id=\"划分边界\"><a href=\"#划分边界\" class=\"headerlink\" title=\"划分边界\"></a>划分边界</h3><ul>\n<li>设计良好的系统架构不应该依赖细节，而应该尽可能推迟细节性的决策。通过划清边界，可以推迟和延后细节性的决策，从而节省大量时间，避免问题。</li>\n<li>边界线应该画在不相干的事情中间，譬如GUI和业务逻辑</li>\n<li>针对核心业务逻辑的插件式架构可以提高可维护性和可扩展性</li>\n</ul>\n<h3 id=\"边界剖析\"><a href=\"#边界剖析\" class=\"headerlink\" title=\"边界剖析\"></a>边界剖析</h3><p>简言之，应该尽可能从底层组件指向高层组件。</p>\n<h3 id=\"策略和层次\"><a href=\"#策略和层次\" class=\"headerlink\" title=\"策略和层次\"></a>策略和层次</h3><ul>\n<li>变更原因、时间和层次不同的策略应该属于不同的组件</li>\n<li>按距离系统输入、输出距离的远近，可以确定策略的层次</li>\n<li>源码间的依赖关系，应该主要和组件所在的层次挂钩</li>\n<li>低层组件应该以插件的方式依赖高层组件</li>\n</ul>\n<h3 id=\"业务逻辑\"><a href=\"#业务逻辑\" class=\"headerlink\" title=\"业务逻辑\"></a>业务逻辑</h3><p><strong>业务逻辑是程序中真正用于或者体现赚钱&#x2F;省钱的逻辑与过程</strong>。其中关键逻辑和关键数据紧密组合成为<strong>业务实体</strong>。业务实体应该只有高层逻辑，没有具体实现。而<strong>用例</strong>是业务实体在不同侧面的具体体现。通过用例可以规范用户和业务实体的交互方式。</p>\n<h3 id=\"“尖叫”的软件架构\"><a href=\"#“尖叫”的软件架构\" class=\"headerlink\" title=\"“尖叫”的软件架构\"></a>“尖叫”的软件架构</h3><p>“尖叫”即所见即所得。软件架构本身就足以能够体现其用途。一个良好的架构设计应该围绕用例展开，推迟和延后框架的选择，不要过度拘泥于框架。<strong>框架只是一个可选项</strong>，是一个工具，而不是一种信念，更不是一种架构。</p>\n<h3 id=\"整洁架构\"><a href=\"#整洁架构\" class=\"headerlink\" title=\"整洁架构\"></a>整洁架构</h3><p>一些常见的系统架构通常具有以下特点：</p>\n<ul>\n<li>独立于框架</li>\n<li>可被测试</li>\n<li>独立于UI</li>\n<li>独立于数据库</li>\n<li>独立于外部接口</li>\n</ul>\n<h3 id=\"Main组件\"><a href=\"#Main组件\" class=\"headerlink\" title=\"Main组件\"></a>Main组件</h3><ul>\n<li>Main组件包含了系统中最细节化最底层的策略，它应该在做完脏活累活后，将程序的控制权交给最高抽象层的代码去执行</li>\n<li>针对不同系统可以配置不同的Main组件，即将Main组件视为应用程序的一个插件</li>\n</ul>\n<h3 id=\"服务：微观和宏观\"><a href=\"#服务：微观和宏观\" class=\"headerlink\" title=\"服务：微观和宏观\"></a>服务：微观和宏观</h3><ul>\n<li>系统的架构边界事实上并不落在服务之间，而是<strong>穿透</strong>所有服务，在服务内以组件形式存在</li>\n<li>服务可以提升系统的可扩展性和可开发性，不过服务却并不能代表整个系统的架构设计</li>\n</ul>\n<h3 id=\"整洁的嵌入式架构\"><a href=\"#整洁的嵌入式架构\" class=\"headerlink\" title=\"整洁的嵌入式架构\"></a>整洁的嵌入式架构</h3><ul>\n<li>固件即对平台或硬件的强依赖代码，在固件和软件之间可以设置HAL（硬件抽象层），为它上层的软件提供服务，它可以帮助软件<em>脱离</em>目标硬件平台来测试</li>\n<li>类似地，我们还可以引入OSAL（操作系统抽象层）来减少软件对操作系统的依赖</li>\n</ul>\n<h2 id=\"实现细节\"><a href=\"#实现细节\" class=\"headerlink\" title=\"实现细节\"></a>实现细节</h2><p>那么什么算是实现细节呢？</p>\n<ul>\n<li><strong>数据库</strong>，数据的组织结构和模型都是系统架构的一部分，但是从磁盘中存储&#x2F;读取数据的机制或手段则没那么重要，就比如数据库或静态文件</li>\n<li><strong>Web</strong>，Web只是UI，只是一种I&#x2F;O设备</li>\n<li><strong>应用框架</strong>，框架被创造的目的是解决作者遇到的问题，它要求我们去阅读文档，按照作者的要求整合到我们的应用中，可以使用但是不要被框架绑定</li>\n</ul>\n<h3 id=\"案例：视频销售网站\"><a href=\"#案例：视频销售网站\" class=\"headerlink\" title=\"案例：视频销售网站\"></a>案例：视频销售网站</h3><ul>\n<li>系统架构设计的第一步是识别系统中的各种角色和用例</li>\n</ul>\n<p><em>–END–</em></p>\n",
            "tags": [
                "设计",
                "架构",
                "组件"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/01/29/zen-of-unix/",
            "url": "http://shenlvmeng.github.com/blog/2021/01/29/zen-of-unix/",
            "title": "Unix编程艺术集萃",
            "date_published": "2021-01-29T13:45:15.000Z",
            "content_html": "<p>这本书从Unix的设计理念等各方面讲起，内容充实有趣，尽管介绍细节的部分对于不太了解Unix的人呢来讲有些生涩，但在道的介绍上有不少可取之处。由于某人的出现，生活中多了新的追求，比想象中多用了一些时间看完了它。下面摘取一些其中精华的观点，力图尽量还原书中的本意。</p>\n<h2 id=\"Context\"><a href=\"#Context\" class=\"headerlink\" title=\"Context\"></a>Context</h2><h3 id=\"哲学\"><a href=\"#哲学\" class=\"headerlink\" title=\"哲学\"></a>哲学</h3><ul>\n<li>每过18个月，就有一半的知识会过时</li>\n<li>X致力提供一套“机制，而不是策略”</li>\n<li>提供机制而不是方针的哲学让Unix长期保鲜</li>\n<li>Unix传统将重点放在尽力使各程序接口相对小巧、简洁、正交</li>\n<li>Unix管道发明人Doug McIlroy曾说过：<ul>\n<li>让每个程序就做好一件事</li>\n<li>假定每个程序的输出都会成为另个程序的输入</li>\n<li>尽早将设计和编译的软件投入使用</li>\n<li>优先使用工具而不是拙劣的帮助来减轻编程任务的负担</li>\n</ul>\n</li>\n<li>Rob Pike曾从不同的角度表述了Unix的哲学<ul>\n<li>你无法断定程序会在什么地方好费时间，所以别急于找地方改代码，除非你已经证实那儿就是瓶颈所在</li>\n<li>没对代码估量最耗时的部分前，别去优化速度</li>\n<li>花哨的算法在n很小的时候通常很慢，而n一般很小</li>\n<li>花哨的算法比简单算法更容易出bug、更难实现</li>\n<li>编程的核心是数据结构，而不是算法</li>\n</ul>\n</li>\n<li>书中对Unix的哲学，总结为下面这些点<ul>\n<li><strong>模块原则</strong>，使用简洁的接口拼接简单的部件</li>\n<li><strong>清晰原则</strong>，清晰胜于机巧，程序是写给人看的</li>\n<li><strong>组合原则</strong>，设计时要考虑拼接组合</li>\n<li><strong>分离原则</strong>，策略和机制分离，接口和引擎分离</li>\n<li><strong>简洁原则</strong>，设计要简洁，复杂度能低则低</li>\n<li><strong>吝啬原则</strong>，除非没有办法，不要写大程序</li>\n<li><strong>透明性原则</strong>，设计要有<strong>可见性</strong>（如输入输出、打点上报），便于审查和调试</li>\n<li><strong>健壮原则</strong>，健壮源于透明和简洁</li>\n<li><strong>表示原则</strong>，把知识转移到数据中，保证逻辑的简朴而健壮</li>\n<li><strong>通俗原则</strong>，即最少惊奇原则，接口设计避免标新立异，缓和学习曲线</li>\n<li><strong>缄默原则</strong>，设计良好的程序将用户的注意力视为有限的宝贵资源</li>\n<li><strong>补救原则</strong>，出现异常时，马上退出并给出错误信息</li>\n<li><strong>经济原则</strong>，宁花机器1分，不花程序员1秒</li>\n<li><strong>生成原则</strong>，避免手工hack，编写程序去生成程序</li>\n<li><strong>优化原则</strong>，过早优化会妨碍全局优化，先制作原型，再精雕细琢；先可用，再优化</li>\n<li><strong>多样原则</strong>，不相信“不二法门”的断言</li>\n<li><strong>扩展原则</strong>，未来总比预想来得要快</li>\n</ul>\n</li>\n<li>Unix哲学一言以蔽之，即KISS（Keep It Simple, Stupid!）</li>\n<li>善用他人写好的工具，尽可能将一切自动化</li>\n</ul>\n<h3 id=\"历史\"><a href=\"#历史\" class=\"headerlink\" title=\"历史\"></a>历史</h3><ul>\n<li>计算机不应仅被视为一种逻辑设备而更应视为社群的立足点</li>\n<li>1985年IEEE支持的POSIX标准表述了BSD和SVR3（System V Release3）调用的交集</li>\n<li>1987年初，GNU C编译器第一版问世</li>\n<li>1995年，Linux找到自己的杀手级应用——开源的web服务器Apache</li>\n<li>过度依赖任何一种技术或者商业模式都是错误的</li>\n</ul>\n<h3 id=\"Unix哲学和其他哲学的对比\"><a href=\"#Unix哲学和其他哲学的对比\" class=\"headerlink\" title=\"Unix哲学和其他哲学的对比\"></a>Unix哲学和其他哲学的对比</h3><ul>\n<li>统一性理念：一切皆文件 &amp; 管道概念</li>\n<li>多任务能力：抢先式多任务</li>\n<li>协作进程：低价的进程生成和简便的进程间通讯</li>\n<li>内部边界：程序员最清楚一切</li>\n<li>文件属性和记录结构：没有文件属性</li>\n<li>减少使用不透明的二进制文件格式</li>\n<li>首选CLI命令行界面</li>\n<li>Unix是程序员写给程序员的</li>\n<li>开发的门槛：轻松编程</li>\n<li>操作系统的比较<ul>\n<li>MacOS：MacOS有一个自己的界面方针，非常详细地说明了应用程序GUI的表现形式和行为模式</li>\n<li>Windows NT：有注册表蠕变现象，不过支持了Cygwin，实现了Unix API的兼容</li>\n<li>MVS：一切皆批处理</li>\n<li>Linux：贴近终端用户的愿望使得Linux开发者比专有Unix更注重系统安装的平稳性和软件发布问题</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"Design\"><a href=\"#Design\" class=\"headerlink\" title=\"Design\"></a>Design</h2><h3 id=\"模块性\"><a href=\"#模块性\" class=\"headerlink\" title=\"模块性\"></a>模块性</h3><ul>\n<li>展开来说就是，要编写复杂软件又不至于一败涂地的唯一方法就是用定义清晰的接口把若干简单模块组合起来</li>\n<li>Unix程序员骨子里的传统是：更加笃信重视模块化、更注重正交性和紧凑性等问题</li>\n<li>封装良好的模块不会过多向外披露自身的细节</li>\n<li>缺陷个数随着模块的代码行数会先减小，随后按代码行数的平方上升</li>\n<li>紧凑性和正交性<ul>\n<li>人类短期记忆能够容纳的不连续信息数就是7，加2或减2</li>\n<li>紧凑性：有经验的用户通常不需要操作手册，让人乐于使用，不会在想法和工作间格格不入；紧凑不等于薄弱；一个功能子集，能够满足专家用户80%以上的一般需求</li>\n<li>正交性：任何操作均无副作用，改变每个属性的方法有且仅有一个；重构代码就是改变代码的结构和组织，而不改变其外在行为</li>\n<li>任何一个知识点在系统内都应当有一个<strong>唯一</strong>、明确、权威的表述（Single Point of Truth, SPOT）</li>\n<li>提高紧凑性的精妙但强大的办法就是围绕“解决一个定义明确的问题”的强核心算法组织设计，避免臆断和捏造。形式化往往能极其明晰地阐述一项任务，与形式法相对的是<strong>试探法</strong>——凭经验法则得到的解决方案，这种思路的问题是回增生出大量特例和边界情况</li>\n</ul>\n</li>\n<li>“限制不仅提倡了经济性，而且某种程度上提倡了设计的优雅”。要达到这种简洁性，尽量不要去想一种语言或操作系统最多能做多少事情，而是尽量去想这种语言或操作系统最少能做的事情——不是带着假想行动</li>\n<li>设计有自顶向下和自底向上两种思路，前者通常先考虑主事件循环，再插入具体事件；后者通常先考虑封装具体任务，再按次序粘合在一起</li>\n<li>出于自我保护，程序员尽量双管齐下——一方面以自顶向下的应用逻辑表达抽象规范，另一方面以函数或库来手机底层的域原语（原子操作）</li>\n<li>实际代码往往是自顶向下和自底向上的综合产物。同一个项目经常同时兼有，这就导致了“胶合层”的出现</li>\n<li>胶合层是个挺讨厌的东西，必须尽可能薄，这一点极为重要。薄胶合层原则可以看做是分离原则的升华。策略（应用逻辑）应该与机制（原子操作集）清晰地分离和解耦。</li>\n<li>“完美之道，不在无可增加，而在无可删减”</li>\n<li>OO语言鼓励“具有厚重的胶合和复杂层次”的体系。当问题域真的很复杂、确实需要大量抽象时，这可能是好事，但如果编程员到头来用复杂的方法来做简单的事情——仅仅是为他们能够这样做，结果便适得其反</li>\n<li><strong>全局变量意味着代码不能重入</strong></li>\n<li>“就我个人而言，如果局部变量太多，我倾向于拆分子程序。另一个方法是看代码行是否存在（太多）缩进。我几乎从来不看代码长度。——Ken Thompson”</li>\n<li>如果通过电话向另一个程序员描述说不清楚，API可能就是太复杂，设计太糟糕了。</li>\n</ul>\n<h3 id=\"文本化\"><a href=\"#文本化\" class=\"headerlink\" title=\"文本化\"></a>文本化</h3><ul>\n<li>序列化有时被称为列集（marshaling），其反向操作（载入）过程称为散集（unmarshaling）</li>\n<li>互用性、透明性、可扩展性和经济性都是设计文本格式和应用协议需要考虑的问题</li>\n<li>设计一个文本协议往往可以微系统的未来省不少力气；使用二进制协议的唯一正当理由是：如果要处理<strong>大批量</strong>的数据集，因而确实关注能否在介质上获得最大位密度，或是关心数据转化时的时间或指令开销。大图像和多媒体数据的格式有时可以算是前者的例子，对延时有严格要求的网络协议有则算作后者的例子</li>\n<li>文本格式的位密度未必一定比二进制格式低多少；设计紧凑二进制格式的思路往往不能够兼顾干净扩展的要求</li>\n<li>数据文件元格式是一套句法和词法约定，已经正式标准化或者通过实践得到充分确定<ul>\n<li>DSV：冒号是默认的分隔符</li>\n<li>RFC 822：字段名不得包含空格，通常用横线代替，空格和tab作为当前逻辑行的延续</li>\n<li>XML：需要文档类型定义（如XHTML）和相关应用逻辑赋予其语义。通常可以语法检查就能发现形式问题或数据错误</li>\n<li>Unix文本文件约定<ul>\n<li>如果可能，以新行符结束的每一行只存一个记录</li>\n<li>每行建议少于80字符</li>\n<li>用<code>#</code>开始注释</li>\n<li>支持反斜线<code>\\</code></li>\n<li>用冒号或连续空白作为字段分隔符</li>\n<li>在节格式中，支持连续行</li>\n<li>要么包含一个版本号，要么将格式设计成相互独立的自描述字节块</li>\n<li>不要只压缩或者二进制编码文件的一部分</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>应用协议设计：如果应用协议是文本式的，那仅凭肉眼就能容易地分析，例：SMTP、POP3、IMAP</li>\n<li>应用协议元格式：应用协议元格式是为了简化网络间事务处理的序列化操作而发展出来的，因为网络带宽要比存储昂贵得多，所以需要重视事务处理的经济性</li>\n<li>目前还没有个制订较完善的元协议非常适合真正的P2P应用，不像客户端-服务器应用——HTTP在这一领域的游刃有余</li>\n</ul>\n<h3 id=\"透明性\"><a href=\"#透明性\" class=\"headerlink\" title=\"透明性\"></a>透明性</h3><ul>\n<li>如果软件系统包含的功是为了帮助人们对软件建立正确的“做什么、怎样做”的心理模型而设计，这个软件系统就是可显的</li>\n<li>用户喜欢UI中的透明性和可显性，是因为这意味着学习曲线比较平缓，而“最小立异原则”就是一个体现</li>\n<li>优雅是力量与简洁的结合。优雅的代码事半功倍；优雅的代码不仅正确，而且<strong>显然</strong>正确；优雅的代码不仅将算法传达给计算机，同时也把简洁和信心传递给阅读代码的人</li>\n<li>编写透明、可显的系统而节省的精力，将来完全可能就是自己的财富</li>\n<li>用户的注意力是宝贵的，让Unix工具正常运行的最好策略是在大部分时间里沉默</li>\n<li>真正的聪明是找到方法，可以访问部分细节，但是又不让它们太显眼</li>\n<li>为透明性和可显性而设计<ul>\n<li>不要在具体操作的代码上叠放太多的抽象层</li>\n<li>透明性和可显性同模块性一样，主要是设计的特性而不是代码的特性<ul>\n<li>程序调用层级最大深度是多少？</li>\n<li>代码是否有强大而明显的不变性质</li>\n<li>API的各函数调用是否正交</li>\n<li>程序的数据结构或分类和它们代表的外部实体间，是否有一一映射关系</li>\n<li>有多少魔法数字</li>\n</ul>\n</li>\n<li><strong>隐藏</strong>细节和<strong>无法访问</strong>细节有着重要区别</li>\n<li>透明的系统更容易实施恢复措施，首先就是更能抵抗bug的破坏</li>\n</ul>\n</li>\n<li>Unix程序员的品性：“宁愿抛弃、重建代码也不远修补蹩脚的代码”</li>\n<li>选择简单的算法</li>\n</ul>\n<h3 id=\"多路程序控制\"><a href=\"#多路程序控制\" class=\"headerlink\" title=\"多路程序控制\"></a>多路程序控制</h3><ul>\n<li>Unix最具特点的程序模块化技法就是将大型程序分解成多个合作进程</li>\n<li>Unix的设计风格强调用定义良好的进程间通信或共享文件来联通小型进程。因此，Unix操作系统提倡把程序分解成更简单的子进程，并专注考虑它们之间的接口<ul>\n<li>降低进程生成的开销</li>\n<li>提供方法（shellout、IO重定向、管道、消息传递、套接字）简化进程通信</li>\n<li>提倡使用简单透明的文本数据格式来通信</li>\n</ul>\n</li>\n<li>真正的难题不在协议语法而是<strong>协议逻辑</strong>——协议必须既有充分的表达能力又有防范死锁的能力</li>\n<li>Unix的IPC分类<ul>\n<li>最简单的形式：调用另一个程序来完成任务；专门程序通常借由文件系统和父进程通信</li>\n<li>管道、重定向和过滤器：过滤器即从标准输入顺序读数据，然后向标准输出写数据；管道操作把程序的标准输出连接到另一个程序的标准输入</li>\n<li>包装器：包装器或者将调用程序专用化，或者为它创建新的接口</li>\n<li>从进程：子程序通过连接到标准输入和标准输出的管道，交互地和调用程序收发数据</li>\n<li>对等进程通信：需要对等的通道<ul>\n<li>临时文件：最古老的的IPC技法，灵活但有风险</li>\n<li>信号：每个信号都对机收进程产生默认作用，进程可以声明<strong>信号处理程序</strong>，让信号处理程序覆盖信号的默认行为<ul>\n<li><code>SIGHUP</code>，重新初始化</li>\n<li><code>SIGTERM</code>，温和的终止</li>\n<li><code>SIGKILL</code>，立即杀死进程</li>\n</ul>\n</li>\n<li>套接字：套接字类似文件描述符，创建时可以指定<strong>协议族</strong>来告诉网络层如何解释套接字名称</li>\n<li>共享内存：共享内存通常依靠<code>mmap</code>，把文件映射成可以被多个进程共享的内存</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"微型语言\"><a href=\"#微型语言\" class=\"headerlink\" title=\"微型语言\"></a>微型语言</h3><ul>\n<li>程序员每百行代码出错率和所使用的编程语言在很大程度上无关</li>\n<li>有两个好方法和一个坏方法做好微型语言的设计<ul>\n<li>预先认识到可以使用微型语言设计把变成问题的规格说明提升一个层次</li>\n<li>注意到规格说明文件格式越来越像微型语言——规格中蕴含着行为</li>\n<li><strong>错误</strong>的方法是通过扩展变成微型语言</li>\n</ul>\n</li>\n<li>微型语言的范畴从声明性发展到命令性，从而逐渐具有通用性，当他们明确为完备图灵机时，它们就是解释器</li>\n<li>样例<ul>\n<li>SNG，PNG的纯文本表达</li>\n<li>正则表达式</li>\n<li>Glade，描述GUI界面的XML文件</li>\n<li>m4，一套宏指令集，规定文本串扩展成其他文本串的方式</li>\n<li>XSLT，描述XML数据的变换</li>\n<li>awk，将文本输入变换成文本输出</li>\n<li>PostScript，向成像设备描述排班文本和图片的微型语言</li>\n<li>bc、dc，任意精度计算</li>\n<li>Emacs Lisp</li>\n<li>JavaScript</li>\n</ul>\n</li>\n<li>设计微型语言<ul>\n<li>控制复杂度，声明性微型语言应该具有一个明确、一直、类自然语言的语法被人类所阅读</li>\n<li>扩展和嵌入脚本语言，实现命令性语言</li>\n<li>编写自定义语法</li>\n<li>慎用宏</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"生成\"><a href=\"#生成\" class=\"headerlink\" title=\"生成\"></a>生成</h3><ul>\n<li>人类其实更善于肉眼观察数据而不是推导控制流程</li>\n<li>数据比程序逻辑更易驾驭</li>\n<li>数据驱动编程：把代码和代码作用的数据结构分清楚，始终把问题层次往上推，尽量把程序逻辑转移到数据中</li>\n<li>专用代码的生成：尽可能少干活，让数据塑造代码，依靠工具，分离机制和策略</li>\n</ul>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><ul>\n<li>无论何时想增加配置选项，最好考虑下下面的问题<ul>\n<li>能省掉这个功能么</li>\n<li>能否有无伤大雅的方式改变程序常规行为</li>\n<li>选项是否过于花哨</li>\n<li>需不需要一个独立的额外程序</li>\n</ul>\n</li>\n<li>Unix的程序配置信息一般在以下5个位置<ul>\n<li><code>/etc</code>下的运行控制文件</li>\n<li>系统设置的环境变量</li>\n<li>用户主目录下的运行控制文件（通常用<code>.</code>开头）</li>\n<li>用户设置的环境变量</li>\n<li>启动程序命令行参数</li>\n</ul>\n</li>\n<li>可执行未见后面加<code>rc</code>表示“运行控制”（命名来自CTSS的runcom命令脚本功能）</li>\n<li>一些最为常见的系统环境变量：<code>USER</code>，<code>LOGNAME</code>，<code>HOME</code>，<code>LINES</code>，<code>SHELL</code>，<code>PATH</code>等</li>\n<li>常见的从<code>-a</code>到<code>-z</code>的命令行选项的可能含义<ul>\n<li><code>-a</code>，所有、添加</li>\n<li><code>-b</code>，缓冲区、批处理</li>\n<li><code>-c</code>，命令、检查</li>\n<li><code>-d</code>，调试、删除</li>\n<li><code>-D</code>，定义</li>\n<li><code>-e</code>，执行、编辑</li>\n<li><code>-f</code>，文件、强制执行</li>\n<li><code>-g</code>，全局</li>\n<li><code>-h</code>，头部、帮助</li>\n<li><code>-i</code>，初始化、交互式</li>\n<li><code>-k</code>，保留、杀死</li>\n<li><code>-l</code>，列表、登录、加载</li>\n<li><code>-m</code>，消息、邮件</li>\n<li><code>-n</code>，数字、否</li>\n<li><code>-o</code>，输出</li>\n<li><code>-p</code>，端口</li>\n<li><code>-q</code>，安静</li>\n<li><code>-r</code>，递归</li>\n<li><code>-s</code>，缄默，大小</li>\n<li><code>-t</code>，标记</li>\n<li><code>-u</code>，用户</li>\n<li><code>-v</code>，冗长</li>\n<li><code>-V</code>，版本</li>\n<li><code>-w</code>，宽度</li>\n<li><code>-y</code>，是</li>\n<li><code>-z</code>，启用压缩</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"接口设计\"><a href=\"#接口设计\" class=\"headerlink\" title=\"接口设计\"></a>接口设计</h3><ul>\n<li>从最小立异原则出发，启动后程序通常从下列来源获得输入或命令<ul>\n<li>程序标准输入端的数据和命令</li>\n<li>通过IPC的输入</li>\n<li>已知位置的文件和设备</li>\n</ul>\n</li>\n<li>最小立异原则不应被理解为在设计中号召机械的保守主义，新颖性提高了用户与接口最初几次的交互成本，但是糟糕的设计永远使接口令人痛苦而多余</li>\n<li>“我们提倡以共生和委派策略来提高代码的复用并降低软件复杂度”</li>\n<li>最小立异原则目的就是为了减少用户在使用接口时必须学习的复杂过程</li>\n<li>Unix接口设计历史：CLI &#x3D;&gt; X</li>\n<li>接口的5种度量标准：<strong>简洁、表现力、易用、透明和脚本化能力</strong><ul>\n<li>简洁：事务处理需要的时间和复杂度需要有上限</li>\n<li>表现力：接口可以触发广泛的行为</li>\n<li>易用性：接口要求用户记忆的东西较少</li>\n<li>透明度：用户使用接口时，几乎不用记忆什么问题、数据或者程序状态</li>\n<li>脚本能力：容易被其他程序使用</li>\n</ul>\n</li>\n<li>CLI和可视化接口的对比<ul>\n<li>CLI更具表达力、脚本化能力、简洁性，适用于举例：SQL</li>\n<li>可视化接口透明度、易用性较好，适用性举例：画图、网页浏览器</li>\n<li>随着用户越来越熟练，对CLI接口的抵触也越少</li>\n</ul>\n</li>\n<li>Unix接口设计模式<ul>\n<li>过滤器：接受输入，转换成其他格式，再输出到标准输出端；宽进严出、不丢弃不需要的信息、不增加无用数据</li>\n<li>cantrip（没有输入输出）、源模式（无输入且输出在启动条件中控制）、接收器模式（接收输入但不发送东西到输出）、编译器模式（无标准输入输出，但会发送信息到标准错误端）</li>\n<li>ed模式（编辑器模式）</li>\n<li>roguelike模式（来自BSD的地牢探险游戏rogue，用字符阵列显示界面UI），如vi、emacs，没有鼠标参与，适合指法熟练的人</li>\n<li>引擎和接口分离，又或者模型和视图分离，了解MVC模式的人自然了解<ul>\n<li>配置者、执行者</li>\n<li>假脱机、守护进程</li>\n<li>驱动、引擎</li>\n<li>客户端、服务端</li>\n</ul>\n</li>\n<li>基于语言的接口模式</li>\n</ul>\n</li>\n<li>浏览器作为通用前端</li>\n<li><strong>如果程序没有什么有趣的或者惊奇的东西要说就应该闭嘴</strong>（有点意思）</li>\n</ul>\n<h3 id=\"优化\"><a href=\"#优化\" class=\"headerlink\" title=\"优化\"></a>优化</h3><ul>\n<li>Unix的经验告诉我们最主要的就是如何知道何时不去优化</li>\n<li>最强大的优化技术就是<strong>不去优化</strong></li>\n<li>先估量，后优化，直觉是糟糕的向导</li>\n<li>最有效的代码优化方法是保持代码短小简单</li>\n<li>核心数据结构必须留在最快的缓存</li>\n<li>吞吐量和延迟时间的权衡是普遍现象，例TCP、UDP</li>\n<li>对于减少延迟来说，阻塞或等待中间结果都是致命的</li>\n<li><strong>按需计算</strong>出昂贵的结果，再<strong>缓存</strong>起来之后使用，可以兼得<strong>低延迟</strong>和<strong>高吞吐</strong></li>\n</ul>\n<h3 id=\"复杂度\"><a href=\"#复杂度\" class=\"headerlink\" title=\"复杂度\"></a>复杂度</h3><ul>\n<li>简单即美即雅即善，而复杂即丑即怪即恶</li>\n<li>程序员为了理解一个程序，会建立思维模型并调试之；程序的复杂度即模型建立和程序调试的困难程度</li>\n<li>Unix思想的一个主题就是<strong>工具小巧锐利，设计从零开始，接口简单一致</strong></li>\n<li><strong>偶然复杂度</strong>的产生是因为没有找到实现规定功能集合的最简方法，可以通过良好设计去除；<strong>选择复杂度</strong>和期望的功能相关联，只能通过修改工程目标解决</li>\n<li>计算资源以及人类的思考，同财富一样，不是靠储藏而是靠消费来证明价值的</li>\n<li><strong>选择需要管理的上下文环境，并且按照边界所允许的最小化方式构建程序</strong></li>\n</ul>\n<h2 id=\"Implementation\"><a href=\"#Implementation\" class=\"headerlink\" title=\"Implementation\"></a>Implementation</h2><h3 id=\"语言\"><a href=\"#语言\" class=\"headerlink\" title=\"语言\"></a>语言</h3><ul>\n<li>C和C++以增加实现时间和（特别是）调试时间为代价来优化效率</li>\n<li>C的内存管理是复杂性和错误的渊薮</li>\n<li>C语言最佳之处是资源效率和接近机器语言，糟糕的地方是槟城简直是资源管理的炼狱</li>\n<li>C++试图满足所有人的所有要求</li>\n<li>Perl是增强版的shell，它为替代<code>awk</code>而设计，适合大量使用正则表达式的地方</li>\n<li>Java的设计目标是“write once, run anywhere”，但它并没有实现这两个最初的设计目标</li>\n<li>Java对小项目是大材小用</li>\n<li>Emacs Lisp传统上只用于为Emacs编辑器编写本身的控制程序</li>\n</ul>\n<h3 id=\"重用\"><a href=\"#重用\" class=\"headerlink\" title=\"重用\"></a>重用</h3><ul>\n<li>重新发明轮子之所以糟糕不仅因为浪费时间，还因为它浪费的时间往往是平方级</li>\n<li>避免重新发明轮子的有效方法就是借用别人的设计和实现，即重用代码</li>\n<li>文档并不能传达代码具现的所有细微差别之处</li>\n<li>开放源码和代码重用的关系，许多地方很像浪漫爱情和有性生殖的关系</li>\n<li>设计最好的实践需要情感的投入；软件开发者，同其他任何类型的工匠和技师一样；他们想要成为艺术家，这并不是什么私密。他们有艺术家的动力和需求，也拥有听众的欲望</li>\n<li>开放源码是从意识形态上解决这些所有问题的优先方法</li>\n<li>发布不够格软件的作者会承受许多的社会压力来修正或撤回代码（不一定）</li>\n<li>阅读代码是为未来而投资</li>\n<li><h2 id=\"许可证-许可证能够授权代码以某种形式使用，否则在版权法之下是禁止或者需要付费的-非商业使用的许可证并不等同于开源许可证\"><a href=\"#许可证-许可证能够授权代码以某种形式使用，否则在版权法之下是禁止或者需要付费的-非商业使用的许可证并不等同于开源许可证\" class=\"headerlink\" title=\"许可证- 许可证能够授权代码以某种形式使用，否则在版权法之下是禁止或者需要付费的- 非商业使用的许可证并不等同于开源许可证\"></a>许可证<br>- 许可证能够授权代码以某种形式使用，否则在版权法之下是禁止或者需要付费的<br>- 非商业使用的许可证并不等同于开源许可证</h2></li>\n</ul>\n<h2 id=\"Community\"><a href=\"#Community\" class=\"headerlink\" title=\"Community\"></a>Community</h2><h3 id=\"可移植性\"><a href=\"#可移植性\" class=\"headerlink\" title=\"可移植性\"></a>可移植性</h3><ul>\n<li>C语言基于早期Ken Thompson的B语言解析器，脱胎于BCPL（Basic Common Programming Language），因此这个C代表Common（通用）</li>\n<li>在IETF传统中，标准必须来自于一个可用原型实现的经验；不幸的是，这并不是标准通常发展的方式</li>\n<li>搞笑RFC大概是唯一能够立即成为RFC的提议，比如RFC 1149（IP数据报的信鸽传递），RFC 2324（超文本咖啡壶控制协议）</li>\n<li>对于具备提倡标准资格的RFC，其规格必须稳定，经过同行评审，并且已经吸引了互联网社区的极大兴趣</li>\n<li>IETF标准化过程有意提倡由实践而非理论驱动的标准化过程</li>\n<li>国际化的首要动作：<strong>分离信息库（配置）和代码</strong></li>\n<li>“暗含的意思就是，成为标准的最好方法就是发布一个高质量的开源实现” —— Henry Spencer</li>\n</ul>\n<h3 id=\"文档\"><a href=\"#文档\" class=\"headerlink\" title=\"文档\"></a>文档</h3><ul>\n<li>“一切皆HTML，所有引用都是URL”</li>\n<li>绝大多数软件的文档都是由技术人员写给可能连最小公分母都不知道的普通大众的——渊博者写给无知者</li>\n<li>编写Unix文档的最佳实践<ul>\n<li>数量多不会被认为是质量高</li>\n<li>信息密度适中，少用屏幕截图</li>\n<li>没人喜欢庞大的文档，考虑提供快速的摘要</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"开放源码\"><a href=\"#开放源码\" class=\"headerlink\" title=\"开放源码\"></a>开放源码</h3><ul>\n<li>开源开发的规则<ul>\n<li>源码公开</li>\n<li>尽早发布，经常发布</li>\n<li>给贡献以表扬</li>\n</ul>\n</li>\n<li><code>major.minor.patch</code>，补丁号修正错误和次要功能；次版本号为兼容的新功能；主版本号为不兼容的更改</li>\n<li><strong>发布前对文档和README进行拼写检查</strong></li>\n<li>基于所需功能而不是平台来编写移植层（面向接口编程）<ul>\n<li>“<code>#ifdef</code>和<code>#if</code>是最后一招，这通常是思路不当、产品过度差异化，无理由‘优化’或是无用垃圾聚集的先兆” —— Doug Mcllroy</li>\n</ul>\n</li>\n<li>选择一个编码规范（lint）</li>\n<li>常见的标准文件命名规范<ul>\n<li>README</li>\n<li>INSTALL</li>\n<li>AUTHORS</li>\n<li>NEWS</li>\n<li>HISTORY</li>\n<li>CHANGES</li>\n<li>COPYING 项目许可证条款</li>\n<li>LICENSE</li>\n<li>FAQ</li>\n</ul>\n</li>\n<li>以版本号来命名目录，考虑多版本在同一系统共存</li>\n<li>在设计讨论中更广泛的参与常常是件好事，但是如果列表相对开放，迟早就会有些用户在其上询问一些初级问题</li>\n<li>开源许可证<ul>\n<li>MIT：授予无限权利的拷贝、使用、修改和对修改的再发布，只要在所有修改版本中保留版权和许可证条款</li>\n<li>BSD：授予无限权利的拷贝、使用、修改和对修改的再发布，只要在所有修改版本中保留版权和许可证条款；同时在广告和软件包相关文档中包含致谢</li>\n<li>Artistic：授予无限权利的拷贝、使用和本地修改的权利。允许在发行修改后的二进制版本，但是限制源码再发行</li>\n<li>GPL、Mozilla</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"未来\"><a href=\"#未来\" class=\"headerlink\" title=\"未来\"></a>未来</h3><ul>\n<li>分离机制（配置）与策略（算法）成为一个明确准则</li>\n<li>Unix文件仅仅是个字节大袋子，而没有其他文件属性</li>\n<li><strong>开放源码将软件业转变为服务业</strong></li>\n</ul>\n<p><em>–END–</em></p>\n",
            "tags": [
                "设计模式",
                "Unix"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2021/01/05/2020-to-2021/",
            "url": "http://shenlvmeng.github.com/blog/2021/01/05/2020-to-2021/",
            "title": "2020回顾暨2021展望",
            "date_published": "2021-01-05T15:32:20.000Z",
            "content_html": "<p>2019年写下第一篇<a href=\"https://shenlvmeng.github.io/blog/2019/01/03/2018-to-2019/\">总结</a>的时候，也未曾想到，这会成为一种一年一度的仪式，甚至能吸引到听众。但既然开始了，最好也能坚持下去。</p>\n<p>如果说2019充满意外的话，2020只会是加大分量。不论是喜悦还是痛苦，2020留下的印记都格外得深一些。整体来看，由于遇到了一些预料之外的事情，在自我提升上向陌生方向多走了一些，不知是好是坏。</p>\n<h2 id=\"2020回顾\"><a href=\"#2020回顾\" class=\"headerlink\" title=\"2020回顾\"></a>2020回顾</h2><p>内在素质上，阅读技术非技术方面的书籍完成5本，小说6本。基本完成任务。</p>\n<ul>\n<li><a href=\"https://shenlvmeng.github.io/blog/2019/12/24/golang-learning/\">Go语言入门学习</a></li>\n<li><a href=\"https://shenlvmeng.github.io/blog/2020/05/31/pragmatic-thinking-and-learning/\">《程序员思维修炼》—— 思维方式和学习技巧</a></li>\n<li><a href=\"https://shenlvmeng.github.io/blog/2020/06/01/principles-of-macroeconomics/\">《经济学原理》 - 宏观经济学原理笔记</a></li>\n<li><a href=\"https://shenlvmeng.github.io/blog/2020/08/12/soft-skills-for-software-developer/\">《软技能 —— 代码外的生存指南》书摘</a></li>\n<li><a href=\"https://shenlvmeng.github.io/blog/2020/08/17/refactoring-design-improvement/\">重构 —— 代码的实用性与艺术性</a></li>\n</ul>\n<p>整体还是在东看看西看看的阶段，其中《程序员思维修炼》一书对思维方式的介绍补足了自己的知识体系中方法论的部分。《软技能》一书启发了在理财方面的一些认识。</p>\n<p>大多数的书还是看了又忘，忘了就再看看总结，然后再淡忘。这个过程中，留在知识体系里幸存的部分并不多。尤其是编程相关的书籍，还是需要靠实践做项目来巩固所看的内容。没错，说的就是《Go语言入门学习》。</p>\n<p>个人形象上，作息时间基本达到预期计划。但由于出现了新爱好（调酒），买衣服的计划被长期搁置。工装裤和卫衣还是去年那些，果然这两样买再多都不够。体重略有下降，回到80。算是基本完成目标。发型在推平后，又往偏分的方向留了起来，和此前的侧背区别不甚大。短发在身边朋友的反馈里居然还不错。</p>\n<p>社交上，丢失和主动放弃了一些朋友，大多是三观不合或者事业变动。在和朋友的沟通交往中，更偏向主动。不过长期如此，还挺累的。热情不用更热情了，倒是应该更加增大交友面。有试图发展亲密关系的朋友，在对象上有过努力，也同时认识到很多道理，此处略去。</p>\n<p>生活情趣上，在骑车、拉琴、看电影上仍旧投入较多业余时间，其中骑车的设备也一直还是那辆老旧的山地车。拉琴和看电影上也没有什么投入。同时，发展了喝酒和调鸡尾酒的爱好。在冰箱中屯了很多，对基酒和调酒也有了些认识。骑行上，因为圣僧的工作变动，离开了北京，一位年轻的同事成为了新的骑友。百里画廊未能成行，但是<a href=\"https://shenlvmeng.github.io/blog/2020/10/06/tour-to-qinghai-lake/\">青海湖</a>成功成行，也是一次难忘的经历。旅行上，疫情原因日本没去成，年末去了广州，吃了好吃的一本满足。拉琴上，一直也有练习，有能熟练演奏的曲目，不过都还需要看谱演奏。另外，也在公司内做过相关分享。新爱好上，看了第一次话剧，livehouse一直没遇到喜欢的乐队，未能成行。另外因为厨房卫生问题，在家做饭频率下降，反而提高了探店的频率。整体看，生活还蛮有趣味。</p>\n<p>工作事业上，发展尚可，背靠还不错的项目组，也遇到了很多挑战，有了带小方向的机会，在团队建设上也开始有了思考。不过进步速度在下半年有所减缓，注意力有些偏移。希望在下一年能调整过来。</p>\n<h3 id=\"简单说几句\"><a href=\"#简单说几句\" class=\"headerlink\" title=\"简单说几句\"></a>简单说几句</h3><ul>\n<li>积累太过理想化书面化，积累些现实点的东西，不是坏事</li>\n<li>穿衣上，裤长是最严重的问题</li>\n<li>要少喝酒，小酌小酌</li>\n<li>坚持作息和三餐，坚持骑行登山游泳轧马路</li>\n<li>要能清醒思考个人价值和现实价值</li>\n<li>一段长久的亲密关系应该是相互成就而不是相互束缚的</li>\n<li>爱合理分布在亲人、伴侣、朋友身上</li>\n<li>事业上决断力要提高，还要画饼能力，越大越好</li>\n</ul>\n<h2 id=\"2021展望\"><a href=\"#2021展望\" class=\"headerlink\" title=\"2021展望\"></a>2021展望</h2><p>OK，又到了flag时间。吸取前两年的经验，目标不宜太明确，往往有意外惊喜。</p>\n<ul>\n<li><strong>内在</strong>：看完囤积的4本业务书籍和10本左右小说<ul>\n<li>再寻找一项和前端覆盖率类似的技术点去探索突破</li>\n<li>能清醒地评估个人价值，先知己</li>\n<li>回顾过去几年积累，完善知识体系</li>\n</ul>\n</li>\n<li><strong>外在</strong>：尝试新风格，保持健康，坚持运动<ul>\n<li>坚持吃早饭和早睡</li>\n<li>增加锻炼频率</li>\n<li>发型尝试</li>\n<li>基本款补齐（同去年）</li>\n</ul>\n</li>\n<li><strong>情感</strong><ul>\n<li>平衡爱的收入和支出，更有自信</li>\n<li>能给一个人未来</li>\n</ul>\n</li>\n<li><strong>生活</strong><ul>\n<li>寻找一些提高生活幸福感的小东西或者经验</li>\n<li>保持室内干净卫生</li>\n<li>必要的旅行</li>\n<li>固定的户外长途骑行</li>\n<li>尝试新的菜式</li>\n<li>坚持拉琴、电影、探店</li>\n<li>至少一次livehouse</li>\n</ul>\n</li>\n<li><strong>事业</strong><ul>\n<li>思考职业规划和发展路线</li>\n<li>考虑落脚城市、医疗、教育等现实因素</li>\n<li>也去考虑父母的未来生活质量</li>\n</ul>\n</li>\n</ul>\n<p>就这么多吧，流水账短点为妙。诸位明年见~</p>\n<p><em>Bye~</em></p>\n",
            "tags": [
                "总结",
                "2020",
                "2021"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2020/10/06/tour-to-qinghai-lake/",
            "url": "http://shenlvmeng.github.com/blog/2020/10/06/tour-to-qinghai-lake/",
            "title": "记青海湖骑行",
            "date_published": "2020-10-06T12:02:17.000Z",
            "content_html": "<blockquote>\n<p>随便写写。旅程中的大多数美好，事后回忆，原来都在造化中。</p>\n</blockquote>\n<h2 id=\"序：准备阶段\"><a href=\"#序：准备阶段\" class=\"headerlink\" title=\"序：准备阶段\"></a>序：准备阶段</h2><p>这次旅行本该在<a href=\"https://shenlvmeng.github.io/blog/2019/09/16/tour-to-lijiang-and-dali/\">去年国庆</a>成行，由于假期有限等种种原因delay到今年这个长假。又碰巧赶上疫情和中秋带来的额外假期，于是7、8月便早早和档期向来紧张的圣僧约好。圣僧和我本是隔壁宿舍关系，从3年多前的一次结伴骑行结缘，是我的长期骑友。他是个旅行达人（友链一波：<a href=\"https://feichashao.com/travels/\">肥叉烧</a>），身在外企，有钱有闲，经常出游，经验丰富。正巧这次碰上疫情，国外无处可去，和我定好日程后，三下五除二便把攻略搞定。和他一起出游真是省心。</p>\n<h2 id=\"Day-1：银川\"><a href=\"#Day-1：银川\" class=\"headerlink\" title=\"Day 1：银川\"></a>Day 1：银川</h2><p>出于下面多个因素考虑（其实主要是第三项），我们第一天先出发去银川。</p>\n<ul>\n<li>假期时间充裕</li>\n<li>慢慢适应高海拔</li>\n<li>中转机票更便宜</li>\n<li>凭借圣僧的会员，中转免费送一晚住宿外加去市区的大巴券</li>\n</ul>\n<p>因为这次是从大兴机场出发，还是8点半的飞机，早上5点就得起床。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00ltL6.jpg\" alt=\"清晨的知春路口\"></p>\n<p>我们在机场值机柜台碰面，托运完行李时间已经不早了，于是直接就安检进站。安检中还没收了我的修车工具（😢）。这也是这一路意外离开我的第一样东西。突然到我都没拍张照给它留个纪念。</p>\n<p>进站后，借助圣僧招行信用卡会员，一起在VIP休息厅吃了个早餐，条件还不错。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00les0.jpg\" alt=\"VIP休息厅视角\"></p>\n<p>9月26号的银川天气不错，我们住宿的酒店——西港航空饭店距离银川河东机场非常近。酒店建筑整体很新，周围被各种绿化围绕，完全感觉不到在西北。另外房间很大，由于远离市区，环境也很安静。加上是中转免费送的，算是我们整个旅程中最满意的住宿体验了。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00lMoF.jpg\" alt=\"西港-1\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00lKdU.jpg\" alt=\"西港-2\"></p>\n<p>在房间里稍作休息，我们步行到机场坐大巴前往市区，大巴券25元一位，我们使用的中转服务的免费大巴券直接乘车。大约1小时车程，我们在终点站鼓楼下车便进入了市中心。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00luZT.jpg\" alt=\"鼓楼\"></p>\n<p>稍微逛逛，我和圣僧很快就发现了多不胜数的<strong>蜜雪冰城</strong>，几乎不见其他知名品牌，剩下的也都是没听过名字的小牌子。在竞争上，蜜雪冰城比上有其很能打的性价比，比下又有标准化保证。4元的柠檬水、5元的奶茶、2元的圆筒冰淇淋。天哪，这也太香了。蜜雪冰城也将成为我们后面旅程中的一大精神寄托，按下不表。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00lmLV.jpg\" alt=\"蜜雪冰城\"></p>\n<p>作为回族自治区的省会，菜单中自然没有猪肉，取而代之的是各种<strong>羊肉</strong>。从鼓楼步行街向西走过几个路口，我们惯例性在地在邮局寄了明信片。随后在旁边的迎宾楼吃了午饭，尝了下号称特色的手抓羊肉。这么一盘98元，没想象中好吃，吃了三分之一就有点腻了。最后打包给圣僧当了晚餐。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00lli4.jpg\" alt=\"手抓羊肉\"></p>\n<p>吃饱喝足，下个目标是带些伴手礼。宁夏的<strong>枸杞</strong>是比较出名的，其中以中卫的为最优。枸杞分红枸杞和黑枸杞，都没有明确的药用价值。但是日常保健还是有用的，号称能补气虚，很适合阳气虚弱的男性。黑枸杞据说劲儿更野一点。稍微做了下功课，我们在超市一人来了2斤，一斤75元。事后看，这个价格似乎有些上当，建议各位小买怡情即可。</p>\n<p>银川城区内的共享单车似乎都是电动车，不论是青桔还是小蓝，还是美团单车。在一天的观察下，只注意到凤毛麟角的人力单车。这到底是因为当地人自行车技术很烂还是电动车驾驶技术很普及？挺有意思。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00l3W9.jpg\" alt=\"共享单车\"></p>\n<p>天色渐暗，在人民公园感受了城市氛围后，我们乘坐大巴回到西港航空饭店，为第二天前往西宁做准备。</p>\n<h2 id=\"Day-2-西宁\"><a href=\"#Day-2-西宁\" class=\"headerlink\" title=\"Day 2: 西宁\"></a>Day 2: 西宁</h2><p>西宁相比银川更有省会的感觉。不同于银川的回族居多，西宁有着比较明显的藏族气息，藏民也很常见。高海拔的强烈紫外线下，大多数人都是黝红的脸。由于第二天要坐大巴前往西海镇，我们这一天住在汽车站旁边的如家，在市区中处于偏东郊的位置。不出意外，楼下又是一家蜜雪冰城。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00l1JJ.jpg\" alt=\"酒店\"></p>\n<p>西宁城区内有湟水自西向东流过，我们下午先是打车到了河边的<strong>中心广场</strong>，类似北京的元大都城垣遗址一样，不过明显更大且更有层次，湟水河宽度近似海河。在河边坐也好，走也好，感觉都是很不错的。下午3点，气温十余度，在河边的长椅上，一直都能看到飞机在高楼的天际线上划过。</p>\n<p>西宁海拔约2100左右，处于多个山脉中的河谷地区，适宜建设城市的面积不大，只有大概一个十字形状的区域。所以城区中的楼房都格外的高，且能看出一些地势起伏。整体感觉，似乎来到了小号版的重庆。和重庆一样，这里看不到共享单车。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00l8zR.jpg\" alt=\"城市景观\"></p>\n<p>不过从一些城市的角落，还是能瞥见藏在深处的旧工业时代的厂房气息。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00lJQ1.jpg\" alt=\"旧厂房\"></p>\n<p>我比较偏好用随便走走四处看看的方式感受城市的风格。下午我们从中心广场绕过<strong>力盟商业区</strong>，再穿过九龙城寨般的<strong>商业巷大世界</strong>，从<strong>人民公园</strong>门口向回走，最后又回到颇具人气的力盟步行街。不能免俗，吃了顿呷哺呷哺。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00lYsx.jpg\" alt=\"呷哺呷哺\"></p>\n<h2 id=\"Day-3-西海镇-种羊场\"><a href=\"#Day-3-西海镇-种羊场\" class=\"headerlink\" title=\"Day 3: 西海镇 - 种羊场\"></a>Day 3: 西海镇 - 种羊场</h2><blockquote>\n<p>里程：48km</p>\n</blockquote>\n<p>去西海镇的车票我们是提前一天买好的，25元。但因为游客不多，其实也可以当天早上买。从火车站背后上京藏高速，一路穿过湟中区、湟源县、海晏县就到达了最终骑行的出发点西海镇，全程约2小时。租车上，我们早已提前和当地租车师傅约好，6天行程，租车500元，外加解决住宿700元（对租车店老板安排的住宿不要抱太高期望）和押金500元（结束骑行后退还），一共1700元。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003oq0.jpg\" alt=\"西宁到西海镇\"></p>\n<p>西海镇是海北藏族自治州的州首府，不过却意外的荒凉，街道两边政府部门倒是周正齐全，基础设施也是一应完善，可是就是人迹稀少，连车都没几辆。我们下车后已经10点，第一天尚有40多公里的路程要骑。我们调试好车辆，装好驮包，穿戴好装备，擦好防晒（这个十分重要），简单吃了个饭就出发了。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003Q29.jpg\" alt=\"出发合影\"></p>\n<p>沿着刚察路直走，穿过和G213国道的路口，就上了环湖东路。沿着环湖东路直走就可以达到第一天的目的地——湖东种羊场。路线也是相当简单。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003KC4.jpg\" alt=\"路牌\"></p>\n<p>初见丘陵和草原，配合着壮观的云层，还是很有新鲜感的。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003n5F.jpg\" alt=\"草原1\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003mUU.jpg\" alt=\"草原2\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003M8J.jpg\" alt=\"山丘1\"></p>\n<p>第一天的路并不像路书中那样全是平路，相反上下坡并不少。幸运的是，路边的景观稍微减缓了骑行的疲惫感。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/0033K1.jpg\" alt=\"上坡1\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003lvR.jpg\" alt=\"上坡2\"></p>\n<p>穿过和G213国道的分岔路口后，我们离湖越来越近了。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003YVK.jpg\" alt=\"996\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003Gb6.jpg\" alt=\"路牌\"></p>\n<p>随着湖水越来越近，金银潭和沙岛上起伏的沙丘却是也越来越显眼。湖边的荒漠化土地是我预先没想到的，据说是气候原因导致。但从沿路看到的各种牛羊来推断，和过度放牧可能也有些关系。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/0038Dx.jpg\" alt=\"沙漠1\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003N5D.jpg\" alt=\"牦牛1\"></p>\n<p>穿过金银滩沙漠区，是一个大下坡，下坡后路两侧又逐渐恢复了植被和河流，看起来顺眼多了。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003aPe.jpg\" alt=\"大下坡\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003tUO.jpg\" alt=\"绿地\"></p>\n<p>青海湖边地广人稀（整个青海除了西宁和海东应该都是地广人稀），除了风声，路两旁十分宁静，若是没有毒辣的紫外线，实在惬意极了。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003d8H.jpg\" alt=\"车1\"></p>\n<p>再往前骑数公里，终于到达种羊场。这并不是一个镇或县，顶多是围绕湖东种羊场的一个聚落。住宿环境自然十分感人。卫生糟糕，门窗都可以从外面打开。具老板所说，这里民风淳朴，姑且只能信了。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003w2d.jpg\" alt=\"种羊场住宿\"></p>\n<p>幸好有<strong>炕锅羊肉</strong>和壮观的落日场景可以抚慰。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003rrt.jpg\" alt=\"炕锅羊肉\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/0030xA.jpg\" alt=\"落日1\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003DKI.jpg\" alt=\"落日2\"></p>\n<p>青海湖周围海拔3200到3400，昼夜温差较大，太阳一落山，气温就比较冷了。种羊场也无甚可逛，我们直接倒头就睡，洗漱更衣直接放弃。只期待第二天住宿能好点。</p>\n<h2 id=\"Day-4-种羊场-江西沟\"><a href=\"#Day-4-种羊场-江西沟\" class=\"headerlink\" title=\"Day 4: 种羊场 - 江西沟\"></a>Day 4: 种羊场 - 江西沟</h2><blockquote>\n<p>里程：55km</p>\n</blockquote>\n<p>第二天一早我们吃了点买好的干粮，擦了防晒就直接出发。种羊场实在没什么好留恋。青海湖环湖的路都很直，两侧要么是无边的草原，要么是起伏的山丘，要么是看不到头的湖面。以至于路也看不到终点，似乎永远都骑不到头。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003sqP.jpg\" alt=\"路1\"></p>\n<p>不过在骑行中，能察觉到远处的村庄、山岭、景观一点点靠近，还是蛮奇妙。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/0036Vf.jpg\" alt=\"路2\"></p>\n<p>路边是牧民们的牛羊，似乎和内地的品种并不相同。牦牛们都很沉默，羊们也是，我蹩脚地起个头，它们也只是懒懒地抬个头望向我，依旧沉默。马儿们有的自由吃草，被人看管的则用来招徕游客骑行创收。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003WGQ.jpg\" alt=\"牛\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003ca8.jpg\" alt=\"羊\"></p>\n<p>骑过错果，便告别了环湖东路S207，来到G109国道，相比环湖东路，国道上的车辆明显多了很多。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003RPg.jpg\" alt=\"错果\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003gIS.jpg\" alt=\"路牌2\"></p>\n<p>从环湖东路和G109的交叉口到二郎剑景区，靠湖一侧都有维护良好的辅路，路面起伏不大，还有成片的油菜花可以欣赏，油菜花都不高，游客在其中拍照能露出脑袋，从车上看颇有趣味。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003f2j.jpg\" alt=\"油菜花\"></p>\n<p>路的另一侧是连绵的不知疲倦的山丘，它将一路陪伴我们告别G109国道。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003hxs.jpg\" alt=\"山丘2\"></p>\n<p>临近二郎剑景区有可以直接接近湖面的地方。这是一路第一次能亲近湖水的机会。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/003Irq.jpg\" alt=\"青海湖\"></p>\n<p>在二郎剑边的中石油稍作休息，是一路枯燥的景观，16km后便到达终点江西沟。令人欣慰的是，住宿环境有了些微的改善。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/0035Mn.jpg\" alt=\"江西沟住宿\"></p>\n<h2 id=\"Day-5-江西沟-黑马河-x2F-茶卡\"><a href=\"#Day-5-江西沟-黑马河-x2F-茶卡\" class=\"headerlink\" title=\"Day 5: 江西沟 - 黑马河&#x2F;茶卡\"></a>Day 5: 江西沟 - 黑马河&#x2F;茶卡</h2><blockquote>\n<p>里程：48km</p>\n</blockquote>\n<p>这一天的里程虽然不长，却是环湖几天中，最疲惫的。原因是没有止境的逆风。一路上，景观和前一天无异，枯燥的山丘和草原，连湖面也不太能看见了。因为恼火的逆风，我甚至都没心情抬头看看路两旁的风景。</p>\n<p>也许是因为大风把碎云都卷走，天上的云倒是挺好看。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00JeVP.jpg\" alt=\"云1\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rb8I.jpg\" alt=\"云2\"></p>\n<p>我大约提前圣僧1个小时到达，考虑到高原和糟糕的风向，圣僧临时修改计划，将第二天的茶卡盐湖之旅提前，把本来一天到达刚察县的计划拆成石乃亥 - 刚察县。这一决定不仅让我们看到了茶卡盐湖上的落日，也极大提升了后两天的骑行体验。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00Jn58.jpg\" alt=\"黑马河\"></p>\n<p>黑马河位于G109和<strong>环湖西路</strong>S209的交叉口，前往茶卡、鸟岛，大西北自驾环线、环湖骑行都要经过这里。本来是发展不错的一个小镇。近些年考虑到环保因素，拆了大多数建筑，统一由政府管理建设，道路管道也大兴土木整修，目前看起来完全感受不到当地人所说当初的繁华。</p>\n<p>我们运气不错，碰巧民宿老板要前往茶卡办公事，在圣僧下午3点到达后，我们搭了个便车去往茶卡（来回两人300元）。走G109去茶卡镇要穿越橡皮山，最高海拔3800m，且单程80km。对于骑行来说不太现实。老板比较健谈，一路和我们介绍了青海湖的旅游发展以及周边地理人文，挺有意思。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00JKPS.jpg\" alt=\"橡皮山1\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00JmUf.jpg\" alt=\"橡皮山2\"></p>\n<p>茶卡盐湖的风景十分看天气。晴天无风的天气下，才有天空之镜的感觉。我们去的那天虽然晴空万里，不过风力较大，差不多夕阳落山时，西风终于转弱，得以让我拍到下面的景象。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00JVbt.jpg\" alt=\"夕阳3\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00JM8g.jpg\" alt=\"夕阳4\"></p>\n<p>盐湖门票原价60，对青海、湖北、浙江籍游客免票。小火车单程50，车速和步行差不多，没有强需求可以不做。小火车沿着一条向湖区深处的路一直开到最里面，大约30分钟。路的西边湖水较浅，许多已蒸干出盐巴，还能看到湖盐厂的旧铁路和新厂址。许多游客穿着租赁的胶鞋在水面嬉戏。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00JQ2Q.jpg\" alt=\"盐湖游客\"></p>\n<p>搭配雪一样的湖盐，有种北极村的感觉。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00Jlvj.jpg\" alt=\"&quot;北极村&quot;\"></p>\n<p>坐车回到黑马河时已经晚上9点了，晚饭是<strong>牦牛肉串</strong> + 牛肉面，巴适得很。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00J3Ks.jpg\" alt=\"肉串加牛肉面\"></p>\n<h2 id=\"Day-6-黑马河-石乃亥\"><a href=\"#Day-6-黑马河-石乃亥\" class=\"headerlink\" title=\"Day 6: 黑马河 - 石乃亥\"></a>Day 6: 黑马河 - 石乃亥</h2><blockquote>\n<p>里程：39km</p>\n</blockquote>\n<p>没有了恼人的逆风后，这一天好骑多了（再加上里程短，应该是环湖最轻松的一天）。骑出黑马河镇，就和G109国道告别，上了环湖西路，车辆明显稍多了，整体体验大大提升。经过一段笔直的路程，可以绕到离湖不远的地方，接下来的一路也都如此，还能时不时看到自驾游的游客在路边拍照。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00J8rn.jpg\" alt=\"湖边\"></p>\n<p>等接近石乃亥后，我们便离湖越来越远。经过一个小上坡，便能远远看到石乃亥乡的轮廓了。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rrE4.jpg\" alt=\"小上坡1\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rcCR.jpg\" alt=\"小上坡2\"></p>\n<p>石乃亥不大，基础设施倒是挺完善。由于到得比较早，我们很轻松吃了个<strong>土火锅</strong>作为午饭。土火锅里面有牦牛肉和各种素菜，价格145，还算划算。我们大快朵颐了快1个小时，最后也没吃完。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00ry59.jpg\" alt=\"土火锅\"></p>\n<h2 id=\"Day-7-石乃亥-刚察县\"><a href=\"#Day-7-石乃亥-刚察县\" class=\"headerlink\" title=\"Day 7: 石乃亥 - 刚察县\"></a>Day 7: 石乃亥 - 刚察县</h2><blockquote>\n<p>里程：78km</p>\n</blockquote>\n<p>骑出石乃亥约20公里，我们告别了海南共和县，来到海北刚察县境内。一如往常又是广袤的草原和起伏的山丘。骑过关闭的鸟岛，就来到了湖边的最后一段路。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rg81.jpg\" alt=\"湖羊\"></p>\n<p>站在环湖东路的末尾处回头望，能看到最后一片湖面的波光粼粼。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00r2gx.jpg\" alt=\"波光粼粼\"></p>\n<p>从岔路口右拐上G315国道，会贴着青藏铁路走一段。之后越过新修的西和高速便进入县城内。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rRv6.jpg\" alt=\"岔道\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rhDO.jpg\" alt=\"铁路1\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00r4bD.jpg\" alt=\"铁路2\"></p>\n<p>刚察县虽然只是个县城，但是热闹程度和城市美化程度一点不亚于西海镇，甚至更甚。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rIVe.jpg\" alt=\"刚察县\"></p>\n<p>县城里的藏城电影院也在营业，虽然放映厅很小，还没有大学大教室大，但两人包场看《我和我的故乡》的体验还不错。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00roUH.jpg\" alt=\"刚察电影院\"></p>\n<p>吃厌了羊肉，我们晚饭在一家成都冒菜馆解决了晚饭，能有吃菜自由的感觉真好。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rHPA.jpg\" alt=\"冒菜\"></p>\n<p>另外，刚察的旅游厕所做的是真不错，体验比北京的管理公厕都要好。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rT5d.jpg\" alt=\"刚厕\"></p>\n<h2 id=\"Day-8：刚察县-西海镇\"><a href=\"#Day-8：刚察县-西海镇\" class=\"headerlink\" title=\"Day 8：刚察县 - 西海镇\"></a>Day 8：刚察县 - 西海镇</h2><blockquote>\n<p>里程：90km</p>\n</blockquote>\n<p>最后一天离湖就很远了。出刚察县先是一个大上坡，接着几乎一路平路骑28km可以到达哈尔盖河边的哈尔盖镇。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rsUJ.jpg\" alt=\"刚察县上坡顶\"></p>\n<p>在哈尔盖中石化稍作休整，沿着315国道再骑20km到达甘子河乡，开始最后一个长坡，从海拔3200m来到3415m。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rN3q.jpg\" alt=\"哈尔盖车站路口\"></p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rwuT.jpg\" alt=\"G315-170km\"></p>\n<p>从这个坡顶一个俯冲下来穿过西和高速，便从G315回到G213国道。这一段逆风很大，由于修路，大车也很多。它们开过的同时，尘土飞扬，恨不得把自行车都给吸进去。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00ravV.jpg\" alt=\"G315下坡\"></p>\n<p>在一段艰辛的骑行后，我们来到修路的终点，也是整段路的最高海拔3445m，接着一路下坡，20km后在G213的拐弯处，西海镇已经越来越清晰。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rtCn.jpg\" alt=\"骑行结尾\"></p>\n<p>我们最后还了车，又寄了明信片。在西海镇停留了最后一天。这里作为海北藏族自治州首府，各种政府部门和基础设施完备齐全。就是人迹稀少。偌大的跳广场舞的活动中心也没个人影。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rUg0.jpg\" alt=\"海北藏族自治州文化活动中心\"></p>\n<p>夜晚了，路边的住房都亮起灯，仿佛又回到当初两弹一星时期建立原子城的岁月。</p>\n<p><img src=\"https://s1.ax1x.com/2020/10/08/00rBbF.jpg\" alt=\"原子城夜景\"></p>\n<h2 id=\"Day-9-x2F-10-西海镇-西宁-北京\"><a href=\"#Day-9-x2F-10-西海镇-西宁-北京\" class=\"headerlink\" title=\"Day 9&#x2F;10: 西海镇 - 西宁 - 北京\"></a>Day 9&#x2F;10: 西海镇 - 西宁 - 北京</h2><p>最后一天，我们回到西宁。重回城市的感觉真好，标准化和工业化给人太饱满的安全感了，躺在床上，回想起这为期6天的骑行，尽管风景很原生态很美好，但这也是以牺牲了工业化和标准化为代价的。除开住宿环境，缺少便捷的物流和交通，让沿途小镇的餐饮费物价居然比在西宁高。离开西宁前往西海镇前，我们恐怕没有预期到，以前毫不在意的蜜雪冰城和德克士居然成为了一种奢求和精神寄托。也许，人们都是图个新鲜，享受惯了工业化城市化带来的福利，居然也会想吃吃贫瘠和原生态的苦。</p>\n<p>经过此次“艰苦”的骑行，圣僧说他心心念念的川藏线骑行也要好好考虑考虑了，可能磨练人的不是骑行本身，反而是沿途令人生畏的住宿环境。我们脸上和腿上的晒伤需要时间痊愈。不知道，圣僧心理上的畏惧又需要多久痊愈。</p>\n<p><em>–END–</em></p>\n",
            "tags": [
                "攻略",
                "随笔",
                "西北",
                "银川",
                "西宁",
                "青海湖",
                "西海镇",
                "茶卡盐湖"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2020/08/17/refactoring-design-improvement/",
            "url": "http://shenlvmeng.github.com/blog/2020/08/17/refactoring-design-improvement/",
            "title": "重构 —— 代码的实用性与艺术性",
            "date_published": "2020-08-17T14:56:03.000Z",
            "content_html": "<p>MF的《重构》一书算是程序设计书籍的经典了。其中对于重构的认识和剖析深入浅出，提纲挈领。对于有一定编程经验的人来说更是如虎添翼的帮助。下面我尽量在不贬损原意的基础上，用自己的思路和语言进行适当的总结。</p>\n<h2 id=\"序-amp-前言：重构的再认识\"><a href=\"#序-amp-前言：重构的再认识\" class=\"headerlink\" title=\"序 &amp; 前言：重构的再认识\"></a>序 &amp; 前言：重构的再认识</h2><p>开篇名义，还未进入正文，书从序和前言开始，便不自觉间流露着真知灼见：</p>\n<ul>\n<li>重构是<strong>不改变软件可观察行为的前提下改善其内部结构</strong>。</li>\n<li>重构需要你维护一份“坏味道”和重构手段的对应</li>\n<li>设计前期使用模式通常会导致过度工程</li>\n<li>代码总将随着设计者的经验成长而进化</li>\n</ul>\n<h2 id=\"样例：感受重构\"><a href=\"#样例：感受重构\" class=\"headerlink\" title=\"样例：感受重构\"></a>样例：感受重构</h2><blockquote>\n<p>任何一个傻瓜都能写出计算机理解的代码。但唯有优秀的程序员才能写出人类能理解的代码</p>\n</blockquote>\n<p>代码被阅读和修改的次数远多于被编写的次数。尽管代码在机器中运行时，机器并不会嫌弃代码丑陋。但是代码总是要修改的，当我们打算修改系统时，就涉及到了人。人在乎这些。差劲的系统很难维护，如果很难找到修改点，程序员就可能犯错，从而引入bug。如果你发现你需要为程序增加特性，但是当前的代码结构让你不能方便达成目标时，先重构那个程序，再方便地添加特性。</p>\n<p>当然，重构前一定要确认，自己有没有一套<strong>可靠的测试机制</strong>，因为你需要它来保证重构的基础要素：不修改已有功能。重构中，最好能以<strong>微小的步伐</strong>前进（这样能及时回滚）。在本章样例的重构中，体现了下面一些“好味道”：</p>\n<ul>\n<li>代码块越小，代码功能就越好管理</li>\n<li>好的代码应该能够清楚表达自己的功能，变量名也是代码清晰的关键</li>\n<li>用多态取代条件判断逻辑</li>\n<li>结构化风格相比过程化风格更易扩展也更好维护</li>\n</ul>\n<h2 id=\"原则\"><a href=\"#原则\" class=\"headerlink\" title=\"原则\"></a>原则</h2><p>本章介绍了重构的一些原则和基础性认识。</p>\n<ul>\n<li>何为重构：不改变软件可观察特性的前提下，通过修改内部结构，提高其可理解性。通常情况下和<strong>性能优化</strong>相对应<ul>\n<li>两顶帽子：添加新功能和重构应该属于两种截然不同的行为，它们应该分开交替进行</li>\n</ul>\n</li>\n<li>重构的好处<ul>\n<li>改进软件设计，整理代码让后续的修改更容易</li>\n<li>让软件更好理解，准确说出我想要的</li>\n<li>帮忙找到bug</li>\n<li>提高未来的编程速度</li>\n</ul>\n</li>\n<li>何时重构<ul>\n<li><strong>事不过三</strong>，第一次只管去做，第二次产生反感但还是去做，第三次做类似的事情就去重构</li>\n<li>修改bug时重构</li>\n<li>review代码时重构</li>\n</ul>\n</li>\n<li>间接层和重构：中间层能够允许逻辑共享和意图的分开解释，同时隔离变化和解耦。<ul>\n<li>提前设计好中间层不如先直接做再重构</li>\n<li>少数情况下，中间层只会带来冗余</li>\n</ul>\n</li>\n<li>重构的难题<ul>\n<li>修改已有API：建议维护新旧两个接口，让用户做出反应后，再迁移。这期间，旧接口应该要调用新接口实现</li>\n<li>代码已经无法正常运行时，重写比重构更省事</li>\n</ul>\n</li>\n<li>重构和性能优化：大多数的性能优化集中在小部分代码上。先写出风格良好的代码，再使用性能工具实测数据，对瓶颈处单独优化性能。好的重构也会让性能优化更容易进行</li>\n</ul>\n<h2 id=\"坏味道\"><a href=\"#坏味道\" class=\"headerlink\" title=\"坏味道\"></a>坏味道</h2><p>在遇到下面一些“味道”时，可能你就需要重构了。</p>\n<ul>\n<li>重复代码</li>\n<li>函数过长，每当你需要用注释说明点什么时，可以把需要说明的东西写到一个独立函数中</li>\n<li>太长的类</li>\n<li>函数入参过多</li>\n<li>发散式变化：一个类因为多个原因发生不同的变化</li>\n<li>霰弹式变化：一个原因引起一个类的多个变化</li>\n<li>特性依恋：函数对某个类的兴趣高于自己所在的类</li>\n<li>数据泥团：喜欢聚合在一起的零散数据字段</li>\n<li>基础类型偏执：对于基础类型如字符串、整型不愿意使用简单类来封装</li>\n<li>swtich语句</li>\n<li>冗余类</li>\n<li>夸夸其谈未来性：过度为未来设计</li>\n<li>令人迷惑的暂时字段</li>\n<li>过度耦合的链式调用，如<code>a.b.c().d()</code>，链上任意类做修改都会影响整个调用</li>\n<li>两个类的狎昵关系</li>\n<li>异曲同工的类</li>\n<li>幼稚的数据类：只有最简单的getter和setter</li>\n<li>子类拒绝继承超类的函数或数据</li>\n<li>过多的注释</li>\n</ul>\n<h2 id=\"测试体系：重构的保证\"><a href=\"#测试体系：重构的保证\" class=\"headerlink\" title=\"测试体系：重构的保证\"></a>测试体系：重构的保证</h2><p>前面已经提到数次，重构的前提是不对已经已有行为做改动，这需要测试的帮助。本章对建立测试给了一些简单的介绍。</p>\n<ul>\n<li>编写测试代码最有用时机是编程之前</li>\n<li>编写一个测试case时，可以先让测试失败，再通过成功验证程序功能</li>\n<li>遇到bug时，先添加一个单元测试复现这个bug</li>\n<li><strong>测试不能保证程序没有bug</strong>，编写测试样例也遵循82原则，当样例已经很多时，它带来的边际效果就没那么好了。应该更多考虑容易出错的<strong>边界条件</strong>，积极思考如何“破坏代码”。</li>\n</ul>\n<h2 id=\"重构列表\"><a href=\"#重构列表\" class=\"headerlink\" title=\"重构列表\"></a>重构列表</h2><p>下面分几大方向介绍具体的重构手段。每个手段会分场景、思路、动机、做法来展开。</p>\n<h3 id=\"组织函数\"><a href=\"#组织函数\" class=\"headerlink\" title=\"组织函数\"></a>组织函数</h3><p>日常工作中，非常容易坏味道中的过长函数，下面的一些重构方式可以帮我们优化这一点。</p>\n<h4 id=\"提炼函数\"><a href=\"#提炼函数\" class=\"headerlink\" title=\"提炼函数\"></a>提炼函数</h4><ul>\n<li>场景：有一段相对独立的代码可以被组织并独立出来</li>\n<li>思路：将这段代码放到一个独立函数中，用<strong>函数名解释该函数的用途</strong></li>\n<li>动机：有时会遇到过长函数中有一段需要注释才能看明白的代码。将这样相对独立的逻辑拆分成表意的短小函数后，可以让高层函数读起来就像一系列注释。如果提炼可以提高代码清晰度，就算函数名比函数体长都无所谓</li>\n<li>做法：用<strong>做什么</strong>而不是<strong>怎么做</strong>来为函数命名（如果你想不出一个更有意义的名称，就别动了）。检查是否有临时变量，如果有读取，可以作为入参传递给函数；如果对临时变量甚至有再赋值，那可能还要让函数返回临时变量修改后的值</li>\n</ul>\n<h4 id=\"内联函数\"><a href=\"#内联函数\" class=\"headerlink\" title=\"内联函数\"></a>内联函数</h4><ul>\n<li>场景：函数本体和名称一样清晰易懂</li>\n<li>思路：在函数调用点插入函数本体，然后移除函数</li>\n<li>动机：如果函数本体足够简单，且表意清晰，同时调用点有限，<strong>不具备多态性</strong>。那么出于减少无用中间层的考虑，可以直接使用函数体</li>\n<li>做法：注意检查是否有多态性</li>\n</ul>\n<h4 id=\"内联临时变量\"><a href=\"#内联临时变量\" class=\"headerlink\" title=\"内联临时变量\"></a>内联临时变量</h4><ul>\n<li>场景：一个临时变量只被<strong>简单表达式</strong>赋值一次，同时妨碍了其他重构手法</li>\n<li>思路：将对变量的引用动作，替换成给它赋值的表达式本身</li>\n<li>动机：过多的临时变量会妨碍你重构长函数</li>\n<li>做法：注意确保表达式<strong>没有副作用</strong></li>\n</ul>\n<h4 id=\"以查询替代临时变量\"><a href=\"#以查询替代临时变量\" class=\"headerlink\" title=\"以查询替代临时变量\"></a>以查询替代临时变量</h4><ul>\n<li>场景：程序中有个临时变量保存了某个表达式的运算结果，同时被多处引用</li>\n<li>思路：将表达式提炼成独立函数，在独立变量的所有引用点替换成对新函数的调用</li>\n<li>动机：替换成函数后，整个类都可以获得这份信息，同时会减少对该变量的频繁引用带来的重构困难</li>\n<li>做法：寻找<strong>只被赋值一次</strong>的临时变量，对于赋值多次的临时变量使用“分解临时变量”方法先重构，保证提炼出来的函数没有副作用。先不要担心性能问题，等到出现了优化也会比较简单</li>\n</ul>\n<h4 id=\"引入解释性变量\"><a href=\"#引入解释性变量\" class=\"headerlink\" title=\"引入解释性变量\"></a>引入解释性变量</h4><ul>\n<li>场景：有个复杂的表达式，表意不够清晰</li>\n<li>思路：将表达式的值放进一个临时变量，用变量名表意</li>\n<li>动机：表达式不如变量名更好阅读。如果临时变量在整个类都有意义，建议直接使用“提炼函数”方法</li>\n<li>做法：先判断是否使用“提炼函数”的做法</li>\n</ul>\n<h4 id=\"分解临时变量\"><a href=\"#分解临时变量\" class=\"headerlink\" title=\"分解临时变量\"></a>分解临时变量</h4><ul>\n<li>场景：某个临时变量被<strong>多次赋值</strong>，且每次赋值意义不一样</li>\n<li>思路：针对每次不同意义的赋值使用不一样的临时变量</li>\n<li>动机：临时变量的多义性会增大理解成本</li>\n<li>做法：寻找被多次赋值且有多义性的变量，不同的意义使用新的不同临时变量</li>\n</ul>\n<h4 id=\"移除对函数入参的赋值\"><a href=\"#移除对函数入参的赋值\" class=\"headerlink\" title=\"移除对函数入参的赋值\"></a>移除对函数入参的赋值</h4><ul>\n<li>场景：对函数入参赋值</li>\n<li>思路：用新的临时变量取代入参</li>\n<li>动机：对入参赋值会混淆按值传递和按引用传递的传参方式</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"用函数对象取代函数\"><a href=\"#用函数对象取代函数\" class=\"headerlink\" title=\"用函数对象取代函数\"></a>用函数对象取代函数</h4><ul>\n<li>场景：大型函数中代码过于复杂，无法使用“提炼函数”</li>\n<li>思路：直接将函数放在<strong>单独对象</strong>中，将复杂的局部变量变成对象字段，从而可以轻松地在对象中分解这个大型函数到多个小型函数</li>\n<li>动机：略</li>\n<li>做法<ol>\n<li>建立一个新类，用函数用途给这类命名</li>\n<li>在新类中创建final字段保存大型函数所在的对象，即“源对象”</li>\n<li>新类的构造函数使用原函数入参作为入参</li>\n<li>新类中建立<code>computed()</code>函数</li>\n<li>赋值原代码到<code>computed()</code>中</li>\n<li>在原函数位置，创建这个新类的一个对象，并调用这个对象的<code>computed()</code>函数</li>\n<li>继续重构新类中的<code>computed()</code>函数</li>\n</ol>\n</li>\n</ul>\n<h4 id=\"替换算法\"><a href=\"#替换算法\" class=\"headerlink\" title=\"替换算法\"></a>替换算法</h4><ul>\n<li>场景：某个算法有更清晰的算法替代</li>\n<li>思路：直接更换函数本体</li>\n<li>动机：略</li>\n<li>做法：略</li>\n</ul>\n<h3 id=\"对象间的特性搬移\"><a href=\"#对象间的特性搬移\" class=\"headerlink\" title=\"对象间的特性搬移\"></a>对象间的特性搬移</h3><p>类应该承担清晰且明确的责任。不论是承担责任过多还是“不怎么负责任”，都需要进行重构。</p>\n<h4 id=\"搬移函数\"><a href=\"#搬移函数\" class=\"headerlink\" title=\"搬移函数\"></a>搬移函数</h4><ul>\n<li>场景：有函数和所在类以外的其他类反而有更多交流，如调用或被调用</li>\n<li>思路：在和函数交流更多的类中建立一个有类似行为的新函数，改造旧函数为新函数的委托函数，或者直接移除旧函数</li>\n<li>动机：略</li>\n<li>做法：<ul>\n<li>检查和搬移函数关联的字段或函数，判断是否要一起搬移</li>\n<li>检查子类和超类有无其他声明，检查有无多态性</li>\n<li>如果目标函数需要太多源类特性，就需要进一步分解后再搬移</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"搬移字段\"><a href=\"#搬移字段\" class=\"headerlink\" title=\"搬移字段\"></a>搬移字段</h4><ul>\n<li>场景：某个字段和所在类以外的其他类有更多交流</li>\n<li>思路：在目标类新建字段，修改源字段的所有使用者，令它们使用新字段</li>\n<li>动机：略</li>\n<li>做法：如果字段的访问级别是<code>public</code>，需要先用“封装字段”手段制造一个委托中间层</li>\n</ul>\n<h4 id=\"提炼类\"><a href=\"#提炼类\" class=\"headerlink\" title=\"提炼类\"></a>提炼类</h4><ul>\n<li>场景：某个类做了两个类的事情</li>\n<li>思路：建立新类，搬移函数和字段</li>\n<li>动机：一个类应该是清楚的抽象，即可以使用清晰的命名</li>\n<li>做法：拆分类，建立两个类之间的单向或双向连接，搬移底层函数，搬移高层函数</li>\n</ul>\n<h4 id=\"内联化类\"><a href=\"#内联化类\" class=\"headerlink\" title=\"内联化类\"></a>内联化类</h4><ul>\n<li>场景：某个类没做什么事情</li>\n<li>思路：将这个类的特性搬移到其他类，然后移除原类</li>\n<li>动机：通常会由于此前的重构动作移走了这个类的责任</li>\n<li>做法：选择和这个类关系最近的类进行合并，可以先在目标类中使用委托，然后再通过搬移函数的方式完成重构</li>\n</ul>\n<h4 id=\"隐藏委托关系\"><a href=\"#隐藏委托关系\" class=\"headerlink\" title=\"隐藏委托关系\"></a>隐藏委托关系</h4><ul>\n<li>场景：使用者通过委托类来调用对象</li>\n<li>思路：在提供服务的类上直接建立使用者所需的所有函数，隐藏委托关系</li>\n<li>动机：隐藏调用关系可以减少实现细节暴露从而减少耦合</li>\n<li>做法：在发起请求的类中，直接实现功能的接口，移除使用者的委托代码</li>\n</ul>\n<h4 id=\"移除中间人\"><a href=\"#移除中间人\" class=\"headerlink\" title=\"移除中间人\"></a>移除中间人</h4><ul>\n<li>场景：类做了过多<strong>简单委托</strong>的动作</li>\n<li>思路：让使用者直接调用受托类</li>\n<li>动机：当“隐藏委托关系”使用过多时，封装会很痛苦，这个时候不如直接让使用者通过链式调用用中间受托类实现功能</li>\n<li>做法：刚好是“隐藏委托关系”的反向过程</li>\n</ul>\n<h4 id=\"引入外加函数\"><a href=\"#引入外加函数\" class=\"headerlink\" title=\"引入外加函数\"></a>引入外加函数</h4><ul>\n<li>场景：需要为提供服务的类新增函数，但是你无法修改这个类（通常是库代码）</li>\n<li>思路：在使用者类中建立一个函数，并用第一参数的方式传入服务类实例</li>\n<li>动机：尽管可以在不修改服务类代码的情况下，自行添加新函数，但还是建议当外加函数较多时，使用“引入本地扩展”的方式，或直接推动服务类升级</li>\n<li>做法：在客户类中建立函数，这个函数不调用客户类特性，只是转发请求到服务类</li>\n</ul>\n<h4 id=\"引入本地扩展\"><a href=\"#引入本地扩展\" class=\"headerlink\" title=\"引入本地扩展\"></a>引入本地扩展</h4><ul>\n<li>场景：需要为服务类添加一些额外函数，但你无法修改这个类</li>\n<li>思路：建立一个新类，使其包含这些额外函数，让这个扩展类成为源类的子类或包装类</li>\n<li>动机：子类工作量较少，但是必须在对象创建期接管创建过程；包装类只是单纯转发请求，没有这个限制，但是转发过程都需要自己实现</li>\n<li>做法：略</li>\n</ul>\n<h3 id=\"重新组织数据\"><a href=\"#重新组织数据\" class=\"headerlink\" title=\"重新组织数据\"></a>重新组织数据</h3><h4 id=\"自封装字段\"><a href=\"#自封装字段\" class=\"headerlink\" title=\"自封装字段\"></a>自封装字段</h4><ul>\n<li>场景：直接访问一个字段的方式给你的重构带来了麻烦，或是引入了麻烦的耦合关系</li>\n<li>思路：用取值&#x2F;设值函数替代直接访问字段</li>\n<li>动机：这种方式让字段更为灵活，但是根据奥卡姆剃刀法则，等需要的时候再用</li>\n<li>做法：有的字段可能需要一个初始化函数</li>\n</ul>\n<h4 id=\"用对象取代数据值\"><a href=\"#用对象取代数据值\" class=\"headerlink\" title=\"用对象取代数据值\"></a>用对象取代数据值</h4><ul>\n<li>场景：数据项需要和行为合在一起使用才有价值</li>\n<li>思路：把简单的数据项封装成对象</li>\n<li>动机：开发初期的简单数据，可能在迭代后会加上特殊行为，如果不及时处理，就会出现特性依恋或重复代码</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"将值对象改为引用对象\"><a href=\"#将值对象改为引用对象\" class=\"headerlink\" title=\"将值对象改为引用对象\"></a>将值对象改为引用对象</h4><ul>\n<li>场景：从一个类会衍生出多个实例，实例间只是一个实体的多种状态</li>\n<li>思路：将值对象改为引用对象</li>\n<li>动机：值对象通过<code>equals()</code>或<code>hashCode()</code>判断，如日期；引用对象则直接可以用相等操作符<code>==</code>判断，如顾客、账户等概念</li>\n<li>做法：你可能需要一个静态字段或提前创建好多个新对象作为访问点</li>\n</ul>\n<h4 id=\"将引用对象改为值对象\"><a href=\"#将引用对象改为值对象\" class=\"headerlink\" title=\"将引用对象改为值对象\"></a>将引用对象改为值对象</h4><ul>\n<li>场景：你的引用对象很小且<strong>不可变</strong>，同时不易管理</li>\n<li>思路：将引用对象改为值对象</li>\n<li>动机：引用对象不好控制，值对象的<strong>不可变特性</strong>在某些场景很好用。</li>\n<li>做法：<strong>只有不可变对象才能被重构</strong></li>\n</ul>\n<h4 id=\"以对象取代数组\"><a href=\"#以对象取代数组\" class=\"headerlink\" title=\"以对象取代数组\"></a>以对象取代数组</h4><ul>\n<li>场景：有个数组，其中的元素类型不一，代表不同的东西</li>\n<li>思路：用对象替代数组，用字段表示不同意义的元素</li>\n<li>动机：数组的作用是<strong>以某种顺序存储一组相似对象</strong>，不要让位置具有特殊意义</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"复制被监视数据\"><a href=\"#复制被监视数据\" class=\"headerlink\" title=\"复制被监视数据\"></a>复制被监视数据</h4><ul>\n<li>场景：有些领域数据被放在了GUI部分代码里</li>\n<li>思路：将数据复制到领域对象中，建立Observer模式，剥离UI和逻辑</li>\n<li>动机：分层良好的系统，用户界面和业务逻辑代码是分开的，这样也更好维护</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"将单向关联改成双向关联\"><a href=\"#将单向关联改成双向关联\" class=\"headerlink\" title=\"将单向关联改成双向关联\"></a>将单向关联改成双向关联</h4><ul>\n<li>场景：两个类都需要对方特性，但目前只有单向连接</li>\n<li>思路：增加一个反向指针，同时修改函数能够同时更新两条链接</li>\n<li>动机：略</li>\n<li>做法：注意删除过程移除指针的顺序</li>\n</ul>\n<h4 id=\"将双向关联改为单向关联\"><a href=\"#将双向关联改为单向关联\" class=\"headerlink\" title=\"将双向关联改为单向关联\"></a>将双向关联改为单向关联</h4><ul>\n<li>场景：两个类有双向关联，但是一个类已经不需要另一个类的特性</li>\n<li>思路：去除不必要连接</li>\n<li>动机：维护双向连接带来便利的同时，也会增加维护的复杂度</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"用常量取代魔法数\"><a href=\"#用常量取代魔法数\" class=\"headerlink\" title=\"用常量取代魔法数\"></a>用常量取代魔法数</h4><ul>\n<li>场景：有个字面量数值，具有特殊含义，但是不能一眼看明白</li>\n<li>思路：创造一个常量，用命名说明字面数值的意义</li>\n<li>动机：魔法数是类型码时，要使用“以类取代类型码”</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"封装字段\"><a href=\"#封装字段\" class=\"headerlink\" title=\"封装字段\"></a>封装字段</h4><ul>\n<li>场景：类中有public字段</li>\n<li>思路：声明改为private，提供相应的访问函数</li>\n<li>动机：暴露public会降低函数的模块化程度，数据应该和行为集中在一起，不应被直接修改</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"封装集合\"><a href=\"#封装集合\" class=\"headerlink\" title=\"封装集合\"></a>封装集合</h4><ul>\n<li>场景：函数返回一个集合</li>\n<li>思路：返回集合的只读副本，并在类中提供添加&#x2F;移除集合元素的函数</li>\n<li>动机：类似“封装字段”，返回的集合一样可能被修改</li>\n<li>做法：使用Collection，或返回一个副本</li>\n</ul>\n<h4 id=\"用数据类取代记录\"><a href=\"#用数据类取代记录\" class=\"headerlink\" title=\"用数据类取代记录\"></a>用数据类取代记录</h4><ul>\n<li>场景：面对传统编程中的记录结构</li>\n<li>思路：创建“哑”数据对象</li>\n<li>动机：要将记录型结构转成面向对象的程序中</li>\n<li>做法：创建private字段，创建读写函数并提供</li>\n</ul>\n<h4 id=\"以类取代类型码\"><a href=\"#以类取代类型码\" class=\"headerlink\" title=\"以类取代类型码\"></a>以类取代类型码</h4><ul>\n<li>场景：类中有个数值类型码，但是<strong>不影响类行为</strong></li>\n<li>思路：用新的类替换数值类型码</li>\n<li>动机：略</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"以子类取代类型码\"><a href=\"#以子类取代类型码\" class=\"headerlink\" title=\"以子类取代类型码\"></a>以子类取代类型码</h4><ul>\n<li>场景：类中有个<strong>不可变</strong>数值类型码，同时<strong>影响类行为</strong></li>\n<li>思路：用宿主的子类替换类型码</li>\n<li>动机：可以用子类的多态性取代switch语句，不过，如果类型码会发生改变，或者宿主类已经有子类则不能用此方法</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"以状态-x2F-策略取代类型码\"><a href=\"#以状态-x2F-策略取代类型码\" class=\"headerlink\" title=\"以状态&#x2F;策略取代类型码\"></a>以状态&#x2F;策略取代类型码</h4><ul>\n<li>场景：类中有个数值类型码，会<strong>影响类行为</strong>，同时不能通过继承来消除</li>\n<li>思路：以状态对象取代替换数值类型码</li>\n<li>动机：略</li>\n<li>做法：创建一个新的类，用类型码的用途为它命名，这就是一个状态对象。所有的新类继承自超类，返回不同的状态码</li>\n</ul>\n<h4 id=\"以字段取代字段\"><a href=\"#以字段取代字段\" class=\"headerlink\" title=\"以字段取代字段\"></a>以字段取代字段</h4><ul>\n<li>场景：子类的查边只在<strong>返回常量数据</strong>的函数上</li>\n<li>思路：修改函数，让它们返回超类的新增字段，然后销毁子类</li>\n<li>动机：这样可以避免继承带来的额外复杂性</li>\n<li>做法：略</li>\n</ul>\n<h3 id=\"简化条件表达式\"><a href=\"#简化条件表达式\" class=\"headerlink\" title=\"简化条件表达式\"></a>简化条件表达式</h3><p>条件逻辑会增加理解的层级，处理不好时，很容易配合长代码造成理解困难。</p>\n<h4 id=\"分解条件表达式\"><a href=\"#分解条件表达式\" class=\"headerlink\" title=\"分解条件表达式\"></a>分解条件表达式</h4><ul>\n<li>场景：有一个复杂的条件语句</li>\n<li>思路：为if、then、else语句段落提炼独立函数</li>\n<li>动机：条件逻辑通常会使代码更难阅读</li>\n<li>做法：使用表意的函数名说明条件语句意思</li>\n</ul>\n<h4 id=\"合并条件表达式\"><a href=\"#合并条件表达式\" class=\"headerlink\" title=\"合并条件表达式\"></a>合并条件表达式</h4><ul>\n<li>场景：有一系列的条件逻辑，都得到相同结果</li>\n<li>思路：合并成一个条件表达式，并将之提炼成一个独立函数</li>\n<li>动机：有时候这么做能把“做什么”的语句转换成“为什么”的含义，前提是这些检查并非彼此独立</li>\n<li>做法：注意确认条件语句都没有副作用，有些条件表达式甚至可以简化成三元表达式</li>\n</ul>\n<h4 id=\"合并重复的条件片段\"><a href=\"#合并重复的条件片段\" class=\"headerlink\" title=\"合并重复的条件片段\"></a>合并重复的条件片段</h4><ul>\n<li>场景：条件表达式的每个分支都有相同的一段代码</li>\n<li>思路：将代码提取到条件表达式之外</li>\n<li>动机：减少重复语句</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"移除控制标记\"><a href=\"#移除控制标记\" class=\"headerlink\" title=\"移除控制标记\"></a>移除控制标记</h4><ul>\n<li>场景：在一系列布尔表达式中，某变量具有控制标记的作用</li>\n<li>思路：用<code>break</code>或<code>return</code>替代</li>\n<li>动机：有时候为了可读性和可维护性，可以牺牲单一出口的做法</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"用“卫语句”替代嵌套条件表达式\"><a href=\"#用“卫语句”替代嵌套条件表达式\" class=\"headerlink\" title=\"用“卫语句”替代嵌套条件表达式\"></a>用“卫语句”替代嵌套条件表达式</h4><ul>\n<li>场景：嵌套的条件逻辑过多，难以看清正常执行路径</li>\n<li>思路：用“卫语句”枚举出所有特殊情况，减少嵌套层数</li>\n<li>动机：当特殊case多于正常case时，提前处理每种特殊情况，可以有效减少嵌套层数</li>\n<li>做法：注意“卫语句”要么就从函数返回，要么就抛出异常，反正要跳出当前执行流</li>\n</ul>\n<h4 id=\"用多态取代条件表达式\"><a href=\"#用多态取代条件表达式\" class=\"headerlink\" title=\"用多态取代条件表达式\"></a>用多态取代条件表达式</h4><ul>\n<li>场景：你手上有个条件表达式，根据对象类型不同选择不同行为</li>\n<li>思路：将条件表达式的每个分支放在子类的重载函数中，然后将父类的原始函数声明为抽象函数</li>\n<li>动机：面向对象程序中，更少出现switch语句也是得益于多态这个工具</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"引入Null对象\"><a href=\"#引入Null对象\" class=\"headerlink\" title=\"引入Null对象\"></a>引入Null对象</h4><ul>\n<li>场景：在很多地方检查对象是否为<code>null</code></li>\n<li>思路：用一个特殊的Null对象取代<code>null</code>值</li>\n<li>动机：空对象对外就像是特殊的空的对象（Go笑而不语），而不是什么都没有，有利于保证函数行为的一致性</li>\n<li>做法：空对象一定是单例的</li>\n</ul>\n<h4 id=\"引入断言\"><a href=\"#引入断言\" class=\"headerlink\" title=\"引入断言\"></a>引入断言</h4><ul>\n<li>场景：某段代码需要对程序状态做出假设</li>\n<li>思路：用断言表示这种假设</li>\n<li>动机：有些时候，只有某个条件为真，代码才能正常运行，这个时候用断言明确这些假设。</li>\n<li>做法：注意不要滥用断言，只用来检查“一定为真”的条件，而不要去检查“应该为真”的条件</li>\n</ul>\n<h3 id=\"优化函数调用\"><a href=\"#优化函数调用\" class=\"headerlink\" title=\"优化函数调用\"></a>优化函数调用</h3><p>我们在前面提到了函数体本身的优化，这一章我们主要介绍函数调用的优化</p>\n<h4 id=\"函数改名\"><a href=\"#函数改名\" class=\"headerlink\" title=\"函数改名\"></a>函数改名</h4><ul>\n<li>场景：函数名没能说明函数用途</li>\n<li>思路：修改函数名</li>\n<li>动机：优化函数名，让它达到注释的效果，重新安排参数顺序，提高代码清晰度</li>\n<li>做法：对于旧函数，可以标注<code>deprecated</code>，说明其不建议使用</li>\n</ul>\n<h4 id=\"添加参数\"><a href=\"#添加参数\" class=\"headerlink\" title=\"添加参数\"></a>添加参数</h4><ul>\n<li>场景：函数需要从调用端得到更多信息</li>\n<li>思路：为函数添加新的对象参数</li>\n<li>动机：如果有其他重构的方法，只要可能，基本都比添加参数要好</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"移除参数\"><a href=\"#移除参数\" class=\"headerlink\" title=\"移除参数\"></a>移除参数</h4><ul>\n<li>场景：函数本体不需要某个参数</li>\n<li>思路：去除该参数</li>\n<li>动机：暂时不要考虑未来是否能用到</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"分离查询和修改\"><a href=\"#分离查询和修改\" class=\"headerlink\" title=\"分离查询和修改\"></a>分离查询和修改</h4><ul>\n<li>场景：一个函数即返回对象状态，同时又有副作用</li>\n<li>思路：将查询和修改分离出两个参数</li>\n<li>动机：任何有返回值的函数，最好都不要有看得见的副作用</li>\n<li>做法：先分离查询，再分离修改</li>\n</ul>\n<h4 id=\"让函数携带参数\"><a href=\"#让函数携带参数\" class=\"headerlink\" title=\"让函数携带参数\"></a>让函数携带参数</h4><ul>\n<li>场景：若干函数做了类似的操作，仅仅因为某些值表现不同</li>\n<li>思路：用一个单一函数表示，用参数来表示那些不同的值</li>\n<li>动机：减少重复代码</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"用明确函数取代参数\"><a href=\"#用明确函数取代参数\" class=\"headerlink\" title=\"用明确函数取代参数\"></a>用明确函数取代参数</h4><ul>\n<li>场景：有一个函数，其中<strong>完全取决于参数</strong>表现出不同行为</li>\n<li>思路：针对参数的不同值，建立一个独立函数</li>\n<li>动机：函数内大多以条件表达式检查这些参数值，并作出不同行为；有时也可以用多态实现</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"保持对象完整\"><a href=\"#保持对象完整\" class=\"headerlink\" title=\"保持对象完整\"></a>保持对象完整</h4><ul>\n<li>场景：你从对象中取了若干字段，将它们作为函数调用的一些参数</li>\n<li>思路：改为传递整个对象</li>\n<li>动机：如果传递整个对象会让你的依赖结构恶化，那么就不该用这个方法</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"用函数取代参数\"><a href=\"#用函数取代参数\" class=\"headerlink\" title=\"用函数取代参数\"></a>用函数取代参数</h4><ul>\n<li>场景：对象调用某个函数，用其结果做参数传递给另一个函数，然而接受改参数的函数本身也能调用到前一个函数</li>\n<li>思路：让参数接受函数直接去调用前一个函数，然后去除该参数</li>\n<li>动机：<strong>如果函数有其他途径获得参数值，就不该通过参数获得</strong></li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"引入参数对象\"><a href=\"#引入参数对象\" class=\"headerlink\" title=\"引入参数对象\"></a>引入参数对象</h4><ul>\n<li>场景：某些函数入参总是在一起出现</li>\n<li>思路：直接用一个对象取代这些参数</li>\n<li>动机：略</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"移除设值函数\"><a href=\"#移除设值函数\" class=\"headerlink\" title=\"移除设值函数\"></a>移除设值函数</h4><ul>\n<li>场景：类的某个字段在创建时设值，然后就不再改变</li>\n<li>思路：去掉字段的设值函数</li>\n<li>动机：提供设值字段就表示可能被改变</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"隐藏函数\"><a href=\"#隐藏函数\" class=\"headerlink\" title=\"隐藏函数\"></a>隐藏函数</h4><ul>\n<li>场景：有函数从未被其他类用到</li>\n<li>思路：将函数改为private</li>\n<li>动机：减少无谓的API暴露</li>\n<li>做法：可以利用lint工具帮忙检查</li>\n</ul>\n<h4 id=\"用工厂函数替代构造函数\"><a href=\"#用工厂函数替代构造函数\" class=\"headerlink\" title=\"用工厂函数替代构造函数\"></a>用工厂函数替代构造函数</h4><ul>\n<li>场景：希望创建对象时不仅做简单的构建动作</li>\n<li>思路：使用工厂函数</li>\n<li>动机：这个方法也可以用来通过类型码创建类对象</li>\n<li>做法：结合<code>Class.forName()</code>可以不用写switch语句</li>\n</ul>\n<h4 id=\"封装向下转型\"><a href=\"#封装向下转型\" class=\"headerlink\" title=\"封装向下转型\"></a>封装向下转型</h4><ul>\n<li>场景：函数返回的对象需要由调用者向下转型</li>\n<li>思路：将向下转型放在函数中进行</li>\n<li>动机：略</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"用异常取代错误码\"><a href=\"#用异常取代错误码\" class=\"headerlink\" title=\"用异常取代错误码\"></a>用异常取代错误码</h4><ul>\n<li>场景：函数返回特性的代码表示错误情况</li>\n<li>思路：改用异常</li>\n<li>动机：异常能够区分出正常情况和异常处理</li>\n<li>做法：需要决定抛出受控异常或者非受控异常</li>\n</ul>\n<h4 id=\"用测试取代异常\"><a href=\"#用测试取代异常\" class=\"headerlink\" title=\"用测试取代异常\"></a>用测试取代异常</h4><ul>\n<li>场景：对于一个调用者可以预先检查的条件，抛出了异常</li>\n<li>思路：修改调用者，改在调用前进行检查</li>\n<li>动机：能够提前检查的情况，就不算是异常</li>\n<li>做法：略</li>\n</ul>\n<h3 id=\"处理继承关系\"><a href=\"#处理继承关系\" class=\"headerlink\" title=\"处理继承关系\"></a>处理继承关系</h3><h4 id=\"字段上移\"><a href=\"#字段上移\" class=\"headerlink\" title=\"字段上移\"></a>字段上移</h4><ul>\n<li>场景：两个子类有相同字段</li>\n<li>思路：将字段移至超类</li>\n<li>动机：归纳重复特性</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"函数上移\"><a href=\"#函数上移\" class=\"headerlink\" title=\"函数上移\"></a>函数上移</h4><ul>\n<li>场景：两个子类有相同作用的函数</li>\n<li>思路：将函数移至超类</li>\n<li>动机：归纳重复特性。子类的函数覆写超类函数，但是做相同工作时，也要使用函数上移</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"构造函数上移\"><a href=\"#构造函数上移\" class=\"headerlink\" title=\"构造函数上移\"></a>构造函数上移</h4><ul>\n<li>场景：子类的构造函数几乎完全一致</li>\n<li>思路：在超类中新建构造函数，再在子类构造函数中调用它</li>\n<li>动机：如果重构过程过于复杂，可以考虑使用“用工厂函数替代构造函数”</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"函数下移\"><a href=\"#函数下移\" class=\"headerlink\" title=\"函数下移\"></a>函数下移</h4><ul>\n<li>场景：超类的某函数只和部分子类有关</li>\n<li>思路：将函数移到相关的子类中去</li>\n<li>动机：和“函数上移”恰恰相反</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"字段下移\"><a href=\"#字段下移\" class=\"headerlink\" title=\"字段下移\"></a>字段下移</h4><ul>\n<li>场景：超类的字段只被部分子类用到</li>\n<li>思路：将字段移到真正需要的子类中去</li>\n<li>动机：和“字段上移”恰恰相反</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"提炼子类\"><a href=\"#提炼子类\" class=\"headerlink\" title=\"提炼子类\"></a>提炼子类</h4><ul>\n<li>场景：类的特性只被部分实例对象用到</li>\n<li>思路：新建一个子类，将未被用到的特性转移到子类中</li>\n<li>动机：上述的差异行为有时也可能通过类型码区分，这个时候可以由“以子类取代类型码”或“以状态&#x2F;策略取代类型码”方法来重构</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"提炼超类\"><a href=\"#提炼超类\" class=\"headerlink\" title=\"提炼超类\"></a>提炼超类</h4><ul>\n<li>场景：两个类有相似特性</li>\n<li>思路：为两个类建立超类，将相似特性移到超类中</li>\n<li>动机：两个类用相同方式做类似事情往往意味着重复代码</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"提炼接口\"><a href=\"#提炼接口\" class=\"headerlink\" title=\"提炼接口\"></a>提炼接口</h4><ul>\n<li>场景：若干客户端使用类中的同一子集，或者两个类有部分相同点</li>\n<li>思路：将相同的子集提炼到独立接口中</li>\n<li>动机：接口有助于系统的<strong>责任划分</strong>和<strong>能力声明</strong>（鸭子类型）。在单继承的语言中，接口扮演了组合功能代码的角色。尤其某个类在不同环境表现不同时，使用接口是个好主意</li>\n<li>做法：接口命名通常由<code>-able</code>结尾</li>\n</ul>\n<h4 id=\"折叠继承关系\"><a href=\"#折叠继承关系\" class=\"headerlink\" title=\"折叠继承关系\"></a>折叠继承关系</h4><ul>\n<li>场景：超类和子类几乎无法区分</li>\n<li>思路：将它们合为一体</li>\n<li>动机：往往在过度设计时出现</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"构造模板函数\"><a href=\"#构造模板函数\" class=\"headerlink\" title=\"构造模板函数\"></a>构造模板函数</h4><ul>\n<li>场景：有一些子类，细节上有所区别，但是整个流程上操作类似</li>\n<li>思路：提炼出操作流程，上移至超类，将具体细节操作放在独立函数中，让它们有相同的签名，然后实现超类的抽象函数</li>\n<li>动机：这样抽离出来的流程函数也叫模板函数，模板上<em>插槽</em>接口固定，然而提供插槽的模板函数是一致的</li>\n<li>做法：后续新增的类，只需实现超类抽象函数就可以完成扩展</li>\n</ul>\n<h4 id=\"用委托取代继承\"><a href=\"#用委托取代继承\" class=\"headerlink\" title=\"用委托取代继承\"></a>用委托取代继承</h4><ul>\n<li>场景：子类只使用超类接口的一部分，或者直接不需要继承来的数据</li>\n<li>思路：在子类中新建字段保存超类，然后调整子类函数，让它委托超类，然后去掉两者的继承关系</li>\n<li>动机：略</li>\n<li>做法：略</li>\n</ul>\n<h4 id=\"用继承取代委托\"><a href=\"#用继承取代委托\" class=\"headerlink\" title=\"用继承取代委托\"></a>用继承取代委托</h4><ul>\n<li>场景：两个类的委托关系过多，且委托函数都很简单</li>\n<li>思路：让委托类继承受托类</li>\n<li>动机：如果你没有使用<strong>所有</strong>受托类函数，那么就不要用这个重构方法，继续保持委托关系，使用其他重构方法；另外受托对象可变时，也要注意</li>\n<li>做法：略</li>\n</ul>\n<h2 id=\"大型重构\"><a href=\"#大型重构\" class=\"headerlink\" title=\"大型重构\"></a>大型重构</h2><blockquote>\n<p>Kent Beck和作者所写</p>\n</blockquote>\n<p>本章介绍了4个大型重构的思路，也是大型程序容易遇到的4个问题</p>\n<ul>\n<li>梳理和分析继承体系：往往因为某个继承体系承担的两个甚至更多责任，有一个特征是，某一层级的所有类，子类都以相同形容词开始。可以通过委托的形式，对继承体系做正交化</li>\n<li>过程化设计转化为对象设计：往往出现在过程化风格传统语言中。可以将数据记录变为对象，拆分大块行为为小块，然后将行为转移到相关对象中。</li>\n<li>分离领域和UI：出现在有GUI的场景中。传统的MVC设计模式就是将领域逻辑分离出来，用接口的方式和UI部分代码对接</li>\n<li>提炼继承体系：有的类做了太多工作，里面经常有较多的条件表达式。对于这种，可以借助面向对象中的子类和多态或者策略模式实现</li>\n</ul>\n<h2 id=\"重构与现实\"><a href=\"#重构与现实\" class=\"headerlink\" title=\"重构与现实\"></a>重构与现实</h2><p>重构在某些角度和技术演进很像。技术的接纳过程类似一条钟形曲线。前段包括先行者和早期接受者，中部大量人群包括早期消费者和晚期消费者，最后则是行动迟缓者。不同人有不同的消费动机。先行者和早期接受者感兴趣的是<strong>新技术，“范式转移和突破性思想”的愿景</strong>；早期和晚期消费者则关心<strong>成熟度、成本、支持程度，以及这种新思想&#x2F;新产品是否被和他们相似的其他人成功使用</strong>。</p>\n<h2 id=\"尾声\"><a href=\"#尾声\" class=\"headerlink\" title=\"尾声\"></a>尾声</h2><ul>\n<li>重构工具能节省你的重构时间</li>\n<li>永远记住“两顶帽子”，重构时保持代码功能不变</li>\n</ul>\n",
            "tags": [
                "重构",
                "设计模式",
                "代码质量"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2020/08/12/soft-skills-for-software-developer/",
            "url": "http://shenlvmeng.github.com/blog/2020/08/12/soft-skills-for-software-developer/",
            "title": "《软技能 —— 代码外的生存指南》书摘",
            "date_published": "2020-08-12T13:16:12.000Z",
            "content_html": "<p>关于编程相关的书籍已有太多太多，本书相比其他编码相关的技术书籍来说，从技术外的视角来介绍还是挺有意思的。编码无非是求生的一种方式，对于程序员来讲，把生活过好也绝不仅是把代码写好就OK的。书中所写基本是作者对其过去职业和人生经历的一个总结，以tips的形式给出，是“术”而非“道”。是的，本书的介绍思路大概是告诉你一些方法，对你的生活和工作有些帮助的方法，而非构建一个体系，一种思考方式。因此，对于那些三观和做事方法思路基本稳定的人来说，它没法撼动你根本的认识，只能做到具体某个方面的启示和改进。同时，读起来也是相对简单的。不客气地说，这本书应该是最近一年中读到的信息密度最低的书了。不过，其中理财和健身两章，尤其是第55章应该算是全书的精华，对我还是挺有帮助的。</p>\n<p>下面分章节，对其中的关键的idea进行摘录。</p>\n<h2 id=\"职业\"><a href=\"#职业\" class=\"headerlink\" title=\"职业\"></a>职业</h2><p>可能由于作者大多数时间是自由职业者，这一部分介绍没有太多新意</p>\n<ul>\n<li>工作是公司的，职业生涯是你自己的</li>\n<li>把自己当成公司去思考，你有什么可以卖，相比其他“产品”你的优势是什么</li>\n<li>作为程序员，你能提供的基础服务就是创建软件</li>\n<li>人际交往不能忽略</li>\n<li>通过面试最快捷的方式是让面试官对你产生好感，如果能提前接触就更好了（Really？）</li>\n<li>承担更多责任是脱颖而出的一种方式，同时保证自己被注意到</li>\n<li>成为自由职业者之后，一定不要忘了自我营销</li>\n</ul>\n<h2 id=\"自我营销\"><a href=\"#自我营销\" class=\"headerlink\" title=\"自我营销\"></a>自我营销</h2><p>作为自由职业者，作者在自我营销上有些自己的见解</p>\n<ul>\n<li>自我营销：打造自我品牌 + 多种媒介 + 持之以恒</li>\n<li>一个品牌需要包含：传达的信息（slogan） + 视觉符号（logo） + 一致性 + 曝光率，重点在建立一套预期</li>\n<li>不要忘了有效利用社交媒体，为自己积累粉丝</li>\n<li>学会演讲</li>\n<li>著书有时候不是为了赚钱，而是赢得名声</li>\n</ul>\n<h2 id=\"学习\"><a href=\"#学习\" class=\"headerlink\" title=\"学习\"></a>学习</h2><ul>\n<li>学习知识最好能将知识用于实践</li>\n<li>十步学习法：了解全局、确定范围、定义目标、寻找资源、创建计划、筛选资源、开始学习、动手操作、全面掌握、乐为人师<ul>\n<li>前6步能让你明确方向和目标，为正式学习做准备</li>\n<li>后面4步循环往复，快速迭代，乐为人师能强行提高你的理解程度</li>\n</ul>\n</li>\n<li>有时候导师也很重要</li>\n<li>遇到知识短板时，就是你成长的机会</li>\n</ul>\n<h2 id=\"注意力\"><a href=\"#注意力\" class=\"headerlink\" title=\"注意力\"></a>注意力</h2><ul>\n<li>专注像是一种惯性，是逐渐达到的，不可能一次性达成</li>\n<li>番茄工作法：将时间拆分成30分钟的番茄钟（25分钟专心工作 +5分钟休息），通过番茄钟衡量工作量和自己的工作效率（实际工作中太容易被打乱节奏了，比较适合自由职业者）</li>\n<li>定额工作法：对于需要定期完成的任务，自我规定周期内需要达到的工作量，承诺然后完成。有时候可以借助大众的监督来坚持</li>\n<li>多任务并行通常会因为上下文切换影响工作效率，除非另一项任务不需要花费脑力</li>\n<li>电视是时间杀手</li>\n<li><strong>为了享受快乐有意识地去做，就不是浪费时间；为了逃避自己应该完成的任务去做，就是浪费时间</strong></li>\n<li>分解任务可以有效地减小解决问题的困难程度</li>\n<li>任何行动都比不行动要好（主要是行动可以获得反馈）</li>\n</ul>\n<h2 id=\"理财\"><a href=\"#理财\" class=\"headerlink\" title=\"理财\"></a>理财</h2><p>本篇是全书相对最有信息量的一篇。其中第55章对于自己生涯的描述，甚至比其他所有篇章的介绍都要精华。其他章节可能有粉饰自己的成分，但是第55章“额外馈赠”足够真诚。</p>\n<ul>\n<li>资产是使用价值高于维护成本的东西，负债则相反。减少负债，增加资产</li>\n<li>自我营销越好，薪酬越好谈</li>\n<li>期权是指在未来某个时期前购买一定数量股票的选择权，购买的是期望。买方最大亏损有限，最大盈利无限，有权利没有义务；卖方相反。看涨期权和看跌期权作为买方都需要交期望差额的<strong>权利金</strong>。到期日时（这是欧式期权的做法，美式期权可以在到期日前任意时间交易），买方可以选择或放弃行权，选择行权时，买方卖出股票，赚取高于权利金的差额；放弃行权时同时放弃权利金。</li>\n<li>房地产投资是低风险高负债的投资类型，一方面可以寻求房产出售的机会，另一方面可以通过租金获取稳定收入。当然在租赁房产时，建议选择负责任的物业托管。通过部分租金换取安心。</li>\n<li>想要提前退休，需要有资本积累，同时，这个资本还要让你获得足够生活的<strong>被动收入</strong>。如果有提前退休打算，需要下面几点准备<ul>\n<li>树立目标，即XX岁前退休</li>\n<li>意识到通胀的存在，他会吞噬你赶不上它速度的资产</li>\n<li>做有固定收益和被动收入的投资（最好还能赶上通胀）</li>\n<li>要想更早退休，自然要比常人花更多精力“开源”和“节流”</li>\n</ul>\n</li>\n<li>真正获得财务成功的唯一方法就是用钱生钱</li>\n<li><strong>一边欠债一边存钱是最愚蠢的做法</strong>，因为债务利息永远高于存款利息。<ul>\n<li>存钱之前先把房屋抵押贷款还清（这么做还是有些绝对，还要留些以备急用）</li>\n<li>能一次付清就一次付清，除非你能通过提前享受获得超过利息的收益</li>\n<li>确保先偿还利息最高的债务</li>\n<li>并非所有债务都是不好的，除非你能通过提前享受获得超过利息的收益（如住房贷款和学生贷款）</li>\n</ul>\n</li>\n<li>退休即自由，即可以不以钱作为出发点行事，更形象地说，“从社会中赎回自己的生活”。</li>\n<li>买房办理贷款时注意贷款利率是否是固定的</li>\n<li>作者最初也是程序员的工作，之后逐渐贷款购置房产用于租赁，通过日常工作还款。之后几次创业都不太成功。但是房产累积越来越多。之后通过个人营销开始创办博客和培训教程，认识大佬后，培训教程逐渐受到欢迎。之后订下退休目标，随着房产带来的被动收入和在线培训（编程 + 健身 + 创业）被动收入逐渐稳定，作者成功上岸退休</li>\n</ul>\n<h2 id=\"健身\"><a href=\"#健身\" class=\"headerlink\" title=\"健身\"></a>健身</h2><ul>\n<li>同时达到多个健身目标是很难实现的。很难在增肌同时减掉脂肪，同样地，很难在减脂同时增长肌肉</li>\n<li>减肥很简单：摄入的卡路里小于燃烧的卡路里。<ul>\n<li>摄入卡路里通过食物计算，但是烹饪过程对热量也有很大影响</li>\n<li>燃烧的卡路里可以根据基础代谢率BMR结合训练消耗计算</li>\n</ul>\n</li>\n<li>增肌需要给肌肉压力，挑选动作的时候注意选择复合动作，如深蹲、硬拉、卧推、杠铃推举等等。注意保持足够的蛋白质摄入</li>\n<li><strong>腹肌不是靠增肌得到，而要通过减脂</strong>。体脂率下降到特定水平自然能看到腹肌。可以通过高强度间歇式训练（HITT）来减脂</li>\n<li>跑步和站立式办公都是简单的燃脂方式</li>\n</ul>\n<h2 id=\"心灵\"><a href=\"#心灵\" class=\"headerlink\" title=\"心灵\"></a>心灵</h2><ul>\n<li>积极思考不只是外表乐观，而且对健康有益，延年益寿</li>\n<li>做事方法的第一步是相信自己有改变的能力，改变不了现状，你至少能改变自己的心态。</li>\n<li>爱情不是追逐游戏，你追我逃。更健康的模式是行为上体现出自信，用自然随和且充满自信的态度和别人交往。“我自己感觉很好，我不需要你，但是我觉得你挺有意思的，所以我想更好地了解你”<ul>\n<li>关键是你要真得能表现出足够的自信，你要对自己足够尊重</li>\n<li>做一个绝望的、缺乏自信的人，你会发现自己会真的孤立无援</li>\n</ul>\n</li>\n<li>那些拒绝最终都会把你带到一个想和你在一起的人那里</li>\n</ul>\n<h2 id=\"结束语-amp-附录\"><a href=\"#结束语-amp-附录\" class=\"headerlink\" title=\"结束语 &amp; 附录\"></a>结束语 &amp; 附录</h2><ul>\n<li>生活原本比你所厌恶的朝九晚五的工作丰富多彩得多</li>\n<li>空头是指，你事先“借”该股票的一些股份并卖出，这会产生空头头寸，最终你需要靠回购这只股票来填补你借入的空头头寸</li>\n<li>Ⅰ型糖尿病是指自身不能产生胰岛素，Ⅱ型糖尿病是指自身对胰岛素不够敏感</li>\n<li>吃垃圾食品不会对健康造成重大影响，但是摄入食品的总量却会影响健康。相比健康食品，垃圾食品带来更高热量的同时，只有较低的饱腹感。因此，达到标准热量所使用的垃圾食品可能会让你长期处于挨饿状态。</li>\n<li>水果和蔬菜都是健康食品，热量都不高；高蛋白食物的热量值通常也不怎么高。纤维带来饱腹感的同时有较低的热量<ul>\n<li>总结来说，未经加工的食品就是最健康的</li>\n</ul>\n</li>\n</ul>\n<p><em>–END–</em></p>\n",
            "tags": [
                "软技能",
                "理财",
                "健身",
                "自我营销",
                "学习"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2020/08/04/senior-schoolmates-sharing/",
            "url": "http://shenlvmeng.github.com/blog/2020/08/04/senior-schoolmates-sharing/",
            "title": "师兄师姐分享会",
            "date_published": "2020-08-04T14:56:10.000Z",
            "content_html": "<p>前一阵被邀请参与公司新任培训的师兄师姐分享环节，大体是和小组内的新入职校招同学分享工作中的积累和收获。分享内容没有要求，但是大家提的比较多的问题是入职后有没有什么成长的tips或者坑。我干脆提前做了些相关的准备，也一并在这里记录下来吧。</p>\n<p>我回忆了下过去2年多以来，在公司遇到的之前未曾预期的种种，大致可以总结为下面两点：</p>\n<ul>\n<li>了解业务</li>\n<li>以人为本</li>\n</ul>\n<p>先说了解业务吧。我们在日常工作中遇到的需求无非两类：<strong>业务需求</strong>和<strong>技术需求</strong>。这两类工作都要求对业务的了解。在业务需求中，首先了解业务才有可能完好地还原prd的需求，避免产生不符合预期的情况，避免被产品或QA打回。然后，我们每个人都不是需求实现的机器，了解业务能让你知道，你写的每一行代码都是有意义的，都是真真正正为人服务的，而不是机械地完成任务。同时，对业务的熟悉程度也能让你的视野上个台阶，从更高的角度考虑问题，看到更远的可能。实际上，服务端同学相对来说，由于要设计数据库表，实现底层的业务逻辑，需要对整个业务理解更深入，所以在大多数团队，leader也都是服务端同学担当。</p>\n<p>在技术需求中，同样离不开对业务的理解。可能有些刚入职的同学不会意识到：<strong>我们其实是工程师，而不是科学家</strong>。我们需要把技术应用到实际工作中，而不是单纯地指出某个技术的可行性。<strong>失去业务土壤的技术需求是无法带来真正价值的</strong>。业务需要需要能够从业务中挖掘，并在最后真正应用到业务中产生价值。举个反例，在我刚入职时实现过一个流程图工具，想法很单纯，用技术实现工具是个很酷的事。然而没有考虑过如何应用到业务中，最后半途而废。类似地，在入职1年多的时候，和同事开发了能够托管UI稿和prd稿的平台，但是我们无视了市面上已经有太多成熟好用的产品，最终也没能推动业务使用。一个比较好的技术需求应该怎么做呢：了解业务需要、使用技术赋能，然后保证实现落地。这三步中，使用技术赋能反而是最简单的一步。理解业务需要和推动业务使用是比想象中要困难的。</p>\n<p>第二点叫做以人为本。这也是刚加入工作时可能注意不到的一点，入职前你可能以为你每天很浪漫地和代码泡在一起，和机器打交道。真正工作一段时间后，你会发现，<strong>每天至少50%的时间是在和人打交道的</strong>。人和机器是不一样的，机器是可靠的，可预期的，可以根据在学校里学习的知识推测的；而人是不可靠的，需要技巧，需要将心比心。这种不一样的思维方式会给可能过于理性的你带来麻烦。不然你会发现每天70%~80%的烦恼都是人而非机器带来的。</p>\n<p>说几个例子，展开聊一下。先说代码，<strong>代码是写给人看，写给人理解的，然后才是交给机器去执行</strong>。看似你是在写代码，实际上你是通过代码在和未来的你或者接手你代码的人交流思路。所以代码的风格、可读性可能比你想象中要重要。一个糟糕的代码风格、可读性会让未来的你或者其他同事想要骂人，想要通过<code>git blame</code>找到这一坨shi一样的代码究竟是哪一个如此没品味的人写出来的。相反，一个好的风格、可读性会让未来的你和你的同事接手代码时心情愉悦，如清风拂面。类似地，可扩展性和设计良好与否也能起到上面的效果。可扩展性强和设计良好的代码可以极高地提高修改代码的愉悦程度和生产效率。</p>\n<p>作为前端，界面的设计也一样重要。不要只是单纯地去实现PM或者UI的设计，可以站在终端用户的角度换位思考。如果是你遇到这种交互，它是否符合你的直觉，使用起来是否够简单，是否能达到目的。遇到有疑问的地方，随时可以找PM和UI讨论。</p>\n<p>当然，这里说以人为本也不要矫枉过正。各位在日常工作中，还是以做事为主，公司内也还是看大家工作成果如何，而不是人际关系搞的如何。这里只是提个醒，希望大家在踏实努力的同时，也不要忘记了“人”这个角色的重要性。</p>\n<p>总结上来看，就是上面这些，没别的了。各位既然来参加今天的培训，肯定也是从学校的环境刚进入工作环境没多久。上面这段分享听完之后，如果能对有些人有启示，能让大家意识到思维方式的不同，就达到我的目的了。</p>\n<p>谢谢！</p>\n",
            "tags": [
                "成长",
                "业务"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2020/06/29/http-2-for-frontend/",
            "url": "http://shenlvmeng.github.com/blog/2020/06/29/http-2-for-frontend/",
            "title": "面向前端的HTTP/2介绍",
            "date_published": "2020-06-29T14:41:51.000Z",
            "content_html": "<p>正式版HTTP&#x2F;2发布于2015年5月，距今已经快5年了，相比老一辈HTTP 1.1有了许多改进。在具体讨论这些改进前，我们先简单回顾下HTTP这一路以来的历程。</p>\n<h2 id=\"历史回顾\"><a href=\"#历史回顾\" class=\"headerlink\" title=\"历史回顾\"></a>历史回顾</h2><p>HTTP在1991年发布了最初的HTTP0.9版本，主要用于学术交流，目的也只是用来在网络之间传递HTML超文本的内容。HTTP0.9基于TCP，只有一个GET请求类型，请求和文档响应都是ASCII字符流，响应数据类型只有HTML类型，在响应结束后立即断开连接。</p>\n<p>随着互联网发展，1994年底出现了拨号上网，网景推出浏览器后，WWW已经不仅局限于学术交流，浏览器中除了承载HTML以外，还包括了JavaScript、CSS、图片、音视频等资源。HTTP1.0在这个背景下于1996年推出（RFC1945），它支持了状态码、方法、头部的概念，响应内容不局限于超文本文件，编码类型也不仅限于ASCII。但是TCP连接在响应返回后依旧会断开连接。</p>\n<p>在浏览器等技术发展，HTTP请求更多也更复杂，HTTP1.0的已有问题暴露得越来越明显。TCP频繁建立连接的时延，缓存协商机制的不完整、大文件下载的支持等问题需要解决。于是HTTP1.1在1999年推出（RFC2616），这是个很庞大的协议，全文长达176页，在后续IETF对该规范进行更新时，则被拆分成了总页数更多的六个文档（即RFC7230协议族）。HTTP1.1包含了太多细节和可选的部分，包含不常用的功能和不合适的优化，因此几乎没有任何实现包含完整的协议功能。总的来看，HTTP1.1做了一些尝试：</p>\n<ul>\n<li>TCP持久连接（keep-alive），即在一个TCP连接上发起HTTP请求</li>\n<li>支持范围请求（Accept-Ranges）</li>\n<li>更强大的缓存机制（协商缓存和强缓存，以及相关的头部）</li>\n<li>提出了HTTP pipeline，尝试改善串行HTTP请求引起的线头阻塞（Head-of-line blocking）问题</li>\n<li>更多的错误相关状态码</li>\n<li>Host头处理</li>\n</ul>\n<p>之后HTTP1.1便被一直使用至今，随着互联网页面请求资源的数量和体积增大，HTTP1.1中没能妥善解决的问题越来越明显。HTTPbis工作组在2007年夏天便着手于HTTP1.1标准的更新，并最终在2014年初形成上面提到的RFC7230系列协议族。</p>\n<p><a href=\"http://en.wikipedia.org/wiki/SPDY\">SPDY</a>（SPeeDY）是由Google牵头开发的开源协议，意图在TLS和HTTP中间插入中间层，解决HTTP协议的问题。大约在2012年提出，也被大多数主流浏览器支持。最终在2015年HTTP&#x2F;2协议发布后，逐步放弃支持。实际上HTTP&#x2F;2也是在SPDY&#x2F;3草案的基础上形成的协议初稿。</p>\n<h2 id=\"历史问题\"><a href=\"#历史问题\" class=\"headerlink\" title=\"历史问题\"></a>历史问题</h2><h3 id=\"传输资源与延迟\"><a href=\"#传输资源与延迟\" class=\"headerlink\" title=\"传输资源与延迟\"></a>传输资源与延迟</h3><p>当今的互联网环境和20世纪末那会儿已经有了很大的不同，现在的Web页面更像一个应用的概念，而非一个简单的页面（SPA）。从HTTPArchive一个页面下请求的资源数已经上百，请求的资源体积也接近2M。</p>\n<p><img src=\"https://raw.githubusercontent.com/bagder/http2-explained/master/images/transfer-size-growth.png\" alt=\"http-transfer-size\"></p>\n<p>随着这些年网络硬件条件的迅猛发展，<strong>带宽</strong>已经不再是影响人们体验的因素，而<strong>网络延迟</strong>仍然没有太好的改善。高延迟的网络上（比如移动设备），即使拥有高连接速率，也很难获得优质快速的网络体验。页面从访问到打开的近70%时间都发生在网络上。</p>\n<h3 id=\"请求-响应模型\"><a href=\"#请求-响应模型\" class=\"headerlink\" title=\"请求-响应模型\"></a>请求-响应模型</h3><p>HTTP1.1是无状态协议，需要以客户端请求开始，然后才能响应。一个TCP上同时只能有一个请求&#x2F;响应。TCP协议的能力并没有被充分利用。在HTTP1.1启用keep-alive后，TCP连接重复建立的问题被解决。但是请求还是需要排队一个一个发送，TCP的RTT（round-trip time）还是比较可观。后续的HTTP1.1提出了<strong>HTTP管线化</strong>（pipeline），即将多个HTTP请求合并成一个，一起发送，这样的确提高了服务器的资源利用率，但是也会带来线头阻塞（head-of-line blocking）问题，即一个比较耗时的请求会影响后续的所有请求。另外，它会给重试带来麻烦，需要网络中间节点的支持。所以这个特性并没有得到浏览器和服务器认可，实现也并不普及。目前大多数桌面浏览器也是默认关闭这个特性的。</p>\n<p><img src=\"https://mdn.mozillademos.org/files/13727/HTTP1_x_Connections.png\" alt=\"http-pipeline\"></p>\n<h4 id=\"那些年，我们一起克服延迟的办法\"><a href=\"#那些年，我们一起克服延迟的办法\" class=\"headerlink\" title=\"那些年，我们一起克服延迟的办法\"></a>那些年，我们一起克服延迟的办法</h4><p>针对上面的困难，智慧的开发者们自然也是有了许多应对办法。</p>\n<p><img src=\"https://raw.githubusercontent.com/bagder/http2-explained/master/images/spriting.jpg\"></p>\n<ul>\n<li>雪碧图：将小图片整合成一张大图。</li>\n<li>内联：将高优先级资源或小资源通过script标签或style标签或dataUrl的形式直接内嵌在页面里</li>\n<li>分片（sharding）与域名散列：将图片或者其他资源分发到不同主机。最初的HTTP1.1规范（RFC2616）提到一个客户端最多只能对同一主机建立两个TCP连接。后来，两个连接的限制被取消了（RFC7230），现在的浏览器一般允许每个域名主机建立6-8个连接。根据httparchive.org的记录显示，在Top30万个URL中平均使用40个TCP连接来显示页面</li>\n</ul>\n<p><img src=\"https://raw.githubusercontent.com/bagder/http2-explained/master/images/expressen-sharding.jpg\" alt=\"http-sharding\"></p>\n<p>除此之外，为了减少请求数，前端会将代码合并并打包，这也是webpack这样的工具诞生的背景。</p>\n<h3 id=\"冗长的头部\"><a href=\"#冗长的头部\" class=\"headerlink\" title=\"冗长的头部\"></a>冗长的头部</h3><p>HTTP1.1中1000+字节的头部都是常见的且体积较大的，如<code>Cookie</code>。头部信息有许多多余信息。这也让许多大请求建立连接的过程变得很慢。</p>\n<p>总结来看，HTTP1.1遗留了下面几个问题：</p>\n<ul>\n<li>对TCP利用较差，同时只能有一个请求&#x2F;响应<ul>\n<li>目前应对方法：开多个TCP连接（分片），减少请求数（合并资源）；这些方法多少会遇到TCP慢启动、DNS开销等问题</li>\n</ul>\n</li>\n<li>HTTP头部没有压缩，占用较大空间<ul>\n<li>目前应对方法：减少请求数、使用cookie-less域名</li>\n</ul>\n</li>\n<li>固有的请求-响应模式，重要资源无法优先推送<ul>\n<li>目前应对方法：内联资源</li>\n</ul>\n</li>\n</ul>\n<p>HTTP&#x2F;2对于上面这些问题自然是重拳出击。</p>\n<h2 id=\"HTTP-x2F-2概述\"><a href=\"#HTTP-x2F-2概述\" class=\"headerlink\" title=\"HTTP&#x2F;2概述\"></a>HTTP&#x2F;2概述</h2><blockquote>\n<p>“HTTP&#x2F;2 enables a more efficient use of network resources and a reduced perception of latency by introducing header field compression and allowing multiple concurrent exchanges on the same connection. It also introduces unsolicited push of representations from servers to clients.”</p>\n</blockquote>\n<p>根据<a href=\"https://httpwg.org/specs/rfc7540.html\">RFC7540</a>的摘要，简明扼要地点出了HTTP&#x2F;2带来的几个重要特性：</p>\n<ul>\n<li>多路复用的二进制协议；一个TCP连接上不再只有1个请求&#x2F;响应，同时采用二进制而非文本传输数据</li>\n<li>头部压缩；用二进制分帧配合专门设计的头部压缩算法（HPACK）大大减少头部体积，HPACK有专门的<a href=\"https://httpwg.github.io/specs/rfc7541.html\">RFC7541</a>来规范。</li>\n<li>服务器推送；在客户端发送请求前，主动将资源推送给客户端</li>\n</ul>\n<p>整个HTTP&#x2F;2实际上还是在HTTP的框架下的，对HTTP1.1也是完全兼容的，这意味着你可以像以前一样使用HTTP的API、方法、头部、状态码这些：</p>\n<ul>\n<li>HTTP&#x2F;2必须维持HTTP的范式。它只是一个让客户端发送请求到服务器的基于TCP的协议</li>\n<li>不能改变<code>http://</code>和<code>https://</code>这样的URL，也不能对其添加新的结构。使用这类URL的网站太多了，没法指望他们全部改变。</li>\n<li>HTTP1.1的服务器和客户端依然会存在很久，所以必须提供HTTP1.1到HTTP&#x2F;2服务器的代理</li>\n<li>不再使用小版本号。服务器和客户端都必须确定自己是否完整兼容http2或者彻底不兼容</li>\n</ul>\n<h3 id=\"协商\"><a href=\"#协商\" class=\"headerlink\" title=\"协商\"></a>协商</h3><p>SPDY依赖于TLS，不过从SPDY中诞生的HTTP&#x2F;2却可以选择是否基于TLS。由此带来2种HTTP&#x2F;2协商机制。对于普通的HTTP1.1，通过给服务器发送一个带升级头部的报文。如果服务器支持HTTP&#x2F;2，它将以“101 Switching”作为回复的状态码，并从此开始在该连接上使用HTTP&#x2F;2。这种连接方式也被称为<strong>h2c</strong>（HTTP&#x2F;2 cleartext），此时HTTP&#x2F;2在TCP之上运行。出于安全性考虑。<strong>几乎所有的主流浏览器都不支持这种协商实现</strong>（curl可以支持）。</p>\n<p>对于在TLS之上的https，Next Protocol Negotiation (NPN)是一个用来在TLS服务器上协商SPDY的协议。IETF将这个非正式标准进行规范化，从而演变成了ALPN（Application Layer Protocol Negotiation）。ALPN会伴随HTTP&#x2F;2中的使用而推广，考虑到SPDY会使用NPN，而许多服务器又会同时提供SPDY以及HTTP&#x2F;2，所以在这些服务器上同时支持ALPN以及NPN显然会成为最理所当然的选择。ALPN和NPN的主要区别在于，ALPN中由服务端最终决定通信协议，NPN中由客户端最终决定。</p>\n<h2 id=\"HTTP-x2F-2特性\"><a href=\"#HTTP-x2F-2特性\" class=\"headerlink\" title=\"HTTP&#x2F;2特性\"></a>HTTP&#x2F;2特性</h2><p>在HTTP&#x2F;2的介绍中提到，协议通过定义一个优化的基础连接的HTTP语义映射来解决HTTP1.1的问题。具体地，它允许在<strong>同一连接</strong>上<strong>交错</strong>地建立请求和响应消息，并使用<strong>高效率编码</strong>的HTTP报头字段。它还允许<strong>请求的优先级</strong>，让更多的重要的请求更快速的完成，进一步提升了性能。最终协议设计为对网络更友好，因为它相对HTTP&#x2F;1.x减少了TCP连接。最后，这种封装也通过使用<strong>二进制消息帧</strong>使信息处理更具扩展性。</p>\n<p>里面加粗的部分即HTTP&#x2F;2带来的几个新特性：</p>\n<ul>\n<li>单一TCP连接</li>\n<li>二进制分帧<ul>\n<li>请求优先级</li>\n<li>服务端推送</li>\n<li>流量控制</li>\n</ul>\n</li>\n<li>多路复用</li>\n<li>头部压缩（HPACK）</li>\n</ul>\n<h3 id=\"二进制分帧“层”\"><a href=\"#二进制分帧“层”\" class=\"headerlink\" title=\"二进制分帧“层”\"></a>二进制分帧“层”</h3><p>首先，HTTP&#x2F;2是个二进制协议。它的请求和响应都是流的形式，它基本的协议单位是帧。每个帧都有不同的类型和用途。HTTP&#x2F;2所有性能增强的核心也在于这个新的二进制分帧层，它定义了如何封装 HTTP 消息并在客户端与服务器之间传输。</p>\n<p><img src=\"https://developers.google.com/web/fundamentals/performance/http2/images/binary_framing_layer01.svg\" alt=\"http2-framing-layer\"></p>\n<p>从图中能看到，在TLS之上，HTTP&#x2F;2之下新增了一个二进制分帧层。这里所谓的“层”，指的是位于套接字接口与应用可见的高级HTTP API之间一个经过优化的新编码机制：HTTP的语义（包括各种动词、方法、标头）都不受影响，不同的是传输期间对它们的<strong>编码方式</strong>变了。不同于HTTP1.x里面用换行符作为分隔，HTTP&#x2F;2中将信息分割成帧，并进行二进制编码。整个分帧过程由客户端和服务端替我们完成。</p>\n<h3 id=\"数据流和帧\"><a href=\"#数据流和帧\" class=\"headerlink\" title=\"数据流和帧\"></a>数据流和帧</h3><p>上面这种二进制分帧机制改变了客户端与服务器之间交换数据的方式，也带来了流的概念。</p>\n<ul>\n<li>流（Stream）：一个双向字节帧流穿过HTTP&#x2F;2连接中的虚拟通道，可以承载一条或多条消息。</li>\n<li>消息：与逻辑请求或响应消息对应的完整的一系列帧。</li>\n</ul>\n<p>流的生存周期包含idle、reserved(local)、reserved(remote)、open、half closed(local)、half closed(remote)、closed多个阶段。状态间通过特定的帧类型流转。在不同状态下对应着不同的能力，对于<a href=\"https://tools.ietf.org/html/rfc7540#section-5.1\">状态规范</a>描述以外的操作请求都会给出协议错误（PROTOCOL_ERROR）。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">                         +--------+</span><br><span class=\"line\">                 send PP |        | recv PP</span><br><span class=\"line\">                ,--------|  idle  |--------.</span><br><span class=\"line\">               /         |        |         \\</span><br><span class=\"line\">              v          +--------+          v</span><br><span class=\"line\">       +----------+          |           +----------+</span><br><span class=\"line\">       |          |          | send H /  |          |</span><br><span class=\"line\">,------| reserved |          | recv H    | reserved |------.</span><br><span class=\"line\">|      | (local)  |          |           | (remote) |      |</span><br><span class=\"line\">|      +----------+          v           +----------+      |</span><br><span class=\"line\">|          |             +--------+             |          |</span><br><span class=\"line\">|          |     recv ES |        | send ES     |          |</span><br><span class=\"line\">|   send H |     ,-------|  open  |-------.     | recv H   |</span><br><span class=\"line\">|          |    /        |        |        \\    |          |</span><br><span class=\"line\">|          v   v         +--------+         v   v          |</span><br><span class=\"line\">|      +----------+          |           +----------+      |</span><br><span class=\"line\">|      |   half   |          |           |   half   |      |</span><br><span class=\"line\">|      |  closed  |          | send R /  |  closed  |      |</span><br><span class=\"line\">|      | (remote) |          | recv R    | (local)  |      |</span><br><span class=\"line\">|      +----------+          |           +----------+      |</span><br><span class=\"line\">|           |                |                 |           |</span><br><span class=\"line\">|           | send ES /      |       recv ES / |           |</span><br><span class=\"line\">|           | send R /       v        send R / |           |</span><br><span class=\"line\">|           | recv R     +--------+   recv R   |           |</span><br><span class=\"line\">| send R /  `-----------&gt;|        |&lt;-----------&#x27;  send R / |</span><br><span class=\"line\">| recv R                 | closed |               recv R   |</span><br><span class=\"line\">`-----------------------&gt;|        |&lt;----------------------&#x27;</span><br><span class=\"line\">                         +--------+</span><br><span class=\"line\"></span><br><span class=\"line\">   send:   endpoint sends this frame</span><br><span class=\"line\">   recv:   endpoint receives this frame</span><br><span class=\"line\"></span><br><span class=\"line\">   H:  HEADERS frame (with implied CONTINUATIONs)</span><br><span class=\"line\">   PP: PUSH_PROMISE frame (with implied CONTINUATIONs)</span><br><span class=\"line\">   ES: END_STREAM flag</span><br><span class=\"line\">   R:  RST_STREAM frame</span><br></pre></td></tr></table></figure>\n\n<p>流和帧的关系是：</p>\n<ul>\n<li>所有通信都在一个TCP连接上完成，这个连接可以承载任意数量的流</li>\n<li>每个流上面都有唯一标识符和<em>可选</em>的优先级信息，里面会承载要传递的消息</li>\n<li>每条消息都是一条逻辑HTTP信息（如请求或相应），有完整的HTTP语义，其中可能有一个或多个帧</li>\n<li>帧是最小的通信单位，承载着特定类型的数据，例如HTTP 标头、消息负载等等。帧可以<strong>交错发送</strong>，然后再根据帧头的数据流标识符进行组装</li>\n</ul>\n<p><img src=\"https://developers.google.com/web/fundamentals/performance/http2/images/streams_messages_frames01.svg\" alt=\"http2-frame\"></p>\n<p>所有的帧以8字节的报头开始并且跟着0到16383字节长度的主体。帧格式如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> 0                   1                   2                   3</span><br><span class=\"line\"> 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class=\"line\">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class=\"line\">| R |     Length (14)           |   Type (8)    |   Flags (8)   |</span><br><span class=\"line\">+-+-+-----------+---------------+-------------------------------+</span><br><span class=\"line\">|R|                 Stream Identifier (31)                      |</span><br><span class=\"line\">+=+=============================================================+</span><br><span class=\"line\">|                   Frame Payload (0...)                      ...</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<p>其中：</p>\n<ul>\n<li>R：保留字段</li>\n<li>Length：14位无符号整数的帧主体长度</li>\n<li>Type：帧类型，它描述了剩余的帧报头和帧主体将如何被解释</li>\n<li>Flags：为帧类型保留的8位布尔类型字段，根据不同帧类型赋予不同语义</li>\n<li>Stream Identifier：31字节的流标识符(见StreamIdentifiers)。0是保留的，标明帧是与连接相关作为一个整体而不是一个单独的流。</li>\n</ul>\n<h3 id=\"请求与响应复用\"><a href=\"#请求与响应复用\" class=\"headerlink\" title=\"请求与响应复用\"></a>请求与响应复用</h3><p>在HTTP1.1中，客户端要想发起多个并行请求以提升性能，则必须使用多个TCP连接，这种对TCP效率低下的利用，在HTTP&#x2F;2中得到改善。二进制分帧层将HTTP消息分解为互不依赖的帧，然后交错发送，最后再在另一端把它们重新组装起来。</p>\n<p><img src=\"https://developers.google.com/web/fundamentals/performance/http2/images/multiplexing01.svg\" alt=\"http2-reusing\"></p>\n<p>在上图中，流1和流3交错在同一个TCP连接上并行运行。这种机制带来了下面一些具体的提升：</p>\n<ul>\n<li>请求之间交错且互不影响</li>\n<li>响应之间交错且互不影响</li>\n<li>可以使用一个连接并行发送多个请求和响应</li>\n<li>不必再为了优化HTTP1.1性能做雪碧图、分片等骚操作</li>\n<li>一定程度上解决了线头阻塞问题</li>\n</ul>\n<h3 id=\"流控制\"><a href=\"#流控制\" class=\"headerlink\" title=\"流控制\"></a>流控制</h3><p>HTTP&#x2F;2的流控制类似TCP，但是更为精细和更靠近应用层。借助HTTP&#x2F;2流控制，可以实现在用户暂停一个大型视频流后，减少或阻塞视频里带来的HTTP流量，又或者中间代理匹配上下游流量速率。HTTP&#x2F;2流控制提出了一些规则，但<strong>并没有指出特定算法</strong>，目标在于允许不需要协议改动的情况下改进流量控制算法。</p>\n<ul>\n<li>流量控制是逐跳的，而不是头尾端点的</li>\n<li>流量控制是基于窗口更新帧的。接收端广播自己准备在流及整个连接过程中接收的字节大小。这是一个信用为基础的方案。</li>\n<li>流量控制是有方向性的，由接收端全权掌握。</li>\n<li>流量控制窗口初始值是65,535字节，不过接收方可以设置一个更大的值</li>\n<li>帧类型决定了是否适用流量控制规则。目前只有DATA帧受流量控制</li>\n<li>不能被禁用</li>\n<li>通过使用<code>WINDOW_UPDATE</code>帧类型来实现</li>\n</ul>\n<h3 id=\"流优先级\"><a href=\"#流优先级\" class=\"headerlink\" title=\"流优先级\"></a>流优先级</h3><p>HTTP&#x2F;2标准允许每个数据流都有一个关联的权重和依赖关系：</p>\n<ul>\n<li>可以向每个数据流分配一个介于1至256之间的整数。</li>\n<li>每个数据流与其他数据流之间可以存在显式依赖关系。</li>\n</ul>\n<p>优先级的目的是让客户端可以构建和传递“优先级树”，表明它倾向于如何接收响应。反过来，服务器可以使用此信息通过控制CPU、内存和其他资源的分配设定数据流处理的优先级。</p>\n<p><img src=\"https://developers.google.com/web/fundamentals/performance/http2/images/stream_prioritization01.svg\" alt=\"http2-priority\"></p>\n<p>数据流依赖关系通过将另一个数据流的唯一标识符作为父项引用进行声明；如果忽略标识符，相应数据流将依赖于“根数据流”。分配时，会尽可能先向父数据流分配资源，然后再向其依赖项分配资源。共享相同父项的数据流按其权重比例分配资源。在上图中，数据流B获得的资源是数据流A所获资源的三分之一。</p>\n<p>新建流的终端可以在报头帧中包含优先级信息来对流标记优先级。对于已存在的流，优先级帧可以用来改变流优先级。</p>\n<p>更详细规范参考<a href=\"https://tools.ietf.org/html/rfc7540#section-5.3\">RFC</a>。</p>\n<h3 id=\"帧类型\"><a href=\"#帧类型\" class=\"headerlink\" title=\"帧类型\"></a>帧类型</h3><h4 id=\"DATA\"><a href=\"#DATA\" class=\"headerlink\" title=\"DATA\"></a>DATA</h4><p>数据帧，类型0x0，传递和流关联的任意变量值长度的字节数据。例如，一个或多个数据帧被用来携带HTTP请求或者响应的载体。数据帧定义了以下标记：</p>\n<ul>\n<li>END_STREAM (0x1) ：用来表示当前帧是确定的流发送的最后一帧。设置这个标记时流进入到一种半封闭状态或者关闭状态。</li>\n<li>END_SEGMENT (0x2) ：表示是当前端的最后一帧。代理端绝对不能跨越多个端的边界来合并帧，转发帧的时候代理端必须保持片段的边界。</li>\n<li>PADDED (0x8) ： 位4用来表示Pad Length字段是可见的。</li>\n</ul>\n<p>数据帧绝对需要与流相关联，且遵从流量控制。</p>\n<h4 id=\"HEADERS\"><a href=\"#HEADERS\" class=\"headerlink\" title=\"HEADERS\"></a>HEADERS</h4><p>报头帧，类型0x1，用来打开一个流，并携带头部片段。能在流打开或者半封闭(远程)的状态下发送。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+---------------+</span><br><span class=\"line\">|Pad Length? (8)|</span><br><span class=\"line\">+-+-------------+-----------------------------------------------+</span><br><span class=\"line\">|E|                 Stream Dependency? (31)                     |</span><br><span class=\"line\">+-+-------------+-----------------------------------------------+</span><br><span class=\"line\">|  Weight? (8)  |</span><br><span class=\"line\">+-+-------------+-----------------------------------------------+</span><br><span class=\"line\">|                   Header Block Fragment (*)                 ...</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br><span class=\"line\">|                           Padding (*)                       ...</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<p>它有以下标记：</p>\n<ul>\n<li>END_STREAM (0x1) ：用来标识这是发送端对确定的流发送的最后报头区块。设置这个标记将使流进入一种半封闭状态。后面伴随带有END_STREAM标记的延续帧的报头帧表示流的终止。延续帧不用来终止流。</li>\n<li>END_SEGMENT (0x2) ：表示这是当前端的最后一帧。中介端绝对不能跨片段来合并帧，且在转发帧的时候必须保持片段的边界。</li>\n<li>END_HEADERS (0x4) ：表示帧包含了整个的报头块，且后面没有延续帧。不带有END_HEADERS标记的报头帧在同个流上后面必须跟着延续帧。</li>\n<li>PADDED (0x8) ：表示Pad Length字段会呈现。</li>\n<li>PRIORITY (0x8) ：设置指示专用标记(E)，流依赖及权重字段将会呈现</li>\n</ul>\n<h4 id=\"PRIORITY\"><a href=\"#PRIORITY\" class=\"headerlink\" title=\"PRIORITY\"></a>PRIORITY</h4><p>优先级帧，类型0x2。明确了发送者建议的流的优先级，它可以在任意时间的流中发送。优先级帧不包含任何标记（flag）。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> 0                   1                   2                   3</span><br><span class=\"line\"> 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class=\"line\">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class=\"line\">|E|                  Stream Dependency (31)                     |</span><br><span class=\"line\">+-+-------------+-----------------------------------------------+</span><br><span class=\"line\">|   Weight (8)  |</span><br><span class=\"line\">+-+-------------+</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"RST-STREAM\"><a href=\"#RST-STREAM\" class=\"headerlink\" title=\"RST_STREAM\"></a>RST_STREAM</h4><p>类型0x3，允许流的立即终止。通常用来取消一个流，或表示有错误发生。绝不应该在idle状态下发出。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0                   1                   2                   3</span><br><span class=\"line\">0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class=\"line\">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class=\"line\">|                        Error Code (32)                        |</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"SETTINGS\"><a href=\"#SETTINGS\" class=\"headerlink\" title=\"SETTINGS\"></a>SETTINGS</h4><p>设置帧，类型0x4。包含影响如何与终端通信的设置参数，并且用来确认这些参数的接收。设置帧<em>必须</em>由两个终端在连接开始的时候发送，并且<em>可以</em>由各个终端在连接生存期的任意时间发送。</p>\n<h4 id=\"PUSH-PROMISE\"><a href=\"#PUSH-PROMISE\" class=\"headerlink\" title=\"PUSH_PROMISE\"></a>PUSH_PROMISE</h4><p>推送承诺帧，类型0x5。用来在流发送者准备发送流之前告知对等端。包含了终端准备创建的长流的31位无符号标记以及提供附加上下文的报头的集合。通常在服务器中使用。推送承诺的接收端可以选择给推送承诺的发送端返回一个与被承诺的流标识符相关的RST_STREAM标记来拒绝接收承诺流。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0                   1                   2                   3</span><br><span class=\"line\">0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class=\"line\">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class=\"line\">| [Pad High(8)] | [Pad Low (8)] |X|  Promised Stream ID (31)  ...</span><br><span class=\"line\">+---------------+---------------+-+-----------------------------+</span><br><span class=\"line\">...    Promised Stream ID       | Header Block Fragment (*)   ...</span><br><span class=\"line\">+-------------------------------+-------------------------------+</span><br><span class=\"line\">|                   Header Block Fragment (*)                 ...</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br><span class=\"line\">|                           Padding (*)                       ...</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"PING\"><a href=\"#PING\" class=\"headerlink\" title=\"PING\"></a>PING</h4><p>类型0x6。从发送端测量最小的RTT时间的机制，同样也是一种检测连接是否可用的方法。PING帧可以被任何终端发送，且必须在载体中包含一个8字节长度的任意数据。</p>\n<h4 id=\"GOAWAY\"><a href=\"#GOAWAY\" class=\"headerlink\" title=\"GOAWAY\"></a>GOAWAY</h4><p>超时帧，类型0x7。通知远端对等端不要在这个连接上建立新流。超时帧可以由客户端或者服务端发送。发送后，可以针对新的流创建一个新的连接。这个帧的目的是允许终端优雅的停止接收新的流，但仍可以继续完成之前已经建立的流的处理。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0                   1                   2                   3</span><br><span class=\"line\">0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class=\"line\">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class=\"line\">|X|                  Last-Stream-ID (31)                        |</span><br><span class=\"line\">+-+-------------------------------------------------------------+</span><br><span class=\"line\">|                      Error Code (32)                          |</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br><span class=\"line\">|                  Additional Debug Data (*)                    |</span><br><span class=\"line\">+---------------------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<p>32位的错误码中包含了关闭连接的原因。</p>\n<h4 id=\"WINDOW-UPDATE\"><a href=\"#WINDOW-UPDATE\" class=\"headerlink\" title=\"WINDOW_UPDATE\"></a>WINDOW_UPDATE</h4><p>窗口更新帧，类型0x8。用来实现流控制。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0                   1                   2                   3</span><br><span class=\"line\">0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1</span><br><span class=\"line\">+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</span><br><span class=\"line\">|X|              Window Size Increment (31)                     |</span><br><span class=\"line\">+-+-------------------------------------------------------------+</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"CONTINUATION\"><a href=\"#CONTINUATION\" class=\"headerlink\" title=\"CONTINUATION\"></a>CONTINUATION</h4><p>延续帧，类型0x9，用来延续一个报头区块。在END_HEADERS标记前，可以在HEADERS帧、PUSH_PROMISE帧以及CONTINUATION帧后接续任意数量的CONTINUATION帧。它包含一个flag：</p>\n<ul>\n<li>END_HEADERS (0x4) : 设置指示这个帧的报头区块的终止</li>\n</ul>\n<p>延续帧必须与流相关联。如果延续帧的相关流表示字段是0x0，终端必须响应一个类型为协议错误的连接错误。</p>\n<h3 id=\"服务器推送\"><a href=\"#服务器推送\" class=\"headerlink\" title=\"服务器推送\"></a>服务器推送</h3><p><img src=\"https://developers.google.com/web/fundamentals/performance/http2/images/push01.svg\" alt=\"http2-server-push\"></p>\n<p>HTTP&#x2F;2中的服务器推送打破了原来HTTP中的请求-响应语义（对原有语义也做了<a href=\"https://tools.ietf.org/html/rfc7540#section-8.1\">改进</a>），支持服务器可以对一个客户端请求发送多个响应。在原先的HTTP1.1中我们可能会将重要资源内联到网页中，减少网络延迟，这实际上等同于HTTP&#x2F;2中的强制推送。在HTTP&#x2F;2中的服务器推送还有下面一些功能：</p>\n<ul>\n<li>推送的资源能被客户端缓存（服务器也只能推送可被缓存的资源）</li>\n<li>在不同页面之间可以重用</li>\n<li>可以由服务器设定优先级</li>\n<li>可以被客户端拒绝</li>\n</ul>\n<p>服务器推送数据流由PUSH_PROMISE帧发起，需要先于请求推送资源的响应数据传输。实现上的策略是先于父响应（即，DATA 帧）发送所有PUSH_PROMISE帧，其中包含所承诺资源的HTTP头部。客户端接收到PUSH_PROMISE帧后，它可以根据自身情况选择接受拒绝（通过RST_STREAM帧）数据流。（例如，如果资源已经位于缓存中）</p>\n<p>客户端完全掌控服务器推送的使用方式。客户端可以限制并行推送的数据流数量；调整初始的流控制窗口以控制在数据流首次打开时推送的数据量；或完全停用服务器推送。这些在HTTP&#x2F;2连接开始时通过SETTINGS帧传输，可能随时更新。</p>\n<h3 id=\"头部压缩\"><a href=\"#头部压缩\" class=\"headerlink\" title=\"头部压缩\"></a>头部压缩</h3><p>在HTTP1.1中，头部数据使用以纯文本的形式传输，所占空间较大，在使用HTTP Cookie后，更是会达到上千字节。为了减少此开销和提升性能，HTTP&#x2F;2使用专门设计的<a href=\"https://httpwg.github.io/specs/rfc7541.html\">HPACK</a>压缩格式压缩请求和响应头部，这种格式通过静态霍夫曼编码对传输的头部字段进行编码。HPACK要求客户端和服务器同时维护和更新一个包含之前见过的标头字段的索引列表，利用之前传输值的索引列表，我们可以通过传输索引值的方式对重复值进行编码，索引值可用于有效查询和重构完整的头部键值对。</p>\n<p><img src=\"https://developers.google.com/web/fundamentals/performance/http2/images/header_compression01.svg\" alt=\"hpack\"></p>\n<p>作为一种进一步优化方式，HPACK压缩上下文包含一个<a href=\"https://httpwg.org/specs/rfc7541.html#static.table.definition\">静态表</a>和一个动态表：静态表在规范中定义，并提供了一个所有连接都可能使用的常用HTTP头部字段列表；动态表最初为空，将根据在特定连接内交换的值进行更新。</p>\n<p>早期版本的HTTP&#x2F;2和SPDY使用的<a href=\"https://tools.ietf.org/html/rfc1951\">DEFLATE</a>对头部进行压缩，但是在2012年夏天出现了<a href=\"https://en.wikipedia.org/w/index.php?title=CRIME&oldid=660948120\">CRIME</a>这种安全攻击。因此，之后HTTP&#x2F;2的头部压缩采用了专门设计的HPACK方案。在使用HPACK后，初次访问后的压缩率能达到70%~80%，甚至90%+。</p>\n<h2 id=\"支持度与调试\"><a href=\"#支持度与调试\" class=\"headerlink\" title=\"支持度与调试\"></a>支持度与调试</h2><p>支持度上，<a href=\"https://caniuse.com/#search=http%2F2\">主流浏览器</a>和<a href=\"https://github.com/http2/http2-spec/wiki/Implementations\">服务器程序</a>都已支持。你也可以访问<a href=\"https://http2.akamai.com/demo\">这个网址</a>体验HTTP&#x2F;2和HTTP1.1在load大量图片时的延迟对比。</p>\n<p>如果你想确认当前网页中的哪些请求是使用的HTTP&#x2F;2，可以在chrome devTools下的network选项卡里查看“Protocol”列（未发现此列的可以在表头右键找到并勾选显示），其中HTTP&#x2F;2将显示为h2。正如之前所说，支持HTTP&#x2F;2的浏览器会和服务器使用特定协议协商，对于不支持HTTP&#x2F;2的情况，会自动会退到HTTP1.1版本。</p>\n<p>尽管HTTP&#x2F;2使用二进制传输数据，然而浏览器为我们掩盖了实现细节。如果想要深入查看甚至是调试二进制分帧层的功能，如何去debug呢？</p>\n<ul>\n<li>Wireshark</li>\n<li>curl</li>\n<li><a href=\"https://github.com/bradfitz/http2/tree/master/h2i\">h2i</a>，不过这个好像已经不维护了</li>\n</ul>\n<h2 id=\"TLS调优\"><a href=\"#TLS调优\" class=\"headerlink\" title=\"TLS调优\"></a>TLS调优</h2><p>目前各大浏览器只在<code>https://</code>的基础上支持HTTP&#x2F;2，即在TLS层之上的HTTP&#x2F;2。多出的TLS的层也是会增加时延和成本的，具体涉及到的TLS握手、会话和加密套件协商过程还有优化空间，如减少证书层级、减少证书大小等。其余优化方向可以查看参考中一些文章介绍。</p>\n<h2 id=\"之前的优化还应该继续用么\"><a href=\"#之前的优化还应该继续用么\" class=\"headerlink\" title=\"之前的优化还应该继续用么\"></a>之前的优化还应该继续用么</h2><h3 id=\"继续保持的\"><a href=\"#继续保持的\" class=\"headerlink\" title=\"继续保持的\"></a>继续保持的</h3><ul>\n<li>减少DNS查询<ul>\n<li>减少域名</li>\n<li>启用预读：dns-prefetch</li>\n</ul>\n</li>\n<li>使用CDN</li>\n<li>避免重定向</li>\n<li>资源压缩<ul>\n<li>代码压缩（JS、HTML、CSS）</li>\n<li>资源压缩（图片、字体、音频、视频）</li>\n<li>文本压缩（Gzip）</li>\n</ul>\n</li>\n<li>使用缓存</li>\n</ul>\n<h3 id=\"不再需要的\"><a href=\"#不再需要的\" class=\"headerlink\" title=\"不再需要的\"></a>不再需要的</h3><ul>\n<li>分片与域名散列：HTTP&#x2F;2对于一个域名只使用一个TCP连接，分片反而会浪费资源，同时也会影响流控制、头部压缩的表现。</li>\n<li>资源打包合并：HTTP&#x2F;2支持多路复用，资源合并会降低缓存利用率，且会让开发流程更复杂。（<a href=\"https://github.com/pikapkg/snowpack\">snowpack</a>了解一下）</li>\n<li>资源内联：可以由服务器推送解决这类需求，资源内联一方面无法缓存，另一方面会让页面代码更大</li>\n</ul>\n<h2 id=\"常见问题\"><a href=\"#常见问题\" class=\"headerlink\" title=\"常见问题\"></a>常见问题</h2><ul>\n<li>Q: 既然HTTP&#x2F;2是在SPDY工作基础上设计的，那HTTP&#x2F;2推出后，SPDY还使用吗</li>\n<li>A: Google公开声明了他们会在2016年移除Chrome里对SPDY和NPN的支持，并且极力推动服务器迁移至HTTP&#x2F;2。2016年2月他们<a href=\"https://blog.chromium.org/2016/02/transitioning-from-spdy-to-http2.html\">声明</a>了SPDY和NPN会在Chrome 51之后被移除。</li>\n<li>Q: 这个协议是否只对大型网站有效</li>\n<li>A: 由于缺乏内容分发网络，小网站的网络延迟往往较高，而多路复用的能力可以极大的改善在高网络延迟下的体验。</li>\n<li>Q: 基于TLS让速度变得更慢</li>\n<li>A: 正如上一节提到的，TLS的握手确实增加了额外的开销，也有越来越多的方案提出来减少TLS往返的时间。TLS同时也会更多消耗CPU等资源，更多例子可见<a href=\"https://istlsfastyet.com/\">istlsfastyet.com</a>。不过一方面HTTP&#x2F;2并不强制要求基于TLS，另一方面HTTP&#x2F;2带来的性能提升使得即使基于TLS，通常也会比HTTP1.1更快</li>\n<li>Q: 为什么不使用文本传输</li>\n<li>A: 的确，如果可以直接读出协议内容，那么调试和追踪都会变得更为简单。但是二进制带来的灵活度更高，何况浏览器会自动帮你解析。</li>\n<li>Q: 看起来，HTTP1.1中的一些短板并没有改彻底</li>\n<li>A: 实际上，设计HTTP&#x2F;2之初的目标就包括向前兼容HTTP&#x2F;1.1的范式，来保证升级协议也不用重写底层的很多东西。老的HTTP功能，如协议头、状态码、可怕的Cookie，这些都保留了。性能优化更多通过增加了一个中间分帧层解决的。</li>\n<li>Q: 目前使用的广泛程度如何</li>\n<li>A: 在2015年年底大多数浏览器就已经支持HTTP&#x2F;2，目前约96%的浏览器支持HTTP&#x2F;2，同时约46%的网站支持HTTP&#x2F;2。</li>\n</ul>\n<h2 id=\"后续\"><a href=\"#后续\" class=\"headerlink\" title=\"后续\"></a>后续</h2><ul>\n<li>官网在给出HTTP&#x2F;2规范时，也曾预计要10年时间和HTTP1.1并存，在这个期间，Web优化的思路也可能会有调整</li>\n<li><a href=\"https://wiki.openssl.org/index.php/TLS1.3\">TLS1.3</a>。2020年2月的<a href=\"https://tools.ietf.org/html/rfc8740\">RFC8740</a>中给出了基于TLS1.3的HTTP&#x2F;2的实现建议。</li>\n<li>既然TCP容易遇到线头阻塞问题，那么能不用使用UDP呢？Google提出的<a href=\"https://www.chromium.org/quic\">QUIC</a>（Quick UDP Internet Connection）它在很大程度上继承了SPDY的衣钵。QUIC可以理解成TCP + TLS + HTTP&#x2F;2替代实现。</li>\n<li>2018年10月，互联网工程任务组HTTP及QUIC工作小组正式将基于QUIC协议的HTTP（英语：HTTP over QUIC）重命名为<a href=\"https://datatracker.ietf.org/doc/draft-ietf-quic-http/\">HTTP&#x2F;3</a>以为确立下一代规范做准备。</li>\n</ul>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li><a href=\"https://imququ.com/post/http2-new-opportunities-and-challenges.html\">HTTP&#x2F;2：新的机遇与挑战</a></li>\n<li><a href=\"https://imququ.com/post/http2-resource.html\">HTTP&#x2F;2 资料汇总</a></li>\n<li><a href=\"https://http2.github.io/\">HTTP&#x2F;2官网</a></li>\n<li><a href=\"https://httpwg.org/specs/rfc7540.html\">HTTP&#x2F;2规范</a></li>\n<li><a href=\"https://httpwg.github.io/specs/rfc7541.html\">HPACK规范</a></li>\n<li><a href=\"https://developers.google.com/web/fundamentals/performance/http2\">HTTP&#x2F;2简介</a></li>\n<li><a href=\"https://ye11ow.gitbooks.io/http2-explained/content/\">HTTP&#x2F;2讲解</a></li>\n<li><a href=\"https://imququ.com/post/header-compression-in-http2.html\">HTTP&#x2F;2 头部压缩技术介绍</a></li>\n<li><a href=\"https://github.com/fex-team/http2-spec/blob/master/HTTP2%E4%B8%AD%E8%8B%B1%E5%AF%B9%E7%85%A7%E7%89%88(06-29).md\">HTTP&#x2F;2草案13中英对照</a></li>\n<li><a href=\"https://www.mnot.net/talks/h2fe/#8\">HTTP&#x2F;2 for Front-End Developers</a></li>\n<li><a href=\"http://velocityconf.com/devops-web-performance-2015/public/schedule/detail/42385\">HTTP&#x2F;2 is here, let’s optimize!</a></li>\n<li><a href=\"https://caniuse.com/#search=HTTP%2F2\">HTTP&#x2F;2支持度</a></li>\n<li><a href=\"https://github.com/http2/http2-spec/wiki/Implementations\">HTTP&#x2F;2实现列表</a></li>\n<li><a href=\"https://www.chainnews.com/articles/401950499827.htm\">HTTP发展史梳理笔记</a></li>\n<li><a href=\"https://http2.akamai.com/demo\">HTTP&#x2F;2 is the future of the Web | Akamai</a></li>\n</ul>\n",
            "tags": [
                "HTTP",
                "HTTP/2",
                "SPDY",
                "QUIC"
            ]
        }
    ]
}