<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/blog/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon.png">
  <link rel="mask-icon" href="/blog/favicon.png" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"shenlvmeng.github.com","root":"/blog/","images":"/blog/images","scheme":"Muse","darkmode":false,"version":"8.14.1","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"algolia":{"appID":"N573WZGUR1","apiKey":"f4b654279103617a4cefb92a132ff0c3","indexName":"blog","hits":{"per_page":10}}}</script><script src="/blog/js/config.js"></script>

    <meta name="description" content="php.net  简介PHP来源于工程PHP&#x2F;FI，由Rasmus Lerdorf创建于1995年，起初只是一套简单的Perl脚本，名字叫做“Personal Home Page Tools”，语法也和Perl很像，随着用户的增加，改进为用C语言实现。1997年，Andi Gutmans 和 Zeev Suraski 重写了代码，推出第三版，PHP&#x2F;FI也演变成PHP（PHP">
<meta property="og:type" content="article">
<meta property="og:title" content="（旧文）PHP语言介绍">
<meta property="og:url" content="http://shenlvmeng.github.com/blog/2019/09/10/php-note/">
<meta property="og:site_name" content="Shenlvmeng&#39;s Blog">
<meta property="og:description" content="php.net  简介PHP来源于工程PHP&#x2F;FI，由Rasmus Lerdorf创建于1995年，起初只是一套简单的Perl脚本，名字叫做“Personal Home Page Tools”，语法也和Perl很像，随着用户的增加，改进为用C语言实现。1997年，Andi Gutmans 和 Zeev Suraski 重写了代码，推出第三版，PHP&#x2F;FI也演变成PHP（PHP">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-09-10T13:02:17.000Z">
<meta property="article:modified_time" content="2019-09-10T13:04:17.978Z">
<meta property="article:author" content="shenlvmeng">
<meta property="article:tag" content="PHP">
<meta property="article:tag" content="参考">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://shenlvmeng.github.com/blog/2019/09/10/php-note/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://shenlvmeng.github.com/blog/2019/09/10/php-note/","path":"2019/09/10/php-note/","title":"（旧文）PHP语言介绍"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>（旧文）PHP语言介绍 | Shenlvmeng's Blog</title>
  






  <script async defer data-website-id="" src=""></script>

  <script defer data-domain="" src=""></script>

  <noscript>
    <link rel="stylesheet" href="/blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Shenlvmeng's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container">
  <div class="algolia-stats"><hr></div>
  <div class="algolia-hits"></div>
  <div class="algolia-pagination"></div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE"><span class="nav-number">2.</span> <span class="nav-text">安装和配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E6%AE%B5%E4%BB%A3%E7%A0%81"><span class="nav-number">3.</span> <span class="nav-text">第一段代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E6%80%A7%E5%8F%82%E8%80%83"><span class="nav-number">4.</span> <span class="nav-text">特性参考</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PHP%E6%A0%87%E8%AF%86"><span class="nav-number">4.1.</span> <span class="nav-text">PHP标识</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B-amp-%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-number">4.2.</span> <span class="nav-text">类型 &amp; 类型转换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#boolean"><span class="nav-number">4.2.1.</span> <span class="nav-text">boolean</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#integer"><span class="nav-number">4.2.2.</span> <span class="nav-text">integer</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#float"><span class="nav-number">4.2.3.</span> <span class="nav-text">float</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#string"><span class="nav-number">4.2.4.</span> <span class="nav-text">string</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#array"><span class="nav-number">4.2.5.</span> <span class="nav-text">array</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#object"><span class="nav-number">4.2.6.</span> <span class="nav-text">object</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#resource"><span class="nav-number">4.2.7.</span> <span class="nav-text">resource</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NULL"><span class="nav-number">4.2.8.</span> <span class="nav-text">NULL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#callback"><span class="nav-number">4.2.9.</span> <span class="nav-text">callback</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-number">4.2.10.</span> <span class="nav-text">类型转换</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F-amp-%E5%B8%B8%E9%87%8F"><span class="nav-number">4.3.</span> <span class="nav-text">变量 &amp; 常量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E5%8F%98%E5%8F%98%E9%87%8F"><span class="nav-number">4.3.1.</span> <span class="nav-text">可变变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%84%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="nav-number">4.3.2.</span> <span class="nav-text">预定义变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-number">4.3.3.</span> <span class="nav-text">作用域</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E9%87%8F"><span class="nav-number">4.3.4.</span> <span class="nav-text">常量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F-amp-%E6%B5%81%E7%A8%8B"><span class="nav-number">4.4.</span> <span class="nav-text">表达式 &amp; 流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">4.5.</span> <span class="nav-text">函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB-amp-%E5%AF%B9%E8%B1%A1"><span class="nav-number">4.6.</span> <span class="nav-text">类 &amp; 对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#trait-amp-%E5%8C%BF%E5%90%8D%E7%B1%BB"><span class="nav-number">4.6.1.</span> <span class="nav-text">trait &amp; 匿名类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%80%9C%E9%87%8D%E8%BD%BD%E2%80%9D"><span class="nav-number">4.6.2.</span> <span class="nav-text">“重载”</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="nav-number">4.6.3.</span> <span class="nav-text">魔术方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%84%E5%AE%9A%E4%B9%89%E6%8E%A5%E5%8F%A3"><span class="nav-number">4.6.4.</span> <span class="nav-text">预定义接口</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="nav-number">4.7.</span> <span class="nav-text">命名空间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E5%92%8C%E5%BC%82%E5%B8%B8"><span class="nav-number">4.8.</span> <span class="nav-text">错误和异常</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%EF%BC%88generator%EF%BC%89"><span class="nav-number">4.9.</span> <span class="nav-text">生成器（generator）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E7%94%A8"><span class="nav-number">4.10.</span> <span class="nav-text">引用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%AF%E6%8C%81%E7%9A%84%E5%8D%8F%E8%AE%AE"><span class="nav-number">4.11.</span> <span class="nav-text">支持的协议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E8%80%83"><span class="nav-number">5.</span> <span class="nav-text">函数参考</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E6%A0%B8"><span class="nav-number">5.1.</span> <span class="nav-text">内核</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E7%BB%84"><span class="nav-number">5.1.1.</span> <span class="nav-text">数组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">5.1.2.</span> <span class="nav-text">字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%98%E9%87%8F"><span class="nav-number">5.1.3.</span> <span class="nav-text">变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1"><span class="nav-number">5.1.4.</span> <span class="nav-text">类和对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4"><span class="nav-number">5.1.5.</span> <span class="nav-text">日期和时间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">5.1.6.</span> <span class="nav-text">文件系统</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="nav-number">5.1.7.</span> <span class="nav-text">错误处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#session"><span class="nav-number">5.1.8.</span> <span class="nav-text">session</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="nav-number">5.1.9.</span> <span class="nav-text">进程控制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8"><span class="nav-number">5.1.10.</span> <span class="nav-text">函数调用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Hash"><span class="nav-number">5.1.11.</span> <span class="nav-text">Hash</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PHP%E8%87%AA%E8%BA%AB"><span class="nav-number">5.1.12.</span> <span class="nav-text">PHP自身</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6"><span class="nav-number">5.1.13.</span> <span class="nav-text">数学</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E6%8E%A7%E5%88%B6"><span class="nav-number">5.1.14.</span> <span class="nav-text">输出控制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9D%82%E9%A1%B9"><span class="nav-number">5.1.15.</span> <span class="nav-text">杂项</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%91%E5%AE%9A%E6%8B%93%E5%B1%95%E5%BA%93"><span class="nav-number">5.2.</span> <span class="nav-text">绑定拓展库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Ctype"><span class="nav-number">5.2.1.</span> <span class="nav-text">Ctype</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-number">5.2.2.</span> <span class="nav-text">正则表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON"><span class="nav-number">5.2.3.</span> <span class="nav-text">JSON</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E5%AD%97%E8%8A%82%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">5.2.4.</span> <span class="nav-text">多字节字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BCMath"><span class="nav-number">5.2.5.</span> <span class="nav-text">BCMath</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86"><span class="nav-number">5.2.6.</span> <span class="nav-text">图像处理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exif"><span class="nav-number">5.2.7.</span> <span class="nav-text">Exif</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Socket"><span class="nav-number">5.2.8.</span> <span class="nav-text">Socket</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E9%83%A8%E6%8B%93%E5%B1%95%E5%BA%93"><span class="nav-number">5.3.</span> <span class="nav-text">外部拓展库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#client-URL"><span class="nav-number">5.3.1.</span> <span class="nav-text">client URL</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%B9%E8%89%B2"><span class="nav-number">6.</span> <span class="nav-text">特色</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E5%85%A8"><span class="nav-number">7.</span> <span class="nav-text">安全</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">7.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session%E5%AE%89%E5%85%A8"><span class="nav-number">7.2.</span> <span class="nav-text">Session安全</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F-1"><span class="nav-number">7.3.</span> <span class="nav-text">文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">7.4.</span> <span class="nav-text">数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="nav-number">7.5.</span> <span class="nav-text">SQL注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E6%8A%A5%E5%91%8A"><span class="nav-number">7.6.</span> <span class="nav-text">错误报告</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%90%E8%97%8FPHP"><span class="nav-number">7.7.</span> <span class="nav-text">隐藏PHP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%85%E6%A0%B8-1"><span class="nav-number">8.</span> <span class="nav-text">内核</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86"><span class="nav-number">8.1.</span> <span class="nav-text">内存管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E4%BD%BF%E7%94%A8"><span class="nav-number">8.2.</span> <span class="nav-text">变量使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FAQ"><span class="nav-number">9.</span> <span class="nav-text">FAQ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">10.</span> <span class="nav-text">参考</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="shenlvmeng"
      src="/blog/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">shenlvmeng</p>
  <div class="site-description" itemprop="description">Be sharp, my friend.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/blog/archives/">
          <span class="site-state-item-count">143</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/blog/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/blog/tags/">
        <span class="site-state-item-count">424</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/shenlvmeng" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;shenlvmeng" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://weibo.com/shenlvmeng" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;shenlvmeng" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://shenlvmeng.github.com/blog/2019/09/10/php-note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
      <meta itemprop="name" content="shenlvmeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shenlvmeng's Blog">
      <meta itemprop="description" content="Be sharp, my friend.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="（旧文）PHP语言介绍 | Shenlvmeng's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          （旧文）PHP语言介绍
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2019-09-10 21:02:17 / 修改时间：21:04:17" itemprop="dateCreated datePublished" datetime="2019-09-10T21:02:17+08:00">2019-09-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%AF%AD%E8%A8%80/" itemprop="url" rel="index"><span itemprop="name">语言</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/blog/2019/09/10/php-note/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/09/10/php-note/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>38k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1:03</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <blockquote>
<p><a target="_blank" rel="noopener" href="//php.net">php.net</a></p>
</blockquote>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>PHP来源于工程PHP&#x2F;FI，由Rasmus Lerdorf创建于1995年，起初只是一套简单的Perl脚本，名字叫做“Personal Home Page Tools”，语法也和Perl很像，随着用户的增加，改进为用C语言实现。1997年，Andi Gutmans 和 Zeev Suraski 重写了代码，推出第三版，PHP&#x2F;FI也演变成PHP（PHP: Hypertext Preprocessor）。注意，这是一个递归的缩写。</p>
<p>1999年，由两人改进的更具模块化的“Zend Engine”引入PHP，在结合了许多新功能后，2000年5月发布官方版PHP 4.0。如今广泛使用的5.x版本从2004年起发布。5.x版本支持完整的面向对象模型。目前的最新版本已经到了7.x版本（直接从稳定的5.6版跃迁）。</p>
<p>由于丰富的PHP主要用于服务端的脚本程序，就像其他的CGI程序，如收集表单，生成网页，发送&#x2F;接收Cookie等。除此以外，PHP还用于命令行脚本，编写桌面应用程序。这两种开发可能会用到PHP的拓展库。由于解析器的存在，PHP的跨平台能力很好。 </p>
<p>关于php的绝大多数内容都可以在<a target="_blank" rel="noopener" href="//php.net">php.net</a>上找到，上面介绍的历史也是如此。本文的绝大多数内容更是如此。</p>
<h2 id="安装和配置"><a href="#安装和配置" class="headerlink" title="安装和配置"></a>安装和配置</h2><p>在通常情况下，php用于服务器端脚本，安装配置较之Javascript复杂很多。在Unix环境下，假设服务器环境（如Apache, Nginx等）已经安装完毕，可以通过configure脚本安装配置。Windows环境下，通过MSI文件安装配置PHP和所有内置以及PECL拓展库。此外Mac OS X，云平台等安装各有不同，详见<a target="_blank" rel="noopener" href="http://php.net/manual/zh/install.php">官方教程</a>。</p>
<p>配置文件（<code>php.ini</code>）在PHP启动时被读取，作为服务器模块版本的PHP，仅在服务器启动时读取1次，作为CGI和CLI版本，每次调用都会读取。用户亦可自定义自己的<code>user.ini</code>文件。PHP的有些指令可以在PHP脚本中用<code>ini_set()</code>设定，有些只能在<code>php.ini</code>或<code>httpd.conf</code>中设定。这些是由指令的模式决定的，模式有4种：<code>PHP_INI_USER</code>, <code>PHP_INI_PERDIR</code>, <code>PHP_INI_SYSTEM</code>, <code>PHP_INI_ALL</code>。具体见<a target="_blank" rel="noopener" href="http://php.net/manual/zh/configuration.changes.modes.php">文档</a>。</p>
<p>PHP作为Apache模块运行时，还可以用<code>php_value</code>, <code>php_flag</code>, <code>php_admin_value</code>, <code>php_admin_flag</code>命令设置。</p>
<h2 id="第一段代码"><a href="#第一段代码" class="headerlink" title="第一段代码"></a>第一段代码</h2><p>与C等语言通过代码输出HTML不同的是，PHP页面本身就是HTML，你也完全可以像通常建立HTML页面那样创建和编辑PHP页面，只不过其中嵌入了<code>&lt;?php</code>和<code>?&gt;</code>包裹的PHP代码。与Javascript不同的是，PHP运行在服务端，用户无从得知脚本是如何运行的。</p>
<p>值得一提的是，除了上述的开始和结束标记，使用<code>&lt;script language =&quot;php&quot;&gt;&lt;/script&gt;</code>或者asp风格的短标记<code>&lt;?=</code>, <code>&lt;%=</code>也行（<em>不建议</em>）。在这一对标记之外的内容都会被PHP解析器忽略。可以在脚本中通过<code>phpinfo()</code>打印php的整体配置信息。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>在html语句中嵌入php语句时，尽量做到将业务逻辑和展示语句隔离开对维护php工程有着极大的好处。</p>
<h2 id="特性参考"><a href="#特性参考" class="headerlink" title="特性参考"></a>特性参考</h2><h3 id="PHP标识"><a href="#PHP标识" class="headerlink" title="PHP标识"></a>PHP标识</h3><p>如上文中提到，PHP通过<code>&lt;?php</code>和<code>?&gt;</code>分隔php脚本，在<code>php.ini</code>激活<code>short_open_tag</code>配置后，支持使用短标记作为分隔符。<strong>如果文件内容为纯PHP代码，最好在文末删除结束标记，以免打印意料之外的空白</strong>。如下示例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hello world&quot;</span>;</span><br><span class="line"><span class="comment">// ... more code</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Last statement&quot;</span>;</span><br><span class="line"><span class="comment">// stop here</span></span><br></pre></td></tr></table></figure>

<p>PHP使用<strong>分号</strong>作为分隔符，支持C，C++，Perl风格的注释。即<code>//</code>，<code>/**/</code>和<code>#</code>。</p>
<h3 id="类型-amp-类型转换"><a href="#类型-amp-类型转换" class="headerlink" title="类型 &amp; 类型转换"></a>类型 &amp; 类型转换</h3><p>PHP的原始数据类型有<strong>boolean，integer，float，string，array，object，resource，NULL</strong>。其中前4种为标量，第5，6中为复合类型。resouce表示资源，<strong>NULL表示无类型</strong>。PHP中<strong>float也称为double</strong>。在确保代码易读性上，还有mixed，number和callback几种伪类型。需要注意的是，PHP和Javascript一样，类型往往根据上下文确定。</p>
<h4 id="boolean"><a href="#boolean" class="headerlink" title="boolean"></a>boolean</h4><p>和JavaScript类似。</p>
<p>只有TRUE或FALSE，除了false以外，还有下列假值：</p>
<ul>
<li>0</li>
<li>0.0</li>
<li>‘’</li>
<li>“0”</li>
<li>[],</li>
<li>{}（仅4.0）</li>
<li>NULL</li>
</ul>
<p>其余均为真值（包含任何resource）。和Javascript类似，支持&#x3D;&#x3D;&#x3D;全等。</p>
<h4 id="integer"><a href="#integer" class="headerlink" title="integer"></a>integer</h4><p>有十进制，十六进制，八进制，二进制表示。除十进制外，分别以<code>0</code>, <code>0x</code>, <code>0b</code>开头。5.0.5后最大值可以用常量<code>PHP_INT_MAX</code>设置。<strong>整数溢出时会被解释为float</strong>。<strong>注意：八进制中传递非法数字后，后面数字会被忽略</strong>。类型转换时，可以使用<code>intval()</code>。在浮点数过大，分数强制转换和其他类型转换时，结果未定义。</p>
<h4 id="float"><a href="#float" class="headerlink" title="float"></a>float</h4><p>又称为double和real，支持科学记数法。运算时精度有限，高精度要求下参考任意精度数学函数和gmp函数。在比较大小时需要谨慎，可以采用相减之差和最大容忍度比较的方法作折衷。常量<code>NAN</code>表示浮点计算中不可描述的值，为float类型，不等于任何其他变量，甚至自身。可以用<code>is_nan()</code>检查。</p>
<h4 id="string"><a href="#string" class="headerlink" title="string"></a>string</h4><p>和JavaScript区别较大。</p>
<ul>
<li>PHP字符串的字符占1个字节，因此不支持Unicode。字符串最长可达2GB</li>
<li>表示字符串有4种方法，<strong>单引号，双引号，heredoc和nowdoc</strong>。<ul>
<li>单引号下，只转义单引号和反斜线，其余字符均为plain text，支持多行；</li>
<li>双引号下，对换行回车制表符等特殊字符进行转义，还会对变量解析（$xxx）的形式（和Javascript相似）。</li>
<li>Heredoc结构里，在&lt;&lt;&lt;符号后提供一个标识符然后换行，接下来是字符串本身，字符串后另起一行用前面定义的标识符作为结束标志。中间内容的处理方式同双引号。</li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&lt;&lt;&lt;EOD</span></span><br><span class="line"><span class="string">Example of string</span></span><br><span class="line"><span class="string">spanning multiple lines</span></span><br><span class="line"><span class="string">using heredoc syntax.</span></span><br><span class="line"><span class="string">EOD</span>;</span><br></pre></td></tr></table></figure>

<p>5.3.0以后，可以使用heredoc结构初始化静态变量和类的属性以及常量。nowdoc结构类似于单引号版的heredoc，但是跟在<code>&lt;&lt;&lt;</code>之后的标识符要用单引号括起来，多用在不解析特殊字符的大段文本中。在双引号或heredoc结构中，变量会被解析，简单语法下，PHP解析器会去组合尽量多的标识形成一个合法的<strong>变量名</strong>。复杂语法下，<code>$</code>符号的<strong>外侧或里侧</strong>会紧贴<code>&#123;&#125;</code>，来实现更复杂的变量表达式。</p>
<p>字符串中的字符可以用<code>[]</code>或者<code>&#123;&#125;</code>（不建议）访问。下标超出字符串长度时，会将<strong>多出的长度用空格填充</strong>。另外，字符串使用<code>.</code>连接。使用<code>strval()</code>转换变量为字符串，boolean会转成<code>&quot;1&quot;</code>或<code>&quot;&quot;</code>。integer和float作字面转换。**array总转换成<code>&quot;Array&quot;</code>**。object总转换成”Object”。NULL总转变成<code>&quot;&quot;</code>。</p>
<p><code>serialize()</code>可以串行化大部分PHP值。字符串转为数值时，类似Javascript的<code>parseInt()/parseFloat()</code>，试图从头转换直到遇到不合法字符，支持科学记数法。区别在于PHP中失败时返回<code>0</code>而不是<code>NAN</code>。</p>
<p>关于string的更多介绍，参加<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.types.string.php#language.types.string">官方文档String</a>一章。</p>
<h4 id="array"><a href="#array" class="headerlink" title="array"></a>array</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$array</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&quot;foo&quot;</span> =&gt; <span class="string">&quot;bar&quot;</span>,</span><br><span class="line">    <span class="string">&quot;bar&quot;</span> =&gt; <span class="string">&quot;foo&quot;</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自 PHP 5.4 起</span></span><br><span class="line"><span class="variable">$array</span> = [</span><br><span class="line">    <span class="string">&quot;foo&quot;</span> =&gt; <span class="string">&quot;bar&quot;</span>,</span><br><span class="line">    <span class="string">&quot;bar&quot;</span> =&gt; <span class="string">&quot;foo&quot;</span>,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>与Javascript区别较大，PHP中的数组也是个<strong>有序</strong>映射，描述了keys到values的映射。array使用<code>array()</code>初始化，在5.4版本后支持字面量定义。<strong>key可以是integer或string</strong>（integer时是数组，string时是键值对），value可以是任何类型。使用<code>[]</code>访问和修改数组元素，通过<code>unset()</code>删除某键值对（类似与Javascript的<code>delete</code>）。有趣的是，使用<code>[]</code>不指定键名时，则取当前最大整数索引值（曾经存在即可），新的键名在之上加1。可以使用<code>array_values()</code>重建索引。</p>
<p>转换为数组时，除object、NULL类型外，其余类型得到只有一个元素的数组。object类型转换时，单元为对象的属性，键名为成员变量名，还有其他特殊情况见文档<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.types.array.php">数组</a>部分。NULL会转换为一个空数组。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$A</span>; <span class="comment">// This will become &#x27;\0A\0A&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$A</span>; <span class="comment">// This will become &#x27;\0B\0A&#x27;</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$AA</span>; <span class="comment">// This will become &#x27;AA&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>((<span class="keyword">array</span>) <span class="keyword">new</span> <span class="title function_ invoke__">B</span>());</span><br></pre></td></tr></table></figure>

<h4 id="object"><a href="#object" class="headerlink" title="object"></a>object</h4><p>对象，通过new来实例化一个类产生。转换为对象时，PHP会创建一个内置类stdClass的实例，可以通过<code>new stdClass()</code>创建一个空对象。php 7后，还有<code>new class&#123;&#125;</code>和<code>(object) []</code>方法。</p>
<h4 id="resource"><a href="#resource" class="headerlink" title="resource"></a>resource</h4><p>用于保存到外部资源的一个引用，通过专门的函数建立和使用，由Zend引擎维护资源回收。</p>
<h4 id="NULL"><a href="#NULL" class="headerlink" title="NULL"></a>NULL</h4><p>表示一个变量没有值。可细分为被赋值为<code>NULL</code>，尚未赋值和被<code>unset()</code>。<strong>NULL不区分大小写</strong>。</p>
<h4 id="callback"><a href="#callback" class="headerlink" title="callback"></a>callback</h4><p>类似Javascript中的function类型，一些函数如<code>call_user_func()</code>可以接收用户定义的回调函数作为参数。传递时，以string类型传递函数名。5.3.0后可以直接传递closure给回调参数。</p>
<p>其余伪类型多用于代码的说明注释中，如<code>mixed</code>表述多种不确定类型，<code>void</code>表述函数返回值无用或不接受任何参数等。</p>
<h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><p>使用<code>var_dump()</code>查看值和类型，<code>gettype()</code>查看类型，<code>is_int</code>&#x2F;<code>is_string</code>&#x2F;…判断类型，<code>(type)</code>或<code>settype()</code>强制类型转换。PHP的强制转换和C非常相似。目前支持<code>(int)</code>, <code>(bool)</code>, <code>(float)</code>, <code>(string)</code>, <code>(array)</code>, <code>(object)</code>, <code>(unset)</code>（转换为<code>NULL</code>）。5.2版本后支持<code>(binary)</code>转换。</p>
<p>除了强制转换，PHP中会根据需要对变量自动转换，如加法。与Javascript的<code>+</code>不大不同，PHP会优先将操作数转为float，否则会将操作数解释为integer。数组的键名会优先转换为integer（仅十进制），再转换为string。下面就是一个有趣的例子：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="variable">$foo</span> = <span class="string">&quot;0&quot;</span>;  <span class="comment">// $foo is a string</span></span><br><span class="line">  <span class="variable">$foo</span> += <span class="number">2</span>;   <span class="comment">// $foo is an int now</span></span><br><span class="line">  <span class="variable">$foo</span> = <span class="variable">$foo</span> + <span class="number">1.3</span>;  <span class="comment">// $foo is a float now (3.3)</span></span><br><span class="line">  <span class="variable">$foo</span> = <span class="number">5</span> + <span class="string">&quot;10 Little Piggies&quot;</span>; <span class="comment">// $foo is an integer (15)</span></span><br><span class="line">  <span class="variable">$foo</span> = <span class="number">5</span> + <span class="string">&quot;Small Pigs&quot;</span>;     <span class="comment">// $foo is an integer (5)</span></span><br></pre></td></tr></table></figure>

<h3 id="变量-amp-常量"><a href="#变量-amp-常量" class="headerlink" title="变量 &amp; 常量"></a>变量 &amp; 常量</h3><p>PHP变量以<code>$</code>符号开头，只能包含数字字母（这里说的字母包含ASCII字符）和下划线且不能以数字开头。变量区分大小写。<code>$this</code>是特殊变量不能赋值。可以在<code>$</code>前加<code>&amp;</code>符号<strong>引用赋值</strong>，在改变原变量时，目标变量也会改动。<code>isset()</code>可以检查变量是否已被赋值。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$var</span> = <span class="string">&#x27;Bob&#x27;</span>;</span><br><span class="line"><span class="variable">$Var</span> = <span class="string">&#x27;Joe&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$var</span>, <span class="subst">$Var</span>&quot;</span>;      <span class="comment">// 输出 &quot;Bob, Joe&quot;</span></span><br><span class="line"></span><br><span class="line">$<span class="number">4</span>site = <span class="string">&#x27;not yet&#x27;</span>;     <span class="comment">// 非法变量名；以数字开头</span></span><br><span class="line"><span class="variable">$_4site</span> = <span class="string">&#x27;not yet&#x27;</span>;    <span class="comment">// 合法变量名；以下划线开头</span></span><br><span class="line"><span class="variable">$i</span>站点is = <span class="string">&#x27;mansikka&#x27;</span>;  <span class="comment">// 合法变量名；可以用中文</span></span><br></pre></td></tr></table></figure>

<p>用户在为变量命名时，有几点要注意的。function, class, interface, 常量和函数外定义的变量会进入全局命名空间；建议在函数名中用<code>_</code>区分，类名中用驼峰或首字母大写的驼峰命名。注意：很多情况下，PHP会自动将变量名中的点转换成下划线。</p>
<h4 id="可变变量"><a href="#可变变量" class="headerlink" title="可变变量"></a>可变变量</h4><p>PHP中的变量名可以很方便地改变，而且可变变量可以用在数组或对象中，如下面的例子，。使用可变变量时，注意通过花括号给属性名清晰定界。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// Given these variables ...</span></span><br><span class="line"><span class="variable">$nameTypes</span>    = <span class="keyword">array</span>(<span class="string">&quot;first&quot;</span>, <span class="string">&quot;last&quot;</span>, <span class="string">&quot;company&quot;</span>);</span><br><span class="line"><span class="variable">$name_first</span>   = <span class="string">&quot;John&quot;</span>;</span><br><span class="line"><span class="variable">$name_last</span>    = <span class="string">&quot;Doe&quot;</span>;</span><br><span class="line"><span class="variable">$name_company</span> = <span class="string">&quot;PHP.net&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Then this loop is ...</span></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$nameTypes</span> <span class="keyword">as</span> <span class="variable">$type</span>)</span><br><span class="line">  <span class="keyword">print</span> $&#123;<span class="string">&quot;name_<span class="subst">$type</span>&quot;</span>&#125; . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... equivalent to this print statement.</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">&quot;<span class="subst">$name_first</span>\n<span class="subst">$name_last</span>\n<span class="subst">$name_company</span>\n&quot;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="预定义变量"><a href="#预定义变量" class="headerlink" title="预定义变量"></a>预定义变量</h4><p>PHP提供许多预定义的变量。PHP中的许多预定义变量都是“超全局的”，这意味着它们在脚本的全部作用域都可见。这种类型在4.1版本中被引入，有<code>$GLOBALS</code>, <code>$_SERVER</code>, <code>$_GET</code>, <code>$_POST</code>, <code>$_FILES</code>, <code>$_COOKIE</code>, <code>$_SESSION</code>, <code>$_REQUEST</code>, <code>$_ENV</code>。它们在5.4版本后不能作为函数的输入参数。通过这些预设的超全局变量，PHP可以轻松地获取请求的各种参数。</p>
<p>除了上述超全局变量外，还有<code>$php_errormsg</code>, <code>$HTTP_RAW_POST_DATA</code>（使用php:&#x2F;&#x2F;input代替）, <code>$http_response_header</code>(使用HTTP包装其时，该变量会被自动填充)，<code>$argc</code>和<code>$argv</code>分别代表传递给脚本的参数数目和参数数组（运行在命令行下时）。</p>
<h4 id="作用域"><a href="#作用域" class="headerlink" title="作用域"></a>作用域</h4><p>变量作用域通常为文件作用域。函数内部的声明的变量被限制在函数作用域内。同时，和Javascript相同，<strong>PHP没有块级作用域</strong>。注意，PHP中定义全局变量需使用<code>global</code>关键字。在函数内部，变量优先视作局部变量。下面的脚本不会有任何输出，因为<code>echo</code>引用了一个局部变量<code>$a</code>，但是在函数作用域内它并没有被赋值。要想$a在函数作用域内可见，需要在引用前声明<code>global</code>。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">1</span>; <span class="comment">/* global scope */</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>; <span class="comment">/* reference to local scope variable */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">Test</span>();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_ invoke__">Test2</span>();</span><br></pre></td></tr></table></figure>

<p>静态变量通过<code>static</code>声明，<strong>仅在局部作用域存在</strong>，程序离开作用域时内容不丢失。静态变量不能使用表达式初始化。在下面的例子中，函数仅在第一次调用时初始化<code>$a</code>变量，之后每次调用都会输出<code>$a</code>，并加一。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">static</span> <span class="variable">$a</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="variable">$a</span>++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h4><p>在类外，常量通过<code>define(name. value)</code>函数定义。在类内使用<code>const</code>定义常量（5.3.0后）。常量的命名规范同C。常量只能是标量。<strong>在访问常量值时，名字前不带<code>$</code><strong>。常量名事先无法确定时，使用<code>constant()</code>获取常量。</strong>常量没有作用域的限制</strong>，可以在任何位置访问。</p>
<p>PHP定义了大量的魔术常量，都以两个下划线开头和结尾。有<code>__LINE__</code>，<code>__FILE__</code>, <code>__DIR__</code>, <code>__FUNCTION__</code>, <code>__CLASS__</code>, <code>__TRAIT__</code>, <code>METHOD__</code>, <code>__NAMESPACE__</code>。具体解释见<a target="_blank" rel="noopener" href="http://php.net/manual/zh/language.constants.predefined.php">官方文档</a>。</p>
<h3 id="表达式-amp-流程"><a href="#表达式-amp-流程" class="headerlink" title="表达式 &amp; 流程"></a>表达式 &amp; 流程</h3><p>PHP的表达式根据官方的定义表述，是<em>任何有值的东西</em>。表达式的组成类似于其他语言，从略。值得注意的有以下几点：</p>
<ul>
<li>PHP的逻辑运算符同时有<code>&amp;&amp;</code>, <code>||</code>以及<code>and</code>, <code>xor</code>, <code>or</code>两套，但是<strong>后一套的优先级最低</strong>。</li>
<li>PHP提供<code>@</code>作为错误控制运算符，放置在表达式前可以忽略产生的任何错误信息。<strong>强烈不建议使用</strong>。</li>
<li>反引号``执行其中的shell命令，并将输出结果返回，等同于执行<code>shell_exec()</code>。</li>
<li><code>+</code>, <code>==</code>, <code>===</code>还可以用于数组间的运算，进行数组的连接，键值对相同的检测。</li>
<li><code>instanceof</code>用于确定变量是否属于某个类的实例。用法如<code>$a instanceof MyClass</code></li>
</ul>
<p>算法流程上，PHP类似C风格。不同点有：</p>
<ul>
<li>提供在<code>&lt;?php&gt;</code>闭合标签内使用<code>for endfor</code>这种用法</li>
<li><code>foreach(array as $key =&gt; $value)</code>便于遍历数组。（注意：在<code>$value</code>前<code>&amp;</code>可以在<code>foreach</code>循环中改变<code>value</code>的值）</li>
<li><code>break</code>可以接受一个可选的数字决定跳出几层循环</li>
<li><code>continue</code>接受一个可选的数字参数来决定跳过几重循环到循环结尾。默认值是<code>1</code></li>
<li><code>declare</code>设定一段代码的施行指令，目前只支持<code>ticks</code>和<code>encoding</code>。前者控制执行计时的若干条命令后的操作，后者决定代码的运行编码。</li>
<li><code>require</code>和<code>include</code>效果类似，用法同C，它们也有带后缀<code>_once</code>的操作符</li>
</ul>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>PHP的函数定义和其他语言类似，定义的函数都具有全局作用域。不同的是</p>
<ul>
<li>PHP可以使用<code>create_function(args, code)</code>这样的函数定义函数（类似JS中的<code>new Function()</code>）</li>
<li>函数需要先定义后使用（这个只是与Javascript不同）</li>
<li>PHP可以定义有条件的函数，通过用if包裹和放在function定义内</li>
</ul>
<p>和C&#x2F;C++风格很像的是：</p>
<ul>
<li>PHP函数参数接收的是一个复制，需要传递引用改变原值；</li>
<li>支持默认参数，需放在最右；</li>
<li>5.0之后支持对输入参数类型检查，到5.4为止支持class &#x2F; array &#x2F; callable类型，7.0以后支持标量类型。如果给出的值类型不对，那么将会产生一个错误</li>
<li>7.0之后支持不对输入参数强制类型转换。</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> <span class="keyword">extends</span> <span class="title">C</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This doesn&#x27;t extend C.</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">C <span class="variable">$c</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">get_class</span>(<span class="variable">$c</span>).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">f</span>(<span class="keyword">new</span> C);</span><br><span class="line"><span class="title function_ invoke__">f</span>(<span class="keyword">new</span> D);</span><br><span class="line"><span class="title function_ invoke__">f</span>(<span class="keyword">new</span> E);</span><br></pre></td></tr></table></figure>

<p>和Js相似的一点时，5.6版之后支持使用<code>...</code>符号获取参数列表。</p>
<p>和可变变量一样，PHP中有可变函数，用法和可变变量一样。在调用对象的静态方法时，函数调用要优于静态属性，下面是一个例子</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="built_in">static</span> <span class="variable">$variable</span> = <span class="string">&#x27;static property&#x27;</span>;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">Variable</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Method Variable called&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title class_">Foo</span>::<span class="variable">$variable</span>; <span class="comment">// This prints &#x27;static property&#x27;. It does need a $variable in this scope.</span></span><br><span class="line"><span class="variable">$variable</span> = <span class="string">&quot;Variable&quot;</span>;</span><br><span class="line"><span class="title class_">Foo</span>::<span class="variable">$variable</span>();  <span class="comment">// This calls $foo-&gt;Variable() reading $variable in this scope.</span></span><br></pre></td></tr></table></figure>

<p>5.3之后，PHP也支持匿名函数，并可以传递给一个变量储存。实际中，这种表达式会被转换为内置类Closure的对象实例。闭包可以从父作用域继承变量，但是此类变量需要用<em>use结构</em>传递进去，类似于<code>function() use($a)&#123;&#125;</code>这样的形式。</p>
<h3 id="类-amp-对象"><a href="#类-amp-对象" class="headerlink" title="类 &amp; 对象"></a>类 &amp; 对象</h3><p>PHP承袭着面向对象语言对类和对象的处理。类以<code>class</code>开头，里面包含属性和方法等，可以包含自己的常量。通过<code>new</code>实例化，通过<code>extends</code>实现继承。子类使用<code>parent::</code>访问被覆盖的属性或方法，使用<code>self::</code>自身的静态属性和方法。5.5之后使用<code>ClassName::class</code>可以获取带有命名空间的完整类名。轻量级的类可以通过强制转换关联数组实现。</p>
<p>类中的静态属性通过<code>::</code>访问，非静态属性通过<code>-&gt;</code>访问。定义常量时使用<code>const</code>，常量的值必须是一个定值（5.6之后可以是数学运算结果）。PHP 5新增了关键字<code>final</code>，修饰方法或者类不可被继承。</p>
<p>PHP 5中，**<code>__autoload()</code>函数会在使用未定义的类时自动调用**，5.3.0之后通常使用<code>spl_autoload_register()</code>作为<code>autoload</code>的替代。<code>__construct()</code>和<code>__destruct()</code>分别是构造和析构函数，5.3.3之前，在没有<code>__construct()</code>函数也没有父类时，会寻找命名空间中与类名同名的方法。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">spl_autoload_register</span>(function (<span class="variable">$class_name</span>) &#123;</span><br><span class="line">    <span class="keyword">require_once</span> <span class="variable">$class_name</span> . <span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span>  = <span class="keyword">new</span> <span class="title class_">MyClass1</span>();</span><br><span class="line"><span class="variable">$obj2</span> = <span class="keyword">new</span> <span class="title class_">MyClass2</span>();</span><br></pre></td></tr></table></figure>

<h4 id="trait-amp-匿名类"><a href="#trait-amp-匿名类" class="headerlink" title="trait &amp; 匿名类"></a>trait &amp; 匿名类</h4><p>在访问控制，继承，抽象类，接口等方面PHP和传统的面向对象语言很像。在5.4.0后，PHP提供了<strong>trait作为类之间代码水平复用的特性（很像mixin）</strong>。在class定义中使用<code>use</code>来获取trait，类似interface，一个类可以插入多个trait，trait会覆盖基类方法而被当前类方法覆盖。在多个trait的同名方法发生冲突时，通过<code>insteadof</code>和<code>as</code>来决定使用哪个，具体见<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.traits.php">trait文档</a>。trait的功能使用依赖注入也可以完成，相关讨论见<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/7892749/traits-in-php-any-real-world-examples-best-practices">stackoverflow trait practives</a>与<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/9205083/traits-vs-interfaces">trait vs interface</a>。trait甚至还支持抽象成员和静态成员。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">smallTalk</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">bigTalk</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">smallTalk</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">bigTalk</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Talker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">A</span>, <span class="title">B</span> &#123;</span><br><span class="line">        <span class="title">B</span>::<span class="title">smallTalk</span> <span class="title">insteadof</span> <span class="title">A</span>;</span><br><span class="line">        A::<span class="variable constant_">bigTalk</span> <span class="keyword">insteadof</span> B;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Aliased_Talker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">A</span>, <span class="title">B</span> &#123;</span><br><span class="line">        <span class="title">B</span>::<span class="title">smallTalk</span> <span class="title">insteadof</span> <span class="title">A</span>;</span><br><span class="line">        A::<span class="variable constant_">bigTalk</span> <span class="keyword">insteadof</span> B;</span><br><span class="line">        B::<span class="variable constant_">bigTalk</span> <span class="keyword">as</span> talk;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>PHP7.0之后支持匿名类，用于创建一次性的简单对象。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// PHP 7 之前的代码</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Logger</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"><span class="variable">$msg</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$msg</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$util</span>-&gt;<span class="title function_ invoke__">setLogger</span>(<span class="keyword">new</span> <span class="title class_">Logger</span>());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用了 PHP 7+ 后的代码</span></span><br><span class="line"><span class="variable">$util</span>-&gt;<span class="title function_ invoke__">setLogger</span>(<span class="keyword">new</span> <span class="keyword">class</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> function <span class="title function_ invoke__">log</span>(<span class="variable">$msg</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$msg</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="“重载”"><a href="#“重载”" class="headerlink" title="“重载”"></a>“重载”</h4><p>PHP提供的<strong>重载（overload）</strong>语义和其他大部分OOP语言不同，指在调用当前环境下未定义或不可见的类属性或方法时调用重载方法。PHP借助<strong>魔术方法</strong>实现重载。读写不可访问属性时，<code>__get()</code>和<code>__set()</code>分别被调用；对不可访问属性调用<code>isset</code>和<code>unset</code>时，<code>__isset()</code>和<code>__unset()</code>分别被调用。<strong>属性重载只能在对象中进行</strong>。调用不可访问的方法和静态方法时，<code>__call()</code>和<code>__callStatic()</code>分别被调用，方法重载用法类似属性重载。重载的示例见文档。（<em>不建议使用这个特性，这会影响ide补全和代码的可读性</em>）。</p>
<p>PHP5提供foreach方法遍历对象，默认情况可见属性都会被遍历，可以让类实现<code>Iterator</code>接口从而自行决定如何处理遍历。实现<code>IteratorAggregate</code>接口可以代替实现所有的Iterator方法，<code>IteratorAggregate</code>只需实现<code>IteratorAggregate::getIterator()</code>方法即可。</p>
<h4 id="魔术方法"><a href="#魔术方法" class="headerlink" title="魔术方法"></a>魔术方法</h4><p>PHP将所有<code>__</code>开头的类方法保留为<strong>魔术方法</strong>，<code>__sleep()</code>方法在<code>serialize()</code>函数前调用，应返回一个包含对象中所有应被序列化的变量名称的数组，相对的<code>__wakeup()</code>在反序列化函数前调用。<code>__toString()</code>在把一个类视作字符串时怎样回应时调用。<code>__invoke()</code>在把一个类视作函数调用时调用。更多方法见<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.magic.php">魔术方法页面</a>。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Connection</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$link</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$server</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$db</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$server</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$db</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;server = <span class="variable">$server</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;db = <span class="variable">$db</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">connect</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;link = <span class="title function_ invoke__">mysql_connect</span>(<span class="variable">$this</span>-&gt;server, <span class="variable">$this</span>-&gt;username, <span class="variable">$this</span>-&gt;password);</span><br><span class="line">        <span class="title function_ invoke__">mysql_select_db</span>(<span class="variable">$this</span>-&gt;db, <span class="variable">$this</span>-&gt;link);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;server&#x27;</span>, <span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;db&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">connect</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>PHP使用<code>clone</code>创造对象的浅复制（即只创造属性的引用），魔术方法<code>__clone()</code>在clone完成后调用。PHP 5中的对象甚至可以相互比较，使用<code>==</code>判断属性和属性值是否一致，<code>===</code>判断变量是否是同一个实例。</p>
<p>自5.3.0起，PHP增加了<code>static::</code>关键字和<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/language.oop5.late-static-bindings.php">后期静态绑定</a>的功能，用于在继承范围内引用静态调用的类。静态环境下绑定静态方法可以让子类在<strong>自己的环境</strong>下（自己的this）调用继承自基类的方法。这种方式绑定非静态方法时，会出现不同结果，尽量避免使用。</p>
<p>对象通过<code>serialize()</code>和<code>unserialize()</code>来序列化和反序列化一个对象，对象的方法和静态成员不会保留。<strong>在解序列的文件域内需要包含类的定义</strong>。</p>
<h4 id="预定义接口"><a href="#预定义接口" class="headerlink" title="预定义接口"></a>预定义接口</h4><p>PHP预定义了许多接口。<code>Traversal</code>接口监测一个类是否可以使用foreach进行遍历（仅供引擎使用）。<code>Iterator</code>接口用来实现对象的foreach迭代，有<code>rewind</code>, <code>current</code>, <code>key</code>, <code>next</code>, <code>valid</code>等成员方法。除此以外还有聚合迭代，数组式访问，序列化，生成器接口等接口和Closure类。这里从略。</p>
<h3 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h3><p>命名空间是PHP一个比较有特点的特性。在PHP中用命名空间解决<strong>类库和用户代码名字冲突的问题</strong>。实际上命名空间所做的事情就是代码模块化，正如Java的packages和Javascript里CommonJS规范一样。命名空间的命名方法类似变量，不允许使用PHP或php开头的命名空间。下面是一个命名空间的范例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title class_">my</span>\<span class="title class_">name</span>; </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myfunction</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">MYCONST</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">MyClass</span>;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> \my\name\MyClass; </span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">strlen</span>(<span class="string">&#x27;hi&#x27;</span>); </span><br><span class="line"></span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">namespace</span>\<span class="title class_">MYCONST</span>; </span><br><span class="line"></span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">__NAMESPACE__</span> . <span class="string">&#x27;\MYCONST&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">constant</span>(<span class="variable">$d</span>);</span><br></pre></td></tr></table></figure>

<p>除了<code>declare</code>语句以外，<strong>namespace的定义需在文件的最前面</strong>。PHP与其它的语言特征不同，同一个命名空间可以定义在多个文件中，即<strong>允许将同一个命名空间的内容分割存放在不同的文件中</strong>。在命名空间中使用define定义常量时，需要带上<code>__NAMESPACE__</code>，否则意味着定义在全局空间下。</p>
<p>PHP中的命名空间和文件目录很像，也支持层级化的定义方法，即定义子命名空间，父子间通过反斜线<code>\</code>隔开。可以在单文件内定义多个namespace（<strong>不提倡</strong>），建议namespace间通过大括号隔离开。PHP命名空间可以和文件系统进行类比，类名非限定时，会在当前空间寻找，以<code>\</code>开头时从全局空间寻找（相对目录），否则从当前空间起向下寻找（绝对目录）。下面是一个使用了三种方法的样例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">Foo</span>\<span class="title class_">Bar</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;file1.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">FOO</span> = <span class="number">2</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">foo</span> </span>&#123;</span><br><span class="line">    <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">staticmethod</span>(<span class="params"></span>) </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 非限定名称 */</span></span><br><span class="line"><span class="title function_ invoke__">foo</span>();     <span class="comment">// 解析为 Foo\Bar\foo</span></span><br><span class="line">foo::<span class="title function_ invoke__">staticmethod</span>();     <span class="comment">// 解析为类 Foo\Bar\foo的静态方法static method</span></span><br><span class="line"><span class="keyword">echo</span> FOO; <span class="comment">// 解析为常量 Foo\Bar\FOO</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 限定名称 */</span></span><br><span class="line">subnamespace\<span class="title function_ invoke__">foo</span>(); <span class="comment">// 解析为函数 Foo\Bar\subnamespace\foo</span></span><br><span class="line">subnamespace\foo::<span class="title function_ invoke__">staticmethod</span>(); <span class="comment">// 解析为类 Foo\Bar\subnamespace\foo, 以及类的方法 staticmethod</span></span><br><span class="line"><span class="keyword">echo</span> subnamespace\FOO; <span class="comment">// 解析为常量 Foo\Bar\subnamespace\FOO</span></span><br><span class="line">                                  </span><br><span class="line"><span class="comment">/* 完全限定名称 */</span></span><br><span class="line">\Foo\Bar\<span class="title function_ invoke__">foo</span>(); <span class="comment">// 解析为函数 Foo\Bar\foo</span></span><br><span class="line">\Foo\Bar\foo::<span class="title function_ invoke__">staticmethod</span>(); <span class="comment">// 解析为类 Foo\Bar\foo, 以及类的方法 staticmethod</span></span><br><span class="line"><span class="keyword">echo</span> \Foo\Bar\FOO; <span class="comment">// 解析为常量 Foo\Bar\FOO</span></span><br></pre></td></tr></table></figure>

<p>命名空间的装载和名称的解析是在编译期完成的。命名空间有三种定义方法：</p>
<ul>
<li>非限定名称：名称中不包含命名空间分割符，即\，如Foo</li>
<li>限定名称：名称中包含命名空间分割符，如Foo\Bar</li>
<li>完全限定名称：名称中包含命名空间分割符，且以\开始的标识符，如\Foo\Bar</li>
</ul>
<p>PHP支持使用<code>namespace</code>关键字或<code>__NAMESPACE__</code>魔术常量获取当前所在命名空间。所有支持命名空间的PHP版本支持三种别名或导入方式：<strong>为类名称使用别名</strong>、<strong>为接口使用别名</strong>、<strong>为命名空间名称使用别名</strong>。这么做类似于在操作系统中创建符号连接。别名通过操作符<code>use as</code>实现。注意：导入命名空间后文件内的类名，接口名等会收到导入的影响。在一个命名空间中，当PHP遇到一个非限定的类、函数或常量名称时，它使用不同的优先策略来解析该名称。对于函数和常量来说，如果当前命名空间中不存在该函数或常量，PHP会退而使用全局空间中的函数或常量。因此在访问系统内部或不包含在命名空间中的类名称时，必须使用完全限定名称。</p>
<h3 id="错误和异常"><a href="#错误和异常" class="headerlink" title="错误和异常"></a>错误和异常</h3><p>PHP的错误类型有很多，可以见<a target="_blank" rel="noopener" href="http://php.net/manual/zh/errorfunc.constants.php">类型列表</a>。PHP对错误的汇报方式由<code>php.ini</code>中的<code>error_reporting</code>命令控制，可以在运行时通过<code>error_reporting()</code>函数动态修改。在开发环境，建议将级别设置到<code>E_ALL</code>，同时在脚本的开头设置级别。<code>php.ini</code>中的<code>display_errors</code>指令控制是否将错误显示在脚本输出中，建议在生产环境中关闭。<code>log_errors</code>指令控制错误记录。</p>
<p>PHP 5中异常可以被抛出，由try&#x2F;catch语句块获取。<code>catch</code>获得的是一个<code>Exception</code>类的实例。类似Java，可以在catch后加上finally语句块。Exception是一个类，有<code>getMessage</code>，<code>getTraceAsString</code>等方法可以使用和拓展，详见介绍。PHP 7中，大多数错误都被作为Error异常抛出，可以被第一个匹配的try&#x2F;catch语句块捕获，否则交给PHP相应的异常处理函数处理，如果尚未通过<code>set_exception_handler()</code>注册童永刚异常处理函数，则会报告一个Fatal Error。注意：捕获错误或异常时，若在自定义命名空间下，Exception需要用完全限定方式书写。</p>
<p>7.0以后的版本中，<code>Error</code>和<code>Exception</code>同属于<code>Throwable</code>类型，这一点与5.x版本不同。代码如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//To catch both exceptions and errors in PHP 5.x and 7, add a catch block for Exception AFTER catching Throwable first.</span></span><br><span class="line"><span class="comment">//Once PHP 5.x support is no longer needed, the block catching Exception can be removed.</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// Code that may throw an Exception or Error.</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (<span class="built_in">Throwable</span> <span class="variable">$t</span>)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// Executed only in PHP 7, will not match in PHP 5</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// Executed only in PHP 5, will not be reached in PHP 7</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="生成器（generator）"><a href="#生成器（generator）" class="headerlink" title="生成器（generator）"></a>生成器（generator）</h3><p>PHP中的生成器的概念与Java等高级语言中生成器的概念无二。生成器函数看起来像一个普通的函数，不同的是普通函数返回一个值，而一个生成器可以<code>yield</code>生成许多它所需要的值。当一个生成器被调用的时候，它返回一个可以被遍历的对象。PHP 将会在每次需要值的时候调用生成器函数，并在产生一个值之后保存生成器的状态。<strong>生成器不可以返回值</strong>。return语句只会终止生成器继续执行。</p>
<p><strong>yield会返回一个值给循环调用此生成器的代码并且只是暂停执行生成器函数</strong>。可以使用yield返回键值对，引用或<code>NULL</code>等。在PHP 7以后，使用<code>yield from</code>可以从实现了Iterator接口的对象或使用yield的函数中yield值。如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">count_to_ten</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">from</span> [<span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">from</span> <span class="keyword">new</span> <span class="built_in">ArrayIterator</span>([<span class="number">5</span>, <span class="number">6</span>]);</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">from</span> <span class="title function_ invoke__">seven_eight</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">yield</span> <span class="keyword">from</span> <span class="title function_ invoke__">nine_ten</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">seven_eight</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">7</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">from</span> <span class="title function_ invoke__">eight</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">eight</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">8</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">nine_ten</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">9</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$gen</span> = <span class="title function_ invoke__">count_to_ten</span>();</span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$gen</span> <span class="keyword">as</span> <span class="variable">$num</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$num</span> &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$gen</span>-&gt;<span class="title function_ invoke__">getReturn</span>();</span><br></pre></td></tr></table></figure>

<p>对比生成器和实现Iterator接口的类来看，生成器的代码可读性更高，代码量也更少，缺憾在于不能多次迭代和回退，除非重建或使用clone。</p>
<h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p><strong>PHP的引用意味着不同的名字访问同一个变量内容</strong>，通过在变量前加上<code>&amp;</code>使用。在对一个未定义的变量进行引用参数传递或引用返回时，会自动创建该变量。不使用<code>&amp;</code>符号时，意味着生成一个拷贝。</p>
<p>在进行引用传递时，只能传递变量，New语句和函数中返回的引用；引用返回时，需要在函数名前加上&amp;符号，同时接受返回值的变量也需写为接收引用的形式。<br>通过<code>unset</code>销毁引用，销毁引用的同时不会销毁原变量（类似于删除符号链接）。<code>global $var</code>实际上就是创建了到<code>$GLOBALS[]</code>的引用。<code>$this</code>也是同理。</p>
<h3 id="支持的协议"><a href="#支持的协议" class="headerlink" title="支持的协议"></a>支持的协议</h3><p>PHP带有内置URL风格的封装协议，可用于类似<code>fopen()</code>、<code>copy()</code>、<code>file_exists()</code>和<code>filesize()</code>的文件系统函数，如file, http, ftp, php, zlib, data等。其中<code>php://</code>提供的是输入输出流和错误描述符的访问能力。创建数据流前，可以通过<code>stream_context_create()</code>创建上下文选项，定义数据流的选项。</p>
<h2 id="函数参考"><a href="#函数参考" class="headerlink" title="函数参考"></a>函数参考</h2><p>PHP本身提供了海量的函数。且都可以全局访问到。</p>
<h3 id="内核"><a href="#内核" class="headerlink" title="内核"></a>内核</h3><p>内核部分的函数，不能通过编译选项去除。PHP这部分的函数和介绍相当多，这里只撷选了常用的部分。</p>
<h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><p>这部分的函数主要用来进行和数组相关的操作，由于PHP中的数组包括了键值对这样类似对象的功能，函数的数量很多，甚至有些冗余。</p>
<ul>
<li><code>array_chunk</code> 将数组分割为多个，单元数目由size决定。返回一个多维数组。</li>
<li><code>array_merge</code> 将多个数组的单元合并在一起，字符串键名相同时，后面的值会覆盖前一个。类似的还有array_merge_recursive。</li>
<li><code>array_count_values</code> 统计数组中所有的值出现的次数，返回一个关联数组</li>
<li><code>array_diff</code> 计算数组的差集，返回在array1但不在array2的元素</li>
<li><code>array_intersect</code> 计算数组的交集，返回一个在array1中出现同时也在其他所有参数数组中出现的值。在差和交的名称前加上u的函数可以自己指定比较方法。</li>
<li><code>array_fill</code> 用给定的值填充数组的num个条目，start_index为返回数组的第一个索引值。array_fill_keys函数可以填充键值对。<code>array_pad</code> 用值将数组填充到指定长度。键从第一个整型数开始，否则从0开始。</li>
<li><code>array_flip</code> 返回一个交换键和值的数组。不合法的值将不会反转。类似的<code>array_reverse</code>返回一个单元顺序相反的数组。</li>
<li><code>array_combine(array $keys , array $values)</code>返回一个由<code>keys</code>数组作键，<code>values</code>数组作值的新数组，两个数组长度不一样时抛出异常。<code>array_keys(array $array [, mixed $search_value [, bool $strict= false ]])</code>返回所有值为<code>search_value</code>的键名，<code>strict</code>表示是否进行严格比较。类似地，<code>array_values(array $input)</code>返回一个由所有值组成的数组，并建立起数字索引。</li>
<li><code>array_multisort</code>用来一次多多个数组排序，输入数组被当作一个数据表的若干列来排序。常用在对数据库数据的排序。返回值为bool类型。</li>
<li><code>array_push</code>和<code>array_pop</code>分别在array的末尾弹出或压入一个元素。</li>
<li><code>array_shift</code>和<code>array_uinshift</code>完成类似于上面的功能，不过是在数组开头。</li>
<li><code>array_product()</code>和<code>array_sum()</code>分别返回数组的乘积和总和。</li>
<li><code>array_filter</code>用回调函数过滤数组单元。没有回调函数时将删除input中等值于FALSE的条目。</li>
<li><code>array_map</code>返回一个arr1所有单元经过callback作用后的单元。callback 接受的参数数目应该和传递给 array_map() 函数的数组数目一致。</li>
<li><code>array_walk</code>使用用户自定义的函数对数组每个函数做回调处理。</li>
<li><code>array_reduce</code>根据回调将array简化为一个值。function变量可以读取result和item。</li>
<li><code>array_replace(array $array1 , array $array2 [, array $... ])</code>将前面的数组的键值对覆盖为后面的键值对。多维数组下有recursive版本。</li>
<li><code>array_key_exists</code>检查键名是否存在于数组中。<code>array_search(mixed $needle , array $haystack [, bool $strict = false ])</code>在数组中搜索给定值。</li>
<li><code>array_slice</code>根据offset和length从数组中取出一段。</li>
<li><code>array_splice</code>把input数组中由offset和length指定的单元去掉，如果提供了replacement参数，则用其中的单元取代。</li>
<li><code>array_unique</code>用于移除数组中重复的值</li>
</ul>
<p>除了这些，还有<code>is_array()</code>，<code>explode()</code>，<code>split()</code>等不以array开头的函数和数组相关，大多用来进行一些简单的操作，列表见<a target="_blank" rel="noopener" href="http://php.net/manual/zh/ref.array.php">数组参考</a>。和数组排序相关的函数也有很多，它们在排序依据，是否稳定等方面各不相同，更多内容参考对数组进行排序。</p>
<h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><p>和字符串相关的函数也很多，但只有以str开头的是严格意义上的字符串函数。下面列举了部分：</p>
<ul>
<li><code>addslashes</code>转义字符串中的单引号，双引号，反斜线和NUL</li>
<li><code>chr</code>返回ASCII码对应的字符，<code>ord()</code>是其互补函数</li>
<li><code>chunk_split($body[,int $chunklen = 76 [,string $end = &quot;\r\n&quot; ]] )</code>拆分<code>$body</code>为<code>$chunklen</code>的小块，每块后用<code>$end</code>结尾</li>
<li><code>crypt</code>返回一个单向字符串散列，<code>md5</code>计算字符串的MD5散列值，<code>sha1</code>计算sha1散列值</li>
<li>echo 输出一组字符串</li>
<li><code>explode</code>使用一个字符串分割另一个字符串；类似地，<code>implode</code>将一个一维数组的值转为字符串。又写作<code>join</code>。</li>
<li><code>htmlentites</code>转义所有的特殊字符为HTML实体；<code>html_entity_decode()</code>实现相反的步骤。</li>
<li><code>htmlspecialchars()</code>和<code>htmlspecialchars_decode()</code>完成的功能和上面相似，但是转义的字符只有<code>&amp;</code>，<code>&quot;</code>，<code>&#39;</code>，<code>&lt;</code>，<code>&gt;</code>。</li>
<li><code>lcfirst</code>将首字母小写，<code>ucfirst</code>将首字母大写，<code>ucwords</code>将每个单词的首字母大写</li>
<li><code>ltrim</code>，<code>rtrim</code>和<code>trim</code>删除字符串首部，尾端和两端的空白。</li>
<li><code>str_getcsv</code>解析csv字符串为一个数组</li>
<li><code>str_pad</code>使用另一个字符串填充字符串到指定长度</li>
<li><code>str_repeat</code> 重复一个字符串</li>
<li><code>str_replace</code> 字符串替换，<code>preg_replace</code>的特殊情况</li>
<li><code>str_shuffle</code>随机打乱一个字符串</li>
<li><code>str_split</code>将一个字符串转换为数组</li>
<li><code>strstr</code>查找字符串的第一次出现。<code>stristr()</code>则不区分大小写地查找</li>
<li><code>strcmp</code>二进制安全字符串比较大小，<code>strncmp</code>类似，不过允许指定比较的长度，<code>strnatcmp</code>以自然顺序比较字符串</li>
<li><code>strlen</code>获取字符串长度</li>
<li><code>strpos</code>查找字符串初次出现位置，<code>strrpos</code>查找最后一次出现，<code>strripos</code>不区分大小写查找最后一次出现</li>
<li><code>strrev</code>反转字符串</li>
<li><code>strip_tags</code>去除str中的空字符，HTML标记和PHP标记，和<code>fgetss()</code>机制一样</li>
<li><code>strtoupper</code>将字符串转化为大写，<code>strtolower</code>将字符串转换为小写</li>
<li><code>strtr()</code>翻译、转换指定字符</li>
<li><code>substr</code>返回字符串的子串</li>
<li><code>substr_count</code>返回子字符串在字符串中出现的次数。</li>
</ul>
<h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><ul>
<li><code>boolvar()</code>转换变量为bool类型</li>
<li><code>empty()</code>判断变量是否为空</li>
<li><code>isset()</code>检测变量是否已设置</li>
<li><code>intval()</code>获取变量整数值，<code>floatval()</code>获取变量浮点数值，<code>strval()</code>获取变量的字符串表示</li>
<li><code>get_resource_type()</code>获取资源类型</li>
<li><code>gettype()</code>获取变量类型，<code>settype($var, string $type)</code>设置变量类型</li>
<li><code>is_array</code>, <code>is_bool</code>, <code>is_callable</code>, <code>is_float</code>, <code>is_int</code>, <code>is_null</code>, <code>is_numeric</code>, <code>is_object</code>, <code>is_resource</code>, <code>is_scalar</code>, <code>is_string</code>用来检测各种类型。</li>
<li><code>print_r()</code>和<code>var_dump()</code>打印变量的相关信息，<code>var_export()</code>以合法PHP代码的形式返回变量的字符串表示</li>
<li><code>serialize()</code>序列化一个变量，<code>unserialize()</code>反序列化一个变量</li>
<li><code>unset()</code>销毁指定的变量</li>
</ul>
<h4 id="类和对象"><a href="#类和对象" class="headerlink" title="类和对象"></a>类和对象</h4><ul>
<li><code>spl_autoload_register()</code>尝试在类名未定义时启动类的自动加载</li>
<li><code>class_alias</code>为一个类创建别名。</li>
<li><code>class_exists</code>检查指定的类是否定义</li>
<li><code>get_class()</code>返回对象实例所属类的名字。类似地还有<code>get_class_vars</code>和<code>get_class_methods</code>函数。</li>
<li><code>get_declare_classes</code>和<code>get_declare_interfaces</code>以及<code>get_declare_traits</code>获取脚本中已定义的类、接口、trait数组。</li>
<li><code>method_exists( mixed $object , string $method_name )</code>检查类方法是否存在于指定object中，类似地还有<code>property_exsits</code>，<code>interface_exists</code>和<code>trait_exist</code>等</li>
</ul>
<h4 id="日期和时间"><a href="#日期和时间" class="headerlink" title="日期和时间"></a>日期和时间</h4><p>PHP中的时间以64为数字存储。使用时需要配置好<code>php.ini</code>中时区等信息。<code>DateTime</code>，<code>DateTimeZone</code>，<code>DateInterval</code>等对象便于进行相关的操作。PHP同时提供了OOP风格和过程化风格两种方式使用函数。其中<code>DateTime</code>和<code>DateTimeImmutable</code>都继承自<code>DateTimeInterface</code>接口，有着<code>diff</code>，<code>format</code>，<code>getTimestamp</code>，<code>getTimezone</code>等方法。</p>
<p>DateTime中的部分方法如下：</p>
<ul>
<li><code>add(DateInterval $interval)</code>在当前时间上加上一个时间段</li>
<li><code>sub(DateInterval $interval)</code>在当前时间上减去一个时间段。</li>
<li><code>__construct()</code>，创建一个对象，过程化风格: <code>date_create()</code></li>
<li><code>createFromFormat</code>创建一种时间格式format的写法格式见<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/datetime.createfromformat.php">参考</a>。</li>
<li><code>modify</code>修改当前时间，modify为合法的时间格式。</li>
<li><code>setDate(int $year, int $month, int $day )</code>设置日期</li>
<li><code>setTime(int $hour ,int $minute [,int $second = 0 ])</code>设置时间。</li>
<li><code>setTimestamp()</code>设置时间戳。</li>
</ul>
<p>上述方法都有对应的过程化风格的对应函数。</p>
<p>DatePeriod和DateTimeZone等的介绍从略。除了以上的对象方法过程化的函数外，还有以下一些常用方法：</p>
<ul>
<li><code>date($format[, $timestamp)</code>，格式化一个本地时间</li>
<li><code>getdate()</code>，获得日期时间信息，<code>localtime</code>功能类似，返回一个数组。</li>
<li><code>mktime</code>获得一个日期的时间戳，默认为当前。类似的还有<code>time</code>，<code>microtime</code>，返回一个时间戳类型</li>
<li><code>strtotime</code>将英文文本的日期时间解析为Unix时间戳</li>
<li>有意思的是<code>date_sunset</code>和<code>date_sunrise</code>可以获取指定时间戳的日出日落时间</li>
</ul>
<h4 id="文件系统"><a href="#文件系统" class="headerlink" title="文件系统"></a>文件系统</h4><ul>
<li><code>basename()</code>返回路径的文件名部分；<code>dirname()</code>返回路径中的目录部分，<code>realpath()</code>返回规范的绝对路径名</li>
<li><code>chgrp()</code>改变文件所属组，类似的还有<code>chmod</code>和<code>chown</code></li>
<li><code>copy</code>用于拷贝文件，<code>rename</code>用于移动和重命名文件。注意，这里没有delete函数。<code>unlink</code>用于删除文件</li>
<li><code>link ()</code>建立一个硬连接，<code>linkinfo</code>, <code>lstat</code>给出连接信息。<code>symlink</code>创建一个符号连接。</li>
<li><code>mkdir</code>和<code>rmdir</code>用来创建和删除文件夹</li>
<li><code>file</code>把整个文件都入到一个数组中，一行一个元素，可以使用URL作为文件名。<code>file_exists</code>检查文件或目录是否已存在。<code>tmpfile</code>则会建立一个关闭后自动删除的临时文件。</li>
<li><code>file_get_contents</code>将文件读入到字符串中，可以使用<code>stream_context_create</code>创建上下文进行更细致的操作。</li>
<li><code>file_put_contents()</code>写文件，和依次调用<code>fopen()</code>, <code>fwrite()</code>, <code>fclose()</code>效果一样。</li>
<li><code>fileatime</code>, <code>filectime</code>, <code>filemtime</code>, <code>filegroup</code>, <code>fileowner</code>, <code>fileperms</code>, <code>filesize</code>, <code>filetype</code>, <code>stat</code>等和字面意义一样获取文件的各方面信息。它们接收文件路径作为参数。</li>
<li><code>is_dir</code>, <code>is_executable</code>, <code>is_file</code>, <code>is_link</code>, <code>is_readable</code>, <code>is_uploaded_file</code>, <code>is_writable</code>检查文件各种属性</li>
<li><code>fopen</code>打开一个文件，返回一个resource句柄，可以交给<code>fread</code>, <code>fwrite</code>, <code>fscanf</code>, <code>fclose</code>等函数做读写操作。</li>
<li><code>fgets</code>从当前指针处读取一行，<code>fgetc</code>读取一个字符，<code>fstat</code>返回文件信息，<code>ftruncate</code>将文件阶段到给定长度。</li>
<li><code>glob()</code>寻找和pattern匹配的文件路径</li>
</ul>
<p>Directory类通过<code>dir()</code>创建。Directory实例有<code>close</code>，<code>read</code>，<code>rewind</code>三种方法。分别用来释放句柄，读取条目和倒回开头。初次以外还有下面这些常用的目录相关函数。</p>
<ul>
<li><code>chdir(string $directory)</code>用来改变当前目录，</li>
<li><code>getcwd</code>取得当前工作目录</li>
<li><code>scandir()</code>返回一个包含目录中所有文件和目录的数组</li>
<li><code>closedir()</code>关闭通过<code>opendir()</code>打开的目录流。</li>
<li><code>readdir()</code>返回目录中下一个文件的文件名。文件名以在文件系统中的排序返回。</li>
</ul>
<h4 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h4><p>下面这些函数允许你定义自己的错误处理规则，以及修改错误记录的方式：</p>
<ul>
<li><code>debug_backtrace()</code>产生一条PHP的回溯跟踪，返回数组类型；<code>debug_print_backtrace()</code>则将回溯打印出来。</li>
<li><code>error_get_last()</code>获取最后一个发生错误的信息，<code>error_clear_last()</code>清除最后一个错误信息</li>
<li><code>error_log()</code>发送错误信息到web服务器的错误日志或是一个文件里。</li>
<li><code>error_reporting()</code>设置应该报告的PHP错误级别。</li>
<li><code>set_error_handler</code>, <code>set_exception_handler</code>, <code>restore_error_handler</code>, <code>restore_exception_handler</code>分别是设置和重置错误以及异常处理的函数</li>
<li><code>trigger_error()</code>触发一个用户级别的错误条件，在运行出现异常时，需要产生一个特定响应时很有用。</li>
</ul>
<h4 id="session"><a href="#session" class="headerlink" title="session"></a>session</h4><p>在会话支持下，每个访问网站的用户都有一个唯一的id标识，这个标识可以存储在cookie中，也可以通过URL传递。当一个访问者访问网站时，PHP将自动检查(如果<code>session.auto_start</code>被设置为1）或者在你要求下检查(明确通过<code>session_start()</code>或者隐式通<code> session_register()</code>) 当前会话 id 是否是先前发送的请求创建. 如果是这种情况，那么先前保存的环境将被重建。</p>
<p>安全方面需要注意以下几点：</p>
<ul>
<li><code>session.cookie_lifetime=0</code>, 即浏览器不持久化存储cookie数据</li>
<li><code>session.use_cookies=On</code> 并且<code>session.use_only_cookies=On</code>，即通过HTTP cookie实现会话ID管理</li>
<li><code>session.use_strict_mode=On</code>，即禁止使用未初始化会话id的会话，从而防止Javascript进行会话ID的注入</li>
<li><code>session.cookie_httponly=On</code>，禁止Javascript访问会话ID</li>
<li><code>session.cookie_secure=On</code>，仅在HTTPS协议下访问session ID，用在仅支持HTTPS的站点</li>
<li><code>session.hash_function=&quot;sha256&quot;</code>。 高强度的散列函数可以产生高强度的会话ID</li>
</ul>
<p>其他注意事项可以在PHP的<a target="_blank" rel="noopener" href="http://php.net/manual/zh/session.security.php">会话与安全章节</a>找到，根据实际需要选择。下面是一些session函数的使用:</p>
<ul>
<li><code>session_destroy()</code>, 销毁一个会话里的全部数据，但不会重置相关全局变量也不会重置cookie，再次使用时需要重新调用<code>session_start()</code>函数。为彻底删除session，需要调用<code>setcookie()</code>清除cookie中的session ID。</li>
<li><code>session_cache_expire()</code>设置或读取当前缓存到期时间（这个只和浏览器页面刷新缓存有关）</li>
<li><code>session_id()</code>获取&#x2F;设置当前会话ID，PHP仅允许会话ID包括a-z A-Z 0-9 ,（逗号） -（减号）.如果不是用cookie来存储session ID，session ID通常附在SID常量中，放在URL里。</li>
<li><code>session_regenerate_id()</code>在不修改当前session数据的前提下使用新的ID替换原有会话ID。如果启用了<code>session.use_trans_sid</code>选项,那么必须在调用<code>session_regenerate_id()</code>函数之后开始进行输出工作，否则会导致使用原有的会话 ID</li>
<li><code>session_start()</code>创建新会话或者重用现有会话。 如果通过GET或者POST方式，或者使cookie提交了会话ID，则会重用现有会话。</li>
<li><code>session_status()</code>返回当前会话状态</li>
<li><code>session_write_close()</code>写入session数据，然后关闭会话</li>
<li><code>session_name()</code>设置或返回当前回话名称，名称应短小易懂，且不能由纯数字组成，如<code>website_id</code>。</li>
<li><code>session_save_path()</code>读取&#x2F;设置当前会话的保存路径</li>
<li><code>session_unset()</code>释放当前会话注册的所有会话变量</li>
</ul>
<h4 id="进程控制"><a href="#进程控制" class="headerlink" title="进程控制"></a>进程控制</h4><p>这部分函数提供执行系统本身命令的能力。注意，<strong>以加锁方式打开的文件，必须在执行后台程序前关闭</strong>。</p>
<ul>
<li><code>escapeshellarg(string $arg)</code>和<code>escapeshellcmd(string $command)</code>对参数和命令元字符转义，保证安全。</li>
<li><code>exec()</code>和<code>passthru()</code>都能执行一个外部程序，区别是前者返回结果的最后一行，后者返回未经处理的全部输出数据。</li>
<li><code>shell_exec()</code>在shell环境下执行命令，以字符串的形式返回完整的字符串。</li>
<li><code>system(string $command[, int &amp;$return_var ] )</code>执行 command 参数所指定的命令，并且输出执行结果。</li>
</ul>
<h4 id="函数调用"><a href="#函数调用" class="headerlink" title="函数调用"></a>函数调用</h4><ul>
<li><code>call_user_func(callable $callback [, mixed $parameter [, mixed $... ]])</code>把第一个参数作为回掉函数调用。在参数很多时，建议使用$callback(…values)的形式传入数组。类似的还有<code>forward_static_call</code>和<code>forward_static_call_array</code>用来调用静态方法。</li>
<li><code>func_get_arg(int $arg_num)</code>和<code>func_get_arg()</code>返回自定义函数的参数和参数列表，用在函数体内。</li>
<li><code>function_exists()</code>判断函数是否定义</li>
<li><code>register_shutdown_function</code>, <code>register_tick_function</code>用来注册<code>exit</code>之后和每个tick后执行的函数</li>
</ul>
<h4 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h4><p>这部分函数自5.1.2版本后成为核心的一部分。</p>
<ul>
<li><code>hash()</code>根据指定的哈希算法生成哈希值。类似的还有<code>hash_file</code>。</li>
<li><code>hash_hmac()</code>使用HMAC方法生成带有密钥的哈希值，类似的还有<code>hash_hmac_file</code>。</li>
<li><code>hash_init()</code>初始化一个哈希运算上下文，返回resource类型</li>
<li><code>hash_update(resource $context , string $data)</code>向活跃的哈希运算上下文中填充数据。细化的，还有<code>hash_update_file</code>和<code>hash_update_stream</code>两个函数。</li>
<li><code>hash_final()</code>结束哈希上下文，返回摘要内容。</li>
<li><code>hash_copy()</code>返回一个哈希运算上下文副本。</li>
</ul>
<h4 id="PHP自身"><a href="#PHP自身" class="headerlink" title="PHP自身"></a>PHP自身</h4><p>这些函数允许你获得许多关于PHP本身的参数。</p>
<ul>
<li><code>assert()</code>检查一个断言是否为FALSE，并在失败的时候调用<code>assert_options()</code>中指定的回调函数</li>
<li><code>dl()</code>运行时加载一个PHP扩展</li>
<li><code>get_cfg_var()</code>获取PHP配置选项的值</li>
<li><code>get_current_user()</code>获取当前PHP脚本所有者名称</li>
<li><code>get_included_files()</code>返回被include和require文件名的 array</li>
<li><code>ini_get()</code>获取一个配置选项的值</li>
<li><code>ini_set()</code>设置指定配置选项的值。这个选项会在脚本运行时保持新的值，并在脚本结束时恢复</li>
<li><code>ini_restore()</code>恢复指定的配置选项到它的原始值</li>
<li><code>memory_get_usage()</code>返回当前分配给你的 PHP 脚本的内存量，单位是字节（byte）</li>
<li><code>php_sapi_name()</code>返回web服务器和PHP之间的接口类型</li>
<li><code>php_uname()</code>返回运行PHP的系统的有关信息</li>
<li><code>phpinfo([int $what = INFO_ALL])</code>输出关于 PHP 配置的信息。可以通过<code>what</code>筛选输出内容。</li>
<li><code>phpversion()</code>获取当前的PHP版本</li>
<li><code>version_compare()</code>对比两个「PHP 规范化」的版本数字字符串</li>
</ul>
<h4 id="数学"><a href="#数学" class="headerlink" title="数学"></a>数学</h4><p>这部分函数处理integer和float范围内的计算。预定义常量包括<code>M_PI</code>, <code>M_E</code>, <code>M_LOG2E</code>, <code>M_LN2</code>, <code>M_PI_2</code>, <code>M_1_PI</code>, <code>M_SQRT2</code>, <code>M_SQRT3</code>, <code>INF</code>等诸多数学常量。函数名和其他语言类似。</p>
<ul>
<li>三角函数相关：<code>sin</code>, <code>cos</code>, <code>tan</code>, <code>asin</code>, <code>acos</code>, <code>atan</code>计算单位为弧度</li>
<li>双曲函数相关：<code>sinh</code>, <code>cosh</code>, <code>tanh</code>, <code>asinh</code>, <code>acosh</code>, <code>atanh</code>, <code>atan2</code></li>
<li>对数相关：<code>log</code>, <code>log10</code>, <code>log1p</code></li>
<li>指数相关：<code>pow</code>, <code>exp</code>, <code>expm</code></li>
<li>近似相关：<code>round</code>, <code>floor</code>, <code>ceil</code></li>
<li>随机数相关： <code>rand(int $min , int $max)</code>, <code>mt_rand</code>（用法同<code>rand</code>，性能更好）, <code>srand</code>和<code>mt_srand</code>（现已不需要使用）</li>
<li>进制转换相关：<code>bindec</code>, <code>octdec</code>, <code>hexdec</code>转为十进制数（读取字符串，输出数字），相对应还有<code>decbin</code>, <code>decbin</code>, <code>dechex</code>。<code>base_convert()</code>可以做任意进制转换</li>
<li>角度相关：<code>deg2rad</code>角度转弧度</li>
<li>运算相关：<code>intdiv</code>返回商的整数部分，<code>fmod</code>返回浮点数余数。<code>abs</code>计算绝对值，<code>sqrt</code>计算开根号</li>
<li>判断相关：<code>is_finite</code>, <code>is_infinite</code>, <code>is_nan</code>,</li>
<li>其他：<code>max</code>, <code>min</code>（可以输入数组）, <code>pi</code>, <code>hypot</code>（根据直角边计算三角形斜边长）</li>
</ul>
<h4 id="输出控制"><a href="#输出控制" class="headerlink" title="输出控制"></a>输出控制</h4><p>PHP脚本有输出时，输出控制函数可以用这些来控制输出。如通过<code>ob_start()</code>将下文的输出放在缓冲区直到调用<code>ob_end_flush()</code>。通常配合<code>header()</code>使用，在真正返回数据前写入header和cookie。</p>
<p>从略。</p>
<h4 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h4><ul>
<li><code>constant()</code>返回一个常量的值</li>
<li><code>define()</code>定义一个常量</li>
<li><code>exit()</code>输出一个消息并且退出当前脚本，<code>die</code>是<code>exit</code>的同名函数。</li>
<li><code>highlight_file()</code>语法高亮一个文件</li>
<li><code>highlight_string()</code>语法高亮一个字符串，使用方法同上。</li>
<li><code>sleep()</code>延迟指定秒数执行。类似的还有<code>usleep</code>以指定微秒数暂缓执行，<code>time_sleep_until</code>使脚本睡眠到指定时间</li>
<li><code>uniqid()</code>返回一个基于当前微秒级时间的带前缀的唯一ID。</li>
</ul>
<h3 id="绑定拓展库"><a href="#绑定拓展库" class="headerlink" title="绑定拓展库"></a>绑定拓展库</h3><p>下面的拓展库绑定在PHP发行包中。较之内核部分的函数，更偏向为解决某类问题而设计。这里也只摘选部分常用的介绍。</p>
<h4 id="Ctype"><a href="#Ctype" class="headerlink" title="Ctype"></a>Ctype</h4><p>用来检测 在当前的区域设定下，一个字符或者字符串 是否仅包含指定类型的字符。根据官方描述，<strong>“如果可以满足需求，请优先考虑使用 ctype 函数， 而不是正则表达式或者对应的 “str_*” 和 “is_*” 函数。 因为 ctype 使用的是原生 C 库，所以会有明显的性能优势”</strong>。在4.2.0版本后，这些函数是默认启动的。</p>
<ul>
<li><code>ctype_alpha()</code>纯字符检测</li>
<li><code>ctype_upper()</code>大写字母检测</li>
<li><code>ctype_lower()</code>小写字母检测</li>
<li><code>ctype_digit()</code>纯数字检测</li>
<li><code>ctype_alnum()</code>检查字符串内的字符否全部为字母或数字</li>
<li><code>ctype_cntrl()</code>控制字符检测</li>
<li><code>ctype_print()</code>字符是否都可以打印</li>
<li><code>ctype_graph()</code>字符输出是否都是可见的</li>
<li><code>ctype_punct()</code>字符是否都可打印却不是字母数组和空白</li>
<li><code>ctype_space()</code>空白字符检测</li>
<li><code>ctype_xdigit()</code>十六进制字符串检测</li>
</ul>
<h4 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h4><p>在PHP5.3版本后，原来的POSIX Regex不再推荐使用。兼容Perl的正则表达式库PCRE仍可以使用，且默认开启。这里仅介绍PCRE相关函数，它们均以<code>preg</code>开头。</p>
<ul>
<li><code>preg_match()</code>返回pattern在subject中的匹配次数</li>
<li><code>preg_match_all()</code>搜索subject中所有匹配pattern给定正则表达式的匹配结果并且将它们以指定顺序输出到matches结果中.</li>
<li><code>preg_replace()</code>执行一个正则表达式的搜索和替换，当$pattern和$replacement都是数组时，会进行相对应位置的替换。</li>
<li><code>preg_grep(string $pattern , array $input [, int $flags = 0 ])</code>返回给定数组input中与模式pattern 匹配的元素组成的数组.</li>
<li><code>preg_split()</code>通过正则表达式分割字符串，返回一个数组。</li>
</ul>
<h4 id="JSON"><a href="#JSON" class="headerlink" title="JSON"></a>JSON</h4><p>自5.2.0起，JSON拓展默认内置并编译进PHP。</p>
<ul>
<li><code>json_encode()</code>JSON编码一个变量。</li>
<li><code>json_decode()</code>解码一个JSON格式的字符串</li>
<li><code>json_last_error()</code>返回JSON编码时最后的错误</li>
</ul>
<h4 id="多字节字符串"><a href="#多字节字符串" class="headerlink" title="多字节字符串"></a>多字节字符串</h4><p>在汉语中，每个字符通常占用2个字节，在使用string的相关函数时，可能会出现意外问题。多字节字符串即为了解决此问题。这不是一个默认扩展，需要在configure选项中显式激活。详见<a target="_blank" rel="noopener" href="http://php.net/manual/zh/mbstring.installation.php">安装</a>。另外，<code>mbstring</code>支持“函数重载”，即使用<code>mb_xxx</code>替代原有的字符串函数。</p>
<ul>
<li><code>mb_detect_encoding()</code>检测字符的编码</li>
<li><code>mb_ereg_xxx</code>打头的与<code>preg_xxx</code>同名的函数为正则匹配多字节版</li>
<li><code>mb_strlen()</code>获取字符串长度。</li>
<li><code>mb_split()</code>使用正则表达式分割多字节字符串</li>
<li><code>mb_substr()</code>执行一个多字节安全的<code>substr()</code>操作</li>
<li><code>mb_strpos()</code>查找字符串在另一个字符串中首次出现的位置；类似地，<code>mb_strrpos</code>查找最后出现的位置。</li>
<li><code>mb_strstr ()</code>查找字符串在另一个字符串里的首次出现；类似地，<code>mb_strrchr()</code>查找指定字符在另一个字符串中最后一次的出现</li>
</ul>
<h4 id="BCMath"><a href="#BCMath" class="headerlink" title="BCMath"></a>BCMath</h4><p>这部分函数进行任意大小和精度的数字的二进制计算。自4.0.4后随PHP一起发布。Windows版本下是默认支持的。</p>
<ul>
<li><code>string bcadd(string $left_operand , string $right_operand [, int $scale ] )</code>加法。scale用来决定小数点位数，输入输出均未string类型，下同。</li>
<li><code>bcsub()</code>减法</li>
<li><code>int bccomp()</code>比较</li>
<li><code>bcmul()</code>乘法</li>
<li><code>bcdiv()</code>除法</li>
<li><code>bcmod()</code>取模</li>
<li><code>bcpow()</code>乘方</li>
<li><code>bcsqrt()</code>二次方根</li>
<li><code>bcscale()</code>设置所有bc数学函数的默认小数点位数</li>
</ul>
<h4 id="图像处理"><a href="#图像处理" class="headerlink" title="图像处理"></a>图像处理</h4><p>PHP可以处理各种格式的图像，并把它们输出到浏览器。这需要在编译时指定GD库（除了<code>getimagesize()</code>函数）。GD库不仅能处理图像，还能对字体进行处理。使用PHP可以动态修改图像文件，或为图像添加水印信息，甚至创建一个图像。</p>
<p>下面是和图像信息相关的函数：</p>
<ul>
<li><code>gd_info()</code>获取当前安装的GD库信息</li>
<li><code>getimagesize()</code>获取图像大小，返回数组类型，按顺序分别是宽度，高度，类型，描述宽高的字符串。<code>getimagesizefromstring</code>函数则通过打开的图片信息（字符串格式）中读取图像尺寸信息</li>
<li><code>image_type_to_extension()</code>获取图像类型的文件后缀</li>
<li><code>imageistruecolor(resource $image)</code>检查图像是否为真彩色</li>
<li><code>imagesx()</code>返回image所代表的图像宽度；<code>imagesy()</code>返回所代表的图像高度</li>
<li><code>imagetypes()</code>返回PHP支持的图像类型，int类型。</li>
</ul>
<p>剩下还有众多以<code>image</code>开头的和创建、输出、删除图像，画图、编辑图片、设置颜色、设置字体相关的函数，见<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/book.image.php">参考</a>。</p>
<h4 id="Exif"><a href="#Exif" class="headerlink" title="Exif"></a>Exif</h4><p>通过Exif拓展，可以操作图像元数据。必须使用<code>--enable-exif</code>选项编译PHP，Windows用户还需要启用mbstring扩展。</p>
<ul>
<li><code>exif_imagetype()</code>读取一个图像的第一个字节并检查其签名</li>
<li><code>exif_read_data()</code>函数从JPEG或TIFF图像文件中读取EXIF头信息</li>
<li><code>exif_thumbnail()</code>读取TIFF或JPEG图像中的嵌入缩略图。如果图像不包含缩略图则返回FALSE</li>
</ul>
<h4 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h4><p>Socket拓展基于流行的BSD sockets，实现了和socket通讯功能的底层接口。在编译PHP时必须在配置中添加—enable-sockets配置项。利用这部分函数可以很方便地搭建起socket服务器和客户端，示例见<a target="_blank" rel="noopener" href="http://php.net/manual/zh/sockets.examples.php">官网</a>。</p>
<ul>
<li><code>socket_create(int $domain , int $type , int $protocol)</code>创建并返回一个套接字（resource类型）。其中<code>domain</code>指定使用的网络协议族，<code>type</code>指定建立的套接字类型，<code>protocol</code>指定使用的具体协议。</li>
<li><code>socket_create_listen()</code>在某端口打开socket以接收连接。</li>
<li><code>socket_bind()</code>绑定网络地址到套接字的源。</li>
<li><code>socket_connect()</code>使用address作为目的地址，建立套接字连接。</li>
<li><code>socket_listen()</code>在创建好socket资源，并绑定了source address后，可以调用此函数监听进入的数据流。</li>
<li><code>socket_accept()</code>在依次使用socket_create创建套接字，使用<code>socket_bind</code>绑定端口，使用<code>socket_listen</code>监听连接后。该函数允许到此套接字上的连接，返回一个新的socket资源用来通信。</li>
<li><code>socket_read()</code>从已连接的socket中读取一段长度的数据，返回读出的数据。</li>
<li><code>socket_recv()</code>功能同上，返回字节数并将数据存放在<code>$buf</code>中。</li>
<li><code>socket_recvfrom() </code>从已连接和还未连接的socket中读取数据。</li>
<li><code>socket_write()</code>向socket中写入数据</li>
<li><code>socket_send()</code>向已连接的socket中写入数据。</li>
<li><code>socket_sendto()</code>向socket中发送数据而不管是否已连接</li>
<li><code>socket_getsockname()</code>和<code>socket_getpeername()</code>获取本地和远端socket信息</li>
<li><code>socket_set_block()</code>和<code>socket_set_nonblock()</code>设置socket是否阻塞</li>
<li><code>socket_set_option()</code>设置套接字选项</li>
<li><code>socket_shutdown()</code>停止从socket中读写数据</li>
<li><code>socket_close()</code>关闭给定的socket资源</li>
</ul>
<h3 id="外部拓展库"><a href="#外部拓展库" class="headerlink" title="外部拓展库"></a>外部拓展库</h3><p>这些扩展库已经绑定在PHP发行包中，但是要编译以下扩展库，需要外部的库文件。这里仅介绍常用的cURL库。Mysqli和Mongo等可能会用得到的库介绍从略。</p>
<h4 id="client-URL"><a href="#client-URL" class="headerlink" title="client URL"></a>client URL</h4><p>PHP支持Daniel Stenberg创建的libcurl库，能够连接通讯各种服务器、使用各种协议。这些curl函数在PHP 4.0.2中引入。需要安装libcurl包才能使用PHP的cURL函数。安装过程从略。curl的使用流程思路和socket，mysql等十分相似，先使用<code>curl_init()</code>初始化会话，再使用<code>curl_setopt()</code>设置选项，然后通过<code>curl_exec()</code>执行会话，最后使用<code>curl_close()</code>关闭。</p>
<ul>
<li><code>curl_setopt()</code>设置一个传输选项，常用的设置包括<code>CURLOPT_URL</code>, <code>CURLOPT_HEADER</code>, <code>CURLOPT_RETURNTRANSFER</code>, <code>CURLOPT_TIMEOUT</code>等。类似的，还有<code>curl_setopt_array</code>函数。</li>
<li><code>curl_reset()</code>重置一个libcurl会话句柄的所有的选项</li>
<li><code>curl_exec()</code>执行一个cURL会话。返回TRUE或执行的结果，或是FALSE。</li>
<li><code>curl_close()</code>关闭一个会话，释放所有相关资源</li>
<li><code>curl_getinfo()</code>获取最后一次传输的相关信息。</li>
<li><code>curl_error()</code>返回一条最近一次cURL操作明确的文本的错误信息</li>
<li><code>curl_version()</code>获取cURL版本信息</li>
</ul>
<h2 id="特色"><a href="#特色" class="headerlink" title="特色"></a>特色</h2><p>这里列举的特点更多是PHP语言的特殊使用方式与应用特性。如HTTP用户认证（介绍见<a target="_blank" rel="noopener" href="http://php.net/manual/zh/features.http-auth.php">官网</a>），cookie等。</p>
<p>PHP透明地支持HTTP cookie，在PHP的网络函数中可以用<code>setcookie()</code>或<code>setrawcookie()</code>函数来设置cookie。cookie是HTTP标头的一部分，因此<code>setcookie()</code>函数必须在其它信息被输出到浏览器前调用，这和对header()函数的限制类似。可以使用输出缓冲函数来延迟脚本的输出，直到按需要设置好了所有的cookie或者其它HTTP标头。</p>
<p>PHP允许用户使用POST方法上传文本和二进制文件。一个上传文件的HTML表单代码类似如下，其中的<code>MAX_FILE_SIZE</code>隐藏字段在浏览器端限制了文件大小（单位字节，不建议依赖于此）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- The data encoding type, enctype, MUST be specified as below --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span> <span class="attr">action</span>=<span class="string">&quot;__URL__&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- MAX_FILE_SIZE must precede the file input field --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;MAX_FILE_SIZE&quot;</span> <span class="attr">value</span>=<span class="string">&quot;30000&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Name of input element determines name in $_FILES array --&gt;</span></span><br><span class="line">    Send this file: <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;userfile&quot;</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Send File&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>全局变量<code>$_FILES</code>自PHP4.1.0起存在，包含了所有上传的文件信息。<code>$_FILES[&#39;userfile&#39;]</code>数组有<code>name</code>, <code>type</code>, <code>size</code>, <code>tmp_name</code>, <code>error</code>等字段。error字段状态码在0-7间，分别表示上传成功&#x2F;文件过大&#x2F;部分上传&#x2F;没有文件&#x2F;找不到临时文件夹&#x2F;写入失败。文件被上传后，默认地会被储存到服务端的默认临时目录中。</p>
<p>PHP支持同时上传多个文件并将它们的信息自动以数组的形式组织。要完成这项功能，需要在HTML表单中对文件上传域使用和多选框与复选框相同的数组式提交语法。像下面的代码那样：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;file-upload.php&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">  Send these files:<span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;userfile[]&quot;</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;userfile[]&quot;</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Send files&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>同时，PHP还支持PUT方法上传文件，内容见官方文档。下面是一个允许用户上传图片的代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/plain; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// Undefined | Multiple Files | $_FILES Corruption Attack</span></span><br><span class="line">    <span class="comment">// If this request falls under any of them, treat it invalid.</span></span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">        !<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;error&#x27;</span>]) ||</span><br><span class="line">        <span class="title function_ invoke__">is_array</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;error&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;Invalid parameters.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check $_FILES[&#x27;upfile&#x27;][&#x27;error&#x27;] value.</span></span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;error&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">case</span> UPLOAD_ERR_OK:</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> UPLOAD_ERR_NO_FILE:</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;No file sent.&#x27;</span>);</span><br><span class="line">        <span class="keyword">case</span> UPLOAD_ERR_INI_SIZE:</span><br><span class="line">        <span class="keyword">case</span> UPLOAD_ERR_FORM_SIZE:</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;Exceeded filesize limit.&#x27;</span>);</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;Unknown errors.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// You should also check filesize here. </span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;size&#x27;</span>] &gt; <span class="number">1000000</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;Exceeded filesize limit.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// DO NOT TRUST $_FILES[&#x27;upfile&#x27;][&#x27;mime&#x27;] VALUE !!</span></span><br><span class="line">    <span class="comment">// Check MIME Type by yourself.</span></span><br><span class="line">    <span class="variable">$finfo</span> = <span class="keyword">new</span> <span class="title function_ invoke__">finfo</span>(FILEINFO_MIME_TYPE);</span><br><span class="line">    <span class="keyword">if</span> (<span class="literal">false</span> === <span class="variable">$ext</span> = <span class="title function_ invoke__">array_search</span>(</span><br><span class="line">        <span class="variable">$finfo</span>-&gt;<span class="title function_ invoke__">file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]),</span><br><span class="line">        <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;jpg&#x27;</span> =&gt; <span class="string">&#x27;image/jpeg&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;png&#x27;</span> =&gt; <span class="string">&#x27;image/png&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;gif&#x27;</span> =&gt; <span class="string">&#x27;image/gif&#x27;</span>,</span><br><span class="line">        ),</span><br><span class="line">        <span class="literal">true</span></span><br><span class="line">    )) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;Invalid file format.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// You should name it uniquely.</span></span><br><span class="line">    <span class="comment">// DO NOT USE $_FILES[&#x27;upfile&#x27;][&#x27;name&#x27;] WITHOUT ANY VALIDATION !!</span></span><br><span class="line">    <span class="comment">// On this example, obtain safe unique name from its binary data.</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">move_uploaded_file</span>(</span><br><span class="line">        <span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>],</span><br><span class="line">        <span class="title function_ invoke__">sprintf</span>(<span class="string">&#x27;./uploads/%s.%s&#x27;</span>,</span><br><span class="line">            <span class="title function_ invoke__">sha1_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]),</span><br><span class="line">            <span class="variable">$ext</span></span><br><span class="line">        )</span><br><span class="line">    )) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RuntimeException</span>(<span class="string">&#x27;Failed to move uploaded file.&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;File is uploaded successfully.&#x27;</span>;</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">RuntimeException</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在php.ini文件中激活了<code>allow_url_fopen</code>选项后，可以在大多数需要用文件名作为参数的函数中使用HTTP和FTP的URL来代替文件名。同时，也可以在<code>include</code>、<code>include_once</code>、<code>require</code>及<code>require_once</code>语句中使用URL。如果有合法的访问权限，以一个用户的身份和某FTP服务器建立了链接，还可以向该FTP服务器端的文件进行写操作。</p>
<p>持久的数据库连接是指在脚本结束运行时不关闭的连接。当收到一个持久连接的请求时。PHP将检查是否已经存在一个（前面已经开启的）相同的持久连接。如果存在，将直接使用这个连接；如果不存在，则建立一个新的连接。所谓“相同”的连接是指用相同的用户名和密码到相同主机的连接。</p>
<p>PHP 5.3后使用GC作为新的垃圾回收机制。每个php变量存在一个叫”zval”的变量容器中。一个zval变量容器，除了包含变量的类型和值，还包括两个字节的额外信息。第一个是”is_ref”，是个bool值，用来标识这个变量是否是属于引用集合(reference set)。第二个额外字节是”refcount”，用以表示指向这个zval变量容器的变量(也称符号即symbol)个数。通常，PHP中的垃圾回收机制，仅仅在循环回收算法确实运行时会有时间消耗上的增加。但是在平常的(更小的)脚本中应根本就没有性能影响。</p>
<h2 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h2><p>PHP作为一种强大的语言，无论是以模块还是CGI的方式安装，它的解释器都可以在服务器上访问文件、运行命令以及创建网络连接等。这些功能也许会给服务器添加很多不安全因素，但是只要正确地安装和配置PHP，以及编写安全的代码，那么PHP相对于Perl和C来说，是能创建出更安全的CGI程序的。这部分提出一些原则，在不同环境下尽可能提高安全性。</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>以CGI模式安装PHP时，它的设计可以用以避免访问系统文件和服务器的任意目录。在安装时配置一些选项可以有助避免这类攻击。具体见<a target="_blank" rel="noopener" href="http://php.net/manual/zh/security.cgi-bin.attacks.php">文档介绍</a>。同理，以Apache模块安装时，权限的注意也请见<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/security.apache.php">官网介绍</a>。</p>
<h3 id="Session安全"><a href="#Session安全" class="headerlink" title="Session安全"></a>Session安全</h3><p>这部分见<a href="####session">Session部分</a>的安全介绍。</p>
<h3 id="文件系统-1"><a href="#文件系统-1" class="headerlink" title="文件系统"></a>文件系统</h3><p>PHP被设计为以用户级别来访问文件系统，所以完全有可能通过编写一段PHP代码来读取系统文件如<code>/etc/passwd</code>，更改网络连接以及发送大量打印任务等等。因此必须确保PHP代码读取和写入的是合适的文件。</p>
<p>由于PHP的文件系统操作是基于C语言的函数的，Null字符在C语言中用于标识字符串结束，一个完整的字符串是从其开头到遇见Null字符为止。因此，任何用于操作文件系统的字符串（特别是程序外部输入的字符串）都必须经过适当的检查。</p>
<p>这种安全问题也会出现在执行来自用户输入的命令。通常有两条路可以选择：1）检查所有来自外部的变量（<strong>黑名单</strong>）；2）后台写死可以执行的文件名或命令有限集（<strong>白名单</strong>）</p>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><p>由于敏感数据和机密数据通常存储在数据库中，数据库安全和保护显得尤为重要。<strong>PHP本身并不能保护数据库的安全</strong>。这里只是讲述怎样用PHP脚本对数据库进行基本的访问和操作。</p>
<p><strong>设计数据库时，永远不要使用数据库所有者或超级用户帐号来连接数据库</strong>，因为这些帐号可以执行任意的操作。应该为程序的每个方面创建不同的数据库帐号，并赋予对数据库对象的极有限的权限。同时，一些功能可以用视图（view）、触发器（trigger）或者规则（rule）在数据库层面完成。</p>
<p><strong>连接数据库</strong>时，把连接建立在 SSL 加密技术上可以增加客户端和服务器端通信的安全性，或者SSH也可以用于加密客户端和数据库之间的连接。</p>
<p><strong>存储模型</strong>中，可以散列一些没必要明文显示的数据，建议加盐散列，同时采用新的SHA散列算法（如SHA-2或SHA-3）以增加安全程度。</p>
<h3 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h3><p>这部分内容是极为常见的网络安全问题，通过构造特殊的SQL语句，获取数据库信息甚至主机权限，介绍从略。</p>
<p>在预防措施上，<strong>永远不要信任外部输入的任何数据，包括表单里和cookie的信息</strong>。</p>
<ul>
<li>使用权限被严格限制的帐号访问数据库</li>
<li>检查输入的数据是否具有所期望的数据格式</li>
<li>减少SQL语句的拼接使用</li>
<li>使用数据库特定的敏感字符转义函数</li>
<li>还可以选择使用数据库的存储过程和预定义指针等特性来抽象数库访问，使用户不能直接访问数据表和视图</li>
</ul>
<h3 id="错误报告"><a href="#错误报告" class="headerlink" title="错误报告"></a>错误报告</h3><p>错误报告是一把双刃剑。一方面可以提高安全性，另一方面又有利于攻击者收集服务器的信息以便寻找弱点。PHP的独有的错误提示风格可以说明系统在运行 PHP，一个函数错误可能暴露系统正在使用的数据库，一个文件系统或者PHP的错误就会暴露web服务器具有什么权限，以及文件在服务器上的组织结构等。</p>
<p>有三个常用的办法处理这些问题。第一个是彻底地检查所有函数，并尝试弥补大多数错误。第二个是对在线系统彻底关闭错误报告。第三个是使用 PHP 自定义的错误处理函数创建自己的错误处理机制</p>
<p>可以通过<code>error_reporting()</code>帮助找到错误所在并使代码更安全。发布程序前，设置为<code>E_ALL</code>找到所有使用不当的地方；正式发布后，设为0彻底关闭错误报告或设置<code>php.ini</code>中的<code>display_errors</code>为<code>off</code>。</p>
<h3 id="隐藏PHP"><a href="#隐藏PHP" class="headerlink" title="隐藏PHP"></a>隐藏PHP</h3><p>一些简单的方法可以帮助隐藏 PHP，这样做可以提高攻击者发现系统弱点的难度。在<code>php.ini</code>文件里设置<code>expose_php = off</code>，可以减少他们能获得的有用信息。</p>
<p>另一个策略就是让web服务器用PHP解析不同扩展名。无论是通过<code>.htaccess</code>文件还是Apache的配置文件，都可以设置能误导攻击者的文件扩展名。</p>
<p>更多机智的隐藏方法见官网<a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/security.hiding.php">隐藏PHP</a>一节。</p>
<h2 id="内核-1"><a href="#内核-1" class="headerlink" title="内核"></a>内核</h2><p>考虑到重点所在，这部分内容仅简单地介绍一些涉及到PHP内部原理的东西。由于PHP运行在C语言的基础上，以下的内容和C语言编程靠近。</p>
<h3 id="内存管理"><a href="#内存管理" class="headerlink" title="内存管理"></a>内存管理</h3><p>用C语言编程时，开发者要手工地进行内存管理。因为PHP经常用作Web服务器的模块，内存管理与预防内存泄漏紧密关联。此外，Zend引擎要面对一个十分特殊的使用模式：在一段比较短的时间内，许多zval结构大小的内存块和其他的小内存块被请求又再被释放。为了满足以上的需求，Zend引擎提供为了处理请求相关数据提供了一种特殊的内存管理器。请求相关数据是指只需要服务于单个请求，最迟会在请求结束时释放的数据。<em>API介绍从略</em>。</p>
<p>因为安全原因，在请求结束时，Zend引擎会释放所有由上面提到的API所分配的内存。</p>
<h3 id="变量使用"><a href="#变量使用" class="headerlink" title="变量使用"></a>变量使用</h3><p>PHP变量，通常来说，由两部分组成：标签（例如，可能是符号表中的一个条目）和实际变量容器。变量容器，在代码中称为zval，掌握了所需处理变量的所有数据。 包括实际值、当前类型、统计指向此容器的标签的数量，和指示这些标签是引用还是副本的标志。在PHP 5.3中，结构如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> _<span class="title">zval_struct</span> <span class="title">zval</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">union</span> _<span class="title">zvalue_value</span> &#123;</span></span><br><span class="line">    <span class="type">long</span> lval;                 <span class="comment">/* long value */</span></span><br><span class="line">    <span class="type">double</span> dval;               <span class="comment">/* double value */</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> &#123;</span>                   <span class="comment">/* string type */</span></span><br><span class="line">        <span class="type">char</span> *val;</span><br><span class="line">        <span class="type">int</span> len;</span><br><span class="line">    &#125; str;</span><br><span class="line">    HashTable *ht;             <span class="comment">/* hash table value */</span></span><br><span class="line">    zend_object_value obj;</span><br><span class="line">&#125; zvalue_value;</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">struct</span> _<span class="title">zval_struct</span> &#123;</span></span><br><span class="line">    <span class="comment">/* Variable information */</span></span><br><span class="line">    zvalue_value value;        <span class="comment">/* value */</span></span><br><span class="line">    zend_uint refcount__gc;</span><br><span class="line">    zend_uchar type;           <span class="comment">/* active type */</span></span><br><span class="line">    zend_uchar is_ref__gc;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>有关函数，类和对象，流等的介绍从略。</p>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><p>Q: PHP 版本之间有什么联系？<br>A: PHP&#x2F;FI 2.0是最早的PHP版本，已经不再支持。PHP 3是PHP&#x2F;FI 2.0的后继者，要好很多。PHP 5是目前一代的PHP，内部使用了Zend 2引擎，除了很多新功能之外还提供了许多附加的面向对象编程（OOP）特性。<br><br><br>Q: 可以同时运行几个不同版本的PHP吗？<br>A: 可以，请参阅见PHP源程序发行包中的 INSTALL文件。<br><br><br>Q: 应该上哪儿去找我的<code>php.ini</code>文件<br>A: UNIX中默认在<code>/usr/local/lib</code>目录中，也就是<code>&lt;install-path&gt;/lib</code>。可以在编译时通过 <code>--with-config-file-path</code>标记来改变路径。Windows中<code>php.ini</code>文件的默认路径在Windows目录下。如果使用的是Apache服务器，则会首先在Apache的安装目录中寻找<code>php.ini</code>。<br><br><br>Q: PHP是否仅限于处理GET和POST请求方法？<br>A: 不是，PHP有可能处理任何请求方法，例如<code>CONNECT</code>。适当的回应状态可以用<code>header()</code>发送。<br><br><br>Q: 我忘了PHP函数的参数顺序，它们是随机的吗？<br>A: 通常情况下，数组函数的参数里，needle在前，haystack在后；字符串函数中，haystack在前，needle在后。<br><br><br>Q: PHP选项<code>register_globals</code>对我有什么影响？<br>A: 强烈不建议开启此选项，<code>register_globals</code>会自动生成变量。<br><br><br>Q: 我需要直接访问请求报头中的信息，怎么能办到？<br>A: 如果以Apache的模块方式运行PHP，那么函数<code>getallheaders()</code>可以做这件事。<br><br><br>Q: 如果不建议使用常用散列函数保护密码， 那么我应该如何对密码进行散列处理？<br>A: 当进行密码散列处理的时候，有两个必须考虑的因素： 计算量以及“盐”。 散列算法的计算量越大，暴力破解所需的时间就越长。PHP 5.5提供了一个原生密码散列API， 它提供一种安全的方式来完成密码散列和验证。 PHP 5.3.7及后续版本中都提供了一个纯PHP的兼容库。PHP 5.3及后续版本中，还可以使用<code>crypt()</code>函数，它支持多种散列算法。针对每种受支持的散列算法，PHP都提供了对应的原生实现。<br><br><br>Q: “盐”是什么？<br>A: 加解密领域中的“盐”是指在进行散列处理的过程中 加入的一些数据，用来避免从已计算的散列值表（被称作“彩虹表”中对比输出数据从而获取明文密码的风险。<br><br><br>Q: 我在使用<code>&lt;input type=&quot;image&quot;&gt;</code>标记，但是没有<code>$foo.x</code>和<code>$foo.y</code>变量，它们哪去了？<br>A: 当提交表单时，可以用图片代替标准的提交按钮，用类似这样的标记<br><code>&lt;input type=&quot;image&quot; src=&quot;image.gif&quot; name=&quot;foo&quot; /&gt;</code><br>当用户点击了图片的任何部分，该表单会被发送到服务器并加上两个额外的变量：<code>foo.x</code>和<code>foo.y</code>。因为<code>foo.x</code>和 <code>foo.y</code>在PHP中会成为非法的变量名，它们被自动转换成了<code>foo_x</code>和<code>foo_y</code>。也就是用下划线代替了点。<br><br><br>Q: PHP 5中还能用MySQL吗？好像找不到了。<br>A: MySQL依然被支持，唯一区别是PHP 5中默认为不激活。这意味着在PHP的configure一行中不包含有<code>--with-mysql</code>选项，因此必须在编译时手工加入。Windows用户可以编辑<code>php.ini</code>并激活<code>php_mysql.dll</code>。<br><br><br>Q: 在函数定义中，参数旁边的<code>&amp;</code>是什么意思？<br>A: 这表示该参数是引用传递，该函数会修改其值。鼓励使用的方法是在函数定义中指定哪些参数应该用引用传递。在函数调用时通过引用传递参数是不推荐的，因为它影响到了代码的整洁。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="http://php.net/manual/zh/book.password.php">php.net</a></li>
<li><a target="_blank" rel="noopener" href="https://laravel-china.github.io/php-the-right-way/">PHP之道中文版</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/blog/tags/PHP/" rel="tag"># PHP</a>
              <a href="/blog/tags/%E5%8F%82%E8%80%83/" rel="tag"># 参考</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/blog/2019/09/01/roadmap-refactor-log/" rel="prev" title="roadmap工程化改造">
                  <i class="fa fa-chevron-left"></i> roadmap工程化改造
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/blog/2019/09/16/tour-to-lijiang-and-dali/" rel="next" title="丽江、大理之行 —— 彩云之南">
                  丽江、大理之行 —— 彩云之南 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2014 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shenlvmeng</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">961k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">26:42</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/schemes/muse.js"></script><script src="/blog/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.14.3/algoliasearch-lite.umd.js" integrity="sha256-dyJcbGuYfdzNfifkHxYVd/rzeR6SLLcDFYEidcybldM=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/4.49.2/instantsearch.production.min.js" integrity="sha256-Nu8yqoXoRZEVYyZf4/eY1V4FsenbiCw85RY3gWjN3zQ=" crossorigin="anonymous"></script><script src="/blog/js/third-party/search/algolia-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/blog/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"shenlvmengs-blog","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/blog/js/third-party/comments/disqus.js"></script>

</body>
</html>
