{
    "version": "https://jsonfeed.org/version/1",
    "title": "Shenlvmeng's Blog â€¢ All posts by \"vue\" tag",
    "description": "Be sharp, my friend.",
    "home_page_url": "http://shenlvmeng.github.com/blog",
    "items": [
        {
            "id": "http://shenlvmeng.github.com/blog/2017/11/17/photogallery-improvement-2/",
            "url": "http://shenlvmeng.github.com/blog/2017/11/17/photogallery-improvement-2/",
            "title": "PhotogalleryæŠ€æœ¯æ¼”è¿›ç¬¬2æ­¥",
            "date_published": "2017-11-17T12:56:12.000Z",
            "content_html": "<h2 id=\"æ„å»ºå·¥å…·å‡çº§\"><a href=\"#æ„å»ºå·¥å…·å‡çº§\" class=\"headerlink\" title=\"æ„å»ºå·¥å…·å‡çº§\"></a>æ„å»ºå·¥å…·å‡çº§</h2><p>å› ä¸ºè¦æ‹†åˆ†ä»£ç ï¼Œä¾¿äºç®¡ç†ï¼Œéœ€è¦ä½¿ç”¨<code>import</code>å’Œ<code>export</code>ï¼Œå› æ­¤å¿…é¡»è¦å¼•å…¥webpackè¿™æ ·çš„æ‰“åŒ…å·¥å…·åˆ°gulpä¸­ï¼Œä½¿ç”¨<a href=\"https://github.com/shama/webpack-stream\">webpack-stream</a>ï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å’Œå…¶ä»–çš„gulpæ’ä»¶ç±»ä¼¼ï¼Œåœ¨pipeåœ¨è¿™æ ·æ’å…¥å°±è¡Œäº†<code>.pipe(webpack())</code>ï¼Œé…ç½®æ–¹å¼å’Œwebpackä¸€æ ·ã€‚ï¼ˆwebpackä¸­å¼•å…¥babel-loaderçš„è¿‡ç¨‹å°±ä¸èµ˜è¿°äº†ï¼‰å¼•å…¥webpackåï¼Œå¼€å‘æµç¨‹å’Œä¸€èµ·ç±»ä¼¼ï¼Œ<code>gulp</code>å¯åŠ¨æµ‹è¯•æœåŠ¡å™¨ï¼Œä½¿ç”¨webpacké€šè¿‡<code>entry.js</code>æ‰“åŒ…ä»£ç ï¼ŒCSSå’ŒJSONç›¸å…³æµç¨‹ä¸å˜ã€‚releaseæ—¶ï¼Œå¢åŠ äº†minifyçš„æµç¨‹ï¼Œè®©jsæµç¨‹åçš„ä»£ç å†å‹ç¼©ä¸€éã€‚</p>\n<p>å¦å¤–ï¼Œå¼•å…¥babelåï¼Œå¯ä»¥ç”¨ES6è¯­æ³•æ”¹å†™<code>gulpfile.js</code>ã€‚æœ€åçš„<code>gulpfile.babel.js</code>åƒä¸‹é¢è¿™æ ·ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> gulp <span class=\"keyword\">from</span> <span class=\"string\">&#x27;gulp&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> rename <span class=\"keyword\">from</span> <span class=\"string\">&#x27;gulp-rename&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> uglify <span class=\"keyword\">from</span> <span class=\"string\">&#x27;gulp-uglify&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> cleanCSS <span class=\"keyword\">from</span> <span class=\"string\">&#x27;gulp-clean-css&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> jsonminify <span class=\"keyword\">from</span> <span class=\"string\">&#x27;gulp-jsonminify&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> webserver <span class=\"keyword\">from</span> <span class=\"string\">&#x27;gulp-webserver&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> webpack <span class=\"keyword\">from</span> <span class=\"string\">&#x27;webpack-stream&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;js&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;src/index.js&#x27;</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">webpack</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">          &#123; <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>, <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span> &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;))</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">rename</span>(<span class=\"string\">&quot;index.js&quot;</span>))</span><br><span class=\"line\">\t\t.<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;dist&#x27;</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;minify&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;dist/index.js&#x27;</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">uglify</span>())</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">rename</span>(<span class=\"string\">&quot;index.min.js&quot;</span>))</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&quot;dist&quot;</span>));</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;css&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>([<span class=\"string\">&#x27;src/index.css&#x27;</span>])</span><br><span class=\"line\">\t\t.<span class=\"title function_\">pipe</span>(<span class=\"title function_\">cleanCSS</span>(&#123;<span class=\"attr\">compatibility</span>: <span class=\"string\">&#x27;ie8&#x27;</span>&#125;))</span><br><span class=\"line\">\t\t.<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;dist&#x27;</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;json&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;src/meta*.json&#x27;</span>)</span><br><span class=\"line\">\t\t.<span class=\"title function_\">pipe</span>(<span class=\"title function_\">jsonminify</span>())</span><br><span class=\"line\">\t\t.<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;dist&#x27;</span>))</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;webserver&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;./&#x27;</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">webserver</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">livereload</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"attr\">directoryListing</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"attr\">open</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;watch&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  gulp.<span class=\"title function_\">watch</span>([<span class=\"string\">&#x27;src/*.js&#x27;</span>, <span class=\"string\">&#x27;src/**/*.js&#x27;</span>, <span class=\"string\">&#x27;src/**/*.vue&#x27;</span>], [<span class=\"string\">&#x27;js&#x27;</span>]);</span><br><span class=\"line\">  gulp.<span class=\"title function_\">watch</span>(<span class=\"string\">&#x27;src/*.css&#x27;</span>, [<span class=\"string\">&#x27;css&#x27;</span>]);</span><br><span class=\"line\">  gulp.<span class=\"title function_\">watch</span>(<span class=\"string\">&#x27;src/*.json&#x27;</span>, [<span class=\"string\">&#x27;json&#x27;</span>]);</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;assets&#x27;</span>, [<span class=\"string\">&#x27;json&#x27;</span>, <span class=\"string\">&#x27;css&#x27;</span>, <span class=\"string\">&#x27;js&#x27;</span>]);</span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;default&#x27;</span>, [<span class=\"string\">&#x27;assets&#x27;</span>, <span class=\"string\">&#x27;webserver&#x27;</span>, <span class=\"string\">&#x27;watch&#x27;</span>]);</span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&quot;release&quot;</span>, [<span class=\"string\">&#x27;assets&#x27;</span>, <span class=\"string\">&#x27;minify&#x27;</span>]);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"ä½¿ç”¨å•æ–‡ä»¶ç»„ä»¶\"><a href=\"#ä½¿ç”¨å•æ–‡ä»¶ç»„ä»¶\" class=\"headerlink\" title=\"ä½¿ç”¨å•æ–‡ä»¶ç»„ä»¶\"></a>ä½¿ç”¨å•æ–‡ä»¶ç»„ä»¶</h2><p>å¼•å…¥webpackåï¼Œå¼€å§‹é«˜é«˜å…´å…´åœ°åˆ†æ¨¡å—æ‹†åˆ†ä»£ç ï¼Œå´å‘ç°åˆ†ç»„ä»¶ä½¿ç”¨Vueæ—¶ï¼Œä¸æ˜¯å•çº¯åœ°å®šä¹‰ç»„ä»¶é…ç½®ä¿¡æ¯ï¼Œç„¶åä¼ ç»™å…¥å£ç»„ä»¶å°±è¡Œã€‚å¿…é¡»è¦å¼•å…¥å…¨å®¶æ¡¶ï¼Œ<code>vue-loader</code>ç­‰å·¥å…·ï¼Œæ–‡ä»¶ä¸å¾—ä¸ç”¨.vueè¿™æ ·çš„å½¢å¼ç»„ç»‡ï¼ˆç°åœ¨å¼€å§‹è§‰å¾—Reactç»„ä»¶çš„ç»„ç»‡æ¯”Vueèˆ’æœäº†ï¼‰ã€‚æœ¬æ¥ä½¿ç”¨å•æ–‡ä»¶çš„å½¢å¼å°±æ˜¯æƒ³å°½é‡ç²¾ç®€ï¼Œå¯éšç€åŠŸèƒ½é€æ¸å¥å…¨ï¼Œçœ‹æ¥é‡æ„ä¹Ÿæ˜¯é¿å…ä¸äº†çš„å•Šã€‚åœ¨<a href=\"https://github.com/vuejs/vue-loader\">vue-loader</a>çš„ä»‹ç»é‡Œï¼Œå±…ç„¶è¿˜è¦é€šè¿‡<code>vue-cli</code>æ¥å¤§ä¸€ç»Ÿï¼Œä½†æ˜¯æˆ‘ä¸€æ˜¯æƒ³ç»´æŒé¡¹ç›®å°½é‡è½»é‡ç²¾ç®€ï¼Œä½¿ç”¨gulpçš„å·¥å…·é“¾ï¼›äºŒæ˜¯é¡¹ç›®å·²ç»å†™äº†å¾ˆä¹…äº†ï¼Œå…¨éƒ¨è¿ç§»è¿‡å»æˆæœ¬æœ‰äº›å¤§ã€‚äºæ˜¯ï¼Œé€šè¿‡<code>vue-cli</code>æ–°å»ºæ ·æœ¬é¡¹ç›®ï¼Œå¯¹ç€<code>package.json</code>å’Œ<code>webpack.config.js</code>ä¸€æŠ„äº†äº‹ã€‚</p>\n<p>åŠ ä¸Šç§ç§<code>.vue</code>æ–‡ä»¶çš„ç›¸å…³é…ç½®ï¼Œ<code>gulp.babel.js</code>æœ€åé•¿ä¸‹é¢è¿™æ ·ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;js&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;src/index.js&#x27;</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">webpack</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">module</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">rules</span>: [</span><br><span class=\"line\">          &#123; <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.js$/</span>, <span class=\"attr\">exclude</span>: <span class=\"regexp\">/node_modules/</span>, <span class=\"attr\">loader</span>: <span class=\"string\">&quot;babel-loader&quot;</span> &#125;,</span><br><span class=\"line\">          &#123; <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.vue$/</span>, <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;vue-loader&#x27;</span>&#125;,</span><br><span class=\"line\">          &#123; <span class=\"attr\">test</span>: <span class=\"regexp\">/\\.(png|jpg|gif|svg)$/</span>, <span class=\"attr\">loader</span>: <span class=\"string\">&#x27;file-loader&#x27;</span>, <span class=\"attr\">options</span>: &#123; <span class=\"attr\">name</span>: <span class=\"string\">&#x27;[name].[ext]?[hash]&#x27;</span> &#125; &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">      <span class=\"attr\">resolve</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">alias</span>: &#123;</span><br><span class=\"line\">          <span class=\"string\">&#x27;vue$&#x27;</span>: <span class=\"string\">&#x27;vue/dist/vue.esm.js&#x27;</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"attr\">extensions</span>: [<span class=\"string\">&#x27;*&#x27;</span>, <span class=\"string\">&#x27;.js&#x27;</span>, <span class=\"string\">&#x27;.vue&#x27;</span>, <span class=\"string\">&#x27;.json&#x27;</span>]</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;))</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">rename</span>(<span class=\"string\">&quot;index.js&quot;</span>))</span><br><span class=\"line\">\t\t.<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;dist&#x27;</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<p>ä¸‹é¢éœ€è¦å¼€å§‹æ‹†åˆ†ä»£ç äº†ã€‚æ ¹æ®React&#x2F;Vueè¿™æ ·æ¡†æ¶é€šå¸¸çš„è®¾è®¡ç»éªŒï¼Œéœ€è¦ä¸‹é¢ä¸€äº›ç»„æˆï¼š</p>\n<ul>\n<li><code>actions</code>  å­˜å‚¨çŠ¶æ€ç®¡ç†çš„åŠ¨ä½œ</li>\n<li><code>components</code>  å­˜å‚¨ç›¸äº’è§£è€¦çš„â€dumbâ€ç»„ä»¶ï¼Œæœ€å¥½å’Œä¸šåŠ¡æ— å…³</li>\n<li><code>constants</code>  å­˜å‚¨å…¨å±€å¸¸é‡</li>\n<li><code>containers</code>  å­˜å‚¨ç»„ç»‡<code>components</code>çš„ä¸šåŠ¡å®¹å™¨ç»„ä»¶</li>\n<li><code>entry</code>  å­˜å‚¨å…¥å£æ–‡ä»¶</li>\n<li><code>helper</code>  å­˜å‚¨å·¥å…·å‡½æ•°</li>\n<li><code>reducers</code>  å­˜å‚¨çŠ¶æ€ç®¡ç†çš„reducers</li>\n<li><code>settings</code>  å­˜å‚¨å…¨å±€é…ç½®ï¼Œé€šå¸¸ç”¨æ¥åˆå§‹åŒ–store</li>\n<li><code>store</code>  å­˜å‚¨å…¨å±€çŠ¶æ€</li>\n<li><code>templates</code>  å­˜å‚¨å¼•å…¥jsçš„htmlæ–‡ä»¶</li>\n</ul>\n<p>æˆ‘çš„é¡¹ç›®æ¯”è¾ƒç®€å•ï¼Œä¸€æ²¡æœ‰çŠ¶æ€ç®¡ç†ï¼ˆåé¢å¤æ‚äº†ä¹‹åå¯èƒ½ä¼šå¼•å…¥ğŸ˜‚ï¼‰ï¼ŒäºŒåªæœ‰ä¸‰ä¸ªç»„ä»¶ï¼Œåªè¦ä¸Šé¢çš„<code>components</code>, <code>constants</code>, <code>containers</code>, <code>helper</code>çš„å°±å¤Ÿç”¨äº†ã€‚æœ€åsrcä¸‹çš„æ–‡ä»¶ç›®å½•å¤§æ¦‚åƒä¸‹é¢è¿™æ ·</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">â”œâ”€â”€ App.vue</span><br><span class=\"line\">â”œâ”€â”€ components</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ column</span><br><span class=\"line\">â”‚Â Â      â””â”€â”€ Column.vue</span><br><span class=\"line\">â”œâ”€â”€ constants</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ index.js</span><br><span class=\"line\">â”œâ”€â”€ containers</span><br><span class=\"line\">â”‚Â Â  â”œâ”€â”€ info</span><br><span class=\"line\">â”‚Â Â  â”‚Â Â  â””â”€â”€ Info.vue</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ wall</span><br><span class=\"line\">â”‚Â Â      â””â”€â”€ Wall.vue</span><br><span class=\"line\">â”œâ”€â”€ helper</span><br><span class=\"line\">â”‚Â Â  â””â”€â”€ utils.js</span><br><span class=\"line\">â”œâ”€â”€ index.css</span><br><span class=\"line\">â””â”€â”€ index.js</span><br></pre></td></tr></table></figure>\n\n<p>åœ¨æ‹†åˆ†æ—¶é‡åˆ°äº†ä¸€äº›æ•°æ®éœ€è¦ä»æœ€å¤–å±‚é€ä¼ åˆ°å­ç»„ä»¶çš„æƒ…å†µï¼Œå¦‚<code>res</code>, <code>tag_list</code>, <code>tag_keys</code>ã€‚ä¸è¿‡ä»–ä»¬æ˜¯åªè¯»çš„ï¼Œè€Œä¸”æ•°ç›®å¾ˆå°‘ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦çŠ¶æ€ç®¡ç†ï¼Œåªç”¨é€šè¿‡propsä¼ ä¸‹å»å°±è¡Œäº†ã€‚</p>\n<h2 id=\"æ–°åŠŸèƒ½\"><a href=\"#æ–°åŠŸèƒ½\" class=\"headerlink\" title=\"æ–°åŠŸèƒ½\"></a>æ–°åŠŸèƒ½</h2><p>é‡æ„å®Œä¹‹åï¼Œç»ˆäºå¯ä»¥å†™æ–°åŠŸèƒ½äº†ã€‚æ–°åŠŸèƒ½ä¸»è¦æ˜¯å¢åŠ ä¸¤ä¸ªä¼ªè·¯ç”±ï¼Œæ–¹ä¾¿é¡µé¢çš„åˆ†äº«ï¼ˆè¿™ä¸ªéœ€æ±‚æˆ‘ä¹‹å‰é‡åˆ°è¿‡å‡ æ¬¡äº†ï¼‰ã€‚é¡µé¢æ˜¯spaç±»å‹çš„ï¼Œæ‰€ä»¥å‰ç«¯è·¯ç”±å¯ä»¥é‡‡ç”¨hashæˆ–history H5 APIæ¥å®ç°ã€‚åŒæ—¶ä¹Ÿæœ‰è®¸å¤šåœ¨è¿™ä¸ªåŸºç¡€ä¸Šäº†å‰ç«¯è·¯ç”±åº“ï¼Œæä¾›ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆã€‚æˆ‘çš„éœ€æ±‚ç›®å‰å…¶å®ä¸éœ€è¦å®Œæ•´çš„è·¯ç”±æ–¹æ¡ˆï¼š</p>\n<ul>\n<li>å›¾ç‰‡è¯¦æƒ…é¡µå¯ä»¥åˆ†äº«</li>\n<li>æœç´¢ç»“æœå¯ä»¥åˆ†äº«</li>\n</ul>\n<p>å› æ­¤ï¼Œè®¾è®¡ä¸Šä½¿ç”¨hashçš„æ–¹æ¡ˆï¼Œå¯¹äºå›¾ç‰‡è¯¦æƒ…é¡µï¼Œç”¨<code>!</code>å¼€å¤´ï¼Œåæ¥å›¾ç‰‡åºå·ã€‚å¯¹äºæœç´¢ç»“æœé¡µï¼Œåˆ™æ²¡æœ‰å¼€å¤´çš„<code>!</code>ï¼Œä»…ä½¿ç”¨<code>/</code>éš”å¼€æ¯ä¸€ä¸ªæœç´¢å…³é”®å­—ã€‚å¯¹hashçš„è¯»å†™ä¸Šï¼Œæ²¡æœ‰ä»€ä¹ˆå›°éš¾çš„åœ°æ–¹ï¼š</p>\n<ul>\n<li><strong>è¯»</strong>ï¼š<code>App.vue</code>æ ¹æ®hashæ³¨å…¥å¯¹åº”çš„æ•°æ®ï¼Œæ›´æ”¹é»˜è®¤è§†å›¾ï¼Œå¯¹äºå›¾ç‰‡è¯¦æƒ…é¡µï¼Œæ›´æ”¹å±•ç¤ºç»„ä»¶</li>\n<li><strong>å†™</strong>ï¼šåˆ‡æ¢ç»„ä»¶æ—¶ï¼Œè®°å½•å½“å‰æ•°æ®åˆ°<code>location.hash</code>ï¼Œæ–¹ä¾¿ç›´æ¥å¤åˆ¶é“¾æ¥åˆ†äº«</li>\n</ul>\n<h2 id=\"åé¢çš„è®¡åˆ’\"><a href=\"#åé¢çš„è®¡åˆ’\" class=\"headerlink\" title=\"åé¢çš„è®¡åˆ’\"></a>åé¢çš„è®¡åˆ’</h2><p>ç°åœ¨ç½‘ç«™è¿˜æ˜¯æœ‰ç‚¹å•è°ƒäº†ã€‚åªèƒ½è‡ªå¨±è‡ªä¹ï¼Œæ²¡æœ‰äº’åŠ¨ã€‚åé¢åº”è¯¥ä¼šè€ƒè™‘åœ¨æ¯å¼ å›¾ç‰‡æ¥å…¥Disqusçš„é—®é¢˜ã€‚</p>\n",
            "tags": [
                "é‡æ„",
                "è„šæ‰‹æ¶",
                "æŠ€æ”¹",
                "Vue",
                "gulp"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2017/09/08/photogallery-improvement/",
            "url": "http://shenlvmeng.github.com/blog/2017/09/08/photogallery-improvement/",
            "title": "PhotoGalleryæŠ€æœ¯æ”¹é€ ",
            "date_published": "2017-09-08T11:31:17.000Z",
            "content_html": "<p><img src=\"/blog/images/photogallery.png\"></p>\n<p>æœ€è¿‘ç¦»èŒåé™¤äº†å‡†å¤‡é¢è¯•ï¼Œå¤šäº†è®¸å¤šæ—¶é—´å¯¹ä»¥å¾€çš„å‰ç«¯ä¸ªäººé¡¹ç›®è¿›è¡Œæ”¹é€ ã€‚<a href=\"http://shenlvmeng.github.io/gallery/index.html\">PhotoGallery</a>å°±æ˜¯å…¶ä¸­ä¸€ä¸ªä¸ªäººå¾ˆå–œæ¬¢ï¼Œä½†ç”±äºæŠ€æœ¯åŸå› æ²¡åšåˆ°å®Œç¾çš„ä¾‹å­ã€‚æœ€è¿‘å‡†å¤‡æŠ½å‡ºæ—¶é—´è¿›è¡Œå®Œå–„ã€‚</p>\n<p>PhotoGalleryæ˜¯ä¸€ä¸ªä½¿ç”¨ç€‘å¸ƒæµå±•ç¤ºç”µå½±æµ·æŠ¥ä»¥åŠèŠ±çµ®ï¼ˆå½“ç„¶éƒ½æ˜¯ä¸ªäººæ¯”è¾ƒå¿ƒæ°´çš„ï¼‰çš„å±•ç¤ºå‹é¡µé¢ã€‚æ‰€æœ‰çš„ç”µå½±å›¾ç‰‡ä¹Ÿæ˜¯ä»å¤§ä¸€å°±å¼€å§‹æ”¶é›†çš„ï¼Œä¸€ç›´å›¤ç§¯åœ¨äººäººä¸Šã€‚é¡µé¢çš„è¯¸å¤šåŠŸèƒ½æ˜¯æ ¹æ®ä¸ªäººçˆ±å¥½è®¾è®¡çš„ï¼Œå¦‚</p>\n<ul>\n<li>æ ¹æ®æ ‡ç­¾æœç´¢</li>\n<li>ç›¸ä¼¼å›¾ç‰‡</li>\n<li>åŸºäºtagçš„æ¨èç­‰</li>\n</ul>\n<p>æ€»ä½“æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªå±•ç¤ºã€ä»‹ç»ã€æ¨èç”µå½±çš„åœ°æ–¹ã€‚å†…å®¹ä¸Šè¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚ä½†æ˜¯ï¼Œå»å¹´å¯’å‡ç ä»£ç æ—¶ï¼Œå‰ç«¯æŠ€æœ¯è¿˜æœ‰å¾…æé«˜ï¼Œå¾ˆå¤šåœ°æ–¹å†™å¾—å¹¶ä¸ä¸¥è°¨ç”šè‡³æ¯”è¾ƒä¸‘é™‹ã€‚åŠŸèƒ½ä¸Šä¹Ÿæœ‰äº›å½±å“ä½“éªŒå¿…é¡»è§£å†³çš„ç—›ç‚¹ã€‚å¤§æ¦‚æœ‰ä¸‹é¢è¿™äº›</p>\n<ul>\n<li><strong>é¦–å±æ¸²æŸ“æ—¶é—´ç³Ÿç³•</strong>ï¼Œè¿™æ˜¯å› ä¸ºå›¾ç‰‡è¿‡å¤šï¼ˆä¸ªäººçœ‹çš„å¤ªå¤šï¼‰ï¼Œåˆä½¿ç”¨äº†Vueã€‚åŒæ—¶Vueè¿™ç§MVVMæ¡†æ¶å’Œç²¾ç»†åŒ–DOMæ“ä½œä¸€å±±ä¸å®¹äºŒè™ï¼Œå› æ­¤ï¼Œç»“åˆæ‡’åŠ è½½ï¼Œæ•ˆæœä¾ç„¶ä¸ç†æƒ³</li>\n<li><strong>å›¾ç‰‡çš„æ—¶åºæ’å¸ƒå¹¶ä¸è‡ªç„¶</strong>ï¼Œå½“æ—¶å›¾çœäº‹ï¼Œä½¿ç”¨çº¯CSSæ–¹æ¡ˆå®ç°ç€‘å¸ƒæµï¼Œç‰ºç‰²äº†å›¾ç‰‡æ’åºã€‚å›¾ç‰‡åªèƒ½ä»ä¸Šåˆ°ä¸‹å†ä»å·¦åˆ°å³æ’åºï¼Œå’Œæ­£å¸¸çš„é˜…è¯»é¡ºåºå¹¶ä¸ä¸€è‡´ã€‚åŒæ—¶ï¼Œæœ€è€çš„å›¾ç‰‡åœ¨æœ€å‰ï¼Œä¹Ÿä¸åˆç†</li>\n<li><strong>æ–°å¢å›¾ç‰‡å›°éš¾</strong>ï¼Œè¿™æ˜¯ç”±äºgithub.ioçš„çº¯é™æ€çš„é™åˆ¶ï¼Œå½“æ—¶é‡‡ç”¨äº†é™æ€å›¾ç‰‡+metaå­˜æ•°æ®çš„æ–¹å¼æ¥å®ç°ï¼Œåé¢çœ‹äº†ç”µå½±å†å¾€é‡ŒåŠ å›¾æ­¥éª¤ç¹çï¼Œæ²¡æœ‰äººæ€§åŒ–çš„åŠæ³•</li>\n<li>æ ·å¼è€æ°”ï¼Œç»†èŠ‚ç²—ç³™</li>\n<li><strong>æœ¬åœ°è°ƒè¯•å›°éš¾</strong>ï¼Œåªä½¿ç”¨äº†gulpæ¥å‹ç¼©jsï¼Œcsså’Œjsonä»£ç ï¼ˆä»£ç å°‘ï¼Œä¸éœ€è¦æ‰“åŒ…ï¼‰ï¼Œä¸æ˜¯å…¨å®¶æ¡¶è„šæ‰‹æ¶ï¼Œæœ¬åœ°è°ƒè¯•å›°éš¾ï¼Œä¸”ä¸èƒ½ä½¿ç”¨ES6è¯­æ³•</li>\n<li><strong>ä»£ç è¯­æ³•å’Œé£æ ¼ä¸Šä¸ä¸¥è°¨</strong>ï¼Œè€ƒè™‘ç»“åˆåœ¨å…¬å¸çš„è§„çŸ©è§„èŒƒ</li>\n</ul>\n<p>é’ˆå¯¹ä¸Šé¢å¤§å¤§å°å°å‡ ç‚¹ï¼Œä»¥åŠå®é™…æƒ…å†µï¼ˆæ¯”å¦‚åªèƒ½ä½¿ç”¨github.ioï¼‰ï¼Œè€ƒè™‘åƒä¸‹é¢è¿™æ ·ä¼˜åŒ–</p>\n<h3 id=\"ç€‘å¸ƒæµå¸ƒå±€å®ç°æ–¹å¼å¾…ä¼˜åŒ–\"><a href=\"#ç€‘å¸ƒæµå¸ƒå±€å®ç°æ–¹å¼å¾…ä¼˜åŒ–\" class=\"headerlink\" title=\"ç€‘å¸ƒæµå¸ƒå±€å®ç°æ–¹å¼å¾…ä¼˜åŒ–\"></a>ç€‘å¸ƒæµå¸ƒå±€å®ç°æ–¹å¼å¾…ä¼˜åŒ–</h3><p>æ”¾å¼ƒä½¿ç”¨column-countçš„æ–¹æ¡ˆã€‚åŸå› æœ‰äºŒï¼š</p>\n<ol>\n<li>æ’å¸ƒé¡ºåºæ˜¯ä»ä¸Šåˆ°ä¸‹ï¼Œå†ä»å·¦åˆ°å³ï¼Œå’Œæ—¥å¸¸ç»éªŒç›¸æ‚–ã€‚ç±»ä¼¼åœ°ï¼Œä½¿ç”¨flexçš„æ–¹æ¡ˆä¹Ÿä¸è¡Œ</li>\n<li>æœ¬èº«å’Œæ‡’åŠ è½½çš„è®¾è®¡å…¼å®¹æ€§å¹¶ä¸å¥½ï¼Œæ‡’åŠ è½½çš„æ–°å›¾ç‰‡ä¼šå¯¼è‡´æ•´ä¸ªé¡µé¢çš„å¸ƒå±€å®Œå…¨æ”¹å˜ã€‚ç±»ä¼¼åœ°ï¼Œä½¿ç”¨gridçš„æ–¹æ¡ˆä¹Ÿä¸é€‚åˆ</li>\n</ol>\n<p>å› æ­¤è€ƒè™‘å€Ÿé‰´<a href=\"http://www.zhangxinxu.com/wordpress/2012/03/%E5%A4%9A%E6%A0%8F%E5%88%97%E8%A1%A8%E5%8E%9F%E7%90%86%E4%B8%8B%E5%AE%9E%E7%8E%B0%E7%9A%84%E7%80%91%E5%B8%83%E6%B5%81%E5%B8%83%E5%B1%80-waterfall-layout/\">å¼ é‘«æ—­å¤§ç¥çš„æ–¹æ¡ˆ</a>ï¼Œç»¼åˆCSSå’ŒJSå®ç°æ‡’åŠ è½½çš„æ»šåŠ¨å¼ç€‘å¸ƒæµå¸ƒå±€ã€‚</p>\n<p><img src=\"http://image.zhangxinxu.com/image/blog/201203/2012-03-23_233114.png\"></p>\n<p>é¦–å…ˆï¼Œæ ¹æ®å±å¹•å®½åº¦è®¾ç½®åˆç†çš„åˆ—æ•°ï¼Œå†é€åˆ—æ’å…¥5å¼ æ–°å›¾ç‰‡ï¼Œä½œä¸ºåˆå§‹æƒ…å†µï¼ŒåŒæ—¶ï¼Œä½¿ç”¨<code>flex</code>å¸ƒå±€ï¼Œè®¾ç½®<code>flex-grow</code>å’Œ<code>justify-content</code>ç­‰å±æ€§ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title class_\">Wall</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">  <span class=\"title function_\">data</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> &#123;</span><br><span class=\"line\">      <span class=\"attr\">columns</span>: <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span> / columnWidth),</span><br><span class=\"line\">      <span class=\"attr\">lastFlag</span>: <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span> / columnWidth) * <span class=\"number\">5</span> - <span class=\"number\">1</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">  <span class=\"attr\">computed</span>: &#123;</span><br><span class=\"line\">    <span class=\"title function_\">items</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"comment\">// ...</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"title function_\">itemsForColumns</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">let</span> ret = <span class=\"title class_\">Array</span>.<span class=\"title function_\">apply</span>(<span class=\"literal\">null</span>, <span class=\"title class_\">Array</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">columns</span>)).<span class=\"title function_\">map</span>(<span class=\"function\">() =&gt;</span> []);</span><br><span class=\"line\">      <span class=\"variable language_\">this</span>.<span class=\"property\">items</span>.<span class=\"title function_\">slice</span>(<span class=\"number\">0</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">lastFlag</span> + <span class=\"number\">1</span>).<span class=\"title function_\">forEach</span>(<span class=\"function\">(<span class=\"params\">item, i</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        ret[i % <span class=\"variable language_\">this</span>.<span class=\"property\">columns</span>].<span class=\"title function_\">push</span>(item);</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">      <span class=\"comment\">// æ¯åˆ—å…ˆåªåŠ è½½5ä¸ª</span></span><br><span class=\"line\">      <span class=\"keyword\">return</span> ret;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"comment\">// ...</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#photos</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: flex;</span><br><span class=\"line\">  <span class=\"attribute\">flex-flow</span>: row wrap;</span><br><span class=\"line\">  <span class=\"attribute\">align-items</span>: flex-start;</span><br><span class=\"line\">  <span class=\"attribute\">justify-content</span>: space-around;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">100%</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"selector-class\">.wall-column</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">display</span>: inline-block;</span><br><span class=\"line\">  <span class=\"attribute\">width</span>: <span class=\"number\">250px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">margin</span>: <span class=\"number\">0</span> <span class=\"number\">8px</span>;</span><br><span class=\"line\">  <span class=\"attribute\">vertical-align</span>: top;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ä¹‹åï¼Œç›‘å¬å¯èƒ½ä¼šæ”¹å˜å¸ƒå±€çš„æ‰€æœ‰æƒ…å†µï¼Œåœ¨æˆ‘è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œå¤§æ¦‚æœ‰ä¸‰ç§ï¼š</p>\n<ul>\n<li>æ»šåŠ¨ï¼ˆscrollï¼‰äº‹ä»¶</li>\n<li>ç¼©æ”¾äº‹ä»¶ï¼ˆresizeï¼‰äº‹ä»¶</li>\n<li>ç­›é€‰å›¾ç‰‡ï¼Œåœ¨æ”¹å˜ç­›é€‰æ¡ä»¶ï¼Œä¼šå¯¼è‡´å›¾ç‰‡æ•°ç›®çš„å˜åŒ–</li>\n</ul>\n<p>ä¸‹é¢åˆ†æƒ…å†µè§£å†³ä¹‹ã€‚</p>\n<p><strong>resizeæ—¶</strong></p>\n<p>ç›‘å¬<code>window</code>çš„<code>resize</code>äº‹ä»¶ï¼Œå½“æœ€åä¸€åˆ—çš„ä½ç½®å˜åŒ–æ—¶ï¼Œæ„å‘³ç€å¸ƒå±€å·²ç»æ”¹å˜ï¼Œéœ€è¦è§¦å‘é‡æ’ã€‚å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„<code>itemForColumns</code>ä¸­ä¾èµ–<code>columns</code>å’Œ<code>lastFlag</code>ä¸¤ä¸ªçŠ¶æ€ã€‚è¿™é‡Œæˆ‘ä»¬åˆ©ç”¨MVVMæ¡†æ¶çš„ä¼˜åŠ¿ï¼Œç»´æŠ¤è¿™ä¸¤ä¸ªå€¼ï¼Œå°±å¯ä»¥è®©Vueå¸®æˆ‘ä»¬å®Œæˆé‡æ’è¿™æ ·çš„ç¹çæ“ä½œã€‚å¦‚ä¸‹ï¼Œå½“<code>columns</code>æ”¹å˜æ—¶ï¼Œæ‰ä¼šè§¦å‘é‡ç»˜ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable language_\">window</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&quot;resize&quot;</span>, <span class=\"function\"><span class=\"params\">e</span> =&gt;</span> &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">columns</span> = <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span> / columnWidth);</span><br><span class=\"line\">  <span class=\"comment\">// å·²ç»å±•ç¤ºè¿‡çš„å›¾ç‰‡å°±ä¸è¦éšè—äº†</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">lastFlag</span> = <span class=\"title class_\">Math</span>.<span class=\"title function_\">max</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">columns</span> * <span class=\"number\">5</span> - <span class=\"number\">1</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">lastFlag</span>);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p><strong>ç­›é€‰å›¾ç‰‡æ—¶</strong></p>\n<p>åŒç†ï¼Œé€šè¿‡å…³é”®è¯ç­›é€‰å›¾ç‰‡æ—¶ï¼Œæ”¹å˜äº†ä¼ å…¥Wallçš„prop <code>factor</code>ã€‚ä¼šåŒæ­¥æ›´æ–°ä¾èµ–<code>factor</code>çš„<code>item</code>ï¼Œè§¦å‘é‡æ’ã€‚æœ‰ä¸€ç‚¹æœ‰æ³¨æ„çš„æ˜¯ï¼Œ**<code>lastFlag</code>éœ€è¦é‡æ–°å¼€å§‹ç´¯åŠ **ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">watch</span>: &#123;</span><br><span class=\"line\">  <span class=\"title function_\">items</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// è®¾ç½®äº†ç­›é€‰æ¡ä»¶åï¼ŒlastFlagéœ€è¦é‡æ–°å¼€å§‹ç´¯åŠ </span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">lastFlag</span> = <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(<span class=\"variable language_\">document</span>.<span class=\"property\">body</span>.<span class=\"property\">clientWidth</span> / columnWidth) * <span class=\"number\">5</span> - <span class=\"number\">1</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>scrollæ—¶</strong></p>\n<p>é¡µé¢æ»šåŠ¨æ—¶ï¼Œéœ€è¦åŠ å…¥æ–°çš„å›¾ç‰‡åˆ°columnä¸­ï¼Œæˆ‘ä»¬è¦åšçš„åªæ˜¯æ›´æ”¹<code>lastFlag</code>å³å¯ï¼ŒVueä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨å®Œæˆä¾èµ–<code>lastFlag</code>çš„<code>itemForColumns</code>æ›´æ–°ã€‚é‡ç‚¹åœ¨ï¼Œæˆ‘ä»¬å¦‚ä½•çŸ¥é“lastFlagåº”è¯¥å¢åŠ åˆ°å¤šå°‘ã€‚</p>\n<p>æˆ‘ä»¬å›çœ‹ä¸‹<code>itemForColumns</code>çš„é€»è¾‘ï¼Œå¯ä»¥å‘ç°<strong>æ–°å¢çš„å›¾ç‰‡æ˜¯å¾ªç¯æ‘†æ”¾çš„</strong>ã€‚è¿™é‡Œé¢å¤–è¯´ä¸€å¥ï¼Œå°½ç®¡æ–°å›¾ç‰‡æ”¾åœ¨æœ€çŸ­åˆ—æ˜¯æœ€åˆç†çš„ï¼Œä½†æ˜¯å·¥ç¨‹ä¸Šå¹¶ä¸åˆç®—ï¼ˆä¸€æ˜¯Vueä¸‹åšè¿™ä¹ˆç²¾ç»†çš„DOMæ“ä½œä¸åˆé€‚ï¼ŒäºŒæ˜¯è·çŸ¥æœ€çŸ­åˆ—æ„å‘³ç€DOMæ“ä½œå·²ç»å‘ç”Ÿï¼Œå³ä¼šæœ‰é¢‘ç¹çš„å›æµå’Œé‡ç»˜ï¼Œè¿™ä¼šå½±å“æ¸²æŸ“æ—¶é—´ï¼‰ã€‚æˆ‘ä»¬å¾ªç¯è€ƒè™‘æ¯ä¸€åˆ—çš„æœ€åº•éƒ¨ä½ç½®ï¼Œå¦‚æœåœ¨è§†å£å†…ï¼Œå°†å›¾ç‰‡æ›´æ–°åˆ°è¯¥åˆ—ï¼Œç›´åˆ°æ‰€æœ‰åˆ—åº•éƒ¨éƒ½åœ¨è§†å£å¤–ã€‚ç›´åˆ°å›¾ç‰‡åŠ è½½å®Œæ¯•ã€‚</p>\n<p>å¦å¤–ï¼Œåœ¨å®è·µæ—¶è¿˜å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œ<code>handleScroll</code>é‡Œæ›´æ”¹äº†<code>lastFlag</code>åï¼ŒVueæœ¬èº«æœ‰batchçš„ä¼˜åŒ–ï¼Œä¼šåœ¨microtaskæ ˆç©ºåï¼Œæ‰ä¼šè¿›è¡Œè€—æ—¶çš„DOMæ“ä½œã€‚å¾ªç¯æ·»åŠ å›¾ç‰‡æ—¶ï¼Œéœ€è¦é€šè¿‡setTimeoutå¼‚æ­¥å®Œæˆï¼Œé¿å…è¯¯åˆ¤ï¼Œåœ¨ä¸€æ¬¡é€’å½’ä¸­åŠ è½½äº†æ‰€æœ‰å›¾ç‰‡ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">handleScroll</span>(<span class=\"params\">top</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">items</span>.<span class=\"property\">length</span> &lt;= <span class=\"variable language_\">this</span>.<span class=\"property\">lastFlag</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> delta = -<span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"variable language_\">this</span>.<span class=\"property\">columns</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> col = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">`wall-<span class=\"subst\">$&#123;i&#125;</span>`</span>);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (col &amp;&amp; col.<span class=\"property\">offsetTop</span> + col.<span class=\"property\">clientHeight</span> &lt; top + (<span class=\"variable language_\">window</span>.<span class=\"property\">innerHeight</span> || <span class=\"variable language_\">document</span>.<span class=\"property\">documentElement</span>.<span class=\"property\">clientHeight</span>)) &#123;</span><br><span class=\"line\">      delta = i;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!!++delta) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">lastFlag</span> += delta;</span><br><span class=\"line\">    <span class=\"comment\">// ç›´åˆ°æ‰€æœ‰åˆ—ä¸‹æ²¿éƒ½ä¸åœ¨è§†å£å†…ï¼Œ</span></span><br><span class=\"line\">    <span class=\"comment\">// åŒæ—¶ï¼Œè®¾ç½®æ—¶å»¶ï¼Œä¿è¯DOMæ“ä½œå®Œæˆåå†ç»§ç»­handleScroll</span></span><br><span class=\"line\">    <span class=\"built_in\">setTimeout</span>(<span class=\"function\">() =&gt;</span> &#123;  <span class=\"variable language_\">this</span>.<span class=\"title function_\">handleScroll</span>(top); &#125;, <span class=\"number\">0</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"æ–°å¢å›¾ç‰‡å›°éš¾\"><a href=\"#æ–°å¢å›¾ç‰‡å›°éš¾\" class=\"headerlink\" title=\"æ–°å¢å›¾ç‰‡å›°éš¾\"></a>æ–°å¢å›¾ç‰‡å›°éš¾</h3><p><del>ç”±äºgithub.ioæ˜¯çº¯é™æ€çš„é¡µé¢ï¼Œæˆ‘å¹¶æ²¡æœ‰åå°ç¯å¢ƒï¼Œè¿™ä¸ªç—›ç‚¹çŸ­æœŸå†…åªèƒ½ç¼“è§£ä¸èƒ½æ ¹é™¤ã€‚ä¸è¿‡åé¢è€ƒè™‘å°†æ‰€æœ‰å›¾ç‰‡è¿ç§»åˆ°å›¾åºŠä¸Šï¼Œæ¯•ç«ŸæŠŠå›¾ç‰‡æ•°æ®ä¹Ÿå­˜åœ¨githubä¸Šæ„Ÿè§‰è¿˜æ˜¯â€¦â€¦æœ‰ç‚¹æ€ªæ€ªçš„ã€‚æ—¥åæ–°å¢å›¾ç‰‡åº”è¯¥è¿˜æ˜¯é€šè¿‡ä¸Šä¼ å›¾ç‰‡ï¼Œæ›´æ–°<code>meta.json</code>çš„å½¢å¼å®Œæˆã€‚</del></p>\n<p>ç›®å‰å·²å°†æ‰€æœ‰å›¾ç‰‡è¿ç§»åˆ°å›¾åºŠä¸Šï¼Œå›¾åºŠé€‰æ‹©ä¸Šå‚è€ƒäº†çŸ¥ä¹ä¸Šçš„æ¨èï¼Œä½¿ç”¨<a href=\"https://www.qiniu.com/\">ä¸ƒç‰›äº‘å­˜å‚¨</a>ï¼Œåœ¨ä¸ªäººå®åè®¤è¯åï¼Œå…è´¹éƒ¨åˆ†æœ‰æ¯æœˆ10Gå›½å†…å’Œå›½å¤–ä¸‹è½½æµé‡ï¼Œ100ä¸‡æ¬¡GETå’ŒPUTè¯·æ±‚æ¬¡æ•°ï¼Œå’Œ10Gå­˜å‚¨ç©ºé—´ã€‚åŒæ—¶ï¼Œå®ƒè¿˜æä¾›å¯¹å›¾ç‰‡çš„å‹ç¼©ç­‰ç®¡ç†ï¼Œå°½é‡å‡å°‘æµé‡ã€‚</p>\n<p>è¿ç§»ä¹‹åï¼Œä»“åº“ä½“ç§¯å¤§å¤§å‡å°ã€‚ä¹‹åæ—¥å¸¸æ›´æ–°æ—¶ï¼Œå›¾ç‰‡å•ç‹¬ä¸Šä¼ ï¼Œæ ¹æ®å¤–é“¾å›ºå®šå‰ç¼€å¾—åˆ°æœ€ç»ˆè·¯å¾„ã€‚</p>\n<p><del><code>meta.json</code>çš„æ›´æ–°ä¸Šï¼Œè€ƒè™‘è‡ªå·±å†™ä¸€ä¸ªå·¥å…·ï¼Œæ ¹æ®æ–°çœ‹çš„ç”µå½±ç”Ÿæˆæ–°çš„contentã€‚</del></p>\n<p>å·²å®Œæˆè‡ªåŠ¨ç”Ÿæˆ<code>meta.json</code>çš„<a href=\"https://shenlvmeng.github.io/meta-maker.html\">å°å·¥å…·</a>ï¼ŒåŸç†å¾ˆç®€å•ï¼Œå°±ä¸å†ä»‹ç»äº†ã€‚</p>\n<h3 id=\"ç»†èŠ‚ç¾åŒ–\"><a href=\"#ç»†èŠ‚ç¾åŒ–\" class=\"headerlink\" title=\"ç»†èŠ‚ç¾åŒ–\"></a>ç»†èŠ‚ç¾åŒ–</h3><p>ç‚¹æ¯”è¾ƒç»†ç¢ã€‚æ•´ä½“å€Ÿé‰´äº†<a href=\"https://material.io/guidelines/material-design/introduction.html#introduction-goals\">material design</a>çš„æ€æƒ³ã€‚</p>\n<p><strong>å½±ç‰‡è¯¦ç»†ä¿¡æ¯çš„é®ç½©</strong></p>\n<p>è€ƒè™‘ä½¿ç”¨100%çš„é®ç½©ï¼ŒåŒæ—¶ç¦æ­¢èƒŒæ™¯æ»šåŠ¨çš„å½¢å¼å±•ç¤ºå›¾ç‰‡çš„è¯¦ç»†ä¿¡æ¯ã€‚èµ·åˆæ‰“ç®—ç”¨jså»å®ç°ï¼Œåæ¥å‘ç°ä¸‹é¢çš„ä¸¤ç‚¹ä½¿å¾—æ–¹æ¡ˆå¹¶ä¸ç®€å•</p>\n<ul>\n<li>scrolläº‹ä»¶ä¸èƒ½è¢«cancelï¼Œè¿™æ„å‘³ç€ä¸èƒ½æ‰“æ–­é»˜è®¤çš„æ»šåŠ¨è¡Œä¸º</li>\n<li>ä»Mouseï¼ŒKeyboardï¼ŒTouchç›¸å…³è§¦å‘scrolläº‹ä»¶çš„äº‹ä»¶åŠ«æŒæ»šåŠ¨è¡Œä¸ºå€’æ˜¯å¯ä»¥ï¼Œä¸è¿‡è¦ç›‘å¬çš„äº‹ä»¶å¤ªå¤š</li>\n</ul>\n<p>åªå¥½ä½œç½¢ï¼Œé€šè¿‡çº¯CSSçš„æ–¹å¼ï¼Œå¼¹å‡ºæµ®å±‚æ—¶ï¼Œä¸ºbodyæŒ‡å®š<code>noscroll</code>çš„ç±»åã€‚è®©æµ®å±‚çš„<code>overflow</code>å±æ€§ä¸º<code>scroll</code>å³å¯ï¼ŒåŒæ—¶è®¾ç½®æµ®å±‚<code>position</code>å±æ€§ä¸º<code>fixed</code>å³å¯ã€‚</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#display</span> &#123;</span><br><span class=\"line\">  <span class=\"attribute\">position</span>: fixed;</span><br><span class=\"line\">  <span class=\"attribute\">top</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"attribute\">left</span>: <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"comment\">/*...*/</span></span><br><span class=\"line\">  <span class=\"attribute\">z-index</span>: <span class=\"number\">100</span>;</span><br><span class=\"line\">  <span class=\"attribute\">overflow-y</span>: scroll;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>ä½¿ç”¨ç¼“åŠ¨å‡½æ•°æ”¹è¿›å›åˆ°å¼€å¤´</strong></p>\n<p>è¿™é‡Œä½¿ç”¨å®šä¹‰åŸŸå’Œå€¼åŸŸéƒ½æ˜¯<code>[0,1]</code>çš„<code>easeInOutCubic</code>å‡½æ•°ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">easeInOutCubic</span> = t =&gt; (t&lt;<span class=\"number\">.5</span> ? <span class=\"number\">4</span>*t*t*t : (t-<span class=\"number\">1</span>)*(<span class=\"number\">2</span>*t-<span class=\"number\">2</span>)*(<span class=\"number\">2</span>*t-<span class=\"number\">2</span>)+<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n\n<p>æœ‰äº†ç¼“åŠ¨å‡½æ•°åï¼Œä½¿ç”¨<code>requestAnimationFrame</code>å³å¯é«˜æ•ˆç‡åœ°ç»˜åˆ¶JSåŠ¨ç”»ã€‚è¿™é‡Œå°è£…äº†ä¸€ä¸ª<code>animate</code>å‡½æ•°ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"title function_\">animate</span> = (<span class=\"params\">obj, prop, end, time, ease</span>) =&gt; &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!obj || !obj[prop] || time &lt; <span class=\"number\">100</span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> start = obj[prop],</span><br><span class=\"line\">      k = end - start,</span><br><span class=\"line\">      timer = <span class=\"literal\">null</span>,</span><br><span class=\"line\">      tick = <span class=\"function\"><span class=\"params\">timestamp</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (timer === <span class=\"literal\">null</span>) &#123;</span><br><span class=\"line\">          timer = timestamp;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> progress = timestamp - timer;</span><br><span class=\"line\">        obj[prop] = start + <span class=\"title function_\">ease</span>(progress / time) * k;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (progress &lt; time) &#123;</span><br><span class=\"line\">          <span class=\"title function_\">requestAnimationFrame</span>(tick);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"title function_\">requestAnimationFrame</span>(tick);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>åé¢ç›´æ¥ä½¿ç”¨<code>animate(document.body, &quot;scrollTop&quot;, 0, 1000, easeInOutCubic)</code>å°±å¯ä»¥åœ†æ»‘åœ°ä¸Šç§»äº†ã€‚</p>\n<p><strong>ç§»åŠ¨ç«¯çš„ä¼˜åŒ–</strong></p>\n<ul>\n<li>ä½¿ç”¨åª’ä½“æŸ¥è¯¢ï¼Œåœ¨å±å¹•å®½åº¦æ›´æ”¹æ—¶ï¼Œéšè—ä¸€äº›å…ƒç´ </li>\n<li>åœ¨UAä¸ºç§»åŠ¨ç«¯è®¾å¤‡æ—¶ï¼Œç»™å‡ºæé†’</li>\n</ul>\n<p><strong>loadingæ ·å¼</strong></p>\n<p>åœ¨æ”¹å˜ç­›é€‰æ¡ä»¶æ—¶ï¼Œè®¾ç½®loadingæ ·å¼æå‡ç”¨æˆ·ä½“éªŒã€‚é€šè¿‡ç§¯ç´¯onloadçš„è®¡æ•°å’Œåˆå§‹åŠ è½½å›¾ç‰‡å€¼è¿›è¡Œå¯¹æ¯”ï¼Œåœ¨è¾¾åˆ°è¯¥å€¼æ—¶æ¸…é™¤é®ç½©ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ...</span></span><br><span class=\"line\"><span class=\"title function_\">loadedCount</span>(<span class=\"params\">newCount</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (newCount &gt;= <span class=\"title class_\">Math</span>.<span class=\"title function_\">min</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">lastFlag</span> + <span class=\"number\">1</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">items</span>.<span class=\"property\">length</span>)) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">console</span>.<span class=\"title function_\">log</span>(<span class=\"string\">&quot;å…¨éƒ¨åŠ è½½å®Œæˆ&quot;</span>);</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">isHidden</span> = <span class=\"literal\">true</span>;</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">// console.log(&quot;Loading...&quot;);</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// ...</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>æ‚é¡¹</strong></p>\n<ul>\n<li>å¯¼èˆªæ¡äº¤äº’ä¼˜åŒ–</li>\n<li>å¯¼èˆªæ¡éƒ¨åˆ†è®¾ç½®é˜´å½±ï¼Œæ›´æ”¹éƒ¨åˆ†å­—ä½“é¢œè‰²å’ŒèƒŒæ™¯è‰²</li>\n<li>ä¿®æ”¹è§¦å‘åˆ†ç±»æ–¹å¼ï¼Œç”±<code>click</code>æ”¹ä¸º<code>mousemove</code></li>\n<li>ä¿®æ”¹tabçš„æ ·å¼</li>\n<li>å°†vueå’Œlodashçš„jsæ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°ï¼Œé¿å…CDNå¤±æ•ˆçš„é—®é¢˜ï¼ˆä¹‹å‰å·²ç»é‡åˆ°è¿‡ä¸€æ¬¡ï¼‰ï¼Œå¢åŠ å¯é æ€§</li>\n<li>æœç´¢æ¡ä»¶ä¸åŒºåˆ†å¤§å°å†™</li>\n</ul>\n<h3 id=\"æœ¬åœ°è°ƒè¯•å›°éš¾\"><a href=\"#æœ¬åœ°è°ƒè¯•å›°éš¾\" class=\"headerlink\" title=\"æœ¬åœ°è°ƒè¯•å›°éš¾\"></a>æœ¬åœ°è°ƒè¯•å›°éš¾</h3><p>å› ä¸ºä»£ç è¾ƒå°‘ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨ä¸ç€webpackè¿™æ ·çš„å…¨å¥—è§£å†³æ–¹æ¡ˆã€‚å°å·§æ˜“ç”¨çš„gulpå°±å¤Ÿäº†ã€‚é’ˆå¯¹æˆ‘ä»¬éœ€è¦çš„ES6è½¬ç ï¼Œæ›¿æ¢minifyæ–¹æ¡ˆï¼Œæœ¬åœ°è°ƒè¯•ç­‰éœ€è¦ï¼Œéƒ½æœ‰å¯¹åº”çš„gulpæ’ä»¶è§£å†³é—®é¢˜ã€‚</p>\n<h4 id=\"gulp-babel\"><a href=\"#gulp-babel\" class=\"headerlink\" title=\"gulp-babel\"></a>gulp-babel</h4><p>ä½¿ç”¨<a href=\"https://babeljs.io/\">babel</a>æ¥è½¬ç ï¼Œ<code>gulp-babel</code>ä¾èµ–<code>babel-core@6</code>æˆ–ä»¥ä¸Šç‰ˆæœ¬ï¼ŒåŒæ—¶è®¾ç½®<code>preset</code>ä¸º<code>es2015</code>æˆ–ES7ç›¸å…³ç‰ˆæœ¬æ—¶ä¹Ÿéœ€è¦ä¸‹è½½å¯¹åº”moduleã€‚</p>\n<p>æˆ‘åªéœ€è¦es2015å³å¯ã€‚</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install --save-dev babel-core gulp-babel babel-preset-es2015</span><br></pre></td></tr></table></figure>\n\n<p>Reactå’ŒES7çš„å„é˜¶æ®µå¯ä»¥åƒä¸‹é¢è¿™æ ·é€‰æ‹©å®‰è£…</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install --save-dev babel-preset-react</span><br><span class=\"line\">$ npm install --save-dev babel-preset-stage-0</span><br><span class=\"line\">$ npm install --save-dev babel-preset-stage-1</span><br><span class=\"line\">$ npm install --save-dev babel-preset-stage-2</span><br><span class=\"line\">$ npm install --save-dev babel-preset-stage-3</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"å…¶ä»–å·¥å…·\"><a href=\"#å…¶ä»–å·¥å…·\" class=\"headerlink\" title=\"å…¶ä»–å·¥å…·\"></a>å…¶ä»–å·¥å…·</h4><ul>\n<li>**<a href=\"https://www.npmjs.com/package/gulp-uglify\">gulp-uglify</a>**ï¼Œå‹ç¼©ä»£ç </li>\n<li><strong>gulp-rename</strong>ï¼Œä¸ºå‹ç¼©å‡ºçš„jsé‡å‘½å</li>\n<li>**<a href=\"https://www.npmjs.com/package/gulp-webserver\">gulp-webserver</a>**ï¼Œå¼€å¯æœ¬åœ°æœåŠ¡ï¼Œæ–¹ä¾¿æœ¬åœ°è°ƒè¯•</li>\n</ul>\n<p>ä¸Šé¢è¿™äº›æ’ä»¶æŒ‰ç…§æ–‡æ¡£æ“ä½œå³å¯ï¼Œå‘æ¯”è¾ƒå°‘ï¼Œä½¿ç”¨webserveræ—¶çš„<code>gulp.src()</code>å…¥å‚é€šå¸¸ä¸º<code>./</code>ï¼ŒæŒ‡ä»¥å½“å‰ç›®å½•ä¸ºæœåŠ¡å™¨æ ¹ç›®å½•ã€‚</p>\n<p>æœ€åè¿˜éœ€è¦åŠ ä¸€ä¸ªwatchï¼Œæ–¹ä¾¿åœ¨è°ƒè¯•æ—¶çš„ä¿®æ”¹èƒ½åŒæ­¥è½¬ç å‹ç¼©ã€‚åƒä¸‹é¢è¿™æ ·</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;watch&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  gulp.<span class=\"title function_\">watch</span>(<span class=\"string\">&#x27;assets/src/*.js&#x27;</span>, [<span class=\"string\">&#x27;js&#x27;</span>]);</span><br><span class=\"line\">  gulp.<span class=\"title function_\">watch</span>(<span class=\"string\">&#x27;assets/src/*.css&#x27;</span>, [<span class=\"string\">&#x27;css&#x27;</span>]);</span><br><span class=\"line\">  gulp.<span class=\"title function_\">watch</span>(<span class=\"string\">&#x27;assets/src/*.json&#x27;</span>, [<span class=\"string\">&#x27;json&#x27;</span>]);</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n\n<p>æœ€åæ•´ä¸ª<code>gulpfile.js</code>æ˜¯ä¸‹é¢çš„æ ·å­</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> gulp = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp&#x27;</span>),</span><br><span class=\"line\">    babel = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-babel&#x27;</span>),</span><br><span class=\"line\">    uglify = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-uglify&#x27;</span>),</span><br><span class=\"line\">    rename = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-rename&#x27;</span>),</span><br><span class=\"line\">    cleanCSS = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-clean-css&#x27;</span>),</span><br><span class=\"line\">    jsonminify = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-jsonminify&#x27;</span>),</span><br><span class=\"line\">    webserver = <span class=\"built_in\">require</span>(<span class=\"string\">&#x27;gulp-webserver&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;js&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;assets/src/*.js&#x27;</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">babel</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">presets</span>: [<span class=\"string\">&#x27;es2015&#x27;</span>]</span><br><span class=\"line\">    &#125;))</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">uglify</span>())</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">rename</span>(&#123; <span class=\"attr\">suffix</span>: <span class=\"string\">&#x27;.min&#x27;</span> &#125;))</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;dist&#x27;</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;css&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>([<span class=\"string\">&#x27;assets/src/*.css&#x27;</span>])</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">cleanCSS</span>(&#123;<span class=\"attr\">compatibility</span>: <span class=\"string\">&#x27;ie8&#x27;</span>&#125;))</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;dist&#x27;</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;json&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;assets/src/meta.json&#x27;</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">jsonminify</span>())</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(gulp.<span class=\"title function_\">dest</span>(<span class=\"string\">&#x27;dist&#x27;</span>))</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;webserver&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  gulp.<span class=\"title function_\">src</span>(<span class=\"string\">&#x27;./&#x27;</span>)</span><br><span class=\"line\">    .<span class=\"title function_\">pipe</span>(<span class=\"title function_\">webserver</span>(&#123;</span><br><span class=\"line\">      <span class=\"attr\">livereload</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"attr\">directoryListing</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">      <span class=\"attr\">open</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">    &#125;));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;watch&#x27;</span>, <span class=\"keyword\">function</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  gulp.<span class=\"title function_\">watch</span>(<span class=\"string\">&#x27;assets/src/*.js&#x27;</span>, [<span class=\"string\">&#x27;js&#x27;</span>]);</span><br><span class=\"line\">  gulp.<span class=\"title function_\">watch</span>(<span class=\"string\">&#x27;assets/src/*.css&#x27;</span>, [<span class=\"string\">&#x27;css&#x27;</span>]);</span><br><span class=\"line\">  gulp.<span class=\"title function_\">watch</span>(<span class=\"string\">&#x27;assets/src/*.json&#x27;</span>, [<span class=\"string\">&#x27;json&#x27;</span>]);</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&#x27;dev&#x27;</span>, [<span class=\"string\">&#x27;default&#x27;</span>, <span class=\"string\">&#x27;webserver&#x27;</span>, <span class=\"string\">&#x27;watch&#x27;</span>]);</span><br><span class=\"line\">gulp.<span class=\"title function_\">task</span>(<span class=\"string\">&quot;default&quot;</span>, [<span class=\"string\">&#x27;json&#x27;</span>, <span class=\"string\">&#x27;css&#x27;</span>, <span class=\"string\">&#x27;js&#x27;</span>]);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"ä»£ç ä¼˜åŒ–\"><a href=\"#ä»£ç ä¼˜åŒ–\" class=\"headerlink\" title=\"ä»£ç ä¼˜åŒ–\"></a>ä»£ç ä¼˜åŒ–</h3><p>ä»ç•¥ã€‚HTMLå’ŒCSSéƒ¨åˆ†å‚ç…§ä»¥å¾€å†™çš„<a href=\"https://shenlvmeng.github.io/blog/2017/06/23/HTML-CSS-code-style-guide/\">å»ºè®®</a>å³å¯ã€‚é™¤æ­¤ä»¥å¤–ï¼Œä¼˜åŒ–äº†ä¸‹é¢çš„éƒ¨åˆ†ï¼š</p>\n<ul>\n<li>åˆ é™¤äº†ä¸ºå…¼å®¹ç§»åŠ¨ç«¯é¢å¤–ä½¿ç”¨çš„touchendäº‹ä»¶ï¼Œå¢åŠ viewportçš„metaæ ‡ç­¾ï¼Œæ¶ˆé™¤ç§»åŠ¨ç«¯chromeæµè§ˆå™¨ç‚¹å‡»300mså»¶æ—¶æƒ…å†µ</li>\n<li>ç”±äºå¼•å…¥äº†babelï¼Œåˆ é™¤äº†å…¼å®¹ES6è¯­æ³•çš„è‡ªå·±å†™çš„polyfilléƒ¨åˆ†</li>\n<li>ä½¿ç”¨<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\">fetch API</a>è¯·æ±‚json</li>\n<li>ä¼˜åŒ–å¯¼èˆªæ¡ç‚¹å‡»äº‹ä»¶å¤„ç†ç›¸å…³çš„ä»£ç </li>\n<li>å‡å°‘å›¾ç‰‡æ•°ç›®å’Œjsonä½“ç§¯</li>\n</ul>\n<h3 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h3><ul>\n<li><a href=\"https://segmentfault.com/a/1190000004394726\">ä½¿ç”¨gulp è¿›è¡ŒES6å¼€å‘</a></li>\n<li><a href=\"http://blog.csdn.net/seven0404/article/details/51880162\">node.jsåˆ©ç”¨gulp å¯åŠ¨webServeræœåŠ¡</a></li>\n<li><a href=\"https://stackoverflow.com/questions/2434602/css-setting-width-height-as-percentage-minus-pixels\">CSS: Setting width&#x2F;height as Percentage minus pixels</a></li>\n<li><a href=\"http://easings.net/zh-cn\">ç¼“åŠ¨å‡½æ•°é€ŸæŸ¥è¡¨</a></li>\n<li><a href=\"https://gist.github.com/gre/1650294\">Simple Easing Functions in Javascript</a></li>\n<li><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame\">window.requestAnimationFrame | MDN</a></li>\n<li><a href=\"https://dribbble.com/\">dribbble</a></li>\n<li><a href=\"https://codepen.io/sdthornton/pen/wBZdXq\">Material Design Box Shadows</a></li>\n<li><a href=\"http://tobiasahlin.com/spinkit/\">SpinKit | Simple CSS Spinners</a></li>\n<li><a href=\"https://www.zhihu.com/question/21667151\">å›½å†…æœ‰ä»€ä¹ˆæ–¹ä¾¿çš„å›¾åºŠï¼Ÿ</a></li>\n</ul>\n",
            "tags": [
                "è„šæ‰‹æ¶",
                "æŠ€æ”¹",
                "Vue",
                "gulp",
                "ç€‘å¸ƒæµ",
                "ç”µå½±"
            ]
        },
        {
            "id": "http://shenlvmeng.github.com/blog/2017/04/05/vue-reactive-sourcecode/",
            "url": "http://shenlvmeng.github.com/blog/2017/04/05/vue-reactive-sourcecode/",
            "title": "Vue2.0çš„å“åº”å¼è®¾è®¡åŸç†",
            "date_published": "2017-04-05T07:12:20.000Z",
            "content_html": "<h3 id=\"å‰è¨€\"><a href=\"#å‰è¨€\" class=\"headerlink\" title=\"å‰è¨€\"></a>å‰è¨€</h3><p>ä¸Šå‘¨æŠ½ç©ºçœ‹äº†çœ‹Vueçš„æºç ï¼Œè®¾è®¡çš„ç²¾å·§è®©æˆ‘è¿™ä¸ªé¶¸ä¸€æ—¶å¸æ”¶ä¸æ¥ã€‚å¦‚æœæƒ³å†™ç¯‡æ—¢å¤§åˆå…¨çš„æ–‡ç« ï¼Œä¸€åŠ³æ°¸é€¸åœ°ä»‹ç»Vue2.0çš„æºç ï¼Œä»¥æˆ‘çš„æ°´å¹³æ˜¾ç„¶æ˜¯åšä¸åˆ°çš„ã€‚äºæ˜¯å°±åªå–ä¸€ç“¢é¥®åœ°ï¼Œç®€å•è®°å½•ä¸‹Vue2.0åœ¨å“åº”å¼åŸç†ä¸Šçš„è®¾è®¡ã€‚å…¶ä»–çš„éƒ¨åˆ†ç­‰æˆ‘åŠŸåŠ›æ·±åšäº†ï¼ˆå…¶å®å°±æ˜¯æ‡’ï¼‰å†åšæ€»ç»“å§ã€‚</p>\n<h3 id=\"åŸºç¡€\"><a href=\"#åŸºç¡€\" class=\"headerlink\" title=\"åŸºç¡€\"></a>åŸºç¡€</h3><p>è¿™ä¸€éƒ¨åˆ†æ˜¯Vueå“åº”å¼åŸç†çš„åŸºç¡€ã€‚åŒ…å«Observerç±»ï¼ŒWatcherç±»ï¼ŒDepç±»ï¼Œäº‹ä»¶è®¢é˜…æ¨¡å¼ï¼Œè¿˜æœ‰æœ€å…³é”®çš„<code>Object.defineProperty</code>æ–¹æ³•ã€‚</p>\n<h4 id=\"Object-defineProperty\"><a href=\"#Object-defineProperty\" class=\"headerlink\" title=\"Object.defineProperty\"></a>Object.defineProperty</h4><p>Vueå®ç°æ•°æ®ç»‘å®šçš„æ–¹å¼å’Œå…¶ä»–çš„MVVMåŒä¾ªä¸åŒï¼ŒReactå’Œbackboneï¼ˆè¿™è´§ä¸æ˜¯MVVMï¼‰é‡‡ç”¨çš„æ˜¯å…¸å‹çš„å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼ŒAngularåˆ™é‡‡ç”¨çš„è„å€¼æ£€æµ‹ã€‚</p>\n<p>Vueä½¿ç”¨äº†æ›´ä¸ºéšè”½å’Œmagicalçš„<code>Object.defineProperty</code>è®¾ç½®å¯¹è±¡è®¿é—®å™¨å±æ€§ï¼ˆè¿™ä¹Ÿæ„å‘³ç€Vueåªæ”¯æŒåˆ°IE9+ï¼‰ã€‚</p>\n<blockquote><p>æŠŠä¸€ä¸ªæ™®é€š Javascript å¯¹è±¡ä¼ ç»™ Vue å®ä¾‹çš„ data é€‰é¡¹ï¼ŒVue å°†éå†æ­¤å¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶ä½¿ç”¨ Object.defineProperty æŠŠè¿™äº›å±æ€§å…¨éƒ¨è½¬ä¸º getter&#x2F;setterã€‚Object.defineProperty æ˜¯ä»… ES5 æ”¯æŒï¼Œä¸”æ— æ³• shim çš„ç‰¹æ€§ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ Vue ä¸æ”¯æŒ IE8 ä»¥åŠæ›´ä½ç‰ˆæœ¬æµè§ˆå™¨çš„åŸå› ã€‚</p>\n</blockquote>\n\n<p><code>Object.defineProperty()</code>å¯ä»¥å®šä¹‰å¯¹è±¡çš„è®¿é—®å™¨å±æ€§ï¼Œå…³äºè®¿é—®å™¨å±æ€§çš„æ›´å¤šä»‹ç»å¯ä»¥çœ‹<a href=\"https://shenlvmeng.github.io/blog/2017/03/13/js-object/\">è¿™é‡Œ</a>ã€‚å…¶ä¸­<code>get</code>å’Œ<code>set</code>æ–¹æ³•åˆ†åˆ«ç”¨æ¥æŒ‡å®šå±æ€§çš„getterå’Œsetterã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> person = &#123;</span><br><span class=\"line\">  <span class=\"attr\">_name</span>: <span class=\"string\">&#x27;&#x27;</span>,  <span class=\"comment\">//`_`è¡¨ç¤ºåªèƒ½é€šè¿‡æ–¹æ³•è®¿é—®</span></span><br><span class=\"line\">  <span class=\"attr\">nickname</span>: <span class=\"string\">&#x27;é…±&#x27;</span></span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"><span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>(person, <span class=\"string\">&#x27;name&#x27;</span>, <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">  <span class=\"attr\">get</span>: <span class=\"keyword\">function</span> (<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"variable language_\">this</span>.<span class=\"property\">_name</span>;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  <span class=\"attr\">set</span>: <span class=\"keyword\">function</span> (<span class=\"params\">newValue</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">nickname</span> = newValue + <span class=\"string\">&#x27;é…±&#x27;</span>;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">_name</span> = newValue;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n\n<p>é€šè¿‡getterå’Œsetterå®ç°æ•°æ®åŠ«æŒæ˜¯Vueæ•°æ®ç»‘å®šçš„åŸºç¡€ã€‚</p>\n<h4 id=\"å‘å¸ƒè®¢é˜…\"><a href=\"#å‘å¸ƒè®¢é˜…\" class=\"headerlink\" title=\"å‘å¸ƒè®¢é˜…\"></a>å‘å¸ƒè®¢é˜…</h4><p><a href=\"https://zh.wikipedia.org/wiki/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F\">å‘å¸ƒè®¢é˜…</a>æ˜¯JavaScriptä¸­äº‹ä»¶æœºåˆ¶çš„å®ç°æ–¹å¼ï¼Œä¹Ÿæ˜¯<a href=\"https://shenlvmeng.github.io/blog/2017/03/29/javascript-async-programming-1/\">JavaScriptå¼‚æ­¥ç¼–ç¨‹</a>çš„å®ç°æ–¹å¼ä¹‹ä¸€ã€‚</p>\n<p>å‘å¸ƒè®¢é˜…æ¨¡å¼ä¸­çš„è§’è‰²ä¸»è¦æœ‰å‘å¸ƒè€…ã€äº‹ä»¶å¯¹è±¡ã€è®¢é˜…è€…ã€‚å‘å¸ƒè€…å’Œäº‹ä»¶å¯¹è±¡æ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œäº‹ä»¶å¯¹è±¡å’Œè®¢é˜…è€…åˆæ˜¯ä¸€å¯¹å¤šçš„å…³ç³»ã€‚å½“å‘å¸ƒè€…çš„çŠ¶æ€æ”¹å˜è§¦å‘äº‹ä»¶å¯¹è±¡æ—¶ï¼Œç›¸å…³çš„è®¢é˜…è€…å°±ä¼šæ”¶åˆ°é€šçŸ¥ã€‚å®ç°èµ·æ¥å°±åƒä¸‹é¢è¿™æ ·ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> <span class=\"title class_\">EventUtil</span> = &#123;</span><br><span class=\"line\">  <span class=\"comment\">// å…¨å±€äº‹ä»¶ç®¡ç†</span></span><br><span class=\"line\">  <span class=\"keyword\">var</span> events = &#123;&#125;,</span><br><span class=\"line\">  <span class=\"comment\">// æ³¨å†Œäº‹ä»¶</span></span><br><span class=\"line\">    on = <span class=\"keyword\">function</span> (<span class=\"params\">type, handler</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (events[type]) &#123;</span><br><span class=\"line\">        events[type].<span class=\"title function_\">push</span>(handler);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        events[type] = [handler];</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// è§¦å‘äº‹ä»¶</span></span><br><span class=\"line\">    emit = <span class=\"keyword\">function</span> (<span class=\"params\">type</span>) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (!events[type]) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">var</span> i = <span class=\"number\">0</span>, len = events[type].<span class=\"property\">length</span>; i &lt; len; i++) &#123;</span><br><span class=\"line\">          events[type][i];</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>Vueå®ç°è§†å›¾è‡ªåŠ¨æ›´æ–°çš„åŸç†ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå½“ç„¶ç»†èŠ‚ä¸Šå°±å¤æ‚å¤šäº†ã€‚</p>\n<h4 id=\"Observerï¼ŒWatcherï¼ŒDep\"><a href=\"#Observerï¼ŒWatcherï¼ŒDep\" class=\"headerlink\" title=\"Observerï¼ŒWatcherï¼ŒDep\"></a>Observerï¼ŒWatcherï¼ŒDep</h4><p>è¿™ä¸‰ä¸ªæ˜¯ç›¸è¾…ç›¸æˆå®ç°Vueæ•°æ®ç»‘å®šçš„ç»„ä»¶ã€‚</p>\n<h5 id=\"Observer\"><a href=\"#Observer\" class=\"headerlink\" title=\"Observer\"></a>Observer</h5><p>Vueåœ¨ç»„ä»¶(Component)åˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œä¼šå°†æ•°æ®å¯¹è±¡å°è£…ä¸ºObserverå¯¹è±¡ï¼Œä¾¿äºç›‘å¬æ•°æ®çš„æ”¹å˜ï¼Œå¹¶ç»‘å®šä¾èµ–åœ¨ä¸Šé¢ã€‚æˆ‘ä»¬æ¥çœ‹ä¸‹<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/observer/index.js#L39-L53\">æºç </a>ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">constructor</span> (<span class=\"attr\">value</span>: any) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = value</span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">dep</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">Dep</span>()  <span class=\"comment\">//ä¸€ä¸ª Depå¯¹è±¡å®ä¾‹ï¼ŒWatcher å’Œ Observer ä¹‹é—´çš„çº½å¸¦</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">vmCount</span> = <span class=\"number\">0</span></span><br><span class=\"line\">  <span class=\"title function_\">def</span>(value, <span class=\"string\">&#x27;__ob__&#x27;</span>, <span class=\"variable language_\">this</span>)  <span class=\"comment\">//æŠŠè‡ªèº« this æ·»åŠ åˆ° value çš„ __ob__ å±æ€§ä¸Š</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"title class_\">Array</span>.<span class=\"title function_\">isArray</span>(value)) &#123; <span class=\"comment\">//å¯¹ value çš„ç±»å‹è¿›è¡Œåˆ¤æ–­</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> augment = hasProto</span><br><span class=\"line\">      ? protoAugment</span><br><span class=\"line\">      : copyAugment</span><br><span class=\"line\">    <span class=\"title function_\">augment</span>(value, arrayMethods, arrayKeys) <span class=\"comment\">// æ•°ç»„å¢å¼ºæ–¹æ³•</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">observeArray</span>(value) <span class=\"comment\">//å¦‚æœæ˜¯æ•°ç»„åˆ™è§‚å¯Ÿæ•°ç»„</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">walk</span>(value) <span class=\"comment\">//å¦åˆ™è§‚å¯Ÿå•ä¸ªå…ƒç´ ã€‚</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Observerå¯¹è±¡å‚¨å­˜åœ¨ <strong>ob</strong> è¿™ä¸ªå±æ€§ï¼Œè¿™ä¸ªå±æ€§ä¿å­˜äº† Observer å¯¹è±¡è‡ªå·±æœ¬èº«ã€‚å¯¹è±¡åœ¨è½¬åŒ–ä¸º Observer å¯¹è±¡çš„è¿‡ç¨‹ä¸­æ˜¯ä¸€ä¸ªé€’å½’çš„è¿‡ç¨‹ï¼Œå¯¹è±¡çš„å­å…ƒç´ å¦‚æœæ˜¯å¯¹è±¡æˆ–æ•°ç»„çš„è¯ï¼Œä¹Ÿä¼šè½¬åŒ–ä¸º Observer å¯¹è±¡ã€‚</p>\n<p>ç”±äºJavaScriptæœ¬èº«çš„åŸå› ï¼ŒVueä¸èƒ½ç›‘æµ‹æ•°ç»„çš„å˜åŒ–ï¼ŒVueé‡‡ç”¨çš„æŠ˜ä¸­æ–¹æ³•æ˜¯å¢å¼ºæ•°ç»„çš„åŸç”Ÿæ–¹æ³•<code>push</code>, <code>pop</code>, <code>shift</code>, <code>unshift</code>, <code>splice</code>, <code>sort</code>, <code>reverse</code>ï¼Œä»¥åŠå»ºè®®ä½¿ç”¨è€…é€šè¿‡Vue.setçš„æ–¹å¼æ˜¾ç¤ºè°ƒç”¨ã€‚é€šè¿‡å…¶ä»–æ–¹å¼å¯¹æ•°ç»„è¿›è¡Œçš„ä¿®æ”¹å°†æ— æ³•è¢«ç›‘å¬åˆ°ã€‚</p>\n<h5 id=\"Watcher\"><a href=\"#Watcher\" class=\"headerlink\" title=\"Watcher\"></a>Watcher</h5><p>Vueä¸­ï¼ŒWatcherå’Œæ¨¡æ¿æ¸²æŸ“ç´§å¯†ç›¸è¿ï¼Œå®ƒå°†Observerå‘ç”Ÿçš„æ”¹å˜åæ˜ åˆ°æ¨¡æ¿å†…å®¹ä¸Šã€‚å®ƒå…³é”®éƒ¨åˆ†çš„<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/observer/watcher.js#L39-L85\">æºç </a>æ˜¯è¿™æ ·ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"title function_\">constructor</span> (</span><br><span class=\"line\">  <span class=\"attr\">vm</span>: <span class=\"title class_\">Component</span>,</span><br><span class=\"line\">  <span class=\"attr\">expOrFn</span>: string | <span class=\"title class_\">Function</span>,</span><br><span class=\"line\">  <span class=\"attr\">cb</span>: <span class=\"title class_\">Function</span>,</span><br><span class=\"line\">  options?: <span class=\"title class_\">Object</span></span><br><span class=\"line\">) &#123;</span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">vm</span> = vm</span><br><span class=\"line\">  vm.<span class=\"property\">_watchers</span>.<span class=\"title function_\">push</span>(<span class=\"variable language_\">this</span>)<span class=\"comment\">// å°†å½“å‰ Watcher ç±»æ¨é€åˆ°å¯¹åº”çš„ Vue å®ä¾‹ä¸­</span></span><br><span class=\"line\">  ......</span><br><span class=\"line\">  <span class=\"comment\">// parse expression for getter</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> expOrFn === <span class=\"string\">&#x27;function&#x27;</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// å¦‚æœæ˜¯å‡½æ•°ï¼Œç›¸å½“äºæŒ‡å®šäº†å½“å‰è®¢é˜…è€…è·å–æ•°æ®çš„æ–¹æ³•ï¼Œæ¯æ¬¡è®¢é˜…è€…é€šè¿‡è¿™ä¸ªæ–¹æ³•è·å–æ•°æ®ç„¶åä¸ä¹‹å‰çš„å€¼è¿›è¡Œå¯¹æ¯”</span></span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">getter</span> = expOrFn</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">getter</span> = <span class=\"title function_\">parsePath</span>(expOrFn)<span class=\"comment\">// å¦åˆ™çš„è¯å°†è¡¨è¾¾å¼è§£æä¸ºå¯æ‰§è¡Œçš„å‡½æ•°</span></span><br><span class=\"line\">    ......</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"property\">value</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">lazy</span></span><br><span class=\"line\">    ? <span class=\"literal\">undefined</span></span><br><span class=\"line\">    : <span class=\"variable language_\">this</span>.<span class=\"title function_\">get</span>()   <span class=\"comment\">//å¦‚æœ lazy ä¸ä¸º trueï¼Œåˆ™æ‰§è¡Œ get å‡½æ•°è¿›è¡Œä¾èµ–æ”¶é›†</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å…¶ä¸­è¾“å…¥å‚æ•°<code>vm</code>æ˜¯ç›‘å¬çš„ç»„ä»¶ï¼Œ<code>expOrFn</code>æœ€ç»ˆå°†äº¤ç»™<code>getter</code>å±æ€§ï¼Œ<code>cb</code>æ˜¯æ›´æ–°æ—¶çš„å›è°ƒå‡½æ•°ã€‚æœ€åä¸€å¥ä¸­çš„<code>this.get()</code>å®Œæˆäº†ä¾èµ–çš„æ”¶é›†å·¥ä½œã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Evaluate the getter, and re-collect dependencies.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\">get () &#123;</span><br><span class=\"line\">  <span class=\"title function_\">pushTarget</span>(<span class=\"variable language_\">this</span>)  <span class=\"comment\">// è®¾ç½®å…¨å±€å˜é‡ Dep.targetï¼Œå°† Watcher ä¿å­˜åœ¨è¿™ä¸ªå…¨å±€å˜é‡ä¸­</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> value = <span class=\"variable language_\">this</span>.<span class=\"property\">getter</span>.<span class=\"title function_\">call</span>(<span class=\"variable language_\">this</span>.<span class=\"property\">vm</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">vm</span>) <span class=\"comment\">// è°ƒç”¨ getter å‡½æ•°ï¼Œè¿›å…¥ get æ–¹æ³•è¿›è¡Œä¾èµ–æ”¶é›†æ“ä½œ</span></span><br><span class=\"line\">  <span class=\"comment\">// &quot;touch&quot; every property so they are all tracked as</span></span><br><span class=\"line\">  <span class=\"comment\">// dependencies for deep watching</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">deep</span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">traverse</span>(value)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"title function_\">popTarget</span>()  <span class=\"comment\">// å°†å…¨å±€å˜é‡ Dep.target ç½®ä¸º null</span></span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"title function_\">cleanupDeps</span>()</span><br><span class=\"line\">  <span class=\"keyword\">return</span> value</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ç¬¬ä¸€å¥çš„<code>pushTarget(this)</code>è®¾ç½®äº†<code>Dep.target</code>ï¼Œgetterå‡½æ•°æ­£æ˜¯é€šè¿‡<code>Dep.target</code>æ˜¯å¦ä¸º<code>null</code>ï¼Œåˆ¤æ–­å½“å‰å¤„äºä¾èµ–æ”¶é›†é˜¶æ®µè¿˜æ˜¯æ™®é€šæ•°æ®è¯»å–ã€‚åé¢çš„ä¸¤å¥å»<code>touch``expOrFn</code>æ¶‰åŠåˆ°çš„æ¯ä¸ªæ•°æ®é¡¹ã€‚ä»è€Œå°†<code>expOrFn</code>çš„ä¾èµ–æ”¶é›†èµ·æ¥ã€‚æœ€åå°†depä¸­çš„å†…å®¹æ¸…ç©ºï¼Œä¸ºä¸‹æ¬¡æ”¶é›†ä¾èµ–åšå‡†å¤‡ã€‚</p>\n<h5 id=\"Dep\"><a href=\"#Dep\" class=\"headerlink\" title=\"Dep\"></a>Dep</h5><p>Depç±»ç”¨äºè¿æ¥Watcherç±»å’ŒObserverç±»ï¼Œæ¯ä¸ªObserverå¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ªDepå®ä¾‹ï¼Œå…¶ä¸­å­˜å‚¨äº†è®¢é˜…è€…Watcherã€‚<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/observer/dep.js#L17-L20\">æºç </a>å¦‚ä¸‹: </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//...</span></span><br><span class=\"line\">  <span class=\"title function_\">constructor</span> () &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">id</span> = uid++</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">subs</span> = [] <span class=\"comment\">//å­˜å‚¨ Watcher å®ä¾‹çš„æ•°ç»„</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"><span class=\"comment\">//...</span></span><br><span class=\"line\">  depend () &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"title class_\">Dep</span>.<span class=\"property\">target</span>) &#123;</span><br><span class=\"line\">      <span class=\"title class_\">Dep</span>.<span class=\"property\">target</span>.<span class=\"title function_\">addDep</span>(<span class=\"variable language_\">this</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  notify () &#123;</span><br><span class=\"line\">    <span class=\"comment\">// stablize the subscriber list first</span></span><br><span class=\"line\">    <span class=\"keyword\">const</span> subs = <span class=\"variable language_\">this</span>.<span class=\"property\">subs</span>.<span class=\"title function_\">slice</span>()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>, l = subs.<span class=\"property\">length</span>; i &lt; l; i++) &#123;   <span class=\"comment\">//éå† Watcher åˆ—è¡¨ï¼Œè°ƒç”¨ update æ–¹æ³•è¿›è¡Œæ›´æ–°æ“ä½œ</span></span><br><span class=\"line\">      subs[i].<span class=\"title function_\">update</span>()</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure>\n\n<p>Depç±»æ¯”è¾ƒç®€å•ï¼Œä¸»è¦æ˜¯ä¸€ä¸ªå­˜å‚¨Watcherå®ä¾‹çš„æ•°ç»„<code>this.subs</code>ã€‚<code>depend()</code>æ–¹æ³•ç”¨äºå‘Watcherå¯¹è±¡ä¸­æ·»åŠ è¿™ä¸ªDepã€‚<code>notify()</code>æ–¹æ³•å°†éå†Watcheråˆ—è¡¨ï¼Œé€šçŸ¥è®¢é˜…è€…æ›´æ–°è§†å›¾ã€‚</p>\n<h3 id=\"å®ç°\"><a href=\"#å®ç°\" class=\"headerlink\" title=\"å®ç°\"></a>å®ç°</h3><p>ä¸‹é¢ä»æºç è§’åº¦ä¸Šçœ‹çœ‹Vueå®ç°æ•°æ®ç»‘å®šçš„è®¾è®¡ã€‚</p>\n<h4 id=\"ç›®å½•ç»“æ„\"><a href=\"#ç›®å½•ç»“æ„\" class=\"headerlink\" title=\"ç›®å½•ç»“æ„\"></a>ç›®å½•ç»“æ„</h4><p>Vueæ ¸å¿ƒéƒ¨åˆ†çš„ä»£ç æ”¾åœ¨<code>src</code>ç›®å½•ã€‚è·¯å¾„ä¸‹è¿˜æœ‰ä¸‹é¢è¿™äº›å­æ–‡ä»¶å¤¹ï¼š</p>\n<ul>\n<li><code>entries</code> å…¥å£æ–‡ä»¶ï¼Œæ ¹æ®ç¼–è¯‘ç¯å¢ƒçš„ä¸åŒï¼Œæ›´æ”¹ä¸€äº›é…ç½®</li>\n<li><code>compiler</code> ç¼–è¯‘æ¨¡æ¿ï¼Œ<code>render</code>å‡½æ•°çš„å®ç°</li>\n<li><code>core</code> å…³é”®éƒ¨åˆ†ä»£ç </li>\n<li><code>core/observer</code> å“åº”å¼è®¾è®¡ä¸­çš„Observerå¯¹è±¡å®ç°</li>\n<li><code>core/vdom</code> è™šæ‹ŸDOMï¼Œdiffç®—æ³•ï¼Œpatchå‡½æ•°å®ç°</li>\n<li><code>core/instance</code> ç»„ä»¶å®ä¾‹ç”Ÿå‘½å‘¨æœŸå®ç°ï¼Œç»„ä»¶åˆå§‹åŒ–å…¥å£</li>\n<li><code>core/components</code> å…¨å±€ç»„ä»¶</li>\n<li><code>core/global-api</code> å…¨å±€API</li>\n<li><code>server</code> æœåŠ¡ç«¯æ¸²æŸ“</li>\n<li><code>platform</code> å¹³å°ç‰¹å®šä»£ç ï¼Œåˆ†ä¸º<code>web</code>å’Œ<code>weex</code></li>\n<li><code>sfc</code> å¤„ç†å•æ–‡ä»¶ç»„ä»¶ è§£æ.vueæ–‡ä»¶</li>\n<li><code>share</code> å·¥å…·å‡½æ•°</li>\n</ul>\n<h4 id=\"ç”Ÿå‘½å‘¨æœŸ\"><a href=\"#ç”Ÿå‘½å‘¨æœŸ\" class=\"headerlink\" title=\"ç”Ÿå‘½å‘¨æœŸ\"></a>ç”Ÿå‘½å‘¨æœŸ</h4><p>å…³äºVueçš„<a href=\"https://vuejs.org/v2/guide/instance.html#Lifecycle-Diagram\">ç”Ÿå‘½å‘¨æœŸ</a>ï¼Œè¿™é‡Œå‡è®¾ä½ å·²ç»ç†Ÿæ‚‰ï¼Œå°±ä¸åšä»‹ç»äº†ã€‚äº†è§£å®ƒä¹Ÿå°†å¸®åŠ©ä½ äº†è§£Vueçš„å·¥ä½œæµç¨‹ã€‚</p>\n<p>æºç çš„å…¥å£ä»ä¸‹é¢ä¸€è¡Œ<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/instance/index.js#L8-L14\">ä»£ç </a>å¼€å§‹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">Vue</span> (options) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (process.<span class=\"property\">env</span>.<span class=\"property\">NODE_ENV</span> !== <span class=\"string\">&#x27;production&#x27;</span> &amp;&amp;</span><br><span class=\"line\">    !(<span class=\"variable language_\">this</span> <span class=\"keyword\">instanceof</span> <span class=\"title class_\">Vue</span>)) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">warn</span>(<span class=\"string\">&#x27;Vue is a constructor and should be called with the `new` keyword&#x27;</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"variable language_\">this</span>.<span class=\"title function_\">_init</span>(options) <span class=\"comment\">//å¼€å§‹åˆå§‹åŒ–æ­¥éª¤</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"title function_\">initMixin</span>(<span class=\"title class_\">Vue</span>) <span class=\"comment\">//æ’å…¥åˆå§‹åŒ–ä»£ç </span></span><br><span class=\"line\"><span class=\"title function_\">stateMixin</span>(<span class=\"title class_\">Vue</span>) <span class=\"comment\">//æ’å…¥æ•°æ®ç»‘å®šä»£ç </span></span><br><span class=\"line\"><span class=\"title function_\">eventsMixin</span>(<span class=\"title class_\">Vue</span>) <span class=\"comment\">//æ’å…¥äº‹ä»¶ç›¸å…³ä»£ç </span></span><br><span class=\"line\"><span class=\"title function_\">lifecycleMixin</span>(<span class=\"title class_\">Vue</span>) <span class=\"comment\">//æ’å…¥ç”Ÿå‘½å‘¨æœŸä»£ç </span></span><br><span class=\"line\"><span class=\"title function_\">renderMixin</span>(<span class=\"title class_\">Vue</span>) <span class=\"comment\">//æ’å…¥æ¨¡æ¿æ¸²æŸ“ä»£ç </span></span><br></pre></td></tr></table></figure>\n\n<p>æ–‡ä»¶ä¸º<code>src/core/instance/index.js</code>ï¼Œå…³é”®åœ¨äºæœ€åä¸€å¥ï¼Œé€šè¿‡è°ƒç”¨<code>init.js</code>ä¸­å®šä¹‰çš„<code>_init(options)</code>æ–¹æ³•åˆå§‹åŒ–Vueå®ä¾‹ã€‚è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ä¸‹é¢çš„<code>initMixin(Vue)</code>ä¸­å¯¼å…¥çš„ã€‚è¿™ç§mixinçš„æ–¹å¼ä¸åŒäºVue1.xç‰ˆæœ¬ï¼Œæ›´å…·æ¨¡å—åŒ–é€‚åˆæ‹“å±•ï¼ˆåŒæ—¶ä¹Ÿå¢åŠ äº†å¯»æ‰¾ä»£ç çš„éš¾åº¦ï¼‰ã€‚</p>\n<p>åˆå§‹åŒ–ç›¸å…³çš„ä¸»è¦<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/instance/init.js#L40-L48\">ä»£ç </a>å¦‚ä¸‹ï¼›</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">initMixin</span> (<span class=\"title class_\">Vue</span>: <span class=\"title class_\">Class</span>&lt;<span class=\"title class_\">Component</span>&gt;) &#123;</span><br><span class=\"line\">  <span class=\"title class_\">Vue</span>.<span class=\"property\"><span class=\"keyword\">prototype</span></span>.<span class=\"property\">_init</span> = <span class=\"keyword\">function</span> (<span class=\"params\">options?: <span class=\"built_in\">Object</span></span>) &#123;</span><br><span class=\"line\"><span class=\"comment\">//...</span></span><br><span class=\"line\">    <span class=\"title function_\">initLifecycle</span>(vm)   <span class=\"comment\">//vm çš„ç”Ÿå‘½å‘¨æœŸç›¸å…³å˜é‡åˆå§‹åŒ–</span></span><br><span class=\"line\">    <span class=\"title function_\">initEvents</span>(vm)    <span class=\"comment\">// vm çš„äº‹ä»¶ç›‘æ§åˆå§‹åŒ–</span></span><br><span class=\"line\">    <span class=\"title function_\">initRender</span>(vm)  <span class=\"comment\">// æ¨¡æ¿è§£æ</span></span><br><span class=\"line\">    <span class=\"title function_\">callHook</span>(vm, <span class=\"string\">&#x27;beforeCreate&#x27;</span>)</span><br><span class=\"line\">    <span class=\"title function_\">initState</span>(vm) <span class=\"comment\">//vm çš„çŠ¶æ€åˆå§‹åŒ–ï¼Œprop/data/computed/method/watch éƒ½åœ¨è¿™é‡Œå®Œæˆåˆå§‹åŒ–</span></span><br><span class=\"line\">    <span class=\"title function_\">callHook</span>(vm, <span class=\"string\">&#x27;created&#x27;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (vm.<span class=\"property\">$options</span>.<span class=\"property\">el</span>) &#123;</span><br><span class=\"line\">\t  vm.$mount(vm.<span class=\"property\">$options</span>.<span class=\"property\">el</span>)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>initLifecycle</code>ä¸»è¦æ˜¯åˆå§‹åŒ–vmå®ä¾‹ä¸Šçš„ä¸€äº›å‚æ•°ï¼›<code>initEvents</code>æ˜¯äº‹ä»¶ç›‘æ§çš„åˆå§‹åŒ–ï¼›<code>initRender</code>æ˜¯æ¨¡æ¿è§£æï¼Œ2.0çš„ç‰ˆæœ¬ä¸­è¿™ä¸€å—æœ‰å¾ˆå¤§çš„æ”¹åŠ¨ï¼Œ1.0çš„ç‰ˆæœ¬ä¸­Vueä½¿ç”¨çš„æ˜¯<code>DocumentFragment</code>æ¥è¿›è¡Œæ¨¡æ¿è§£æï¼Œè€Œ 2.0 ä¸­ä½œè€…é‡‡ç”¨çš„John Resigçš„HTML Parserå°†æ¨¡æ¿è§£ææˆå¯ç›´æ¥æ‰§è¡Œçš„<code>render</code>å‡½æ•°ã€‚<code>initState</code>æ˜¯æ•°æ®ç»‘å®šçš„ä¸»æˆ˜åœºï¼Œæˆ‘ä»¬ä¸‹ä¸€èŠ‚ä¼šè¯¦ç»†è®²åˆ°ã€‚<code>callHook</code>æ‰§è¡Œç”Ÿå‘½å‘¨æœŸçš„é’©å­å‡½æ•°ã€‚</p>\n<h4 id=\"initState\"><a href=\"#initState\" class=\"headerlink\" title=\"initState\"></a>initState</h4><p>åœ¨åˆå§‹åŒ–ä¸­ï¼Œ<code>initState</code>å‡½æ•°æ‰¿æ‹…äº†æ•°æ®ç»‘å®šä¸­çš„æœ€ä¸»è¦çš„è„æ´»ç´¯æ´»ã€‚å®ƒçš„<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/instance/state.js#L24-L36\">æºç </a>åƒä¸‹é¢è¿™æ ·:</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">initState</span> (<span class=\"attr\">vm</span>: <span class=\"title class_\">Component</span>) &#123;</span><br><span class=\"line\">  vm.<span class=\"property\">_watchers</span> = []  <span class=\"comment\">//æ–°å»ºä¸€ä¸ªè®¢é˜…è€…åˆ—è¡¨</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> opts = vm.<span class=\"property\">$options</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (opts.<span class=\"property\">props</span>) <span class=\"title function_\">initProps</span>(vm, opts.<span class=\"property\">props</span>)  <span class=\"comment\">// åˆå§‹åŒ– Propsï¼Œä¸ initData å·®ä¸å¤š</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (opts.<span class=\"property\">methods</span>) <span class=\"title function_\">initMethods</span>(vm, opts.<span class=\"property\">methods</span>)  <span class=\"comment\">// åˆå§‹åŒ– Methodsï¼ŒMethods çš„åˆå§‹åŒ–æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯ä½œç”¨åŸŸçš„é‡æ–°ç»‘å®šã€‚</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (opts.<span class=\"property\">data</span>) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">initData</span>(vm) <span class=\"comment\">// åˆå§‹åŒ– Dataï¼Œå“åº”å¼å…³é”®æ­¥</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">observe</span>(vm.<span class=\"property\">_data</span> = &#123;&#125;, <span class=\"literal\">true</span> <span class=\"comment\">/* asRootData */</span>) <span class=\"comment\">//å¦‚æœæ²¡æœ‰ dataï¼Œåˆ™è§‚å¯Ÿä¸€ä¸ªç©ºå¯¹è±¡</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (opts.<span class=\"property\">computed</span>) <span class=\"title function_\">initComputed</span>(vm, opts.<span class=\"property\">computed</span>)<span class=\"comment\">// åˆå§‹åŒ– computedï¼Œè¿™éƒ¨åˆ†ä¼šæ¶‰åŠ Watcher ç±»ä»¥åŠä¾èµ–æ”¶é›†ï¼Œcomputed å…¶å®æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šçš„ Watcher</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (opts.<span class=\"property\">watch</span>) <span class=\"title function_\">initWatch</span>(vm, opts.<span class=\"property\">watch</span>)<span class=\"comment\">// åˆå§‹åŒ– watchï¼Œè¿™éƒ¨åˆ†ä¼šæ¶‰åŠ Watcher ç±»ä»¥åŠä¾èµ–æ”¶é›†</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>initState</code>å°†å·¥ä½œæ‹†è§£æˆè§‚å¯Ÿ<code>props</code>, <code>data</code>, <code>methods</code>, <code>computed</code>, <code>watch</code>å‡ ä¸ªå…³é”®éƒ¨åˆ†ã€‚</p>\n<h4 id=\"initData\"><a href=\"#initData\" class=\"headerlink\" title=\"initData\"></a>initData</h4><p>ä»¥<code>initData</code>æ–¹æ³•ä¸ºä¾‹ï¼Œå®ƒæ˜¯å¦‚ä½•ä½¿ç”¨ä¸Šé¢æåˆ°çš„Observer, Dep, Watcherç±»çš„å‘¢ï¼Œæˆ‘ä»¬çœ‹çœ‹<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/instance/state.js#L74-L104\">æºç </a>: </p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">function</span> <span class=\"title function_\">initData</span> (<span class=\"attr\">vm</span>: <span class=\"title class_\">Component</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> data = vm.<span class=\"property\">$options</span>.<span class=\"property\">data</span></span><br><span class=\"line\">  data = vm.<span class=\"property\">_data</span> = <span class=\"keyword\">typeof</span> data === <span class=\"string\">&#x27;function&#x27;</span></span><br><span class=\"line\">    ? data.<span class=\"title function_\">call</span>(vm)</span><br><span class=\"line\">    : data || &#123;&#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"title function_\">isPlainObject</span>(data)) &#123;<span class=\"comment\">// ä¿è¯dataå¿…é¡»ä¸ºçº¯å¯¹è±¡</span></span><br><span class=\"line\">    ......</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// proxy data on instance</span></span><br><span class=\"line\">  <span class=\"keyword\">const</span> keys = <span class=\"title class_\">Object</span>.<span class=\"title function_\">keys</span>(data)</span><br><span class=\"line\">  <span class=\"keyword\">const</span> props = vm.<span class=\"property\">$options</span>.<span class=\"property\">props</span></span><br><span class=\"line\">  <span class=\"keyword\">let</span> i = keys.<span class=\"property\">length</span></span><br><span class=\"line\">  <span class=\"keyword\">while</span> (i--) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (props &amp;&amp; <span class=\"title function_\">hasOwn</span>(props, keys[i])) &#123;<span class=\"comment\">// æ˜¯propsï¼Œåˆ™ä¸ä»£ç†</span></span><br><span class=\"line\">      ...... <span class=\"comment\">//å¦‚æœå’Œ props é‡Œé¢çš„å˜é‡é‡äº†ï¼Œåˆ™æŠ›å‡º Warning</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;<span class=\"comment\">// å¦åˆ™å°†å±æ€§ä»£ç†çš„ vm ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ vm.xx è®¿é—®åˆ° vm._data.xx</span></span><br><span class=\"line\">      <span class=\"title function_\">proxy</span>(vm, keys[i]) <span class=\"comment\">//proxyæ–¹æ³•éå† data çš„ keyï¼ŒæŠŠ data ä¸Šçš„å±æ€§ä»£ç†åˆ° vm å®ä¾‹ä¸Š</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// observe data</span></span><br><span class=\"line\">  <span class=\"title function_\">observe</span>(data, <span class=\"literal\">true</span> <span class=\"comment\">/* asRootData */</span>)  <span class=\"comment\">//å…³é”®ä¸€æ­¥ï¼Œobserve(data, this)æ–¹æ³•æ¥å¯¹ data åšç›‘æ§</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªå‡½æ•°åšäº†ä¸‹é¢çš„å·¥ä½œï¼š</p>\n<ul>\n<li>ä¿è¯dataä¸ºçº¯å¯¹è±¡</li>\n<li>æ£€æŸ¥æ˜¯å¦ä¸<code>props</code>ä¸­å±æ€§æœ‰é‡å¤</li>\n<li>è¿›è¡Œæ•°æ®ä»£ç†ï¼Œä¾¿äºæˆ‘ä»¬ç›´æ¥é€šè¿‡vm.xxxçš„å½¢å¼è®¿é—®åŸæœ¬ä½äºvm._data.xxxçš„å±æ€§ã€‚</li>\n<li>è°ƒç”¨<code>observe</code>æ–¹æ³•å¯¹<code>data</code>è¿›è¡ŒåŒ…è£…ï¼Œä½¿ä¹‹å…·æœ‰å“åº”å¼çš„ç‰¹ç‚¹ã€‚</li>\n</ul>\n<p>é‚£æˆ‘ä»¬çœ‹çœ‹<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/observer/index.js#L101-L126\">observe</a>æ–¹æ³•æ˜¯æ€ä¹ˆå†™çš„å§</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Attempt to create an observer instance for a value,</span></span><br><span class=\"line\"><span class=\"comment\"> * returns the new observer if successfully observed,</span></span><br><span class=\"line\"><span class=\"comment\"> * or the existing observer if the value already has one.</span></span><br><span class=\"line\"><span class=\"comment\"> * è¿”å›ä¸€ä¸ª Observer å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">observe</span> (<span class=\"attr\">value</span>: any, <span class=\"attr\">asRootData</span>: ?boolean): <span class=\"title class_\">Observer</span> | <span class=\"keyword\">void</span> &#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (!<span class=\"title function_\">isObject</span>(value)) &#123;  <span class=\"comment\">//å¦‚æœä¸æ˜¯å¯¹è±¡å’Œæ•°ç»„åˆ™ä¸ç›‘æ§ï¼Œç›´æ¥è¿”å›</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">let</span> <span class=\"attr\">ob</span>: <span class=\"title class_\">Observer</span> | <span class=\"keyword\">void</span></span><br><span class=\"line\">  <span class=\"comment\">//åˆ¤æ–­ value æ˜¯å¦å·²ç»æ·»åŠ äº† __ob__ å±æ€§ï¼Œå¹¶ä¸”å±æ€§å€¼æ˜¯ Observer å¯¹è±¡çš„å®ä¾‹ã€‚é¿å…é‡å¤å¼•ç”¨å¯¼è‡´çš„æ­»å¾ªç¯</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"title function_\">hasOwn</span>(value, <span class=\"string\">&#x27;__ob__&#x27;</span>) &amp;&amp; value.<span class=\"property\">__ob__</span> <span class=\"keyword\">instanceof</span> <span class=\"title class_\">Observer</span>) &#123;    <span class=\"comment\">//å¦‚æœæ˜¯å°±ç›´æ¥ç”¨</span></span><br><span class=\"line\">    ob = value.<span class=\"property\">__ob__</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (</span><br><span class=\"line\">    observerState.<span class=\"property\">shouldConvert</span> &amp;&amp; <span class=\"comment\">//åªæœ‰ root instance props éœ€è¦åˆ›å»º Observer å¯¹è±¡</span></span><br><span class=\"line\">    !<span class=\"title function_\">isServerRendering</span>() &amp;&amp; <span class=\"comment\">//ä¸æ˜¯æœåŠ¡ç«¯æ¸²æŸ“</span></span><br><span class=\"line\">    (<span class=\"title class_\">Array</span>.<span class=\"title function_\">isArray</span>(value) || <span class=\"title function_\">isPlainObject</span>(value)) &amp;&amp; <span class=\"comment\">//æ•°ç»„æˆ–è€…æ™®é€šå¯¹è±¡</span></span><br><span class=\"line\">    <span class=\"title class_\">Object</span>.<span class=\"title function_\">isExtensible</span>(value) &amp;&amp; <span class=\"comment\">//å¯æ‰©å±•å¯¹è±¡</span></span><br><span class=\"line\">    !value.<span class=\"property\">_isVue</span> <span class=\"comment\">// é Vue ç»„ä»¶</span></span><br><span class=\"line\">  ) &#123;</span><br><span class=\"line\">    ob = <span class=\"keyword\">new</span> <span class=\"title class_\">Observer</span>(value)  <span class=\"comment\">//å…³é”®æ­¥ï¼åœ¨ value æ»¡è¶³ä¸Šè¿°æ¡ä»¶çš„æƒ…å†µä¸‹åˆ›å»ºä¸€ä¸ª Observer å¯¹è±¡</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (asRootData &amp;&amp; ob) &#123;</span><br><span class=\"line\">    ob.<span class=\"property\">vmCount</span>++</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> ob <span class=\"comment\">// è¿”å›ä¸€ä¸ª Observer å¯¹è±¡</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>observeæ–¹æ³•ä¸»è¦å°±æ˜¯åˆ¤æ–­valueæ˜¯å¦æ»¡è¶³ä¸€äº›é¢„è®¾æ¡ä»¶ï¼Œå¹¶å°†è¿™ä¸ªå¯¹è±¡è½¬åŒ–ä¸ºObserverå¯¹è±¡ã€‚</p>\n<p>å…³äºObserverç±»æˆ‘ä»¬ä¸Šé¢å·²ç»æåˆ°ï¼Œå®ƒçš„æ„é€ å‡½æ•°åšäº†ä¸‹é¢å‡ ä¸ªå·¥ä½œï¼š</p>\n<ul>\n<li>é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªDepå¯¹è±¡å®ä¾‹ï¼›</li>\n<li>ç„¶åæŠŠè‡ªèº«thisæ·»åŠ åˆ°valueçš„<code>__ob__</code>å±æ€§ä¸Šï¼›</li>\n<li>æœ€åå¯¹valueçš„ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ˜¯æ•°ç»„åˆ™è§‚å¯Ÿæ•°ç»„ï¼Œå¦åˆ™è§‚å¯Ÿå•ä¸ªå…ƒç´ ï¼ˆè¦ç†è§£è¿™ä¸€æ­¥æ˜¯ä¸ªé€’å½’è¿‡ç¨‹ï¼Œå³valueçš„å…ƒç´ å¦‚æœç¬¦åˆæ¡ä»¶ä¹Ÿéœ€è¦è½¬åŒ–ä¸ºObserverå¯¹è±¡ï¼‰ã€‚</li>\n</ul>\n<p>ä¸è®ºæ˜¯åŸºç¡€ç±»å‹è¿˜æ˜¯æ•°ç»„æˆ–å¯¹è±¡ï¼Œæœ€ç»ˆéƒ½ä¼šèµ°å…¥åˆ°<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/observer/index.js#L55-L65\">walk</a>æ–¹æ³•ï¼Œæ–¹æ³•å®šä¹‰åœ¨<code>src/core/observer/index.js</code>ä¸­ã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">walk (<span class=\"attr\">obj</span>: <span class=\"title class_\">Object</span>) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> keys = <span class=\"title class_\">Object</span>.<span class=\"title function_\">keys</span>(obj)</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; keys.<span class=\"property\">length</span>; i++) &#123;</span><br><span class=\"line\">    <span class=\"title function_\">defineReactive</span>(obj, keys[i], obj[keys[i]]) <span class=\"comment\">//éå†å¯¹è±¡ï¼Œç»“åˆdefineReactiveæ–¹æ³•åœ°æŸœå°†å±æ€§è½¬åŒ–ä¸ºgetterå’Œsetter</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"defineReactive\"><a href=\"#defineReactive\" class=\"headerlink\" title=\"defineReactive\"></a>defineReactive</h4><p>åœ¨ç»è¿‡ä¸€ç³»åˆ—çš„å‡†å¤‡å·¥ä½œå’Œé“ºå«åï¼Œç»ˆäºå¯ä»¥æ¥è§¦åˆ°æ•°æ®ç»‘å®šæœ€æ ¸å¿ƒéƒ¨åˆ†çš„<code>defineReactive</code>å‡½æ•°ã€‚æ–¹æ³•ä¹Ÿå®šä¹‰åœ¨<code>src/core/observer/index.js</code>ä¸­ï¼Œ<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/observer/index.js#L128-L184\">æºç </a>å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * Define a reactive property on an Object.</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">function</span> <span class=\"title function_\">defineReactive</span> (</span><br><span class=\"line\">  <span class=\"attr\">obj</span>: <span class=\"title class_\">Object</span>,</span><br><span class=\"line\">  <span class=\"attr\">key</span>: string,</span><br><span class=\"line\">  <span class=\"attr\">val</span>: any,</span><br><span class=\"line\">  customSetter?: <span class=\"title class_\">Function</span></span><br><span class=\"line\">) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">const</span> dep = <span class=\"keyword\">new</span> <span class=\"title class_\">Dep</span>()  <span class=\"comment\">//æ¯ä¸ªå¯¹è±¡éƒ½ä¼šæœ‰ä¸€ä¸ª Dep å®ä¾‹ï¼Œç”¨æ¥ä¿å­˜ä¾èµ– (Watcher å¯¹è±¡)</span></span><br><span class=\"line\">  ......</span><br><span class=\"line\">  <span class=\"keyword\">let</span> childOb = <span class=\"title function_\">observe</span>(val)   <span class=\"comment\">//ç»“åˆ observe å‡½æ•°è¿›è¡Œå°†å¯¹è±¡çš„å¯¹è±¡ä¹Ÿå˜æˆç›‘æ§å¯¹è±¡</span></span><br><span class=\"line\">  <span class=\"comment\">// æœ€é‡ç‚¹ã€åŸºçŸ³ã€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼šé€šè¿‡è°ƒç”¨ Object.defineProperty ç»™ data çš„æ¯ä¸ªå±æ€§æ·»åŠ  getter å’Œ setter æ–¹æ³•ã€‚</span></span><br><span class=\"line\">  <span class=\"title class_\">Object</span>.<span class=\"title function_\">defineProperty</span>(obj, key, &#123;</span><br><span class=\"line\">    <span class=\"attr\">enumerable</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">configurable</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    <span class=\"attr\">get</span>: <span class=\"keyword\">function</span> <span class=\"title function_\">reactiveGetter</span> () &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> value = getter ? getter.<span class=\"title function_\">call</span>(obj) : val</span><br><span class=\"line\">      <span class=\"comment\">// ä¾èµ–æ”¶é›†çš„é‡è¦æ­¥éª¤</span></span><br><span class=\"line\">      <span class=\"keyword\">if</span> (<span class=\"title class_\">Dep</span>.<span class=\"property\">target</span>) &#123;<span class=\"comment\">//å¦‚æœå­˜åœ¨Dep.targetè¿™ä¸ªå…¨å±€å˜é‡ä¸ä¸ºç©ºï¼Œè¡¨ç¤ºæ˜¯åœ¨æ–°å»ºWatcherçš„æ—¶å€™è°ƒç”¨çš„ï¼Œä»£ç å·²ç»ä¿è¯</span></span><br><span class=\"line\">        dep.<span class=\"title function_\">depend</span>()    <span class=\"comment\">// ä¾èµ–æ”¶é›†</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (childOb) &#123;</span><br><span class=\"line\">          childOb.<span class=\"property\">dep</span>.<span class=\"title function_\">depend</span>() <span class=\"comment\">// å¤„ç†å¥½å­å…ƒç´ çš„ä¾èµ– watcher</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"title class_\">Array</span>.<span class=\"title function_\">isArray</span>(value)) &#123; <span class=\"comment\">// å¦‚æœæ˜¯æ•°ç»„ï¼Œè¿›ä¸€æ­¥å¤„ç†</span></span><br><span class=\"line\">          <span class=\"title function_\">dependArray</span>(value)</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      <span class=\"keyword\">return</span> value</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">set</span>: <span class=\"keyword\">function</span> <span class=\"title function_\">reactiveSetter</span> (newVal) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> value = getter ? getter.<span class=\"title function_\">call</span>(obj) : val</span><br><span class=\"line\">      ......</span><br><span class=\"line\">      childOb = <span class=\"title function_\">observe</span>(newVal)    <span class=\"comment\">// å¯¹æ–°æ•°æ®é‡æ–° observeï¼Œæ›´æ–°æ•°æ®çš„ä¾èµ–å…³ç³»</span></span><br><span class=\"line\">      dep.<span class=\"title function_\">notify</span>()   <span class=\"comment\">// é€šçŸ¥depè¿›è¡Œæ•°æ®æ›´æ–°ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨å‰é¢çš„ Dep ç±»ä¸­è®²è¿‡</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>defineReactiveæ˜¯å¯¹Object.definePropertyæ–¹æ³•çš„åŒ…è£…ï¼Œç»“åˆobserveæ–¹æ³•å¯¹æ•°æ®é¡¹è¿›è¡Œæ·±å…¥éå†ï¼Œæœ€ç»ˆå°†æ‰€æœ‰çš„å±æ€§å°±è½¬åŒ–ä¸ºgetterå’Œsetterã€‚å…¶ä¸­å¯¹äºDepçš„å¤„ç†ç”¨äºæ”¶é›†ä¾èµ–<code>data</code>çš„Watcherå¯¹è±¡ã€‚</p>\n<h4 id=\"ä¾èµ–æ”¶é›†\"><a href=\"#ä¾èµ–æ”¶é›†\" class=\"headerlink\" title=\"ä¾èµ–æ”¶é›†\"></a>ä¾èµ–æ”¶é›†</h4><p><img src=\"/blog/images/vue-reactive.jpg\"></p>\n<p><code>data</code>çš„ä¾èµ–æ”¶é›†æ˜¯åœ¨getterå‡½æ•°ä¸­å®Œæˆçš„ã€‚Observerå’ŒDepæ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼ŒDepç”¨æ¥å­˜å‚¨ä¾èµ–Observerçš„Watcherã€‚Depå’ŒWatcheræ˜¯å¤šå¯¹å¤šçš„å…³ç³»ï¼Œä¸€ä¸ªDepä¸­å­˜å‚¨äº†è‹¥å¹²Watcherï¼Œä¸€ä¸ªWatcherå¯èƒ½åŒæ—¶ä¾èµ–äºå¤šä¸ªObserverã€‚</p>\n<p>å¯ä»¥çœ‹åˆ°Depæ˜¯è¿æ¥Observerï¼ˆç”Ÿäº§è€…ï¼‰å’ŒWatcherï¼ˆæ¶ˆè´¹è€…ï¼‰çš„å…³é”®çº½å¸¦ã€‚Watcheré€šè¿‡getterå‡½æ•°å»ºç«‹èµ·å’ŒObserverä¸­Depçš„å…³è”ã€‚åœ¨Observerçš„setterå‡½æ•°ä¸­ä¼šè§¦å‘<code>dep.notify()</code>æ–¹æ³•ï¼Œæ ¹æ®ä¸Šæ–‡å¯¹è¯¥æ–¹æ³•çš„è®²è§£ï¼Œå®ƒå®é™…ä¸Šå¯¹æ•°ç»„ä¸­æ¯ä¸ªWatcheræ‰§è¡Œäº†<code>update</code>æ–¹æ³•ã€‚åœ¨æ–¹æ³•ä¸­æ ¹æ®æ˜¯å¦åŒæ­¥å»æ‰§è¡Œ<code>run</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¸­é€šè¿‡<a href=\"https://github.com/vuejs/vue/blob/v2.1.10/src/core/observer/watcher.js#L157-#L191\">æºç </a>å¯ä»¥çœ‹åˆ°å®é™…ä¸Šæ­£æ˜¯é€šè¿‡<code>const value = this.get()</code>è·å–æœ€æ–°çš„valueã€‚</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">update () &#123;</span><br><span class=\"line\">  <span class=\"comment\">/* istanbul ignore else */</span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">lazy</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"property\">dirty</span> = <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">sync</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">run</span>()</span><br><span class=\"line\">  &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">    <span class=\"title function_\">queueWatcher</span>(<span class=\"variable language_\">this</span>)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<ol>\n<li>æ¨¡æ¿ç¼–è¯‘è¿‡ç¨‹ä¸­çš„æŒ‡ä»¤å’Œæ•°æ®ç»‘å®šéƒ½ä¼šç”Ÿæˆ Watcherå®ä¾‹ï¼Œwatchå‡½æ•°ä¸­çš„å¯¹è±¡ä¹Ÿä¼šç”Ÿæˆ Watcherå®ä¾‹ï¼Œåœ¨å®ä¾‹åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè°ƒç”¨watcher.jsä¸­çš„getå‡½æ•°touchè¿™ä¸ªWatcherçš„è¡¨è¾¾å¼æˆ–å‡½æ•°æ¶‰åŠçš„æ‰€æœ‰å±æ€§ï¼›</li>\n<li>touchå¼€å§‹ä¹‹å‰Watcherä¼šè®¾ç½®Depçš„é™æ€å±æ€§Dep.targetæŒ‡å‘å…¶è‡ªèº«ï¼Œç„¶åå¼€å§‹ä¾èµ–æ”¶é›†ï¼›</li>\n<li>touchå±æ€§çš„è¿‡ç¨‹ä¸­ï¼Œå±æ€§çš„getterå‡½æ•°ä¼šè¢«è®¿é—®ï¼›</li>\n<li>å±æ€§gette å‡½æ•°ä¸­ä¼šåˆ¤æ–­Dep.targetï¼ˆtargetä¸­ä¿å­˜çš„æ˜¯ç¬¬2æ­¥ä¸­è®¾ç½®çš„Watcherå®ä¾‹ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™å°† getterå‡½æ•°æ‰€åœ¨çš„Observer å®ä¾‹çš„Depå®ä¾‹ä¿å­˜åˆ°Watcherçš„åˆ—è¡¨ä¸­ï¼Œå¹¶åœ¨æ­¤Depå®ä¾‹ä¸­æ·»åŠ Watcherä¸ºè®¢é˜…è€…ï¼›</li>\n<li>é‡å¤ä¸Šè¿°è¿‡ç¨‹ç›´è‡³Watcherçš„è¡¨è¾¾å¼æˆ–å‡½æ•°æ¶‰åŠçš„æ‰€æœ‰å±æ€§å‡touchç»“æŸï¼ˆå³è¡¨è¾¾å¼æˆ–å‡½æ•°ä¸­æ‰€æœ‰çš„æ•°æ®çš„getterå‡½æ•°éƒ½å·²è¢«è§¦å‘ï¼‰ï¼ŒDep.targetè¢«ç½®ä¸ºnullï¼Œä¾èµ–æ”¶é›†å®Œæˆï¼›</li>\n</ol>\n</blockquote>\n<h3 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h3><p>ä¸Šé¢å°è¯•ä»æºç è§’åº¦å¯¹Vue2.0çš„å“åº”å¼è®¾è®¡åšäº†æµ…æã€‚æ€»ç»“ä¸€ä¸‹å°±æ˜¯ä¸‹é¢å‡ ç‚¹ï¼š</p>\n<ul>\n<li>åœ¨ç”Ÿå‘½å‘¨æœŸçš„initStateæ–¹æ³•ä¸­å¯¹<code>data</code>, <code>prop</code>, <code>method</code>, <code>computed</code>, <code>watch</code>æ–¹æ³•ä¸­çš„æ•°æ®è¿›è¡ŒåŠ«æŒï¼Œé€šè¿‡<code>defineReactive</code>å’Œ<code>observe</code>å°†ä¹‹è½¬æ¢ä¸ºObserverå¯¹è±¡</li>\n<li><code>initRender</code>å‡½æ•°ä¸­è§£ææ¨¡æ¿ï¼Œæ–°å»ºWatcherå¯¹è±¡é€šè¿‡Depå¯¹è±¡å’Œå¯¹åº”æ•°æ®å»ºç«‹äº†ä¾èµ–å…³ç³»ï¼Œé€šè¿‡<code>Dep.target</code>è¿™ä¸ªå…¨å±€å¯¹è±¡åˆ¤æ–­æ˜¯å¦æ˜¯ä¾èµ–æ”¶é›†é˜¶æ®µã€‚</li>\n<li>æ•°æ®å˜åŒ–æ—¶ï¼Œé€šè¿‡<code>setter</code>å‡½æ•°ä¸­çš„<code>dep.notify</code>æ–¹æ³•æ‰§è¡ŒWatcherçš„<code>update</code>æ–¹æ³•æ›´æ–°è§†å›¾</li>\n</ul>\n<h3 id=\"å‚è€ƒ\"><a href=\"#å‚è€ƒ\" class=\"headerlink\" title=\"å‚è€ƒ\"></a>å‚è€ƒ</h3><p><a href=\"https://www.zybuluo.com/zhouweicsu/note/682813\">Vue2.0 æºç é˜…è¯»ï¼šå“åº”å¼åŸç†</a></p>\n",
            "tags": [
                "JavaScript",
                "æºç ",
                "Vue"
            ]
        }
    ]
}