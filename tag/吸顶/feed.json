{
    "version": "https://jsonfeed.org/version/1",
    "title": "Shenlvmeng's Blog • All posts by \"吸顶\" tag",
    "description": "Be sharp, my friend.",
    "home_page_url": "http://shenlvmeng.github.com/blog",
    "items": [
        {
            "id": "http://shenlvmeng.github.com/blog/2019/02/12/some-tips-6/",
            "url": "http://shenlvmeng.github.com/blog/2019/02/12/some-tips-6/",
            "title": "工作中的遇到的一些小知识 6",
            "date_published": "2019-02-12T14:29:56.000Z",
            "content_html": "<h2 id=\"React-Hooks和React-Hot-Loader默认配置相冲突\"><a href=\"#React-Hooks和React-Hot-Loader默认配置相冲突\" class=\"headerlink\" title=\"React Hooks和React Hot Loader默认配置相冲突\"></a>React Hooks和React Hot Loader默认配置相冲突</h2><p>设置RHL的<code>pureSFC</code>配置为true，详见<a href=\"https://github.com/gaearon/react-hot-loader/issues/1088#issuecomment-434862175\">讨论</a>。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setConfig(&#123; pureSFC: true &#125;)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"一个简单的rollup配置样例\"><a href=\"#一个简单的rollup配置样例\" class=\"headerlink\" title=\"一个简单的rollup配置样例\"></a>一个简单的rollup配置样例</h2><p>最近有一个开发前端录音库（严格来说是改进）的需求，目标是发布到npm管理平台上，在打包库上<a href=\"https://rollupjs.org/guide/en\">rollup</a>的发挥要优于webpack。刚好想用用试试，就用了rollup作为打包工具。因为场景比webpack更简单，配置上也比webpack好配很多，基本看看<a href=\"https://rollupjs.org/guide/zh#tutorial\">官方文档</a>就可以上手了。</p>\n<p>不过，文档里用的babel版本还是6.x，使用新版本babel后，配置文件<code>rollup.config.js</code>和<code>.babelrc</code>有些改动，这里列在下面。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// rollup.config.js</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> resolve <span class=\"keyword\">from</span> <span class=\"string\">&#x27;rollup-plugin-node-resolve&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> commonjs <span class=\"keyword\">from</span> <span class=\"string\">&#x27;rollup-plugin-commonjs&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> babel <span class=\"keyword\">from</span> <span class=\"string\">&#x27;rollup-plugin-babel&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> &#123; terser &#125; <span class=\"keyword\">from</span> <span class=\"string\">&quot;rollup-plugin-terser&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">input</span>: <span class=\"string\">&#x27;src/index.js&#x27;</span>,</span><br><span class=\"line\">    <span class=\"attr\">output</span>: &#123;</span><br><span class=\"line\">        <span class=\"attr\">file</span>: <span class=\"string\">&#x27;index.js&#x27;</span>,</span><br><span class=\"line\">        <span class=\"attr\">format</span>: <span class=\"string\">&#x27;es&#x27;</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        <span class=\"title function_\">resolve</span>(),</span><br><span class=\"line\">        <span class=\"title function_\">commonjs</span>(),</span><br><span class=\"line\">        <span class=\"title function_\">babel</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">exclude</span>: <span class=\"string\">&#x27;node_modules/**&#x27;</span></span><br><span class=\"line\">        &#125;),</span><br><span class=\"line\">        <span class=\"title function_\">terser</span>()</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// .babelrc</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"attr\">presets</span>: [</span><br><span class=\"line\">        [</span><br><span class=\"line\">            <span class=\"string\">&#x27;@babel/env&#x27;</span>,</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"attr\">loose</span>: <span class=\"literal\">true</span>,</span><br><span class=\"line\">                <span class=\"attr\">modules</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    <span class=\"attr\">plugins</span>: [</span><br><span class=\"line\">        [<span class=\"string\">&#x27;@babel/proposal-object-rest-spread&#x27;</span>, &#123; <span class=\"attr\">loose</span>: <span class=\"literal\">true</span> &#125;]</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"mouseout和mouseleave事件的区别\"><a href=\"#mouseout和mouseleave事件的区别\" class=\"headerlink\" title=\"mouseout和mouseleave事件的区别\"></a><code>mouseout</code>和<code>mouseleave</code>事件的区别</h2><blockquote>\n<p>mouseout: <a href=\"https://developer.mozilla.org/en-US/docs/Web/Events/mouseout\">https://developer.mozilla.org/en-US/docs/Web/Events/mouseout</a><br>mouseleave: <a href=\"https://developer.mozilla.org/en-US/docs/Web/Events/mouseleave\">https://developer.mozilla.org/en-US/docs/Web/Events/mouseleave</a></p>\n</blockquote>\n<ul>\n<li><code>mouseout</code>在鼠标离开该元素表面时触发，<strong>包括进入到该元素的子元素中</strong></li>\n<li><code>mouseleave</code>在鼠标离开该元素区域时触发，<strong>即离开该元素和所有子元素区域</strong></li>\n</ul>\n<h2 id=\"sublime-goto-definition-快捷键\"><a href=\"#sublime-goto-definition-快捷键\" class=\"headerlink\" title=\"sublime goto definition 快捷键\"></a>sublime goto definition 快捷键</h2><blockquote>\n<p>参考<a href=\"https://stackoverflow.com/questions/16235706/sublime-3-set-key-map-for-function-goto-definition\">这里</a></p>\n</blockquote>\n<h2 id=\"只lint-changed-file的脚本方案\"><a href=\"#只lint-changed-file的脚本方案\" class=\"headerlink\" title=\"只lint changed file的脚本方案\"></a>只lint changed file的脚本方案</h2><p>利用<code>git diff-index</code>。下面以tslint为例。</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">files=$(git diff-index --relative --name-only --cached HEAD | grep -e <span class=\"string\">&#x27;\\\\.ts$&#x27;</span> -e <span class=\"string\">&#x27;\\\\.tsx$&#x27;</span>);</span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"built_in\">test</span> -n \\&quot;<span class=\"variable\">$files</span>\\&quot;;</span><br><span class=\"line\">    <span class=\"keyword\">then</span> <span class=\"built_in\">echo</span> <span class=\"variable\">$files</span> | xargs tslint --fix -t codeFrame;</span><br><span class=\"line\"><span class=\"keyword\">fi</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"升级版\"><a href=\"#升级版\" class=\"headerlink\" title=\"升级版\"></a>升级版</h3><p>使用<a href=\"https://www.npmjs.com/package/lint-staged\">lint-staged</a>，只lint staged的文件内容，代替上面冗长的脚本。</p>\n<h2 id=\"吸顶样式效果\"><a href=\"#吸顶样式效果\" class=\"headerlink\" title=\"吸顶样式效果\"></a>吸顶样式效果</h2><h3 id=\"CSS\"><a href=\"#CSS\" class=\"headerlink\" title=\"CSS\"></a>CSS</h3><blockquote>\n<p>参考：<a href=\"https://developer.mozilla.org/zh-CN/docs/Web/CSS/position\">MDN</a></p>\n</blockquote>\n<p>最简洁的实现方式，缺点是<a href=\"https://caniuse.com/#search=sticky\">支持度</a>较差，只在iOS平台支持度较好。除非做中后台，否则需要谨慎使用。</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-class\">.stick</span> &#123;</span><br><span class=\"line\">    <span class=\"attribute\">position</span>: sticky;</span><br><span class=\"line\">    <span class=\"attribute\">top</span>: <span class=\"number\">20px</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"JS\"><a href=\"#JS\" class=\"headerlink\" title=\"JS\"></a>JS</h3><p>不用赘述，检查滚动元素的<code>scrollTop</code>属性做判断即可，在指定位置上，设置<code>position:fixed</code>配合<code>z-index</code>等实现吸顶。</p>\n<p>另外有意思的一点是，在<code>position:fixed</code>的情况下，<strong>如果没有设置<code>left</code>，<code>left</code>将相对当前元素相对定位</strong>。</p>\n<h2 id=\"一个更友好的图片加载组件\"><a href=\"#一个更友好的图片加载组件\" class=\"headerlink\" title=\"一个更友好的图片加载组件\"></a>一个更友好的图片加载组件</h2><h3 id=\"需求\"><a href=\"#需求\" class=\"headerlink\" title=\"需求\"></a>需求</h3><p>提供类似知乎App内的体验：</p>\n<ul>\n<li>在图片加载时有<strong>相同大小</strong>的占位图和文案提示</li>\n<li>图片加载失败后有<strong>相同大小</strong>的占位图和文案提示，点击文案可以重新加载图片</li>\n</ul>\n<h2 id=\"思路\"><a href=\"#思路\" class=\"headerlink\" title=\"思路\"></a>思路</h2><p>重点在需要图片大小相同的占位图，这通常意味着：</p>\n<ul>\n<li>图片的大小需要伴随图片下发</li>\n<li>客户端的图片宽度或高度固定（通常是宽度）</li>\n</ul>\n<p>点击重新加载可以通过在图片url后拼接每次不一样的参数实现，例如时间戳。</p>\n<p>遮罩可以用图片背景色 + <code>:after</code>伪元素或另外的元素实现。剩下的把loading、loaded、failed状态处理好，工作并不困难。</p>\n<p>下面是粗略实现的一个demo。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@desc</span> smart image provide more friendly image loading experience inspired by zhihu</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@author</span> shenlvmeng&lt;xin_yuanming@163.com&gt;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"title class_\">React</span>, &#123; <span class=\"title class_\">Component</span> &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">&#x27;./index.less&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">interface <span class=\"title class_\">IProps</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">width</span>: number;</span><br><span class=\"line\">    <span class=\"attr\">height</span>: number;</span><br><span class=\"line\">    <span class=\"attr\">src</span>: string;</span><br><span class=\"line\">    onLoad?: <span class=\"function\">() =&gt;</span> <span class=\"keyword\">void</span>;</span><br><span class=\"line\">    onError?: <span class=\"function\">() =&gt;</span> <span class=\"keyword\">void</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">interface <span class=\"title class_\">IState</span> &#123;</span><br><span class=\"line\">    <span class=\"attr\">src</span>: string;</span><br><span class=\"line\">    <span class=\"attr\">loaded</span>: boolean;</span><br><span class=\"line\">    <span class=\"attr\">failed</span>: boolean;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">SmartImage</span> <span class=\"keyword\">extends</span> <span class=\"title class_ inherited__\">Component</span>&lt;<span class=\"title class_\">IProps</span>, <span class=\"title class_\">IState</span>&gt; &#123;</span><br><span class=\"line\">    public readonly <span class=\"attr\">state</span>: <span class=\"title class_\">IState</span> = &#123;</span><br><span class=\"line\">        <span class=\"attr\">src</span>: <span class=\"variable language_\">this</span>.<span class=\"property\">props</span>.<span class=\"property\">src</span>,</span><br><span class=\"line\">        <span class=\"attr\">loaded</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"attr\">failed</span>: <span class=\"literal\">false</span></span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\"></span><br><span class=\"line\">    public <span class=\"title function_\">render</span>(<span class=\"params\"></span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> &#123; width, height &#125; = <span class=\"variable language_\">this</span>.<span class=\"property\">props</span>;</span><br><span class=\"line\">        <span class=\"keyword\">const</span> &#123; src, loaded, failed &#125; = <span class=\"variable language_\">this</span>.<span class=\"property\">state</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> (</span><br><span class=\"line\">            <span class=\"language-xml\"><span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">className</span>=<span class=\"string\">&quot;smart-image-container&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">                <span class=\"tag\">&lt;<span class=\"name\">img</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">                    <span class=\"attr\">className</span>=<span class=\"string\">&quot;smart-image&quot;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">                    <span class=\"attr\">width</span>=<span class=\"string\">&#123;750&#125;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">                    <span class=\"attr\">height</span>=<span class=\"string\">&#123;750</span> * <span class=\"attr\">height</span> / <span class=\"attr\">width</span>&#125;</span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">                    <span class=\"attr\">src</span>=<span class=\"string\">&#123;src&#125;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">                    <span class=\"attr\">onLoad</span>=<span class=\"string\">&#123;this.handleSuccess&#125;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">                    <span class=\"attr\">onError</span>=<span class=\"string\">&#123;this.handleError&#125;</span></span></span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"language-xml\">                /&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">                &#123;!loaded</span></span><br><span class=\"line\"><span class=\"language-xml\">                    ? (</span></span><br><span class=\"line\"><span class=\"language-xml\">                        <span class=\"tag\">&lt;<span class=\"name\">div</span> <span class=\"attr\">className</span>=<span class=\"string\">&quot;smart-image-hint&quot;</span> <span class=\"attr\">onClick</span>=<span class=\"string\">&#123;this.handleRetry&#125;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">                            &#123;failed</span></span><br><span class=\"line\"><span class=\"language-xml\">                                ? <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>图片加载失败，点此重试<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">                                : <span class=\"tag\">&lt;<span class=\"name\">span</span>&gt;</span>图片加载中...<span class=\"tag\">&lt;/<span class=\"name\">span</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">                            &#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">                        <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"language-xml\">                    )</span></span><br><span class=\"line\"><span class=\"language-xml\">                    : null</span></span><br><span class=\"line\"><span class=\"language-xml\">                &#125;</span></span><br><span class=\"line\"><span class=\"language-xml\">            <span class=\"tag\">&lt;/<span class=\"name\">div</span>&gt;</span></span></span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private handleSuccess = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">setState</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">failed</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">            <span class=\"attr\">loaded</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">props</span>.<span class=\"property\">onLoad</span>) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">props</span>.<span class=\"title function_\">onLoad</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private handleError = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">setState</span>(&#123; <span class=\"attr\">failed</span>: <span class=\"literal\">true</span> &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"variable language_\">this</span>.<span class=\"property\">props</span>.<span class=\"property\">onError</span>) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">this</span>.<span class=\"property\">props</span>.<span class=\"title function_\">onError</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private handleRetry = <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!<span class=\"variable language_\">this</span>.<span class=\"property\">props</span>.<span class=\"property\">src</span>.<span class=\"title function_\">startsWith</span>(<span class=\"string\">&#x27;http&#x27;</span>) || !<span class=\"variable language_\">this</span>.<span class=\"property\">state</span>.<span class=\"property\">failed</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">setState</span>(&#123;</span><br><span class=\"line\">            <span class=\"attr\">failed</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">            <span class=\"attr\">src</span>: <span class=\"string\">`<span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.props.src&#125;</span>?ts=<span class=\"subst\">$&#123;<span class=\"built_in\">Date</span>.now()&#125;</span>`</span></span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"title class_\">SmartImage</span>;</span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "React Hooks",
                "Rollup",
                "mouseout",
                "mouseleave",
                "lint-staged",
                "吸顶",
                "图片组件"
            ]
        }
    ]
}