<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/blog/favicon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon.png">
  <link rel="mask-icon" href="/blog/favicon.png" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"shenlvmeng.github.com","root":"/blog/","images":"/blog/images","scheme":"Muse","darkmode":false,"version":"8.14.1","exturl":false,"sidebar":{"position":"right","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"algolia":{"appID":"N573WZGUR1","apiKey":"f4b654279103617a4cefb92a132ff0c3","indexName":"blog","hits":{"per_page":10}}}</script><script src="/blog/js/config.js"></script>

    <meta name="description" content="Be sharp, my friend.">
<meta property="og:type" content="website">
<meta property="og:title" content="Shenlvmeng&#39;s Blog">
<meta property="og:url" content="http://shenlvmeng.github.com/blog/page/5/">
<meta property="og:site_name" content="Shenlvmeng&#39;s Blog">
<meta property="og:description" content="Be sharp, my friend.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="shenlvmeng">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://shenlvmeng.github.com/blog/page/5/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/5/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Shenlvmeng's Blog</title>
  






  <script async defer data-website-id="" src=""></script>

  <script defer data-domain="" src=""></script>

  <noscript>
    <link rel="stylesheet" href="/blog/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Shenlvmeng's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container">
  <div class="algolia-stats"><hr></div>
  <div class="algolia-hits"></div>
  <div class="algolia-pagination"></div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="shenlvmeng"
      src="/blog/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">shenlvmeng</p>
  <div class="site-description" itemprop="description">Be sharp, my friend.</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/blog/archives/">
          <span class="site-state-item-count">152</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/blog/categories/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/blog/tags/">
        <span class="site-state-item-count">469</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/shenlvmeng" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;shenlvmeng" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="http://weibo.com/shenlvmeng" title="Weibo → http:&#x2F;&#x2F;weibo.com&#x2F;shenlvmeng" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://shenlvmeng.github.com/blog/2021/09/10/trunk-based-development/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
      <meta itemprop="name" content="shenlvmeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shenlvmeng's Blog">
      <meta itemprop="description" content="Be sharp, my friend.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Shenlvmeng's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/09/10/trunk-based-development/" class="post-title-link" itemprop="url">Trunk Based Development（主干开发）介绍</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-09-10 10:44:08 / 修改时间：10:45:46" itemprop="dateCreated datePublished" datetime="2021-09-10T10:44:08+08:00">2021-09-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E8%A7%84%E8%8C%83/" itemprop="url" rel="index"><span itemprop="name">规范</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/blog/2021/09/10/trunk-based-development/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/09/10/trunk-based-development/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>4 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>主干开发是相对<a target="_blank" rel="noopener" href="https://nvie.com/posts/a-successful-git-branching-model/">GitFlow</a>和<a target="_blank" rel="noopener" href="https://guides.github.com/introduction/flow/">Github Flow</a>更贴合CI&#x2F;CD（持续集成&#x2F;持续分发）的高效版本控制管理实践，也更贴合Devops团队。</p>
</blockquote>
<h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>在软件开发的早年期间，GitFlow和GithubFlow被用来在软件开发中做版本控制管理。</p>
<ul>
<li>GitFlow工作流中，分为主干分支（<code>master</code>）、开发分支（<code>dev</code>）、特性分支、分布分支、热修分支等，这些分支都是长期存在的，并在需求开发完成&#x2F;bug修复完成&#x2F;代码发布等特定时候执行代码的CR（Code Review）和合码工作。且在合并时，由仓库的核心成员或者管理员们把握代码质量。随着项目的扩大，冲突的几率提高，每次代码合码时候的工作量也大大提升，带来了额外的仓库维护成本。Github Flow便随着Github逐渐流行起来。<br><img src="https://nvie.com/img/git-model@2x.png" alt="GitFlow"></li>
<li>Github Flow工作流中，只有一个主干分支（<code>master</code>），一些特性分支以及发布时会用到的分布分支。开发者可以自由从主干分支签出特性分支开发、调试，并在需求完成后合入主干分支。一定程度上减少了长期存在分支的维护成本，但同样的，CR依然是项目管理者进行，特性分支合码时代码量依然有可能很大，团队内规范不好的话，也容易导致合码后主干分支不可发布。<br><img src="https://images.prismic.io/launchdarkly/bf307def-6bfc-4d27-ac8b-f4dd1a403935_TrunkBasedDev-01+%283%29.png?auto=compress,format" alt="Merge Conflict"></li>
</ul>
<p>主干开发（Trunk Based Development）是一种更敏捷的git工作流，所有的开发者都可以合码到主干分支，结合CI&#x2F;CD流程，有助于团队快速迭代。</p>
<h2 id="什么是主干开发"><a href="#什么是主干开发" class="headerlink" title="什么是主干开发"></a>什么是主干开发</h2><p>主干开发和CI&#x2F;CD相互依赖相辅相成。</p>
<ul>
<li>进行主干开发才能保证CI&#x2F;CD，即每天充分多次的集成乃至发布</li>
<li>CI&#x2F;CD过程中的<strong>快速</strong>自动化测试可以保证主干分支的可发布性</li>
</ul>
<p>在主干开发中每位或者每小组开发者将自己的工作分成小份，然后以每天至少一次的形式从自己的分支合并到主干，由于每次合并代码量不大，CR时间以及CI时间都会缩短。一个典型的主干开发时间轴如下：</p>
<p><img src="https://cloud.google.com/architecture/devops/images/devops-tech-trunk-based-development-typical-trunk-timeline.svg" alt="主干开发时间轴"></p>
<p>在主干开发中，某些情况下需要从主干分支中选出最佳的bug修复合并到对应版本中，但如果每天发布多次，则根本不需要发布分支，可直接从主干中部署。这样做的最大优势在于减少开发线，频繁执行小批量合并，将代码保持最新。从而降低团队的合码成本。</p>
<h2 id="如何实现主干开发"><a href="#如何实现主干开发" class="headerlink" title="如何实现主干开发"></a>如何实现主干开发</h2><p>在进行主干开发时，开发者需要了解如何拆解工作为小份，同时，还需要让构建流程保持通过，如果CI失败，开发者需要立即停止当前工作修复问题，无法短期修复时，也要还原相应更改。通常来讲，主干开发有下面这样的特征：</p>
<ul>
<li>仓库里的活跃分支不超过3个</li>
<li>分支的合码频率不少于每天1次，即分支的生存周期不超过1天</li>
<li>没有代码冻结期或集成期</li>
</ul>
<p>在实践中，有下面一些tips：</p>
<ul>
<li><strong>小commit，多合码</strong>：将每次合码改动限制在少量的commit和较少的代码改动上，保证合码时轻松；主干分支应该有频繁的小批量改动合码</li>
<li><strong>最少1天1合码</strong>：每天合并或关闭待合并分支，有效减少合码压力，提高增量发布敏捷度</li>
<li><strong>同步Code Review</strong>：主干分支的每次合码需要保证CR的及时响应，这可以借助一些代码分析工具的辅助</li>
<li><strong>全面的自动化测试覆盖</strong>：确保有全面的自动化单元测试套件，保证测试通过后再合并代码，这也是保证主干分支可发布的基础</li>
<li><strong>构建快速</strong>：降低CI成本，构建和测试需要在几分钟内完成</li>
</ul>
<p>同时也带来两个新概念</p>
<ul>
<li><strong>分支抽象</strong>：在主干开发中，合码频率很高，有些大需求可能没有办法在1天内就完成合码，对于未完成的需求，可以在代码中先埋下未使用的新特性，等待需求完成后，再使用埋好的新功能。这种在源代码中提前埋下“代码分支”的方式成为抽象分支（Branch by abstraction）</li>
<li><a target="_blank" rel="noopener" href="https://featureflags.io/"><strong>特性开关</strong></a>：在分支抽象的基础上，有些合并到主干的改动不一定想让所有用户都看见，可以在代码中预先埋入分支语句，再从配置中读取当前是否使用特性。这样可以实现功能灵活切换、实现ab-test等效果</li>
</ul>
<p><img src="https://images.prismic.io/launchdarkly/7ad744e0-5c46-4a2f-b08d-6013a95e89c5_TrunkBasedDev-02+%283%29.png?auto=compress,format" alt="feature-flags"></p>
<h2 id="标准开发流"><a href="#标准开发流" class="headerlink" title="标准开发流"></a>标准开发流</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">git checkout master &amp;&amp; git pull --prune</span><br><span class="line">git checkout -b &lt;feat/branch&gt;</span><br><span class="line"><span class="comment"># coding</span></span><br><span class="line">git push -u origin &lt;feat/branch&gt;</span><br><span class="line"><span class="comment"># after any updates</span></span><br><span class="line">git push</span><br><span class="line"><span class="comment"># or add --force if rebased during updates</span></span><br><span class="line">git push -f</span><br></pre></td></tr></table></figure>

<ol>
<li>更新本地master分支</li>
<li>签出特性分支</li>
<li>编码</li>
<li>推送本地分支到远端</li>
<li>提MR，如果MR后有更新，继续push，当rebase master遇到冲突时，推送需要增加<code>-f</code>参数</li>
<li>合码</li>
</ol>
<blockquote>
<p>注：因为主干开发每次合码量不大，建议使用<code>rebase</code>解决冲突</p>
</blockquote>
<h2 id="主干开发的好处"><a href="#主干开发的好处" class="headerlink" title="主干开发的好处"></a>主干开发的好处</h2><p>主干开发的最大好处在于对CI的亲和度。可以想象开发者完成当日工作，当日合码，当日测试通过完成集成，达到可发布状态。很大程度减少了合码的痛苦。进而有：</p>
<ul>
<li>持续CI</li>
<li>持续CR</li>
<li>持续CD</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>非常适用于敏捷开发中，对于团队成员能力过关（要懂得怎样拆分需求）、测试有着良好建设的团队来讲，是种提效的好方式，值得一试。相反如果成员拆分不够良好、代码review不够及时，测试不够自动化和系统，则不适用主干开发。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.atlassian.com/continuous-delivery/continuous-integration/trunk-based-development">Trunk-based development</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.google.com/architecture/devops/devops-tech-trunk-based-development">DevOps技术：主干开发</a></li>
<li><a target="_blank" rel="noopener" href="https://trunkbaseddevelopment.com/">Trunk Based Development: Introduction</a></li>
<li><a target="_blank" rel="noopener" href="https://launchdarkly.com/blog/git-branching-strategies-vs-trunk-based-development/">Git Branching Strategies vs. Trunk-Based Development</a></li>
<li><a target="_blank" rel="noopener" href="https://launchdarkly.com/blog/what-are-feature-flags/">What Are Feature Flags?</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://shenlvmeng.github.com/blog/2021/03/22/clean-architecture/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
      <meta itemprop="name" content="shenlvmeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shenlvmeng's Blog">
      <meta itemprop="description" content="Be sharp, my friend.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Shenlvmeng's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/03/22/clean-architecture/" class="post-title-link" itemprop="url">《架构整洁之道》—— 软件设计的思考</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-03-22 23:47:20" itemprop="dateCreated datePublished" datetime="2021-03-22T23:47:20+08:00">2021-03-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-05-08 23:11:37" itemprop="dateModified" datetime="2021-05-08T23:11:37+08:00">2021-05-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E5%B7%A5%E7%A8%8B/" itemprop="url" rel="index"><span itemprop="name">工程</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/blog/2021/03/22/clean-architecture/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/03/22/clean-architecture/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>全文参考自马丁大叔的《架构整洁之道》，书中文笔清爽易懂，不过在后半段有点条理不清流于术而非道</p>
</blockquote>
<p>在编程领域，问题就像一个生命体一样，是在不断繁殖和进化的。它甚至经常不会人们预期中一般发展。作为一名出色的软件工程师或架构师，你需要有超出普通程序员的视角，考虑系统宏观的未来的发展。你的使命是，在这种恶劣的开发环境下，绘制一幅相对最优的图纸，用最少的时间、人力、金钱构建和维护一个随时可能融化在熵增热汤里的软件系统。和现实物理世界里的架构师类似，你需要了解编程世界里的一般规律，帮助你挑选武器（技术），修炼秘籍（方法论），在不同的江湖里（业务）打造不同的门派（软件系统）。</p>
<p>开卷有益，祝你练武愉快~</p>
<h2 id="你要做什么"><a href="#你要做什么" class="headerlink" title="你要做什么"></a>你要做什么</h2><p>简而言之，架构师的终极目标就是<strong>用最少的人力成本来满足构建和维护软件系统的需求</strong>。糟糕的架构设计会让软件在成功之前，就带来高昂的边际人力成本，即开发新需求的开支越来越大（因为程序员的时间都耗费在系统的修修补补上了）。然而，这种日益增长的边际人力成本现象并不少见。来源于类似龟兔赛跑中兔子的盲目自信，实际上，<strong>无论从短期还是长期看，胡乱编写代码的工作速度其实比循规蹈矩更慢</strong>。</p>
<p>架构师存在的一个必要性就是，软件存在着两种价值维度：</p>
<ul>
<li><strong>行为价值（现在时）</strong>：即实现功能和弥补bug。这类价值是<strong>紧急却并不总是重要的</strong>。</li>
<li><strong>架构价值（将来时）</strong>：即软件是否足够“软”（易于被修改），这类价值是<strong>重要却并不总是紧急的</strong>。</li>
</ul>
<p>很现实的一点是，在公司中，<strong>团队之间的抗争本来就是无穷无尽的</strong>。你作为研发团队的一员，职责的一部分就是避免你的代码在抗争的风吹雨打下变成一坨没人爱的shit。</p>
<h2 id="编程范式"><a href="#编程范式" class="headerlink" title="编程范式"></a>编程范式</h2><p>没错，架构师们也有祖师爷。在1958到1968年期间，3大编程范式就已经陆续出现了。</p>
<ul>
<li><strong>结构化编程</strong>，由Dijkstra在1968年提出，并发扬光大，<strong>它对程序控制权的直接转移（程序语句）进行了限制和规范</strong></li>
<li><strong>面向对象编程</strong>，最早在1966年提出，Ole Johan Dahl和Kriste Nygaard注意到，函数调用堆栈可以被放到堆内存中，从而在函数返回后继续保留。<strong>它对程序控制权的间接转移（函数调用）进行了限制和规范</strong></li>
<li><strong>函数式编程</strong>，启发自Alonzo Church于1936年发明的lambda演算，发扬于1958年的LISP语言。<strong>它对程序的赋值进行了限制和规范</strong></li>
</ul>
<p>值得思考是，三大范式做的都是<strong>限制和规范</strong>，即告诉我们<strong>不能做什么</strong>，而不是可以做什么。另外，多态带来的架构边界飞跃，函数式编程带来的数据访问限制，结构化编程带来的算法拆解为我们架构软件提供了强大武器。这也与软件架构的三个关注点所契合：</p>
<ul>
<li><strong>功能性</strong>，即完整的功能实现</li>
<li><strong>组件独立性</strong>，即合适的耦合度与细粒度</li>
<li><strong>数据管理</strong>，即良好的数据结构设计</li>
</ul>
<h3 id="结构化编程"><a href="#结构化编程" class="headerlink" title="结构化编程"></a>结构化编程</h3><p>Dijkstra在1950年代思考编程时，得出过一个结论：编程是一项<strong>难度很大</strong>的活动。他倾向于把编程类比为数学推导过程，并发现<code>goto</code>的<strong>某些使用</strong>会导致<strong>模块无法被递归拆解成更小的单元</strong>。然而，去掉这些使用的<code>goto</code>可以被<strong>顺序结构、分支结构、循环结构这三种最小集</strong>等价表示出来。从而，大问题可以被逐步拆解为小问题。</p>
<p>不过，事情也并非这么理想，当程序复杂后，我们不可能像Dijkstra一样，用严格的数学推导形式化证明编程的正确性。相反，类似实验学科的<strong>无法被证伪即正确</strong>，我们现今依旧使用着Dijkstra的结构化编程思路将大问题拆解为小问题。</p>
<blockquote>
<p>有趣的是，“无法被证伪即正确”和Dijkstra的一个观点<strong>“测试只能展示bug的存在，并不能证明不存在bug”</strong>不谋而合</p>
</blockquote>
<p>简而言之，去掉goto糟粕诞生的结构化编程中，最有价值的地方就是，它赋予我们创造<strong>可证伪程序单元</strong>的能力，从而架构起大程序。在架构设计领域，<strong>功能性拆解仍然是最佳实践之一</strong>。</p>
<blockquote>
<p>什么？什么叫做可证伪？你应该写过单元测试吧。</p>
</blockquote>
<h3 id="面向对象编程"><a href="#面向对象编程" class="headerlink" title="面向对象编程"></a>面向对象编程</h3><p>什么是面向对象？有人说面向对象是“数据和函数的组合”，也有人说是“对真实世界的一种建模方式”。但这两种理解要么片面，要么虚无缥缈。为了总结这种范式，我们先从它的3大特征入手：</p>
<ul>
<li><strong>封装</strong>，即将一组关联数据和函数圈起来。然而这种特性，从C语言起就支持（struct + 头文件），很难说它是面向对象编程的必要条件</li>
<li><strong>继承</strong>，即可以在某个作用域对外部定义的一组变量与函数进行覆盖。不过C语言也能模拟出这种能力，看起来也比较勉强。</li>
<li><strong>多态</strong>，即在同一接口描述下的不同具体实现形式，C语言起也做了支持（STDOUT），然而使用函数指针显式实现多态问题就在于指针的<strong>危险性</strong>。而面向对象编程对这种程序间接控制权的转移做了约束。</li>
</ul>
<p>传统的函数调用树中，系统行为决定了自上而下的控制流，而控制流决定了<strong>源代码依赖</strong>（代码实现）是自上而下的，比如在C中会使用<code>#include</code>引入依赖。此时不论是代码实现还是代码执行都是自上而下的。然而在<strong>多态</strong>的帮助下，底层函数需要依赖高层接口实现，作为高层函数的插件引入，从而将这种依赖关系和控制流反向，即<strong>依赖反转</strong>。实际上，借助安全便利的多态实现，可以轻松将依赖关系反转。</p>
<p>从而架构师可以<strong>完全控制</strong>这种方式下，系统中所有的源代码依赖关系，进而随意更改源代码依赖关系。让每个组件都有<strong>独立部署</strong>和<strong>独立开发</strong>能力。好了，我们现在可以说明面向对象编程的含义了：</p>
<p>面向对象编程就是以多态为手段来对源代码中的依赖关系进行控制的能力。这种能力让架构师可以构建<strong>插件式架构</strong>，让高层<strong>策略性组件</strong>和底层<strong>实现性组件</strong>相分离。借助接口，底层实现性组件作为插件，可以独立于高层组件开发和部署。</p>
<h3 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h3><p>函数式编程依据的原理早在编程之前就已出现，相对前两种范式，函数式编程的风格可能相对陌生一点。在这类风格中，变量都是不可变的。从而让竞争问题、死锁问题、并发更新问题不复存在。一个架构良好的系统，需要将状态修改的部分和不需要修改的部分隔离开，然后用类似事务型内存的方式来保护可变量。另外，架构师应该着力于将大部分逻辑归于不可变组件中，可变组件的逻辑越少越好。</p>
<p>书中还提到了只包含CR的事件溯源存储逻辑，即通过事务日志的方式保存当前状态。因为不存在更改和删除，从而不存在并发问题。也是一种很新颖的思路。</p>
<p>回顾上面的三种编程范式，都在说什么<strong>不应该做</strong>。也即编程好似在充满死路的熵增旷野中，只有沿着相对安全的几个大方向才可拨开迷雾。</p>
<h2 id="设计原则"><a href="#设计原则" class="headerlink" title="设计原则"></a>设计原则</h2><p>软件的中层需要具有良好的可读性、可扩展性。这里就不得不提到SOLID原则：</p>
<ul>
<li>SRP：<strong>单一职责原则</strong>，每个模块有且只有一个需要被改变的理由</li>
<li>OCP：<strong>开闭原则</strong>，对扩展开放，对修改封闭</li>
<li>LSP：<strong>里氏替换原则</strong>，子类型应该能够无无缝替换类型使用</li>
<li>ISP：<strong>接口隔离原则</strong>，依赖的模块不要包含不需要的接口</li>
<li>DIP：<strong>依赖反转原则</strong>，高层策略性代码不要依赖底层实现性代码</li>
</ul>
<h3 id="SRP"><a href="#SRP" class="headerlink" title="SRP"></a>SRP</h3><p>任何一个软件模块（一组紧密相关的函数和数据结构）都应该只对一个行为者负责。实际上，代码和数据就是靠着和某一类行为者的相关性组合起来的。我们需要<strong>将服务不同行为者的代码进行切分</strong>。</p>
<h3 id="OCP"><a href="#OCP" class="headerlink" title="OCP"></a>OCP</h3><p>设计良好的软件应该易于扩展，同时抗拒修改。实现方式可以通过将系统划分为一系列组件，并且将依赖关系按层次组织，使得高阶组件不会因为低阶组件修改受到影响。</p>
<h3 id="LSP"><a href="#LSP" class="headerlink" title="LSP"></a>LSP</h3><p>里氏替换原则表示，子类型应该能够被当做父类型使用。它实际上表示了一种面向接口设计的设计原则。一旦违背了这种可替换性，就会不得不在系统架构中增加大量复杂的应对机制。</p>
<h3 id="ISP"><a href="#ISP" class="headerlink" title="ISP"></a>ISP</h3><p>ISP告诉我们任何软件设计如果依赖了不需要的东西，都是不好的迹象，很容易带来不必要的麻烦。</p>
<h3 id="DIP"><a href="#DIP" class="headerlink" title="DIP"></a>DIP</h3><p>DIP告诉我们，应该多引用抽象类型，而不是具体实现。因为软件是经常变动的，而抽象出共性的接口则是较少变化的。从而可以衍生出一些守则，譬如：</p>
<ul>
<li>应该多使用抽象接口，避免使用多变的实现类</li>
<li>不要在实现类上创建衍生类</li>
<li>不要覆盖具体实现的函数</li>
</ul>
<p>不过当然了，还是得有人做实现的脏活累活的</p>
<h2 id="组件构建"><a href="#组件构建" class="headerlink" title="组件构建"></a>组件构建</h2><h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><p>组件是构建软件的最小单元，同时也是源代码的集合。在早期会使用链接技术将程序和库函数链接起来，而后随着机器性能的增长，我们会在程序运行中插入动态链接文件，如今这种组件化插件式架构是最常见的软件构建形式。</p>
<h3 id="组件聚合"><a href="#组件聚合" class="headerlink" title="组件聚合"></a>组件聚合</h3><p>和类相似，组件也有一些原则指引我们的构建工作。</p>
<ul>
<li>REP：复用&#x2F;发布原则，即可以一起发布的最小粒度就是复用的最小粒度，也即按可以同时发布聚合</li>
<li>CCP：共同闭包原则，即因为同一原因修改的放在一起，反之不要放在一起，也即按变更原因聚合</li>
<li>CRP：共同复用原则，即会被一起复用的放在一起，反之不要放在一起，也即按减少无用耦合聚合</li>
</ul>
<p>这三大原则相互牵制，在项目的不同阶段，某一原则重要性也会不同；比如在项目早期CCP就会更重要，而后REP会比较重要。</p>
<h3 id="组合耦合"><a href="#组合耦合" class="headerlink" title="组合耦合"></a>组合耦合</h3><p>本节提出了一些可以定量衡量耦合健康度的指标，比较新颖。</p>
<ul>
<li>无依赖环原则：依赖关系中不能有环，会不利于厘清依赖关系；可以通过<strong>依赖反转</strong>或<strong>创建第三方依赖组件</strong>解决。循环依赖关系务必持续监控。</li>
<li>稳定依赖原则：依赖关系必须指向稳定的方向，简单点说就是让经常变更的组件依赖于不经常变更的组件。一个组件的位置稳定性可以通过入向和出向依赖算出，它要能和组件的实际稳定性匹配。</li>
<li>稳定抽象原则：抽象化程度需要和稳定性程度一直，即经常变更的组件要容易变更，即更具体实现；反之，稳定的组件要不容易变更，即更抽象。结合上条看，依赖关系应该指向更抽象的方向。</li>
</ul>
<p>使用位置稳定性指标I和抽象程度A，可以绘制一个坐标系。在主序列上的是最健康的，相反的两块痛苦区和无用区则是不健康的表现。用偏离主序列线的距离可以大致衡量依赖关系的健康程度。结合发布版本的变化来看，还可以得到变化趋势。</p>
<h2 id="软件架构"><a href="#软件架构" class="headerlink" title="软件架构"></a>软件架构</h2><p>软件架构目的就是方便在工作中更好地对组件进行研发、部署、运行和维护。其中的策略就是<strong>保留尽可能多的可选项</strong>。让系统最大化程序员的生产力，同时最小化系统运营成本：</p>
<ul>
<li>开发：系统架构需要方便开发团队对它的开发，不同的团队结构应该采用不同的架构设计，比如团队的大小就会影响架构的选择</li>
<li>部署：一键式部署</li>
<li>运行：几乎任何运行问题都可以通过增加硬件来解决</li>
<li>维护：减小新功能和系统缺陷占用的人力资源</li>
</ul>
<p>保持可选项，忽略那些无关紧要的实现细节。任何软件系统都可以拆解成<strong>策略</strong>（业务的宏观逻辑和流程）和<strong>细节</strong>（具体操作行为）。而<strong>策略才是系统的真正价值所在</strong>。细节是指那些和策略交互的东西，包括:</p>
<ul>
<li>I&#x2F;O设备</li>
<li>数据库</li>
<li>Web系统</li>
<li>服务器</li>
<li>框架</li>
<li>交互协议</li>
</ul>
<p>在设计时，可以尽量拖延上面这些的设计，这样我们做出的决策才不会依赖各种很容易变化的信息。另一方面，也可以<strong>增加实现底层的可替换性</strong>。举个具体例子：<strong>设备无关性</strong>。</p>
<h3 id="独立性"><a href="#独立性" class="headerlink" title="独立性"></a>独立性</h3><p>一个良好的架构应支持下面几点：</p>
<ul>
<li>系统用例：设计良好的架构需要能够<strong>看起来</strong>就可以反映系统的设计意图，比如一个购物车应用架构应该看起来就该是用来实现购物车的</li>
<li>系统运行：可以解耦出多个独立服务，然后通过某种网络协议通信，这种架构即微服务</li>
<li>系统维护</li>
<li>系统开发</li>
<li>系统部署：理想的独立部署应该能够做到<strong>热更新</strong></li>
</ul>
<p>要注意留意表面的重复和实际的重复，如果两段代码变更速率和缘由不同，那么就不算是真正的重复。</p>
<h3 id="划分边界"><a href="#划分边界" class="headerlink" title="划分边界"></a>划分边界</h3><ul>
<li>设计良好的系统架构不应该依赖细节，而应该尽可能推迟细节性的决策。通过划清边界，可以推迟和延后细节性的决策，从而节省大量时间，避免问题。</li>
<li>边界线应该画在不相干的事情中间，譬如GUI和业务逻辑</li>
<li>针对核心业务逻辑的插件式架构可以提高可维护性和可扩展性</li>
</ul>
<h3 id="边界剖析"><a href="#边界剖析" class="headerlink" title="边界剖析"></a>边界剖析</h3><p>简言之，应该尽可能从底层组件指向高层组件。</p>
<h3 id="策略和层次"><a href="#策略和层次" class="headerlink" title="策略和层次"></a>策略和层次</h3><ul>
<li>变更原因、时间和层次不同的策略应该属于不同的组件</li>
<li>按距离系统输入、输出距离的远近，可以确定策略的层次</li>
<li>源码间的依赖关系，应该主要和组件所在的层次挂钩</li>
<li>低层组件应该以插件的方式依赖高层组件</li>
</ul>
<h3 id="业务逻辑"><a href="#业务逻辑" class="headerlink" title="业务逻辑"></a>业务逻辑</h3><p><strong>业务逻辑是程序中真正用于或者体现赚钱&#x2F;省钱的逻辑与过程</strong>。其中关键逻辑和关键数据紧密组合成为<strong>业务实体</strong>。业务实体应该只有高层逻辑，没有具体实现。而<strong>用例</strong>是业务实体在不同侧面的具体体现。通过用例可以规范用户和业务实体的交互方式。</p>
<h3 id="“尖叫”的软件架构"><a href="#“尖叫”的软件架构" class="headerlink" title="“尖叫”的软件架构"></a>“尖叫”的软件架构</h3><p>“尖叫”即所见即所得。软件架构本身就足以能够体现其用途。一个良好的架构设计应该围绕用例展开，推迟和延后框架的选择，不要过度拘泥于框架。<strong>框架只是一个可选项</strong>，是一个工具，而不是一种信念，更不是一种架构。</p>
<h3 id="整洁架构"><a href="#整洁架构" class="headerlink" title="整洁架构"></a>整洁架构</h3><p>一些常见的系统架构通常具有以下特点：</p>
<ul>
<li>独立于框架</li>
<li>可被测试</li>
<li>独立于UI</li>
<li>独立于数据库</li>
<li>独立于外部接口</li>
</ul>
<h3 id="Main组件"><a href="#Main组件" class="headerlink" title="Main组件"></a>Main组件</h3><ul>
<li>Main组件包含了系统中最细节化最底层的策略，它应该在做完脏活累活后，将程序的控制权交给最高抽象层的代码去执行</li>
<li>针对不同系统可以配置不同的Main组件，即将Main组件视为应用程序的一个插件</li>
</ul>
<h3 id="服务：微观和宏观"><a href="#服务：微观和宏观" class="headerlink" title="服务：微观和宏观"></a>服务：微观和宏观</h3><ul>
<li>系统的架构边界事实上并不落在服务之间，而是<strong>穿透</strong>所有服务，在服务内以组件形式存在</li>
<li>服务可以提升系统的可扩展性和可开发性，不过服务却并不能代表整个系统的架构设计</li>
</ul>
<h3 id="整洁的嵌入式架构"><a href="#整洁的嵌入式架构" class="headerlink" title="整洁的嵌入式架构"></a>整洁的嵌入式架构</h3><ul>
<li>固件即对平台或硬件的强依赖代码，在固件和软件之间可以设置HAL（硬件抽象层），为它上层的软件提供服务，它可以帮助软件<em>脱离</em>目标硬件平台来测试</li>
<li>类似地，我们还可以引入OSAL（操作系统抽象层）来减少软件对操作系统的依赖</li>
</ul>
<h2 id="实现细节"><a href="#实现细节" class="headerlink" title="实现细节"></a>实现细节</h2><p>那么什么算是实现细节呢？</p>
<ul>
<li><strong>数据库</strong>，数据的组织结构和模型都是系统架构的一部分，但是从磁盘中存储&#x2F;读取数据的机制或手段则没那么重要，就比如数据库或静态文件</li>
<li><strong>Web</strong>，Web只是UI，只是一种I&#x2F;O设备</li>
<li><strong>应用框架</strong>，框架被创造的目的是解决作者遇到的问题，它要求我们去阅读文档，按照作者的要求整合到我们的应用中，可以使用但是不要被框架绑定</li>
</ul>
<h3 id="案例：视频销售网站"><a href="#案例：视频销售网站" class="headerlink" title="案例：视频销售网站"></a>案例：视频销售网站</h3><ul>
<li>系统架构设计的第一步是识别系统中的各种角色和用例</li>
</ul>
<p><em>–END–</em></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://shenlvmeng.github.com/blog/2021/01/29/zen-of-unix/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
      <meta itemprop="name" content="shenlvmeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shenlvmeng's Blog">
      <meta itemprop="description" content="Be sharp, my friend.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Shenlvmeng's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/01/29/zen-of-unix/" class="post-title-link" itemprop="url">Unix编程艺术集萃</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-29 21:45:15" itemprop="dateCreated datePublished" datetime="2021-01-29T21:45:15+08:00">2021-01-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-03-15 22:25:50" itemprop="dateModified" datetime="2021-03-15T22:25:50+08:00">2021-03-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E6%80%9D%E8%80%83/" itemprop="url" rel="index"><span itemprop="name">思考</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/blog/2021/01/29/zen-of-unix/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/01/29/zen-of-unix/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>13 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>这本书从Unix的设计理念等各方面讲起，内容充实有趣，尽管介绍细节的部分对于不太了解Unix的人呢来讲有些生涩，但在道的介绍上有不少可取之处。由于某人的出现，生活中多了新的追求，比想象中多用了一些时间看完了它。下面摘取一些其中精华的观点，力图尽量还原书中的本意。</p>
<h2 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h2><h3 id="哲学"><a href="#哲学" class="headerlink" title="哲学"></a>哲学</h3><ul>
<li>每过18个月，就有一半的知识会过时</li>
<li>X致力提供一套“机制，而不是策略”</li>
<li>提供机制而不是方针的哲学让Unix长期保鲜</li>
<li>Unix传统将重点放在尽力使各程序接口相对小巧、简洁、正交</li>
<li>Unix管道发明人Doug McIlroy曾说过：<ul>
<li>让每个程序就做好一件事</li>
<li>假定每个程序的输出都会成为另个程序的输入</li>
<li>尽早将设计和编译的软件投入使用</li>
<li>优先使用工具而不是拙劣的帮助来减轻编程任务的负担</li>
</ul>
</li>
<li>Rob Pike曾从不同的角度表述了Unix的哲学<ul>
<li>你无法断定程序会在什么地方好费时间，所以别急于找地方改代码，除非你已经证实那儿就是瓶颈所在</li>
<li>没对代码估量最耗时的部分前，别去优化速度</li>
<li>花哨的算法在n很小的时候通常很慢，而n一般很小</li>
<li>花哨的算法比简单算法更容易出bug、更难实现</li>
<li>编程的核心是数据结构，而不是算法</li>
</ul>
</li>
<li>书中对Unix的哲学，总结为下面这些点<ul>
<li><strong>模块原则</strong>，使用简洁的接口拼接简单的部件</li>
<li><strong>清晰原则</strong>，清晰胜于机巧，程序是写给人看的</li>
<li><strong>组合原则</strong>，设计时要考虑拼接组合</li>
<li><strong>分离原则</strong>，策略和机制分离，接口和引擎分离</li>
<li><strong>简洁原则</strong>，设计要简洁，复杂度能低则低</li>
<li><strong>吝啬原则</strong>，除非没有办法，不要写大程序</li>
<li><strong>透明性原则</strong>，设计要有<strong>可见性</strong>（如输入输出、打点上报），便于审查和调试</li>
<li><strong>健壮原则</strong>，健壮源于透明和简洁</li>
<li><strong>表示原则</strong>，把知识转移到数据中，保证逻辑的简朴而健壮</li>
<li><strong>通俗原则</strong>，即最少惊奇原则，接口设计避免标新立异，缓和学习曲线</li>
<li><strong>缄默原则</strong>，设计良好的程序将用户的注意力视为有限的宝贵资源</li>
<li><strong>补救原则</strong>，出现异常时，马上退出并给出错误信息</li>
<li><strong>经济原则</strong>，宁花机器1分，不花程序员1秒</li>
<li><strong>生成原则</strong>，避免手工hack，编写程序去生成程序</li>
<li><strong>优化原则</strong>，过早优化会妨碍全局优化，先制作原型，再精雕细琢；先可用，再优化</li>
<li><strong>多样原则</strong>，不相信“不二法门”的断言</li>
<li><strong>扩展原则</strong>，未来总比预想来得要快</li>
</ul>
</li>
<li>Unix哲学一言以蔽之，即KISS（Keep It Simple, Stupid!）</li>
<li>善用他人写好的工具，尽可能将一切自动化</li>
</ul>
<h3 id="历史"><a href="#历史" class="headerlink" title="历史"></a>历史</h3><ul>
<li>计算机不应仅被视为一种逻辑设备而更应视为社群的立足点</li>
<li>1985年IEEE支持的POSIX标准表述了BSD和SVR3（System V Release3）调用的交集</li>
<li>1987年初，GNU C编译器第一版问世</li>
<li>1995年，Linux找到自己的杀手级应用——开源的web服务器Apache</li>
<li>过度依赖任何一种技术或者商业模式都是错误的</li>
</ul>
<h3 id="Unix哲学和其他哲学的对比"><a href="#Unix哲学和其他哲学的对比" class="headerlink" title="Unix哲学和其他哲学的对比"></a>Unix哲学和其他哲学的对比</h3><ul>
<li>统一性理念：一切皆文件 &amp; 管道概念</li>
<li>多任务能力：抢先式多任务</li>
<li>协作进程：低价的进程生成和简便的进程间通讯</li>
<li>内部边界：程序员最清楚一切</li>
<li>文件属性和记录结构：没有文件属性</li>
<li>减少使用不透明的二进制文件格式</li>
<li>首选CLI命令行界面</li>
<li>Unix是程序员写给程序员的</li>
<li>开发的门槛：轻松编程</li>
<li>操作系统的比较<ul>
<li>MacOS：MacOS有一个自己的界面方针，非常详细地说明了应用程序GUI的表现形式和行为模式</li>
<li>Windows NT：有注册表蠕变现象，不过支持了Cygwin，实现了Unix API的兼容</li>
<li>MVS：一切皆批处理</li>
<li>Linux：贴近终端用户的愿望使得Linux开发者比专有Unix更注重系统安装的平稳性和软件发布问题</li>
</ul>
</li>
</ul>
<h2 id="Design"><a href="#Design" class="headerlink" title="Design"></a>Design</h2><h3 id="模块性"><a href="#模块性" class="headerlink" title="模块性"></a>模块性</h3><ul>
<li>展开来说就是，要编写复杂软件又不至于一败涂地的唯一方法就是用定义清晰的接口把若干简单模块组合起来</li>
<li>Unix程序员骨子里的传统是：更加笃信重视模块化、更注重正交性和紧凑性等问题</li>
<li>封装良好的模块不会过多向外披露自身的细节</li>
<li>缺陷个数随着模块的代码行数会先减小，随后按代码行数的平方上升</li>
<li>紧凑性和正交性<ul>
<li>人类短期记忆能够容纳的不连续信息数就是7，加2或减2</li>
<li>紧凑性：有经验的用户通常不需要操作手册，让人乐于使用，不会在想法和工作间格格不入；紧凑不等于薄弱；一个功能子集，能够满足专家用户80%以上的一般需求</li>
<li>正交性：任何操作均无副作用，改变每个属性的方法有且仅有一个；重构代码就是改变代码的结构和组织，而不改变其外在行为</li>
<li>任何一个知识点在系统内都应当有一个<strong>唯一</strong>、明确、权威的表述（Single Point of Truth, SPOT）</li>
<li>提高紧凑性的精妙但强大的办法就是围绕“解决一个定义明确的问题”的强核心算法组织设计，避免臆断和捏造。形式化往往能极其明晰地阐述一项任务，与形式法相对的是<strong>试探法</strong>——凭经验法则得到的解决方案，这种思路的问题是回增生出大量特例和边界情况</li>
</ul>
</li>
<li>“限制不仅提倡了经济性，而且某种程度上提倡了设计的优雅”。要达到这种简洁性，尽量不要去想一种语言或操作系统最多能做多少事情，而是尽量去想这种语言或操作系统最少能做的事情——不是带着假想行动</li>
<li>设计有自顶向下和自底向上两种思路，前者通常先考虑主事件循环，再插入具体事件；后者通常先考虑封装具体任务，再按次序粘合在一起</li>
<li>出于自我保护，程序员尽量双管齐下——一方面以自顶向下的应用逻辑表达抽象规范，另一方面以函数或库来手机底层的域原语（原子操作）</li>
<li>实际代码往往是自顶向下和自底向上的综合产物。同一个项目经常同时兼有，这就导致了“胶合层”的出现</li>
<li>胶合层是个挺讨厌的东西，必须尽可能薄，这一点极为重要。薄胶合层原则可以看做是分离原则的升华。策略（应用逻辑）应该与机制（原子操作集）清晰地分离和解耦。</li>
<li>“完美之道，不在无可增加，而在无可删减”</li>
<li>OO语言鼓励“具有厚重的胶合和复杂层次”的体系。当问题域真的很复杂、确实需要大量抽象时，这可能是好事，但如果编程员到头来用复杂的方法来做简单的事情——仅仅是为他们能够这样做，结果便适得其反</li>
<li><strong>全局变量意味着代码不能重入</strong></li>
<li>“就我个人而言，如果局部变量太多，我倾向于拆分子程序。另一个方法是看代码行是否存在（太多）缩进。我几乎从来不看代码长度。——Ken Thompson”</li>
<li>如果通过电话向另一个程序员描述说不清楚，API可能就是太复杂，设计太糟糕了。</li>
</ul>
<h3 id="文本化"><a href="#文本化" class="headerlink" title="文本化"></a>文本化</h3><ul>
<li>序列化有时被称为列集（marshaling），其反向操作（载入）过程称为散集（unmarshaling）</li>
<li>互用性、透明性、可扩展性和经济性都是设计文本格式和应用协议需要考虑的问题</li>
<li>设计一个文本协议往往可以微系统的未来省不少力气；使用二进制协议的唯一正当理由是：如果要处理<strong>大批量</strong>的数据集，因而确实关注能否在介质上获得最大位密度，或是关心数据转化时的时间或指令开销。大图像和多媒体数据的格式有时可以算是前者的例子，对延时有严格要求的网络协议有则算作后者的例子</li>
<li>文本格式的位密度未必一定比二进制格式低多少；设计紧凑二进制格式的思路往往不能够兼顾干净扩展的要求</li>
<li>数据文件元格式是一套句法和词法约定，已经正式标准化或者通过实践得到充分确定<ul>
<li>DSV：冒号是默认的分隔符</li>
<li>RFC 822：字段名不得包含空格，通常用横线代替，空格和tab作为当前逻辑行的延续</li>
<li>XML：需要文档类型定义（如XHTML）和相关应用逻辑赋予其语义。通常可以语法检查就能发现形式问题或数据错误</li>
<li>Unix文本文件约定<ul>
<li>如果可能，以新行符结束的每一行只存一个记录</li>
<li>每行建议少于80字符</li>
<li>用<code>#</code>开始注释</li>
<li>支持反斜线<code>\</code></li>
<li>用冒号或连续空白作为字段分隔符</li>
<li>在节格式中，支持连续行</li>
<li>要么包含一个版本号，要么将格式设计成相互独立的自描述字节块</li>
<li>不要只压缩或者二进制编码文件的一部分</li>
</ul>
</li>
</ul>
</li>
<li>应用协议设计：如果应用协议是文本式的，那仅凭肉眼就能容易地分析，例：SMTP、POP3、IMAP</li>
<li>应用协议元格式：应用协议元格式是为了简化网络间事务处理的序列化操作而发展出来的，因为网络带宽要比存储昂贵得多，所以需要重视事务处理的经济性</li>
<li>目前还没有个制订较完善的元协议非常适合真正的P2P应用，不像客户端-服务器应用——HTTP在这一领域的游刃有余</li>
</ul>
<h3 id="透明性"><a href="#透明性" class="headerlink" title="透明性"></a>透明性</h3><ul>
<li>如果软件系统包含的功是为了帮助人们对软件建立正确的“做什么、怎样做”的心理模型而设计，这个软件系统就是可显的</li>
<li>用户喜欢UI中的透明性和可显性，是因为这意味着学习曲线比较平缓，而“最小立异原则”就是一个体现</li>
<li>优雅是力量与简洁的结合。优雅的代码事半功倍；优雅的代码不仅正确，而且<strong>显然</strong>正确；优雅的代码不仅将算法传达给计算机，同时也把简洁和信心传递给阅读代码的人</li>
<li>编写透明、可显的系统而节省的精力，将来完全可能就是自己的财富</li>
<li>用户的注意力是宝贵的，让Unix工具正常运行的最好策略是在大部分时间里沉默</li>
<li>真正的聪明是找到方法，可以访问部分细节，但是又不让它们太显眼</li>
<li>为透明性和可显性而设计<ul>
<li>不要在具体操作的代码上叠放太多的抽象层</li>
<li>透明性和可显性同模块性一样，主要是设计的特性而不是代码的特性<ul>
<li>程序调用层级最大深度是多少？</li>
<li>代码是否有强大而明显的不变性质</li>
<li>API的各函数调用是否正交</li>
<li>程序的数据结构或分类和它们代表的外部实体间，是否有一一映射关系</li>
<li>有多少魔法数字</li>
</ul>
</li>
<li><strong>隐藏</strong>细节和<strong>无法访问</strong>细节有着重要区别</li>
<li>透明的系统更容易实施恢复措施，首先就是更能抵抗bug的破坏</li>
</ul>
</li>
<li>Unix程序员的品性：“宁愿抛弃、重建代码也不远修补蹩脚的代码”</li>
<li>选择简单的算法</li>
</ul>
<h3 id="多路程序控制"><a href="#多路程序控制" class="headerlink" title="多路程序控制"></a>多路程序控制</h3><ul>
<li>Unix最具特点的程序模块化技法就是将大型程序分解成多个合作进程</li>
<li>Unix的设计风格强调用定义良好的进程间通信或共享文件来联通小型进程。因此，Unix操作系统提倡把程序分解成更简单的子进程，并专注考虑它们之间的接口<ul>
<li>降低进程生成的开销</li>
<li>提供方法（shellout、IO重定向、管道、消息传递、套接字）简化进程通信</li>
<li>提倡使用简单透明的文本数据格式来通信</li>
</ul>
</li>
<li>真正的难题不在协议语法而是<strong>协议逻辑</strong>——协议必须既有充分的表达能力又有防范死锁的能力</li>
<li>Unix的IPC分类<ul>
<li>最简单的形式：调用另一个程序来完成任务；专门程序通常借由文件系统和父进程通信</li>
<li>管道、重定向和过滤器：过滤器即从标准输入顺序读数据，然后向标准输出写数据；管道操作把程序的标准输出连接到另一个程序的标准输入</li>
<li>包装器：包装器或者将调用程序专用化，或者为它创建新的接口</li>
<li>从进程：子程序通过连接到标准输入和标准输出的管道，交互地和调用程序收发数据</li>
<li>对等进程通信：需要对等的通道<ul>
<li>临时文件：最古老的的IPC技法，灵活但有风险</li>
<li>信号：每个信号都对机收进程产生默认作用，进程可以声明<strong>信号处理程序</strong>，让信号处理程序覆盖信号的默认行为<ul>
<li><code>SIGHUP</code>，重新初始化</li>
<li><code>SIGTERM</code>，温和的终止</li>
<li><code>SIGKILL</code>，立即杀死进程</li>
</ul>
</li>
<li>套接字：套接字类似文件描述符，创建时可以指定<strong>协议族</strong>来告诉网络层如何解释套接字名称</li>
<li>共享内存：共享内存通常依靠<code>mmap</code>，把文件映射成可以被多个进程共享的内存</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="微型语言"><a href="#微型语言" class="headerlink" title="微型语言"></a>微型语言</h3><ul>
<li>程序员每百行代码出错率和所使用的编程语言在很大程度上无关</li>
<li>有两个好方法和一个坏方法做好微型语言的设计<ul>
<li>预先认识到可以使用微型语言设计把变成问题的规格说明提升一个层次</li>
<li>注意到规格说明文件格式越来越像微型语言——规格中蕴含着行为</li>
<li><strong>错误</strong>的方法是通过扩展变成微型语言</li>
</ul>
</li>
<li>微型语言的范畴从声明性发展到命令性，从而逐渐具有通用性，当他们明确为完备图灵机时，它们就是解释器</li>
<li>样例<ul>
<li>SNG，PNG的纯文本表达</li>
<li>正则表达式</li>
<li>Glade，描述GUI界面的XML文件</li>
<li>m4，一套宏指令集，规定文本串扩展成其他文本串的方式</li>
<li>XSLT，描述XML数据的变换</li>
<li>awk，将文本输入变换成文本输出</li>
<li>PostScript，向成像设备描述排班文本和图片的微型语言</li>
<li>bc、dc，任意精度计算</li>
<li>Emacs Lisp</li>
<li>JavaScript</li>
</ul>
</li>
<li>设计微型语言<ul>
<li>控制复杂度，声明性微型语言应该具有一个明确、一直、类自然语言的语法被人类所阅读</li>
<li>扩展和嵌入脚本语言，实现命令性语言</li>
<li>编写自定义语法</li>
<li>慎用宏</li>
</ul>
</li>
</ul>
<h3 id="生成"><a href="#生成" class="headerlink" title="生成"></a>生成</h3><ul>
<li>人类其实更善于肉眼观察数据而不是推导控制流程</li>
<li>数据比程序逻辑更易驾驭</li>
<li>数据驱动编程：把代码和代码作用的数据结构分清楚，始终把问题层次往上推，尽量把程序逻辑转移到数据中</li>
<li>专用代码的生成：尽可能少干活，让数据塑造代码，依靠工具，分离机制和策略</li>
</ul>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ul>
<li>无论何时想增加配置选项，最好考虑下下面的问题<ul>
<li>能省掉这个功能么</li>
<li>能否有无伤大雅的方式改变程序常规行为</li>
<li>选项是否过于花哨</li>
<li>需不需要一个独立的额外程序</li>
</ul>
</li>
<li>Unix的程序配置信息一般在以下5个位置<ul>
<li><code>/etc</code>下的运行控制文件</li>
<li>系统设置的环境变量</li>
<li>用户主目录下的运行控制文件（通常用<code>.</code>开头）</li>
<li>用户设置的环境变量</li>
<li>启动程序命令行参数</li>
</ul>
</li>
<li>可执行未见后面加<code>rc</code>表示“运行控制”（命名来自CTSS的runcom命令脚本功能）</li>
<li>一些最为常见的系统环境变量：<code>USER</code>，<code>LOGNAME</code>，<code>HOME</code>，<code>LINES</code>，<code>SHELL</code>，<code>PATH</code>等</li>
<li>常见的从<code>-a</code>到<code>-z</code>的命令行选项的可能含义<ul>
<li><code>-a</code>，所有、添加</li>
<li><code>-b</code>，缓冲区、批处理</li>
<li><code>-c</code>，命令、检查</li>
<li><code>-d</code>，调试、删除</li>
<li><code>-D</code>，定义</li>
<li><code>-e</code>，执行、编辑</li>
<li><code>-f</code>，文件、强制执行</li>
<li><code>-g</code>，全局</li>
<li><code>-h</code>，头部、帮助</li>
<li><code>-i</code>，初始化、交互式</li>
<li><code>-k</code>，保留、杀死</li>
<li><code>-l</code>，列表、登录、加载</li>
<li><code>-m</code>，消息、邮件</li>
<li><code>-n</code>，数字、否</li>
<li><code>-o</code>，输出</li>
<li><code>-p</code>，端口</li>
<li><code>-q</code>，安静</li>
<li><code>-r</code>，递归</li>
<li><code>-s</code>，缄默，大小</li>
<li><code>-t</code>，标记</li>
<li><code>-u</code>，用户</li>
<li><code>-v</code>，冗长</li>
<li><code>-V</code>，版本</li>
<li><code>-w</code>，宽度</li>
<li><code>-y</code>，是</li>
<li><code>-z</code>，启用压缩</li>
</ul>
</li>
</ul>
<h3 id="接口设计"><a href="#接口设计" class="headerlink" title="接口设计"></a>接口设计</h3><ul>
<li>从最小立异原则出发，启动后程序通常从下列来源获得输入或命令<ul>
<li>程序标准输入端的数据和命令</li>
<li>通过IPC的输入</li>
<li>已知位置的文件和设备</li>
</ul>
</li>
<li>最小立异原则不应被理解为在设计中号召机械的保守主义，新颖性提高了用户与接口最初几次的交互成本，但是糟糕的设计永远使接口令人痛苦而多余</li>
<li>“我们提倡以共生和委派策略来提高代码的复用并降低软件复杂度”</li>
<li>最小立异原则目的就是为了减少用户在使用接口时必须学习的复杂过程</li>
<li>Unix接口设计历史：CLI &#x3D;&gt; X</li>
<li>接口的5种度量标准：<strong>简洁、表现力、易用、透明和脚本化能力</strong><ul>
<li>简洁：事务处理需要的时间和复杂度需要有上限</li>
<li>表现力：接口可以触发广泛的行为</li>
<li>易用性：接口要求用户记忆的东西较少</li>
<li>透明度：用户使用接口时，几乎不用记忆什么问题、数据或者程序状态</li>
<li>脚本能力：容易被其他程序使用</li>
</ul>
</li>
<li>CLI和可视化接口的对比<ul>
<li>CLI更具表达力、脚本化能力、简洁性，适用于举例：SQL</li>
<li>可视化接口透明度、易用性较好，适用性举例：画图、网页浏览器</li>
<li>随着用户越来越熟练，对CLI接口的抵触也越少</li>
</ul>
</li>
<li>Unix接口设计模式<ul>
<li>过滤器：接受输入，转换成其他格式，再输出到标准输出端；宽进严出、不丢弃不需要的信息、不增加无用数据</li>
<li>cantrip（没有输入输出）、源模式（无输入且输出在启动条件中控制）、接收器模式（接收输入但不发送东西到输出）、编译器模式（无标准输入输出，但会发送信息到标准错误端）</li>
<li>ed模式（编辑器模式）</li>
<li>roguelike模式（来自BSD的地牢探险游戏rogue，用字符阵列显示界面UI），如vi、emacs，没有鼠标参与，适合指法熟练的人</li>
<li>引擎和接口分离，又或者模型和视图分离，了解MVC模式的人自然了解<ul>
<li>配置者、执行者</li>
<li>假脱机、守护进程</li>
<li>驱动、引擎</li>
<li>客户端、服务端</li>
</ul>
</li>
<li>基于语言的接口模式</li>
</ul>
</li>
<li>浏览器作为通用前端</li>
<li><strong>如果程序没有什么有趣的或者惊奇的东西要说就应该闭嘴</strong>（有点意思）</li>
</ul>
<h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><ul>
<li>Unix的经验告诉我们最主要的就是如何知道何时不去优化</li>
<li>最强大的优化技术就是<strong>不去优化</strong></li>
<li>先估量，后优化，直觉是糟糕的向导</li>
<li>最有效的代码优化方法是保持代码短小简单</li>
<li>核心数据结构必须留在最快的缓存</li>
<li>吞吐量和延迟时间的权衡是普遍现象，例TCP、UDP</li>
<li>对于减少延迟来说，阻塞或等待中间结果都是致命的</li>
<li><strong>按需计算</strong>出昂贵的结果，再<strong>缓存</strong>起来之后使用，可以兼得<strong>低延迟</strong>和<strong>高吞吐</strong></li>
</ul>
<h3 id="复杂度"><a href="#复杂度" class="headerlink" title="复杂度"></a>复杂度</h3><ul>
<li>简单即美即雅即善，而复杂即丑即怪即恶</li>
<li>程序员为了理解一个程序，会建立思维模型并调试之；程序的复杂度即模型建立和程序调试的困难程度</li>
<li>Unix思想的一个主题就是<strong>工具小巧锐利，设计从零开始，接口简单一致</strong></li>
<li><strong>偶然复杂度</strong>的产生是因为没有找到实现规定功能集合的最简方法，可以通过良好设计去除；<strong>选择复杂度</strong>和期望的功能相关联，只能通过修改工程目标解决</li>
<li>计算资源以及人类的思考，同财富一样，不是靠储藏而是靠消费来证明价值的</li>
<li><strong>选择需要管理的上下文环境，并且按照边界所允许的最小化方式构建程序</strong></li>
</ul>
<h2 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h2><h3 id="语言"><a href="#语言" class="headerlink" title="语言"></a>语言</h3><ul>
<li>C和C++以增加实现时间和（特别是）调试时间为代价来优化效率</li>
<li>C的内存管理是复杂性和错误的渊薮</li>
<li>C语言最佳之处是资源效率和接近机器语言，糟糕的地方是槟城简直是资源管理的炼狱</li>
<li>C++试图满足所有人的所有要求</li>
<li>Perl是增强版的shell，它为替代<code>awk</code>而设计，适合大量使用正则表达式的地方</li>
<li>Java的设计目标是“write once, run anywhere”，但它并没有实现这两个最初的设计目标</li>
<li>Java对小项目是大材小用</li>
<li>Emacs Lisp传统上只用于为Emacs编辑器编写本身的控制程序</li>
</ul>
<h3 id="重用"><a href="#重用" class="headerlink" title="重用"></a>重用</h3><ul>
<li>重新发明轮子之所以糟糕不仅因为浪费时间，还因为它浪费的时间往往是平方级</li>
<li>避免重新发明轮子的有效方法就是借用别人的设计和实现，即重用代码</li>
<li>文档并不能传达代码具现的所有细微差别之处</li>
<li>开放源码和代码重用的关系，许多地方很像浪漫爱情和有性生殖的关系</li>
<li>设计最好的实践需要情感的投入；软件开发者，同其他任何类型的工匠和技师一样；他们想要成为艺术家，这并不是什么私密。他们有艺术家的动力和需求，也拥有听众的欲望</li>
<li>开放源码是从意识形态上解决这些所有问题的优先方法</li>
<li>发布不够格软件的作者会承受许多的社会压力来修正或撤回代码（不一定）</li>
<li>阅读代码是为未来而投资</li>
<li><h2 id="许可证-许可证能够授权代码以某种形式使用，否则在版权法之下是禁止或者需要付费的-非商业使用的许可证并不等同于开源许可证"><a href="#许可证-许可证能够授权代码以某种形式使用，否则在版权法之下是禁止或者需要付费的-非商业使用的许可证并不等同于开源许可证" class="headerlink" title="许可证- 许可证能够授权代码以某种形式使用，否则在版权法之下是禁止或者需要付费的- 非商业使用的许可证并不等同于开源许可证"></a>许可证<br>- 许可证能够授权代码以某种形式使用，否则在版权法之下是禁止或者需要付费的<br>- 非商业使用的许可证并不等同于开源许可证</h2></li>
</ul>
<h2 id="Community"><a href="#Community" class="headerlink" title="Community"></a>Community</h2><h3 id="可移植性"><a href="#可移植性" class="headerlink" title="可移植性"></a>可移植性</h3><ul>
<li>C语言基于早期Ken Thompson的B语言解析器，脱胎于BCPL（Basic Common Programming Language），因此这个C代表Common（通用）</li>
<li>在IETF传统中，标准必须来自于一个可用原型实现的经验；不幸的是，这并不是标准通常发展的方式</li>
<li>搞笑RFC大概是唯一能够立即成为RFC的提议，比如RFC 1149（IP数据报的信鸽传递），RFC 2324（超文本咖啡壶控制协议）</li>
<li>对于具备提倡标准资格的RFC，其规格必须稳定，经过同行评审，并且已经吸引了互联网社区的极大兴趣</li>
<li>IETF标准化过程有意提倡由实践而非理论驱动的标准化过程</li>
<li>国际化的首要动作：<strong>分离信息库（配置）和代码</strong></li>
<li>“暗含的意思就是，成为标准的最好方法就是发布一个高质量的开源实现” —— Henry Spencer</li>
</ul>
<h3 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h3><ul>
<li>“一切皆HTML，所有引用都是URL”</li>
<li>绝大多数软件的文档都是由技术人员写给可能连最小公分母都不知道的普通大众的——渊博者写给无知者</li>
<li>编写Unix文档的最佳实践<ul>
<li>数量多不会被认为是质量高</li>
<li>信息密度适中，少用屏幕截图</li>
<li>没人喜欢庞大的文档，考虑提供快速的摘要</li>
</ul>
</li>
</ul>
<h3 id="开放源码"><a href="#开放源码" class="headerlink" title="开放源码"></a>开放源码</h3><ul>
<li>开源开发的规则<ul>
<li>源码公开</li>
<li>尽早发布，经常发布</li>
<li>给贡献以表扬</li>
</ul>
</li>
<li><code>major.minor.patch</code>，补丁号修正错误和次要功能；次版本号为兼容的新功能；主版本号为不兼容的更改</li>
<li><strong>发布前对文档和README进行拼写检查</strong></li>
<li>基于所需功能而不是平台来编写移植层（面向接口编程）<ul>
<li>“<code>#ifdef</code>和<code>#if</code>是最后一招，这通常是思路不当、产品过度差异化，无理由‘优化’或是无用垃圾聚集的先兆” —— Doug Mcllroy</li>
</ul>
</li>
<li>选择一个编码规范（lint）</li>
<li>常见的标准文件命名规范<ul>
<li>README</li>
<li>INSTALL</li>
<li>AUTHORS</li>
<li>NEWS</li>
<li>HISTORY</li>
<li>CHANGES</li>
<li>COPYING 项目许可证条款</li>
<li>LICENSE</li>
<li>FAQ</li>
</ul>
</li>
<li>以版本号来命名目录，考虑多版本在同一系统共存</li>
<li>在设计讨论中更广泛的参与常常是件好事，但是如果列表相对开放，迟早就会有些用户在其上询问一些初级问题</li>
<li>开源许可证<ul>
<li>MIT：授予无限权利的拷贝、使用、修改和对修改的再发布，只要在所有修改版本中保留版权和许可证条款</li>
<li>BSD：授予无限权利的拷贝、使用、修改和对修改的再发布，只要在所有修改版本中保留版权和许可证条款；同时在广告和软件包相关文档中包含致谢</li>
<li>Artistic：授予无限权利的拷贝、使用和本地修改的权利。允许在发行修改后的二进制版本，但是限制源码再发行</li>
<li>GPL、Mozilla</li>
</ul>
</li>
</ul>
<h3 id="未来"><a href="#未来" class="headerlink" title="未来"></a>未来</h3><ul>
<li>分离机制（配置）与策略（算法）成为一个明确准则</li>
<li>Unix文件仅仅是个字节大袋子，而没有其他文件属性</li>
<li><strong>开放源码将软件业转变为服务业</strong></li>
</ul>
<p><em>–END–</em></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://shenlvmeng.github.com/blog/2021/01/05/2020-to-2021/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
      <meta itemprop="name" content="shenlvmeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shenlvmeng's Blog">
      <meta itemprop="description" content="Be sharp, my friend.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Shenlvmeng's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2021/01/05/2020-to-2021/" class="post-title-link" itemprop="url">2020回顾暨2021展望</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-05 23:32:20" itemprop="dateCreated datePublished" datetime="2021-01-05T23:32:20+08:00">2021-01-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2021-01-07 23:32:39" itemprop="dateModified" datetime="2021-01-07T23:32:39+08:00">2021-01-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">日记</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/blog/2021/01/05/2020-to-2021/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/01/05/2020-to-2021/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>2019年写下第一篇<a target="_blank" rel="noopener" href="https://shenlvmeng.github.io/blog/2019/01/03/2018-to-2019/">总结</a>的时候，也未曾想到，这会成为一种一年一度的仪式，甚至能吸引到听众。但既然开始了，最好也能坚持下去。</p>
<p>如果说2019充满意外的话，2020只会是加大分量。不论是喜悦还是痛苦，2020留下的印记都格外得深一些。整体来看，由于遇到了一些预料之外的事情，在自我提升上向陌生方向多走了一些，不知是好是坏。</p>
<h2 id="2020回顾"><a href="#2020回顾" class="headerlink" title="2020回顾"></a>2020回顾</h2><p>内在素质上，阅读技术非技术方面的书籍完成5本，小说6本。基本完成任务。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://shenlvmeng.github.io/blog/2019/12/24/golang-learning/">Go语言入门学习</a></li>
<li><a target="_blank" rel="noopener" href="https://shenlvmeng.github.io/blog/2020/05/31/pragmatic-thinking-and-learning/">《程序员思维修炼》—— 思维方式和学习技巧</a></li>
<li><a target="_blank" rel="noopener" href="https://shenlvmeng.github.io/blog/2020/06/01/principles-of-macroeconomics/">《经济学原理》 - 宏观经济学原理笔记</a></li>
<li><a target="_blank" rel="noopener" href="https://shenlvmeng.github.io/blog/2020/08/12/soft-skills-for-software-developer/">《软技能 —— 代码外的生存指南》书摘</a></li>
<li><a target="_blank" rel="noopener" href="https://shenlvmeng.github.io/blog/2020/08/17/refactoring-design-improvement/">重构 —— 代码的实用性与艺术性</a></li>
</ul>
<p>整体还是在东看看西看看的阶段，其中《程序员思维修炼》一书对思维方式的介绍补足了自己的知识体系中方法论的部分。《软技能》一书启发了在理财方面的一些认识。</p>
<p>大多数的书还是看了又忘，忘了就再看看总结，然后再淡忘。这个过程中，留在知识体系里幸存的部分并不多。尤其是编程相关的书籍，还是需要靠实践做项目来巩固所看的内容。没错，说的就是《Go语言入门学习》。</p>
<p>个人形象上，作息时间基本达到预期计划。但由于出现了新爱好（调酒），买衣服的计划被长期搁置。工装裤和卫衣还是去年那些，果然这两样买再多都不够。体重略有下降，回到80。算是基本完成目标。发型在推平后，又往偏分的方向留了起来，和此前的侧背区别不甚大。短发在身边朋友的反馈里居然还不错。</p>
<p>社交上，丢失和主动放弃了一些朋友，大多是三观不合或者事业变动。在和朋友的沟通交往中，更偏向主动。不过长期如此，还挺累的。热情不用更热情了，倒是应该更加增大交友面。有试图发展亲密关系的朋友，在对象上有过努力，也同时认识到很多道理，此处略去。</p>
<p>生活情趣上，在骑车、拉琴、看电影上仍旧投入较多业余时间，其中骑车的设备也一直还是那辆老旧的山地车。拉琴和看电影上也没有什么投入。同时，发展了喝酒和调鸡尾酒的爱好。在冰箱中屯了很多，对基酒和调酒也有了些认识。骑行上，因为圣僧的工作变动，离开了北京，一位年轻的同事成为了新的骑友。百里画廊未能成行，但是<a target="_blank" rel="noopener" href="https://shenlvmeng.github.io/blog/2020/10/06/tour-to-qinghai-lake/">青海湖</a>成功成行，也是一次难忘的经历。旅行上，疫情原因日本没去成，年末去了广州，吃了好吃的一本满足。拉琴上，一直也有练习，有能熟练演奏的曲目，不过都还需要看谱演奏。另外，也在公司内做过相关分享。新爱好上，看了第一次话剧，livehouse一直没遇到喜欢的乐队，未能成行。另外因为厨房卫生问题，在家做饭频率下降，反而提高了探店的频率。整体看，生活还蛮有趣味。</p>
<p>工作事业上，发展尚可，背靠还不错的项目组，也遇到了很多挑战，有了带小方向的机会，在团队建设上也开始有了思考。不过进步速度在下半年有所减缓，注意力有些偏移。希望在下一年能调整过来。</p>
<h3 id="简单说几句"><a href="#简单说几句" class="headerlink" title="简单说几句"></a>简单说几句</h3><ul>
<li>积累太过理想化书面化，积累些现实点的东西，不是坏事</li>
<li>穿衣上，裤长是最严重的问题</li>
<li>要少喝酒，小酌小酌</li>
<li>坚持作息和三餐，坚持骑行登山游泳轧马路</li>
<li>要能清醒思考个人价值和现实价值</li>
<li>一段长久的亲密关系应该是相互成就而不是相互束缚的</li>
<li>爱合理分布在亲人、伴侣、朋友身上</li>
<li>事业上决断力要提高，还要画饼能力，越大越好</li>
</ul>
<h2 id="2021展望"><a href="#2021展望" class="headerlink" title="2021展望"></a>2021展望</h2><p>OK，又到了flag时间。吸取前两年的经验，目标不宜太明确，往往有意外惊喜。</p>
<ul>
<li><strong>内在</strong>：看完囤积的4本业务书籍和10本左右小说<ul>
<li>再寻找一项和前端覆盖率类似的技术点去探索突破</li>
<li>能清醒地评估个人价值，先知己</li>
<li>回顾过去几年积累，完善知识体系</li>
</ul>
</li>
<li><strong>外在</strong>：尝试新风格，保持健康，坚持运动<ul>
<li>坚持吃早饭和早睡</li>
<li>增加锻炼频率</li>
<li>发型尝试</li>
<li>基本款补齐（同去年）</li>
</ul>
</li>
<li><strong>情感</strong><ul>
<li>平衡爱的收入和支出，更有自信</li>
<li>能给一个人未来</li>
</ul>
</li>
<li><strong>生活</strong><ul>
<li>寻找一些提高生活幸福感的小东西或者经验</li>
<li>保持室内干净卫生</li>
<li>必要的旅行</li>
<li>固定的户外长途骑行</li>
<li>尝试新的菜式</li>
<li>坚持拉琴、电影、探店</li>
<li>至少一次livehouse</li>
</ul>
</li>
<li><strong>事业</strong><ul>
<li>思考职业规划和发展路线</li>
<li>考虑落脚城市、医疗、教育等现实因素</li>
<li>也去考虑父母的未来生活质量</li>
</ul>
</li>
</ul>
<p>就这么多吧，流水账短点为妙。诸位明年见~</p>
<p><em>Bye~</em></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://shenlvmeng.github.com/blog/2020/10/06/tour-to-qinghai-lake/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.jpg">
      <meta itemprop="name" content="shenlvmeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Shenlvmeng's Blog">
      <meta itemprop="description" content="Be sharp, my friend.">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Shenlvmeng's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/blog/2020/10/06/tour-to-qinghai-lake/" class="post-title-link" itemprop="url">记青海湖骑行</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-10-06 20:02:17" itemprop="dateCreated datePublished" datetime="2020-10-06T20:02:17+08:00">2020-10-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2020-10-08 21:13:40" itemprop="dateModified" datetime="2020-10-08T21:13:40+08:00">2020-10-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/blog/categories/%E6%B8%B8%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">游记</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/blog/2020/10/06/tour-to-qinghai-lake/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/10/06/tour-to-qinghai-lake/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <blockquote>
<p>随便写写。旅程中的大多数美好，事后回忆，原来都在造化中。</p>
</blockquote>
<h2 id="序：准备阶段"><a href="#序：准备阶段" class="headerlink" title="序：准备阶段"></a>序：准备阶段</h2><p>这次旅行本该在<a target="_blank" rel="noopener" href="https://shenlvmeng.github.io/blog/2019/09/16/tour-to-lijiang-and-dali/">去年国庆</a>成行，由于假期有限等种种原因delay到今年这个长假。又碰巧赶上疫情和中秋带来的额外假期，于是7、8月便早早和档期向来紧张的圣僧约好。圣僧和我本是隔壁宿舍关系，从3年多前的一次结伴骑行结缘，是我的长期骑友。他是个旅行达人（友链一波：<a target="_blank" rel="noopener" href="https://feichashao.com/travels/">肥叉烧</a>），身在外企，有钱有闲，经常出游，经验丰富。正巧这次碰上疫情，国外无处可去，和我定好日程后，三下五除二便把攻略搞定。和他一起出游真是省心。</p>
<h2 id="Day-1：银川"><a href="#Day-1：银川" class="headerlink" title="Day 1：银川"></a>Day 1：银川</h2><p>出于下面多个因素考虑（其实主要是第三项），我们第一天先出发去银川。</p>
<ul>
<li>假期时间充裕</li>
<li>慢慢适应高海拔</li>
<li>中转机票更便宜</li>
<li>凭借圣僧的会员，中转免费送一晚住宿外加去市区的大巴券</li>
</ul>
<p>因为这次是从大兴机场出发，还是8点半的飞机，早上5点就得起床。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00ltL6.jpg" alt="清晨的知春路口"></p>
<p>我们在机场值机柜台碰面，托运完行李时间已经不早了，于是直接就安检进站。安检中还没收了我的修车工具（😢）。这也是这一路意外离开我的第一样东西。突然到我都没拍张照给它留个纪念。</p>
<p>进站后，借助圣僧招行信用卡会员，一起在VIP休息厅吃了个早餐，条件还不错。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00les0.jpg" alt="VIP休息厅视角"></p>
<p>9月26号的银川天气不错，我们住宿的酒店——西港航空饭店距离银川河东机场非常近。酒店建筑整体很新，周围被各种绿化围绕，完全感觉不到在西北。另外房间很大，由于远离市区，环境也很安静。加上是中转免费送的，算是我们整个旅程中最满意的住宿体验了。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00lMoF.jpg" alt="西港-1"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/00lKdU.jpg" alt="西港-2"></p>
<p>在房间里稍作休息，我们步行到机场坐大巴前往市区，大巴券25元一位，我们使用的中转服务的免费大巴券直接乘车。大约1小时车程，我们在终点站鼓楼下车便进入了市中心。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00luZT.jpg" alt="鼓楼"></p>
<p>稍微逛逛，我和圣僧很快就发现了多不胜数的<strong>蜜雪冰城</strong>，几乎不见其他知名品牌，剩下的也都是没听过名字的小牌子。在竞争上，蜜雪冰城比上有其很能打的性价比，比下又有标准化保证。4元的柠檬水、5元的奶茶、2元的圆筒冰淇淋。天哪，这也太香了。蜜雪冰城也将成为我们后面旅程中的一大精神寄托，按下不表。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00lmLV.jpg" alt="蜜雪冰城"></p>
<p>作为回族自治区的省会，菜单中自然没有猪肉，取而代之的是各种<strong>羊肉</strong>。从鼓楼步行街向西走过几个路口，我们惯例性在地在邮局寄了明信片。随后在旁边的迎宾楼吃了午饭，尝了下号称特色的手抓羊肉。这么一盘98元，没想象中好吃，吃了三分之一就有点腻了。最后打包给圣僧当了晚餐。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00lli4.jpg" alt="手抓羊肉"></p>
<p>吃饱喝足，下个目标是带些伴手礼。宁夏的<strong>枸杞</strong>是比较出名的，其中以中卫的为最优。枸杞分红枸杞和黑枸杞，都没有明确的药用价值。但是日常保健还是有用的，号称能补气虚，很适合阳气虚弱的男性。黑枸杞据说劲儿更野一点。稍微做了下功课，我们在超市一人来了2斤，一斤75元。事后看，这个价格似乎有些上当，建议各位小买怡情即可。</p>
<p>银川城区内的共享单车似乎都是电动车，不论是青桔还是小蓝，还是美团单车。在一天的观察下，只注意到凤毛麟角的人力单车。这到底是因为当地人自行车技术很烂还是电动车驾驶技术很普及？挺有意思。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00l3W9.jpg" alt="共享单车"></p>
<p>天色渐暗，在人民公园感受了城市氛围后，我们乘坐大巴回到西港航空饭店，为第二天前往西宁做准备。</p>
<h2 id="Day-2-西宁"><a href="#Day-2-西宁" class="headerlink" title="Day 2: 西宁"></a>Day 2: 西宁</h2><p>西宁相比银川更有省会的感觉。不同于银川的回族居多，西宁有着比较明显的藏族气息，藏民也很常见。高海拔的强烈紫外线下，大多数人都是黝红的脸。由于第二天要坐大巴前往西海镇，我们这一天住在汽车站旁边的如家，在市区中处于偏东郊的位置。不出意外，楼下又是一家蜜雪冰城。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00l1JJ.jpg" alt="酒店"></p>
<p>西宁城区内有湟水自西向东流过，我们下午先是打车到了河边的<strong>中心广场</strong>，类似北京的元大都城垣遗址一样，不过明显更大且更有层次，湟水河宽度近似海河。在河边坐也好，走也好，感觉都是很不错的。下午3点，气温十余度，在河边的长椅上，一直都能看到飞机在高楼的天际线上划过。</p>
<p>西宁海拔约2100左右，处于多个山脉中的河谷地区，适宜建设城市的面积不大，只有大概一个十字形状的区域。所以城区中的楼房都格外的高，且能看出一些地势起伏。整体感觉，似乎来到了小号版的重庆。和重庆一样，这里看不到共享单车。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00l8zR.jpg" alt="城市景观"></p>
<p>不过从一些城市的角落，还是能瞥见藏在深处的旧工业时代的厂房气息。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00lJQ1.jpg" alt="旧厂房"></p>
<p>我比较偏好用随便走走四处看看的方式感受城市的风格。下午我们从中心广场绕过<strong>力盟商业区</strong>，再穿过九龙城寨般的<strong>商业巷大世界</strong>，从<strong>人民公园</strong>门口向回走，最后又回到颇具人气的力盟步行街。不能免俗，吃了顿呷哺呷哺。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00lYsx.jpg" alt="呷哺呷哺"></p>
<h2 id="Day-3-西海镇-种羊场"><a href="#Day-3-西海镇-种羊场" class="headerlink" title="Day 3: 西海镇 - 种羊场"></a>Day 3: 西海镇 - 种羊场</h2><blockquote>
<p>里程：48km</p>
</blockquote>
<p>去西海镇的车票我们是提前一天买好的，25元。但因为游客不多，其实也可以当天早上买。从火车站背后上京藏高速，一路穿过湟中区、湟源县、海晏县就到达了最终骑行的出发点西海镇，全程约2小时。租车上，我们早已提前和当地租车师傅约好，6天行程，租车500元，外加解决住宿700元（对租车店老板安排的住宿不要抱太高期望）和押金500元（结束骑行后退还），一共1700元。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003oq0.jpg" alt="西宁到西海镇"></p>
<p>西海镇是海北藏族自治州的州首府，不过却意外的荒凉，街道两边政府部门倒是周正齐全，基础设施也是一应完善，可是就是人迹稀少，连车都没几辆。我们下车后已经10点，第一天尚有40多公里的路程要骑。我们调试好车辆，装好驮包，穿戴好装备，擦好防晒（这个十分重要），简单吃了个饭就出发了。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003Q29.jpg" alt="出发合影"></p>
<p>沿着刚察路直走，穿过和G213国道的路口，就上了环湖东路。沿着环湖东路直走就可以达到第一天的目的地——湖东种羊场。路线也是相当简单。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003KC4.jpg" alt="路牌"></p>
<p>初见丘陵和草原，配合着壮观的云层，还是很有新鲜感的。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003n5F.jpg" alt="草原1"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/003mUU.jpg" alt="草原2"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/003M8J.jpg" alt="山丘1"></p>
<p>第一天的路并不像路书中那样全是平路，相反上下坡并不少。幸运的是，路边的景观稍微减缓了骑行的疲惫感。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/0033K1.jpg" alt="上坡1"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/003lvR.jpg" alt="上坡2"></p>
<p>穿过和G213国道的分岔路口后，我们离湖越来越近了。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003YVK.jpg" alt="996"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/003Gb6.jpg" alt="路牌"></p>
<p>随着湖水越来越近，金银潭和沙岛上起伏的沙丘却是也越来越显眼。湖边的荒漠化土地是我预先没想到的，据说是气候原因导致。但从沿路看到的各种牛羊来推断，和过度放牧可能也有些关系。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/0038Dx.jpg" alt="沙漠1"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/003N5D.jpg" alt="牦牛1"></p>
<p>穿过金银滩沙漠区，是一个大下坡，下坡后路两侧又逐渐恢复了植被和河流，看起来顺眼多了。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003aPe.jpg" alt="大下坡"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/003tUO.jpg" alt="绿地"></p>
<p>青海湖边地广人稀（整个青海除了西宁和海东应该都是地广人稀），除了风声，路两旁十分宁静，若是没有毒辣的紫外线，实在惬意极了。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003d8H.jpg" alt="车1"></p>
<p>再往前骑数公里，终于到达种羊场。这并不是一个镇或县，顶多是围绕湖东种羊场的一个聚落。住宿环境自然十分感人。卫生糟糕，门窗都可以从外面打开。具老板所说，这里民风淳朴，姑且只能信了。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003w2d.jpg" alt="种羊场住宿"></p>
<p>幸好有<strong>炕锅羊肉</strong>和壮观的落日场景可以抚慰。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003rrt.jpg" alt="炕锅羊肉"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/0030xA.jpg" alt="落日1"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/003DKI.jpg" alt="落日2"></p>
<p>青海湖周围海拔3200到3400，昼夜温差较大，太阳一落山，气温就比较冷了。种羊场也无甚可逛，我们直接倒头就睡，洗漱更衣直接放弃。只期待第二天住宿能好点。</p>
<h2 id="Day-4-种羊场-江西沟"><a href="#Day-4-种羊场-江西沟" class="headerlink" title="Day 4: 种羊场 - 江西沟"></a>Day 4: 种羊场 - 江西沟</h2><blockquote>
<p>里程：55km</p>
</blockquote>
<p>第二天一早我们吃了点买好的干粮，擦了防晒就直接出发。种羊场实在没什么好留恋。青海湖环湖的路都很直，两侧要么是无边的草原，要么是起伏的山丘，要么是看不到头的湖面。以至于路也看不到终点，似乎永远都骑不到头。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003sqP.jpg" alt="路1"></p>
<p>不过在骑行中，能察觉到远处的村庄、山岭、景观一点点靠近，还是蛮奇妙。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/0036Vf.jpg" alt="路2"></p>
<p>路边是牧民们的牛羊，似乎和内地的品种并不相同。牦牛们都很沉默，羊们也是，我蹩脚地起个头，它们也只是懒懒地抬个头望向我，依旧沉默。马儿们有的自由吃草，被人看管的则用来招徕游客骑行创收。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003WGQ.jpg" alt="牛"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/003ca8.jpg" alt="羊"></p>
<p>骑过错果，便告别了环湖东路S207，来到G109国道，相比环湖东路，国道上的车辆明显多了很多。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003RPg.jpg" alt="错果"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/003gIS.jpg" alt="路牌2"></p>
<p>从环湖东路和G109的交叉口到二郎剑景区，靠湖一侧都有维护良好的辅路，路面起伏不大，还有成片的油菜花可以欣赏，油菜花都不高，游客在其中拍照能露出脑袋，从车上看颇有趣味。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003f2j.jpg" alt="油菜花"></p>
<p>路的另一侧是连绵的不知疲倦的山丘，它将一路陪伴我们告别G109国道。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003hxs.jpg" alt="山丘2"></p>
<p>临近二郎剑景区有可以直接接近湖面的地方。这是一路第一次能亲近湖水的机会。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/003Irq.jpg" alt="青海湖"></p>
<p>在二郎剑边的中石油稍作休息，是一路枯燥的景观，16km后便到达终点江西沟。令人欣慰的是，住宿环境有了些微的改善。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/0035Mn.jpg" alt="江西沟住宿"></p>
<h2 id="Day-5-江西沟-黑马河-x2F-茶卡"><a href="#Day-5-江西沟-黑马河-x2F-茶卡" class="headerlink" title="Day 5: 江西沟 - 黑马河&#x2F;茶卡"></a>Day 5: 江西沟 - 黑马河&#x2F;茶卡</h2><blockquote>
<p>里程：48km</p>
</blockquote>
<p>这一天的里程虽然不长，却是环湖几天中，最疲惫的。原因是没有止境的逆风。一路上，景观和前一天无异，枯燥的山丘和草原，连湖面也不太能看见了。因为恼火的逆风，我甚至都没心情抬头看看路两旁的风景。</p>
<p>也许是因为大风把碎云都卷走，天上的云倒是挺好看。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00JeVP.jpg" alt="云1"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rb8I.jpg" alt="云2"></p>
<p>我大约提前圣僧1个小时到达，考虑到高原和糟糕的风向，圣僧临时修改计划，将第二天的茶卡盐湖之旅提前，把本来一天到达刚察县的计划拆成石乃亥 - 刚察县。这一决定不仅让我们看到了茶卡盐湖上的落日，也极大提升了后两天的骑行体验。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00Jn58.jpg" alt="黑马河"></p>
<p>黑马河位于G109和<strong>环湖西路</strong>S209的交叉口，前往茶卡、鸟岛，大西北自驾环线、环湖骑行都要经过这里。本来是发展不错的一个小镇。近些年考虑到环保因素，拆了大多数建筑，统一由政府管理建设，道路管道也大兴土木整修，目前看起来完全感受不到当地人所说当初的繁华。</p>
<p>我们运气不错，碰巧民宿老板要前往茶卡办公事，在圣僧下午3点到达后，我们搭了个便车去往茶卡（来回两人300元）。走G109去茶卡镇要穿越橡皮山，最高海拔3800m，且单程80km。对于骑行来说不太现实。老板比较健谈，一路和我们介绍了青海湖的旅游发展以及周边地理人文，挺有意思。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00JKPS.jpg" alt="橡皮山1"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/00JmUf.jpg" alt="橡皮山2"></p>
<p>茶卡盐湖的风景十分看天气。晴天无风的天气下，才有天空之镜的感觉。我们去的那天虽然晴空万里，不过风力较大，差不多夕阳落山时，西风终于转弱，得以让我拍到下面的景象。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00JVbt.jpg" alt="夕阳3"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/00JM8g.jpg" alt="夕阳4"></p>
<p>盐湖门票原价60，对青海、湖北、浙江籍游客免票。小火车单程50，车速和步行差不多，没有强需求可以不做。小火车沿着一条向湖区深处的路一直开到最里面，大约30分钟。路的西边湖水较浅，许多已蒸干出盐巴，还能看到湖盐厂的旧铁路和新厂址。许多游客穿着租赁的胶鞋在水面嬉戏。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00JQ2Q.jpg" alt="盐湖游客"></p>
<p>搭配雪一样的湖盐，有种北极村的感觉。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00Jlvj.jpg" alt="&quot;北极村&quot;"></p>
<p>坐车回到黑马河时已经晚上9点了，晚饭是<strong>牦牛肉串</strong> + 牛肉面，巴适得很。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00J3Ks.jpg" alt="肉串加牛肉面"></p>
<h2 id="Day-6-黑马河-石乃亥"><a href="#Day-6-黑马河-石乃亥" class="headerlink" title="Day 6: 黑马河 - 石乃亥"></a>Day 6: 黑马河 - 石乃亥</h2><blockquote>
<p>里程：39km</p>
</blockquote>
<p>没有了恼人的逆风后，这一天好骑多了（再加上里程短，应该是环湖最轻松的一天）。骑出黑马河镇，就和G109国道告别，上了环湖西路，车辆明显稍多了，整体体验大大提升。经过一段笔直的路程，可以绕到离湖不远的地方，接下来的一路也都如此，还能时不时看到自驾游的游客在路边拍照。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00J8rn.jpg" alt="湖边"></p>
<p>等接近石乃亥后，我们便离湖越来越远。经过一个小上坡，便能远远看到石乃亥乡的轮廓了。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rrE4.jpg" alt="小上坡1"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rcCR.jpg" alt="小上坡2"></p>
<p>石乃亥不大，基础设施倒是挺完善。由于到得比较早，我们很轻松吃了个<strong>土火锅</strong>作为午饭。土火锅里面有牦牛肉和各种素菜，价格145，还算划算。我们大快朵颐了快1个小时，最后也没吃完。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00ry59.jpg" alt="土火锅"></p>
<h2 id="Day-7-石乃亥-刚察县"><a href="#Day-7-石乃亥-刚察县" class="headerlink" title="Day 7: 石乃亥 - 刚察县"></a>Day 7: 石乃亥 - 刚察县</h2><blockquote>
<p>里程：78km</p>
</blockquote>
<p>骑出石乃亥约20公里，我们告别了海南共和县，来到海北刚察县境内。一如往常又是广袤的草原和起伏的山丘。骑过关闭的鸟岛，就来到了湖边的最后一段路。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rg81.jpg" alt="湖羊"></p>
<p>站在环湖东路的末尾处回头望，能看到最后一片湖面的波光粼粼。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00r2gx.jpg" alt="波光粼粼"></p>
<p>从岔路口右拐上G315国道，会贴着青藏铁路走一段。之后越过新修的西和高速便进入县城内。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rRv6.jpg" alt="岔道"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rhDO.jpg" alt="铁路1"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/00r4bD.jpg" alt="铁路2"></p>
<p>刚察县虽然只是个县城，但是热闹程度和城市美化程度一点不亚于西海镇，甚至更甚。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rIVe.jpg" alt="刚察县"></p>
<p>县城里的藏城电影院也在营业，虽然放映厅很小，还没有大学大教室大，但两人包场看《我和我的故乡》的体验还不错。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00roUH.jpg" alt="刚察电影院"></p>
<p>吃厌了羊肉，我们晚饭在一家成都冒菜馆解决了晚饭，能有吃菜自由的感觉真好。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rHPA.jpg" alt="冒菜"></p>
<p>另外，刚察的旅游厕所做的是真不错，体验比北京的管理公厕都要好。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rT5d.jpg" alt="刚厕"></p>
<h2 id="Day-8：刚察县-西海镇"><a href="#Day-8：刚察县-西海镇" class="headerlink" title="Day 8：刚察县 - 西海镇"></a>Day 8：刚察县 - 西海镇</h2><blockquote>
<p>里程：90km</p>
</blockquote>
<p>最后一天离湖就很远了。出刚察县先是一个大上坡，接着几乎一路平路骑28km可以到达哈尔盖河边的哈尔盖镇。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rsUJ.jpg" alt="刚察县上坡顶"></p>
<p>在哈尔盖中石化稍作休整，沿着315国道再骑20km到达甘子河乡，开始最后一个长坡，从海拔3200m来到3415m。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rN3q.jpg" alt="哈尔盖车站路口"></p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rwuT.jpg" alt="G315-170km"></p>
<p>从这个坡顶一个俯冲下来穿过西和高速，便从G315回到G213国道。这一段逆风很大，由于修路，大车也很多。它们开过的同时，尘土飞扬，恨不得把自行车都给吸进去。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00ravV.jpg" alt="G315下坡"></p>
<p>在一段艰辛的骑行后，我们来到修路的终点，也是整段路的最高海拔3445m，接着一路下坡，20km后在G213的拐弯处，西海镇已经越来越清晰。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rtCn.jpg" alt="骑行结尾"></p>
<p>我们最后还了车，又寄了明信片。在西海镇停留了最后一天。这里作为海北藏族自治州首府，各种政府部门和基础设施完备齐全。就是人迹稀少。偌大的跳广场舞的活动中心也没个人影。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rUg0.jpg" alt="海北藏族自治州文化活动中心"></p>
<p>夜晚了，路边的住房都亮起灯，仿佛又回到当初两弹一星时期建立原子城的岁月。</p>
<p><img src="https://s1.ax1x.com/2020/10/08/00rBbF.jpg" alt="原子城夜景"></p>
<h2 id="Day-9-x2F-10-西海镇-西宁-北京"><a href="#Day-9-x2F-10-西海镇-西宁-北京" class="headerlink" title="Day 9&#x2F;10: 西海镇 - 西宁 - 北京"></a>Day 9&#x2F;10: 西海镇 - 西宁 - 北京</h2><p>最后一天，我们回到西宁。重回城市的感觉真好，标准化和工业化给人太饱满的安全感了，躺在床上，回想起这为期6天的骑行，尽管风景很原生态很美好，但这也是以牺牲了工业化和标准化为代价的。除开住宿环境，缺少便捷的物流和交通，让沿途小镇的餐饮费物价居然比在西宁高。离开西宁前往西海镇前，我们恐怕没有预期到，以前毫不在意的蜜雪冰城和德克士居然成为了一种奢求和精神寄托。也许，人们都是图个新鲜，享受惯了工业化城市化带来的福利，居然也会想吃吃贫瘠和原生态的苦。</p>
<p>经过此次“艰苦”的骑行，圣僧说他心心念念的川藏线骑行也要好好考虑考虑了，可能磨练人的不是骑行本身，反而是沿途令人生畏的住宿环境。我们脸上和腿上的晒伤需要时间痊愈。不知道，圣僧心理上的畏惧又需要多久痊愈。</p>
<p><em>–END–</em></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/blog/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/blog/">1</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/blog/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/blog/page/31/">31</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/blog/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2014 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">shenlvmeng</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">1.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">29:45</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/blog/js/comments.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/motion.js"></script><script src="/blog/js/schemes/muse.js"></script><script src="/blog/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.14.3/algoliasearch-lite.umd.js" integrity="sha256-dyJcbGuYfdzNfifkHxYVd/rzeR6SLLcDFYEidcybldM=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/4.49.2/instantsearch.production.min.js" integrity="sha256-Nu8yqoXoRZEVYyZf4/eY1V4FsenbiCw85RY3gWjN3zQ=" crossorigin="anonymous"></script><script src="/blog/js/third-party/search/algolia-search.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/blog/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"shenlvmengs-blog","count":true,"i18n":{"disqus":"disqus"}}</script>
<script src="/blog/js/third-party/comments/disqus.js"></script>

</body>
</html>
